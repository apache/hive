PREHOOK: query: explain
select  
        cc_call_center_id Call_Center,
        cc_name Call_Center_Name,
        cc_manager Manager,
        sum(cr_net_loss) Returns_Loss
from
        call_center,
        catalog_returns,
        date_dim,
        customer,
        customer_address,
        customer_demographics,
        household_demographics
where
        cr_call_center_sk       = cc_call_center_sk
and     cr_returned_date_sk     = d_date_sk
and     cr_returning_customer_sk= c_customer_sk
and     cd_demo_sk              = c_current_cdemo_sk
and     hd_demo_sk              = c_current_hdemo_sk
and     ca_address_sk           = c_current_addr_sk
and     d_year                  = 1999 
and     d_moy                   = 11
and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')
        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))
and     hd_buy_potential like '0-500%'
and     ca_gmt_offset           = -7
group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status
order by sum(cr_net_loss) desc
PREHOOK: type: QUERY
PREHOOK: Input: default@call_center
PREHOOK: Input: default@catalog_returns
PREHOOK: Input: default@customer
PREHOOK: Input: default@customer_address
PREHOOK: Input: default@customer_demographics
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@household_demographics
#### A masked pattern was here ####
POSTHOOK: query: explain
select  
        cc_call_center_id Call_Center,
        cc_name Call_Center_Name,
        cc_manager Manager,
        sum(cr_net_loss) Returns_Loss
from
        call_center,
        catalog_returns,
        date_dim,
        customer,
        customer_address,
        customer_demographics,
        household_demographics
where
        cr_call_center_sk       = cc_call_center_sk
and     cr_returned_date_sk     = d_date_sk
and     cr_returning_customer_sk= c_customer_sk
and     cd_demo_sk              = c_current_cdemo_sk
and     hd_demo_sk              = c_current_hdemo_sk
and     ca_address_sk           = c_current_addr_sk
and     d_year                  = 1999 
and     d_moy                   = 11
and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')
        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))
and     hd_buy_potential like '0-500%'
and     ca_gmt_offset           = -7
group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status
order by sum(cr_net_loss) desc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@call_center
POSTHOOK: Input: default@catalog_returns
POSTHOOK: Input: default@customer
POSTHOOK: Input: default@customer_address
POSTHOOK: Input: default@customer_demographics
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@household_demographics
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: customer
          properties:
            hive.sql.query SELECT "t23"."call_center", "t23"."call_center_name", "t23"."manager", "t23"."returns_loss"
FROM (SELECT "t20"."cc_call_center_id" AS "call_center", "t20"."cc_name" AS "call_center_name", "t20"."cc_manager" AS "manager", SUM("t20"."cr_net_loss") AS "returns_loss", SUM("t20"."cr_net_loss") AS "(tok_function sum (tok_table_or_col cr_net_loss))"
FROM (SELECT "c_customer_sk", "c_current_cdemo_sk", "c_current_hdemo_sk", "c_current_addr_sk"
FROM (SELECT "c_customer_sk", "c_current_cdemo_sk", "c_current_hdemo_sk", "c_current_addr_sk"
FROM "customer") AS "t"
WHERE "c_customer_sk" IS NOT NULL AND "c_current_addr_sk" IS NOT NULL AND ("c_current_cdemo_sk" IS NOT NULL AND "c_current_hdemo_sk" IS NOT NULL)) AS "t1"
INNER JOIN (SELECT "ca_address_sk"
FROM (SELECT "ca_address_sk", "ca_gmt_offset"
FROM "customer_address") AS "t2"
WHERE "ca_gmt_offset" = -7 AND "ca_address_sk" IS NOT NULL) AS "t4" ON "t1"."c_current_addr_sk" = "t4"."ca_address_sk"
INNER JOIN (SELECT "hd_demo_sk"
FROM (SELECT "hd_demo_sk", "hd_buy_potential"
FROM "household_demographics") AS "t5"
WHERE "hd_buy_potential" LIKE '0-500%' AND "hd_demo_sk" IS NOT NULL) AS "t7" ON "t1"."c_current_hdemo_sk" = "t7"."hd_demo_sk"
INNER JOIN (SELECT "cd_demo_sk", "cd_marital_status", "cd_education_status"
FROM (SELECT "cd_demo_sk", "cd_marital_status", "cd_education_status"
FROM "customer_demographics") AS "t8"
WHERE ("cd_marital_status" = 'M' AND "cd_education_status" = 'Unknown' OR "cd_marital_status" = 'W' AND "cd_education_status" = 'Advanced Degree') AND "cd_marital_status" IN ('M', 'W') AND ("cd_education_status" IN ('Unknown', 'Advanced Degree') AND "cd_demo_sk" IS NOT NULL)) AS "t10" ON "t1"."c_current_cdemo_sk" = "t10"."cd_demo_sk"
INNER JOIN (SELECT "t13"."cr_returned_date_sk", "t13"."cr_returning_customer_sk", "t13"."cr_call_center_sk", "t13"."cr_net_loss", "t16"."d_date_sk", "t19"."cc_call_center_sk", "t19"."cc_call_center_id", "t19"."cc_name", "t19"."cc_manager"
FROM (SELECT "cr_returned_date_sk", "cr_returning_customer_sk", "cr_call_center_sk", "cr_net_loss"
FROM (SELECT "cr_returned_date_sk", "cr_returning_customer_sk", "cr_call_center_sk", "cr_net_loss"
FROM "catalog_returns") AS "t11"
WHERE "cr_call_center_sk" IS NOT NULL AND ("cr_returned_date_sk" IS NOT NULL AND "cr_returning_customer_sk" IS NOT NULL)) AS "t13"
INNER JOIN (SELECT "d_date_sk"
FROM (SELECT "d_date_sk", "d_year", "d_moy"
FROM "date_dim") AS "t14"
WHERE "d_year" = 1999 AND ("d_moy" = 11 AND "d_date_sk" IS NOT NULL)) AS "t16" ON "t13"."cr_returned_date_sk" = "t16"."d_date_sk"
INNER JOIN (SELECT "cc_call_center_sk", "cc_call_center_id", "cc_name", "cc_manager"
FROM (SELECT "cc_call_center_sk", "cc_call_center_id", "cc_name", "cc_manager"
FROM "call_center") AS "t17"
WHERE "cc_call_center_sk" IS NOT NULL) AS "t19" ON "t13"."cr_call_center_sk" = "t19"."cc_call_center_sk") AS "t20" ON "t1"."c_customer_sk" = "t20"."cr_returning_customer_sk"
GROUP BY "t10"."cd_marital_status", "t10"."cd_education_status", "t20"."cc_call_center_id", "t20"."cc_name", "t20"."cc_manager"
ORDER BY SUM("t20"."cr_net_loss") DESC) AS "t23"
            hive.sql.query.fieldNames call_center,call_center_name,manager,returns_loss
            hive.sql.query.fieldTypes string,string,string,decimal(17,2)
            hive.sql.query.split false
          Select Operator
            expressions: call_center (type: string), call_center_name (type: string), manager (type: string), returns_loss (type: decimal(17,2))
            outputColumnNames: _col0, _col1, _col2, _col3
            ListSink

