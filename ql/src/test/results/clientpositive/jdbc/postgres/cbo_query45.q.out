Warning: Shuffle Join MERGEJOIN[43][tables = [$hdt$_1, $hdt$_2]] in Stage 'Reducer 2' is a cross product
PREHOOK: query: explain cbo
select  ca_zip, ca_county, sum(ws_sales_price)
 from web_sales, customer, customer_address, date_dim, item
 where ws_bill_customer_sk = c_customer_sk
 	and c_current_addr_sk = ca_address_sk 
 	and ws_item_sk = i_item_sk 
 	and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')
 	      or 
 	      i_item_id in (select i_item_id
                             from item
                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)
                             )
 	    )
 	and ws_sold_date_sk = d_date_sk
 	and d_qoy = 2 and d_year = 2000
 group by ca_zip, ca_county
 order by ca_zip, ca_county
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@customer
PREHOOK: Input: default@customer_address
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@item
PREHOOK: Input: default@web_sales
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select  ca_zip, ca_county, sum(ws_sales_price)
 from web_sales, customer, customer_address, date_dim, item
 where ws_bill_customer_sk = c_customer_sk
 	and c_current_addr_sk = ca_address_sk 
 	and ws_item_sk = i_item_sk 
 	and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')
 	      or 
 	      i_item_id in (select i_item_id
                             from item
                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)
                             )
 	    )
 	and ws_sold_date_sk = d_date_sk
 	and d_qoy = 2 and d_year = 2000
 group by ca_zip, ca_county
 order by ca_zip, ca_county
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@customer
POSTHOOK: Input: default@customer_address
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@item
POSTHOOK: Input: default@web_sales
#### A masked pattern was here ####
CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100])
  HiveProject(ca_zip=[$1], ca_county=[$0], $f2=[$2])
    HiveAggregate(group=[{7, 8}], agg#0=[sum($3)])
      HiveFilter(condition=[OR(AND(<>($14, 0), IS NOT NULL($16)), IN(substr($8, 1, 5), _UTF-16LE'85669':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'86197':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'88274':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'83405':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'86475':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'85392':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'85460':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'80348':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'81792':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"))])
        HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$1], ws_bill_customer_sk=[$2], ws_sales_price=[$3], c_customer_sk=[$10], c_current_addr_sk=[$11], ca_address_sk=[$7], ca_county=[$8], ca_zip=[$9], d_date_sk=[$4], d_year=[$5], d_qoy=[$6], i_item_sk=[$12], i_item_id=[$13], c=[$14], i_item_id0=[$15], literalTrue=[$16])
          HiveJoin(condition=[=($1, $12)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$1], ws_bill_customer_sk=[$2], ws_sales_price=[$3], d_date_sk=[$4], d_year=[$5], d_qoy=[$6], ca_address_sk=[$7], ca_county=[$8], ca_zip=[$9], c_customer_sk=[$10], c_current_addr_sk=[$11])
              HiveJdbcConverter(convention=[JDBC.POSTGRES])
                JdbcJoin(condition=[=($2, $10)], joinType=[inner])
                  JdbcJoin(condition=[=($0, $4)], joinType=[inner])
                    JdbcProject(ws_sold_date_sk=[$0], ws_item_sk=[$1], ws_bill_customer_sk=[$2], ws_sales_price=[$3])
                      JdbcFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($0), IS NOT NULL($1))])
                        JdbcProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_bill_customer_sk=[$4], ws_sales_price=[$21])
                          JdbcHiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                    JdbcProject(d_date_sk=[$0], d_year=[$1], d_qoy=[$2])
                      JdbcFilter(condition=[AND(=($2, 2), =($1, 2000), IS NOT NULL($0))])
                        JdbcProject(d_date_sk=[$0], d_year=[$6], d_qoy=[$10])
                          JdbcHiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                  JdbcProject(ca_address_sk=[$0], ca_county=[$1], ca_zip=[$2], c_customer_sk=[$3], c_current_addr_sk=[$4])
                    JdbcJoin(condition=[=($4, $0)], joinType=[inner])
                      JdbcProject(ca_address_sk=[$0], ca_county=[$1], ca_zip=[$2])
                        JdbcFilter(condition=[IS NOT NULL($0)])
                          JdbcProject(ca_address_sk=[$0], ca_county=[$7], ca_zip=[$9])
                            JdbcHiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])
                      JdbcProject(c_customer_sk=[$0], c_current_addr_sk=[$1])
                        JdbcFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($1))])
                          JdbcProject(c_customer_sk=[$0], c_current_addr_sk=[$4])
                            JdbcHiveTableScan(table=[[default, customer]], table:alias=[customer])
            HiveJoin(condition=[=($1, $3)], joinType=[left], algorithm=[none], cost=[not available])
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(i_item_sk=[$0], i_item_id=[$1])
                  HiveProject(i_item_sk=[$0], i_item_id=[$1])
                    HiveJdbcConverter(convention=[JDBC.POSTGRES])
                      JdbcFilter(condition=[IS NOT NULL($0)])
                        JdbcProject(i_item_sk=[$0], i_item_id=[$1])
                          JdbcHiveTableScan(table=[[default, item]], table:alias=[item])
                HiveProject(c=[$0])
                  HiveJdbcConverter(convention=[JDBC.POSTGRES])
                    JdbcAggregate(group=[{}], c=[COUNT()])
                      JdbcFilter(condition=[IN($0, 2:BIGINT, 3:BIGINT, 5:BIGINT, 7:BIGINT, 11:BIGINT, 13:BIGINT, 17:BIGINT, 19:BIGINT, 23:BIGINT, 29:BIGINT)])
                        JdbcProject(i_item_sk=[$0], i_item_id=[$1])
                          JdbcHiveTableScan(table=[[default, item]], table:alias=[item])
              HiveProject(i_item_id=[$0], literalTrue=[$1])
                HiveJdbcConverter(convention=[JDBC.POSTGRES])
                  JdbcProject(i_item_id=[$0], literalTrue=[true])
                    JdbcAggregate(group=[{1}])
                      JdbcFilter(condition=[AND(IN($0, 2:BIGINT, 3:BIGINT, 5:BIGINT, 7:BIGINT, 11:BIGINT, 13:BIGINT, 17:BIGINT, 19:BIGINT, 23:BIGINT, 29:BIGINT), IS NOT NULL($1))])
                        JdbcProject(i_item_sk=[$0], i_item_id=[$1])
                          JdbcHiveTableScan(table=[[default, item]], table:alias=[item])

