PREHOOK: query: explain
select   
         w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
        ,ship_carriers
        ,year
 	,sum(jan_sales) as jan_sales
 	,sum(feb_sales) as feb_sales
 	,sum(mar_sales) as mar_sales
 	,sum(apr_sales) as apr_sales
 	,sum(may_sales) as may_sales
 	,sum(jun_sales) as jun_sales
 	,sum(jul_sales) as jul_sales
 	,sum(aug_sales) as aug_sales
 	,sum(sep_sales) as sep_sales
 	,sum(oct_sales) as oct_sales
 	,sum(nov_sales) as nov_sales
 	,sum(dec_sales) as dec_sales
 	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot
 	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot
 	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot
 	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot
 	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot
 	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot
 	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot
 	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot
 	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot
 	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot
 	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot
 	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot
 	,sum(jan_net) as jan_net
 	,sum(feb_net) as feb_net
 	,sum(mar_net) as mar_net
 	,sum(apr_net) as apr_net
 	,sum(may_net) as may_net
 	,sum(jun_net) as jun_net
 	,sum(jul_net) as jul_net
 	,sum(aug_net) as aug_net
 	,sum(sep_net) as sep_net
 	,sum(oct_net) as oct_net
 	,sum(nov_net) as nov_net
 	,sum(dec_net) as dec_net
 from (
    (select 
 	w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,'DIAMOND' || ',' || 'AIRBORNE' as ship_carriers
       ,d_year as year
 	,sum(case when d_moy = 1 
 		then ws_sales_price* ws_quantity else 0 end) as jan_sales
 	,sum(case when d_moy = 2 
 		then ws_sales_price* ws_quantity else 0 end) as feb_sales
 	,sum(case when d_moy = 3 
 		then ws_sales_price* ws_quantity else 0 end) as mar_sales
 	,sum(case when d_moy = 4 
 		then ws_sales_price* ws_quantity else 0 end) as apr_sales
 	,sum(case when d_moy = 5 
 		then ws_sales_price* ws_quantity else 0 end) as may_sales
 	,sum(case when d_moy = 6 
 		then ws_sales_price* ws_quantity else 0 end) as jun_sales
 	,sum(case when d_moy = 7 
 		then ws_sales_price* ws_quantity else 0 end) as jul_sales
 	,sum(case when d_moy = 8 
 		then ws_sales_price* ws_quantity else 0 end) as aug_sales
 	,sum(case when d_moy = 9 
 		then ws_sales_price* ws_quantity else 0 end) as sep_sales
 	,sum(case when d_moy = 10 
 		then ws_sales_price* ws_quantity else 0 end) as oct_sales
 	,sum(case when d_moy = 11
 		then ws_sales_price* ws_quantity else 0 end) as nov_sales
 	,sum(case when d_moy = 12
 		then ws_sales_price* ws_quantity else 0 end) as dec_sales
 	,sum(case when d_moy = 1 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net
 	,sum(case when d_moy = 2
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net
 	,sum(case when d_moy = 3 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net
 	,sum(case when d_moy = 4 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net
 	,sum(case when d_moy = 5 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net
 	,sum(case when d_moy = 6 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net
 	,sum(case when d_moy = 7 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net
 	,sum(case when d_moy = 8 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net
 	,sum(case when d_moy = 9 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net
 	,sum(case when d_moy = 10 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net
 	,sum(case when d_moy = 11
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net
 	,sum(case when d_moy = 12
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net
     from
          web_sales
         ,warehouse
         ,date_dim
         ,time_dim
 	  ,ship_mode
     where
            ws_warehouse_sk =  w_warehouse_sk
        and ws_sold_date_sk = d_date_sk
        and ws_sold_time_sk = t_time_sk
 	and ws_ship_mode_sk = sm_ship_mode_sk
        and d_year = 2002
 	and t_time between 49530 and 49530+28800 
 	and sm_carrier in ('DIAMOND','AIRBORNE')
     group by 
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
       ,d_year
 	)
 union all
    (select 
 	w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,'DIAMOND' || ',' || 'AIRBORNE' as ship_carriers
       ,d_year as year
 	,sum(case when d_moy = 1 
 		then cs_ext_sales_price* cs_quantity else 0 end) as jan_sales
 	,sum(case when d_moy = 2 
 		then cs_ext_sales_price* cs_quantity else 0 end) as feb_sales
 	,sum(case when d_moy = 3 
 		then cs_ext_sales_price* cs_quantity else 0 end) as mar_sales
 	,sum(case when d_moy = 4 
 		then cs_ext_sales_price* cs_quantity else 0 end) as apr_sales
 	,sum(case when d_moy = 5 
 		then cs_ext_sales_price* cs_quantity else 0 end) as may_sales
 	,sum(case when d_moy = 6 
 		then cs_ext_sales_price* cs_quantity else 0 end) as jun_sales
 	,sum(case when d_moy = 7 
 		then cs_ext_sales_price* cs_quantity else 0 end) as jul_sales
 	,sum(case when d_moy = 8 
 		then cs_ext_sales_price* cs_quantity else 0 end) as aug_sales
 	,sum(case when d_moy = 9 
 		then cs_ext_sales_price* cs_quantity else 0 end) as sep_sales
 	,sum(case when d_moy = 10 
 		then cs_ext_sales_price* cs_quantity else 0 end) as oct_sales
 	,sum(case when d_moy = 11
 		then cs_ext_sales_price* cs_quantity else 0 end) as nov_sales
 	,sum(case when d_moy = 12
 		then cs_ext_sales_price* cs_quantity else 0 end) as dec_sales
 	,sum(case when d_moy = 1 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net
 	,sum(case when d_moy = 2 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net
 	,sum(case when d_moy = 3 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net
 	,sum(case when d_moy = 4 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net
 	,sum(case when d_moy = 5 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net
 	,sum(case when d_moy = 6 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net
 	,sum(case when d_moy = 7 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net
 	,sum(case when d_moy = 8 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net
 	,sum(case when d_moy = 9 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net
 	,sum(case when d_moy = 10 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net
 	,sum(case when d_moy = 11
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net
 	,sum(case when d_moy = 12
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net
     from
          catalog_sales
         ,warehouse
         ,date_dim
         ,time_dim
 	 ,ship_mode
     where
            cs_warehouse_sk =  w_warehouse_sk
        and cs_sold_date_sk = d_date_sk
        and cs_sold_time_sk = t_time_sk
 	and cs_ship_mode_sk = sm_ship_mode_sk
        and d_year = 2002
 	and t_time between 49530 AND 49530+28800 
 	and sm_carrier in ('DIAMOND','AIRBORNE')
     group by 
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
       ,d_year
     ) 
 ) x
 group by 
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,ship_carriers
       ,year
 order by w_warehouse_name
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@catalog_sales
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@ship_mode
PREHOOK: Input: default@time_dim
PREHOOK: Input: default@warehouse
PREHOOK: Input: default@web_sales
#### A masked pattern was here ####
POSTHOOK: query: explain
select   
         w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
        ,ship_carriers
        ,year
 	,sum(jan_sales) as jan_sales
 	,sum(feb_sales) as feb_sales
 	,sum(mar_sales) as mar_sales
 	,sum(apr_sales) as apr_sales
 	,sum(may_sales) as may_sales
 	,sum(jun_sales) as jun_sales
 	,sum(jul_sales) as jul_sales
 	,sum(aug_sales) as aug_sales
 	,sum(sep_sales) as sep_sales
 	,sum(oct_sales) as oct_sales
 	,sum(nov_sales) as nov_sales
 	,sum(dec_sales) as dec_sales
 	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot
 	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot
 	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot
 	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot
 	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot
 	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot
 	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot
 	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot
 	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot
 	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot
 	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot
 	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot
 	,sum(jan_net) as jan_net
 	,sum(feb_net) as feb_net
 	,sum(mar_net) as mar_net
 	,sum(apr_net) as apr_net
 	,sum(may_net) as may_net
 	,sum(jun_net) as jun_net
 	,sum(jul_net) as jul_net
 	,sum(aug_net) as aug_net
 	,sum(sep_net) as sep_net
 	,sum(oct_net) as oct_net
 	,sum(nov_net) as nov_net
 	,sum(dec_net) as dec_net
 from (
    (select 
 	w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,'DIAMOND' || ',' || 'AIRBORNE' as ship_carriers
       ,d_year as year
 	,sum(case when d_moy = 1 
 		then ws_sales_price* ws_quantity else 0 end) as jan_sales
 	,sum(case when d_moy = 2 
 		then ws_sales_price* ws_quantity else 0 end) as feb_sales
 	,sum(case when d_moy = 3 
 		then ws_sales_price* ws_quantity else 0 end) as mar_sales
 	,sum(case when d_moy = 4 
 		then ws_sales_price* ws_quantity else 0 end) as apr_sales
 	,sum(case when d_moy = 5 
 		then ws_sales_price* ws_quantity else 0 end) as may_sales
 	,sum(case when d_moy = 6 
 		then ws_sales_price* ws_quantity else 0 end) as jun_sales
 	,sum(case when d_moy = 7 
 		then ws_sales_price* ws_quantity else 0 end) as jul_sales
 	,sum(case when d_moy = 8 
 		then ws_sales_price* ws_quantity else 0 end) as aug_sales
 	,sum(case when d_moy = 9 
 		then ws_sales_price* ws_quantity else 0 end) as sep_sales
 	,sum(case when d_moy = 10 
 		then ws_sales_price* ws_quantity else 0 end) as oct_sales
 	,sum(case when d_moy = 11
 		then ws_sales_price* ws_quantity else 0 end) as nov_sales
 	,sum(case when d_moy = 12
 		then ws_sales_price* ws_quantity else 0 end) as dec_sales
 	,sum(case when d_moy = 1 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net
 	,sum(case when d_moy = 2
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net
 	,sum(case when d_moy = 3 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net
 	,sum(case when d_moy = 4 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net
 	,sum(case when d_moy = 5 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net
 	,sum(case when d_moy = 6 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net
 	,sum(case when d_moy = 7 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net
 	,sum(case when d_moy = 8 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net
 	,sum(case when d_moy = 9 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net
 	,sum(case when d_moy = 10 
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net
 	,sum(case when d_moy = 11
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net
 	,sum(case when d_moy = 12
 		then ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net
     from
          web_sales
         ,warehouse
         ,date_dim
         ,time_dim
 	  ,ship_mode
     where
            ws_warehouse_sk =  w_warehouse_sk
        and ws_sold_date_sk = d_date_sk
        and ws_sold_time_sk = t_time_sk
 	and ws_ship_mode_sk = sm_ship_mode_sk
        and d_year = 2002
 	and t_time between 49530 and 49530+28800 
 	and sm_carrier in ('DIAMOND','AIRBORNE')
     group by 
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
       ,d_year
 	)
 union all
    (select 
 	w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,'DIAMOND' || ',' || 'AIRBORNE' as ship_carriers
       ,d_year as year
 	,sum(case when d_moy = 1 
 		then cs_ext_sales_price* cs_quantity else 0 end) as jan_sales
 	,sum(case when d_moy = 2 
 		then cs_ext_sales_price* cs_quantity else 0 end) as feb_sales
 	,sum(case when d_moy = 3 
 		then cs_ext_sales_price* cs_quantity else 0 end) as mar_sales
 	,sum(case when d_moy = 4 
 		then cs_ext_sales_price* cs_quantity else 0 end) as apr_sales
 	,sum(case when d_moy = 5 
 		then cs_ext_sales_price* cs_quantity else 0 end) as may_sales
 	,sum(case when d_moy = 6 
 		then cs_ext_sales_price* cs_quantity else 0 end) as jun_sales
 	,sum(case when d_moy = 7 
 		then cs_ext_sales_price* cs_quantity else 0 end) as jul_sales
 	,sum(case when d_moy = 8 
 		then cs_ext_sales_price* cs_quantity else 0 end) as aug_sales
 	,sum(case when d_moy = 9 
 		then cs_ext_sales_price* cs_quantity else 0 end) as sep_sales
 	,sum(case when d_moy = 10 
 		then cs_ext_sales_price* cs_quantity else 0 end) as oct_sales
 	,sum(case when d_moy = 11
 		then cs_ext_sales_price* cs_quantity else 0 end) as nov_sales
 	,sum(case when d_moy = 12
 		then cs_ext_sales_price* cs_quantity else 0 end) as dec_sales
 	,sum(case when d_moy = 1 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net
 	,sum(case when d_moy = 2 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net
 	,sum(case when d_moy = 3 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net
 	,sum(case when d_moy = 4 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net
 	,sum(case when d_moy = 5 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net
 	,sum(case when d_moy = 6 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net
 	,sum(case when d_moy = 7 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net
 	,sum(case when d_moy = 8 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net
 	,sum(case when d_moy = 9 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net
 	,sum(case when d_moy = 10 
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net
 	,sum(case when d_moy = 11
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net
 	,sum(case when d_moy = 12
 		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net
     from
          catalog_sales
         ,warehouse
         ,date_dim
         ,time_dim
 	 ,ship_mode
     where
            cs_warehouse_sk =  w_warehouse_sk
        and cs_sold_date_sk = d_date_sk
        and cs_sold_time_sk = t_time_sk
 	and cs_ship_mode_sk = sm_ship_mode_sk
        and d_year = 2002
 	and t_time between 49530 AND 49530+28800 
 	and sm_carrier in ('DIAMOND','AIRBORNE')
     group by 
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
       ,d_year
     ) 
 ) x
 group by 
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,ship_carriers
       ,year
 order by w_warehouse_name
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@catalog_sales
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@ship_mode
POSTHOOK: Input: default@time_dim
POSTHOOK: Input: default@warehouse
POSTHOOK: Input: default@web_sales
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: web_sales
          properties:
            hive.sql.query SELECT "$f0" AS "w_warehouse_name", "$f1" AS "w_warehouse_sq_ft", "$f2" AS "w_city", "$f3" AS "w_county", "$f4" AS "w_state", "$f5" AS "w_country", CAST('DIAMOND,AIRBORNE' AS VARCHAR(10485760)) AS "ship_carriers", CAST(2002 AS INTEGER) AS "year", "$f6" AS "jan_sales", "$f7" AS "feb_sales", "$f8" AS "mar_sales", "$f9" AS "apr_sales", "$f10" AS "may_sales", "$f11" AS "jun_sales", "$f12" AS "jul_sales", "$f13" AS "aug_sales", "$f14" AS "sep_sales", "$f15" AS "oct_sales", "$f16" AS "nov_sales", "$f17" AS "dec_sales", "$f18" AS "jan_sales_per_sq_foot", "$f19" AS "feb_sales_per_sq_foot", "$f20" AS "mar_sales_per_sq_foot", "$f21" AS "apr_sales_per_sq_foot", "$f22" AS "may_sales_per_sq_foot", "$f23" AS "jun_sales_per_sq_foot", "$f24" AS "jul_sales_per_sq_foot", "$f25" AS "aug_sales_per_sq_foot", "$f26" AS "sep_sales_per_sq_foot", "$f27" AS "oct_sales_per_sq_foot", "$f28" AS "nov_sales_per_sq_foot", "$f29" AS "dec_sales_per_sq_foot", "$f30" AS "jan_net", "$f31" AS "feb_net", "$f32" AS "mar_net", "$f33" AS "apr_net", "$f34" AS "may_net", "$f35" AS "jun_net", "$f36" AS "jul_net", "$f37" AS "aug_net", "$f38" AS "sep_net", "$f39" AS "oct_net", "$f40" AS "nov_net", "$f41" AS "dec_net"
FROM (SELECT "$f0", "$f1", "$f2", "$f3", "$f4", "$f5", SUM("$f6") AS "$f6", SUM("$f7") AS "$f7", SUM("$f8") AS "$f8", SUM("$f9") AS "$f9", SUM("$f10") AS "$f10", SUM("$f11") AS "$f11", SUM("$f12") AS "$f12", SUM("$f13") AS "$f13", SUM("$f14") AS "$f14", SUM("$f15") AS "$f15", SUM("$f16") AS "$f16", SUM("$f17") AS "$f17", SUM("$f6" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f18", SUM("$f7" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f19", SUM("$f8" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f20", SUM("$f9" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f21", SUM("$f10" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f22", SUM("$f11" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f23", SUM("$f12" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f24", SUM("$f13" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f25", SUM("$f14" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f26", SUM("$f15" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f27", SUM("$f16" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f28", SUM("$f17" / CAST("$f1" AS DECIMAL(10, 0))) AS "$f29", SUM("$f18") AS "$f30", SUM("$f19") AS "$f31", SUM("$f20") AS "$f32", SUM("$f21") AS "$f33", SUM("$f22") AS "$f34", SUM("$f23") AS "$f35", SUM("$f24") AS "$f36", SUM("$f25") AS "$f37", SUM("$f26") AS "$f38", SUM("$f27") AS "$f39", SUM("$f28") AS "$f40", SUM("$f29") AS "$f41"
FROM (SELECT "t10"."w_warehouse_name" AS "$f0", "t10"."w_warehouse_sq_ft" AS "$f1", "t10"."w_city" AS "$f2", "t10"."w_county" AS "$f3", "t10"."w_state" AS "$f4", "t10"."w_country" AS "$f5", SUM(CASE WHEN "t13"."=" THEN "t1"."""*""" ELSE 0 END) AS "$f6", SUM(CASE WHEN "t13"."=2" THEN "t1"."""*""" ELSE 0 END) AS "$f7", SUM(CASE WHEN "t13"."=3" THEN "t1"."""*""" ELSE 0 END) AS "$f8", SUM(CASE WHEN "t13"."=4" THEN "t1"."""*""" ELSE 0 END) AS "$f9", SUM(CASE WHEN "t13"."=5" THEN "t1"."""*""" ELSE 0 END) AS "$f10", SUM(CASE WHEN "t13"."=6" THEN "t1"."""*""" ELSE 0 END) AS "$f11", SUM(CASE WHEN "t13"."=7" THEN "t1"."""*""" ELSE 0 END) AS "$f12", SUM(CASE WHEN "t13"."=8" THEN "t1"."""*""" ELSE 0 END) AS "$f13", SUM(CASE WHEN "t13"."=9" THEN "t1"."""*""" ELSE 0 END) AS "$f14", SUM(CASE WHEN "t13"."=10" THEN "t1"."""*""" ELSE 0 END) AS "$f15", SUM(CASE WHEN "t13"."=11" THEN "t1"."""*""" ELSE 0 END) AS "$f16", SUM(CASE WHEN "t13"."=12" THEN "t1"."""*""" ELSE 0 END) AS "$f17", SUM(CASE WHEN "t13"."=" THEN "t1"."*5" ELSE 0 END) AS "$f18", SUM(CASE WHEN "t13"."=2" THEN "t1"."*5" ELSE 0 END) AS "$f19", SUM(CASE WHEN "t13"."=3" THEN "t1"."*5" ELSE 0 END) AS "$f20", SUM(CASE WHEN "t13"."=4" THEN "t1"."*5" ELSE 0 END) AS "$f21", SUM(CASE WHEN "t13"."=5" THEN "t1"."*5" ELSE 0 END) AS "$f22", SUM(CASE WHEN "t13"."=6" THEN "t1"."*5" ELSE 0 END) AS "$f23", SUM(CASE WHEN "t13"."=7" THEN "t1"."*5" ELSE 0 END) AS "$f24", SUM(CASE WHEN "t13"."=8" THEN "t1"."*5" ELSE 0 END) AS "$f25", SUM(CASE WHEN "t13"."=9" THEN "t1"."*5" ELSE 0 END) AS "$f26", SUM(CASE WHEN "t13"."=10" THEN "t1"."*5" ELSE 0 END) AS "$f27", SUM(CASE WHEN "t13"."=11" THEN "t1"."*5" ELSE 0 END) AS "$f28", SUM(CASE WHEN "t13"."=12" THEN "t1"."*5" ELSE 0 END) AS "$f29"
FROM (SELECT "ws_sold_date_sk", "ws_sold_time_sk", "ws_ship_mode_sk", "ws_warehouse_sk", "ws_sales_price" * CAST("ws_quantity" AS DECIMAL(10, 0)) AS "*", "ws_net_paid_inc_tax" * CAST("ws_quantity" AS DECIMAL(10, 0)) AS "*5"
FROM (SELECT "ws_sold_date_sk", "ws_sold_time_sk", "ws_ship_mode_sk", "ws_warehouse_sk", "ws_quantity", "ws_sales_price", "ws_net_paid_inc_tax"
FROM "web_sales") AS "t"
WHERE "ws_warehouse_sk" IS NOT NULL AND "ws_sold_date_sk" IS NOT NULL AND ("ws_sold_time_sk" IS NOT NULL AND "ws_ship_mode_sk" IS NOT NULL)) AS "t1"
INNER JOIN (SELECT "t_time_sk"
FROM (SELECT "t_time_sk", "t_time"
FROM "time_dim") AS "t2"
WHERE "t_time" BETWEEN 49530 AND 78330 AND "t_time_sk" IS NOT NULL) AS "t4" ON "t1"."ws_sold_time_sk" = "t4"."t_time_sk"
INNER JOIN (SELECT "sm_ship_mode_sk"
FROM (SELECT "sm_ship_mode_sk", "sm_carrier"
FROM "ship_mode") AS "t5"
WHERE "sm_carrier" IN ('DIAMOND', 'AIRBORNE') AND "sm_ship_mode_sk" IS NOT NULL) AS "t7" ON "t1"."ws_ship_mode_sk" = "t7"."sm_ship_mode_sk"
INNER JOIN (SELECT "w_warehouse_sk", "w_warehouse_name", "w_warehouse_sq_ft", "w_city", "w_county", "w_state", "w_country"
FROM (SELECT "w_warehouse_sk", "w_warehouse_name", "w_warehouse_sq_ft", "w_city", "w_county", "w_state", "w_country"
FROM "warehouse") AS "t8"
WHERE "w_warehouse_sk" IS NOT NULL) AS "t10" ON "t1"."ws_warehouse_sk" = "t10"."w_warehouse_sk"
INNER JOIN (SELECT "d_date_sk", "d_moy" = 1 AS "=", "d_moy" = 2 AS "=2", "d_moy" = 3 AS "=3", "d_moy" = 4 AS "=4", "d_moy" = 5 AS "=5", "d_moy" = 6 AS "=6", "d_moy" = 7 AS "=7", "d_moy" = 8 AS "=8", "d_moy" = 9 AS "=9", "d_moy" = 10 AS "=10", "d_moy" = 11 AS "=11", "d_moy" = 12 AS "=12"
FROM (SELECT "d_date_sk", "d_year", "d_moy"
FROM "date_dim") AS "t11"
WHERE "d_year" = 2002 AND "d_date_sk" IS NOT NULL) AS "t13" ON "t1"."ws_sold_date_sk" = "t13"."d_date_sk"
GROUP BY "t10"."w_warehouse_name", "t10"."w_warehouse_sq_ft", "t10"."w_city", "t10"."w_county", "t10"."w_state", "t10"."w_country"
UNION ALL
SELECT "t28"."w_warehouse_name" AS "$f0", "t28"."w_warehouse_sq_ft" AS "$f1", "t28"."w_city" AS "$f2", "t28"."w_county" AS "$f3", "t28"."w_state" AS "$f4", "t28"."w_country" AS "$f5", SUM(CASE WHEN "t31"."=" THEN "t19"."""*""" ELSE 0 END) AS "$f6", SUM(CASE WHEN "t31"."=2" THEN "t19"."""*""" ELSE 0 END) AS "$f7", SUM(CASE WHEN "t31"."=3" THEN "t19"."""*""" ELSE 0 END) AS "$f8", SUM(CASE WHEN "t31"."=4" THEN "t19"."""*""" ELSE 0 END) AS "$f9", SUM(CASE WHEN "t31"."=5" THEN "t19"."""*""" ELSE 0 END) AS "$f10", SUM(CASE WHEN "t31"."=6" THEN "t19"."""*""" ELSE 0 END) AS "$f11", SUM(CASE WHEN "t31"."=7" THEN "t19"."""*""" ELSE 0 END) AS "$f12", SUM(CASE WHEN "t31"."=8" THEN "t19"."""*""" ELSE 0 END) AS "$f13", SUM(CASE WHEN "t31"."=9" THEN "t19"."""*""" ELSE 0 END) AS "$f14", SUM(CASE WHEN "t31"."=10" THEN "t19"."""*""" ELSE 0 END) AS "$f15", SUM(CASE WHEN "t31"."=11" THEN "t19"."""*""" ELSE 0 END) AS "$f16", SUM(CASE WHEN "t31"."=12" THEN "t19"."""*""" ELSE 0 END) AS "$f17", SUM(CASE WHEN "t31"."=" THEN "t19"."*5" ELSE 0 END) AS "$f18", SUM(CASE WHEN "t31"."=2" THEN "t19"."*5" ELSE 0 END) AS "$f19", SUM(CASE WHEN "t31"."=3" THEN "t19"."*5" ELSE 0 END) AS "$f20", SUM(CASE WHEN "t31"."=4" THEN "t19"."*5" ELSE 0 END) AS "$f21", SUM(CASE WHEN "t31"."=5" THEN "t19"."*5" ELSE 0 END) AS "$f22", SUM(CASE WHEN "t31"."=6" THEN "t19"."*5" ELSE 0 END) AS "$f23", SUM(CASE WHEN "t31"."=7" THEN "t19"."*5" ELSE 0 END) AS "$f24", SUM(CASE WHEN "t31"."=8" THEN "t19"."*5" ELSE 0 END) AS "$f25", SUM(CASE WHEN "t31"."=9" THEN "t19"."*5" ELSE 0 END) AS "$f26", SUM(CASE WHEN "t31"."=10" THEN "t19"."*5" ELSE 0 END) AS "$f27", SUM(CASE WHEN "t31"."=11" THEN "t19"."*5" ELSE 0 END) AS "$f28", SUM(CASE WHEN "t31"."=12" THEN "t19"."*5" ELSE 0 END) AS "$f29"
FROM (SELECT "cs_sold_date_sk", "cs_sold_time_sk", "cs_ship_mode_sk", "cs_warehouse_sk", "cs_ext_sales_price" * CAST("cs_quantity" AS DECIMAL(10, 0)) AS "*", "cs_net_paid_inc_ship_tax" * CAST("cs_quantity" AS DECIMAL(10, 0)) AS "*5"
FROM (SELECT "cs_sold_date_sk", "cs_sold_time_sk", "cs_ship_mode_sk", "cs_warehouse_sk", "cs_quantity", "cs_ext_sales_price", "cs_net_paid_inc_ship_tax"
FROM "catalog_sales") AS "t17"
WHERE "cs_warehouse_sk" IS NOT NULL AND "cs_sold_date_sk" IS NOT NULL AND ("cs_sold_time_sk" IS NOT NULL AND "cs_ship_mode_sk" IS NOT NULL)) AS "t19"
INNER JOIN (SELECT "t_time_sk"
FROM (SELECT "t_time_sk", "t_time"
FROM "time_dim") AS "t20"
WHERE "t_time" BETWEEN 49530 AND 78330 AND "t_time_sk" IS NOT NULL) AS "t22" ON "t19"."cs_sold_time_sk" = "t22"."t_time_sk"
INNER JOIN (SELECT "sm_ship_mode_sk"
FROM (SELECT "sm_ship_mode_sk", "sm_carrier"
FROM "ship_mode") AS "t23"
WHERE "sm_carrier" IN ('DIAMOND', 'AIRBORNE') AND "sm_ship_mode_sk" IS NOT NULL) AS "t25" ON "t19"."cs_ship_mode_sk" = "t25"."sm_ship_mode_sk"
INNER JOIN (SELECT "w_warehouse_sk", "w_warehouse_name", "w_warehouse_sq_ft", "w_city", "w_county", "w_state", "w_country"
FROM (SELECT "w_warehouse_sk", "w_warehouse_name", "w_warehouse_sq_ft", "w_city", "w_county", "w_state", "w_country"
FROM "warehouse") AS "t26"
WHERE "w_warehouse_sk" IS NOT NULL) AS "t28" ON "t19"."cs_warehouse_sk" = "t28"."w_warehouse_sk"
INNER JOIN (SELECT "d_date_sk", "d_moy" = 1 AS "=", "d_moy" = 2 AS "=2", "d_moy" = 3 AS "=3", "d_moy" = 4 AS "=4", "d_moy" = 5 AS "=5", "d_moy" = 6 AS "=6", "d_moy" = 7 AS "=7", "d_moy" = 8 AS "=8", "d_moy" = 9 AS "=9", "d_moy" = 10 AS "=10", "d_moy" = 11 AS "=11", "d_moy" = 12 AS "=12"
FROM (SELECT "d_date_sk", "d_year", "d_moy"
FROM "date_dim") AS "t29"
WHERE "d_year" = 2002 AND "d_date_sk" IS NOT NULL) AS "t31" ON "t19"."cs_sold_date_sk" = "t31"."d_date_sk"
GROUP BY "t28"."w_warehouse_name", "t28"."w_warehouse_sq_ft", "t28"."w_city", "t28"."w_county", "t28"."w_state", "t28"."w_country") AS "t35"
GROUP BY "$f0", "$f1", "$f2", "$f3", "$f4", "$f5"
ORDER BY "$f0"
FETCH NEXT 100 ROWS ONLY) AS "t38"
            hive.sql.query.fieldNames w_warehouse_name,w_warehouse_sq_ft,w_city,w_county,w_state,w_country,ship_carriers,year,jan_sales,feb_sales,mar_sales,apr_sales,may_sales,jun_sales,jul_sales,aug_sales,sep_sales,oct_sales,nov_sales,dec_sales,jan_sales_per_sq_foot,feb_sales_per_sq_foot,mar_sales_per_sq_foot,apr_sales_per_sq_foot,may_sales_per_sq_foot,jun_sales_per_sq_foot,jul_sales_per_sq_foot,aug_sales_per_sq_foot,sep_sales_per_sq_foot,oct_sales_per_sq_foot,nov_sales_per_sq_foot,dec_sales_per_sq_foot,jan_net,feb_net,mar_net,apr_net,may_net,jun_net,jul_net,aug_net,sep_net,oct_net,nov_net,dec_net
            hive.sql.query.fieldTypes string,int,string,string,string,string,string,int,decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,12),decimal(38,12),decimal(38,12),decimal(38,12),decimal(38,12),decimal(38,12),decimal(38,12),decimal(38,12),decimal(38,12),decimal(38,12),decimal(38,12),decimal(38,12),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2),decimal(38,2)
            hive.sql.query.split false
          Select Operator
            expressions: w_warehouse_name (type: string), w_warehouse_sq_ft (type: int), w_city (type: string), w_county (type: string), w_state (type: string), w_country (type: string), ship_carriers (type: string), year (type: int), jan_sales (type: decimal(38,2)), feb_sales (type: decimal(38,2)), mar_sales (type: decimal(38,2)), apr_sales (type: decimal(38,2)), may_sales (type: decimal(38,2)), jun_sales (type: decimal(38,2)), jul_sales (type: decimal(38,2)), aug_sales (type: decimal(38,2)), sep_sales (type: decimal(38,2)), oct_sales (type: decimal(38,2)), nov_sales (type: decimal(38,2)), dec_sales (type: decimal(38,2)), jan_sales_per_sq_foot (type: decimal(38,12)), feb_sales_per_sq_foot (type: decimal(38,12)), mar_sales_per_sq_foot (type: decimal(38,12)), apr_sales_per_sq_foot (type: decimal(38,12)), may_sales_per_sq_foot (type: decimal(38,12)), jun_sales_per_sq_foot (type: decimal(38,12)), jul_sales_per_sq_foot (type: decimal(38,12)), aug_sales_per_sq_foot (type: decimal(38,12)), sep_sales_per_sq_foot (type: decimal(38,12)), oct_sales_per_sq_foot (type: decimal(38,12)), nov_sales_per_sq_foot (type: decimal(38,12)), dec_sales_per_sq_foot (type: decimal(38,12)), jan_net (type: decimal(38,2)), feb_net (type: decimal(38,2)), mar_net (type: decimal(38,2)), apr_net (type: decimal(38,2)), may_net (type: decimal(38,2)), jun_net (type: decimal(38,2)), jul_net (type: decimal(38,2)), aug_net (type: decimal(38,2)), sep_net (type: decimal(38,2)), oct_net (type: decimal(38,2)), nov_net (type: decimal(38,2)), dec_net (type: decimal(38,2))
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41, _col42, _col43
            ListSink

