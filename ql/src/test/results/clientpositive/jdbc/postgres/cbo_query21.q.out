PREHOOK: query: explain cbo
select  *
 from(select w_warehouse_name
            ,i_item_id
            ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))
	                then inv_quantity_on_hand 
                      else 0 end) as inv_before
            ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))
                      then inv_quantity_on_hand 
                      else 0 end) as inv_after
   from inventory
       ,warehouse
       ,item
       ,date_dim
   where i_current_price between 0.99 and 1.49
     and i_item_sk          = inv_item_sk
     and inv_warehouse_sk   = w_warehouse_sk
     and inv_date_sk    = d_date_sk
     and d_date between (cast ('1998-04-08' as date) - 30 days)
                    and (cast ('1998-04-08' as date) + 30 days)
   group by w_warehouse_name, i_item_id) x
 where (case when inv_before > 0 
             then inv_after / inv_before 
             else null
             end) between 2.0/3.0 and 3.0/2.0
 order by w_warehouse_name
         ,i_item_id
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@inventory
PREHOOK: Input: default@item
PREHOOK: Input: default@warehouse
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select  *
 from(select w_warehouse_name
            ,i_item_id
            ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))
	                then inv_quantity_on_hand 
                      else 0 end) as inv_before
            ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))
                      then inv_quantity_on_hand 
                      else 0 end) as inv_after
   from inventory
       ,warehouse
       ,item
       ,date_dim
   where i_current_price between 0.99 and 1.49
     and i_item_sk          = inv_item_sk
     and inv_warehouse_sk   = w_warehouse_sk
     and inv_date_sk    = d_date_sk
     and d_date between (cast ('1998-04-08' as date) - 30 days)
                    and (cast ('1998-04-08' as date) + 30 days)
   group by w_warehouse_name, i_item_id) x
 where (case when inv_before > 0 
             then inv_after / inv_before 
             else null
             end) between 2.0/3.0 and 3.0/2.0
 order by w_warehouse_name
         ,i_item_id
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@inventory
POSTHOOK: Input: default@item
POSTHOOK: Input: default@warehouse
#### A masked pattern was here ####
CBO PLAN:
HiveJdbcConverter(convention=[JDBC.POSTGRES])
  JdbcSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100])
    JdbcFilter(condition=[AND(CASE(>($2, 0), <=(6.66667E-1, /(CAST($3):DOUBLE, CAST($2):DOUBLE)), false), CASE(>($2, 0), <=(/(CAST($3):DOUBLE, CAST($2):DOUBLE), 1.5E0), false))])
      JdbcAggregate(group=[{0, 1}], agg#0=[sum($2)], agg#1=[sum($3)])
        JdbcProject($f0=[$5], $f1=[$7], $f2=[CASE($9, $3, 0)], $f3=[CASE($10, $3, 0)])
          JdbcJoin(condition=[=($0, $8)], joinType=[inner])
            JdbcJoin(condition=[=($6, $1)], joinType=[inner])
              JdbcJoin(condition=[=($2, $4)], joinType=[inner])
                JdbcProject(inv_date_sk=[$0], inv_item_sk=[$1], inv_warehouse_sk=[$2], inv_quantity_on_hand=[$3])
                  JdbcFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($1), IS NOT NULL($0))])
                    JdbcHiveTableScan(table=[[default, inventory]], table:alias=[inventory])
                JdbcProject(w_warehouse_sk=[$0], w_warehouse_name=[$1])
                  JdbcFilter(condition=[IS NOT NULL($0)])
                    JdbcProject(w_warehouse_sk=[$0], w_warehouse_name=[$2])
                      JdbcHiveTableScan(table=[[default, warehouse]], table:alias=[warehouse])
              JdbcProject(i_item_sk=[$0], i_item_id=[$1])
                JdbcFilter(condition=[AND(BETWEEN(false, $2, 0.99:DECIMAL(2, 2), 1.49:DECIMAL(3, 2)), IS NOT NULL($0))])
                  JdbcProject(i_item_sk=[$0], i_item_id=[$1], i_current_price=[$5])
                    JdbcHiveTableScan(table=[[default, item]], table:alias=[item])
            JdbcProject(d_date_sk=[$0], <=[<(CAST($1):DATE, 1998-04-08)], >==[>=(CAST($1):DATE, 1998-04-08)])
              JdbcFilter(condition=[AND(BETWEEN(false, CAST($1):TIMESTAMP(9), 1998-03-09 00:00:00:TIMESTAMP(9), 1998-05-08 00:00:00:TIMESTAMP(9)), IS NOT NULL($0))])
                JdbcProject(d_date_sk=[$0], d_date=[$2])
                  JdbcHiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

