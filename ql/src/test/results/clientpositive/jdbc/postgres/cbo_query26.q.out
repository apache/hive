PREHOOK: query: explain cbo
select  i_item_id, 
        avg(cs_quantity) agg1,
        avg(cs_list_price) agg2,
        avg(cs_coupon_amt) agg3,
        avg(cs_sales_price) agg4 
 from catalog_sales, customer_demographics, date_dim, item, promotion
 where cs_sold_date_sk = d_date_sk and
       cs_item_sk = i_item_sk and
       cs_bill_cdemo_sk = cd_demo_sk and
       cs_promo_sk = p_promo_sk and
       cd_gender = 'F' and 
       cd_marital_status = 'W' and
       cd_education_status = 'Primary' and
       (p_channel_email = 'N' or p_channel_event = 'N') and
       d_year = 1998 
 group by i_item_id
 order by i_item_id
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@catalog_sales
PREHOOK: Input: default@customer_demographics
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@item
PREHOOK: Input: default@promotion
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select  i_item_id, 
        avg(cs_quantity) agg1,
        avg(cs_list_price) agg2,
        avg(cs_coupon_amt) agg3,
        avg(cs_sales_price) agg4 
 from catalog_sales, customer_demographics, date_dim, item, promotion
 where cs_sold_date_sk = d_date_sk and
       cs_item_sk = i_item_sk and
       cs_bill_cdemo_sk = cd_demo_sk and
       cs_promo_sk = p_promo_sk and
       cd_gender = 'F' and 
       cd_marital_status = 'W' and
       cd_education_status = 'Primary' and
       (p_channel_email = 'N' or p_channel_event = 'N') and
       d_year = 1998 
 group by i_item_id
 order by i_item_id
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@catalog_sales
POSTHOOK: Input: default@customer_demographics
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@item
POSTHOOK: Input: default@promotion
#### A masked pattern was here ####
CBO PLAN:
HiveJdbcConverter(convention=[JDBC.POSTGRES])
  JdbcSort(sort0=[$0], dir0=[ASC], fetch=[100])
    JdbcProject(i_item_id=[$0], agg1=[/(CAST($1):DOUBLE, $2)], agg2=[CAST(/($3, $4)):DECIMAL(11, 6)], agg3=[CAST(/($5, $6)):DECIMAL(11, 6)], agg4=[CAST(/($7, $8)):DECIMAL(11, 6)])
      JdbcAggregate(group=[{12}], agg#0=[sum($4)], agg#1=[count($4)], agg#2=[sum($5)], agg#3=[count($5)], agg#4=[sum($7)], agg#5=[count($7)], agg#6=[sum($6)], agg#7=[count($6)])
        JdbcJoin(condition=[=($2, $11)], joinType=[inner])
          JdbcJoin(condition=[=($3, $10)], joinType=[inner])
            JdbcJoin(condition=[=($0, $9)], joinType=[inner])
              JdbcJoin(condition=[=($1, $8)], joinType=[inner])
                JdbcProject(cs_sold_date_sk=[$0], cs_bill_cdemo_sk=[$1], cs_item_sk=[$2], cs_promo_sk=[$3], cs_quantity=[$4], cs_list_price=[$5], cs_sales_price=[$6], cs_coupon_amt=[$7])
                  JdbcFilter(condition=[AND(IS NOT NULL($1), IS NOT NULL($0), IS NOT NULL($2), IS NOT NULL($3))])
                    JdbcProject(cs_sold_date_sk=[$0], cs_bill_cdemo_sk=[$4], cs_item_sk=[$15], cs_promo_sk=[$16], cs_quantity=[$18], cs_list_price=[$20], cs_sales_price=[$21], cs_coupon_amt=[$27])
                      JdbcHiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                JdbcProject(cd_demo_sk=[$0])
                  JdbcFilter(condition=[AND(=($1, _UTF-16LE'F'), =($2, _UTF-16LE'W'), =($3, _UTF-16LE'Primary'), IS NOT NULL($0))])
                    JdbcProject(cd_demo_sk=[$0], cd_gender=[$1], cd_marital_status=[$2], cd_education_status=[$3])
                      JdbcHiveTableScan(table=[[default, customer_demographics]], table:alias=[customer_demographics])
              JdbcProject(d_date_sk=[$0])
                JdbcFilter(condition=[AND(=($1, 1998), IS NOT NULL($0))])
                  JdbcProject(d_date_sk=[$0], d_year=[$6])
                    JdbcHiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
            JdbcProject(p_promo_sk=[$0])
              JdbcFilter(condition=[AND(OR(=($1, _UTF-16LE'N'), =($2, _UTF-16LE'N')), IS NOT NULL($0))])
                JdbcProject(p_promo_sk=[$0], p_channel_email=[$9], p_channel_event=[$14])
                  JdbcHiveTableScan(table=[[default, promotion]], table:alias=[promotion])
          JdbcProject(i_item_sk=[$0], i_item_id=[$1])
            JdbcFilter(condition=[IS NOT NULL($0)])
              JdbcProject(i_item_sk=[$0], i_item_id=[$1])
                JdbcHiveTableScan(table=[[default, item]], table:alias=[item])

