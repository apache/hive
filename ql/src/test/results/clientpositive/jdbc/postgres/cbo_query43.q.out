PREHOOK: query: explain cbo
select  s_store_name, s_store_id,
        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales
 from date_dim, store_sales, store
 where d_date_sk = ss_sold_date_sk and
       s_store_sk = ss_store_sk and
       s_gmt_offset = -6 and
       d_year = 1998 
 group by s_store_name, s_store_id
 order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@store
PREHOOK: Input: default@store_sales
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select  s_store_name, s_store_id,
        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales
 from date_dim, store_sales, store
 where d_date_sk = ss_sold_date_sk and
       s_store_sk = ss_store_sk and
       s_gmt_offset = -6 and
       d_year = 1998 
 group by s_store_name, s_store_id
 order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@store
POSTHOOK: Input: default@store_sales
#### A masked pattern was here ####
CBO PLAN:
HiveJdbcConverter(convention=[JDBC.POSTGRES])
  JdbcSort(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], sort5=[$5], sort6=[$6], sort7=[$7], sort8=[$8], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], dir6=[ASC], dir7=[ASC], dir8=[ASC], fetch=[100])
    JdbcAggregate(group=[{0, 1}], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)], agg#3=[sum($5)], agg#4=[sum($6)], agg#5=[sum($7)], agg#6=[sum($8)])
      JdbcProject($f0=[$5], $f1=[$4], $f2=[CASE($7, $2, null:DECIMAL(7, 2))], $f3=[CASE($8, $2, null:DECIMAL(7, 2))], $f4=[CASE($9, $2, null:DECIMAL(7, 2))], $f5=[CASE($10, $2, null:DECIMAL(7, 2))], $f6=[CASE($11, $2, null:DECIMAL(7, 2))], $f7=[CASE($12, $2, null:DECIMAL(7, 2))], $f8=[CASE($13, $2, null:DECIMAL(7, 2))])
        JdbcJoin(condition=[=($6, $0)], joinType=[inner])
          JdbcJoin(condition=[=($3, $1)], joinType=[inner])
            JdbcProject(ss_sold_date_sk=[$0], ss_store_sk=[$1], ss_sales_price=[$2])
              JdbcFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($1))])
                JdbcProject(ss_sold_date_sk=[$0], ss_store_sk=[$7], ss_sales_price=[$13])
                  JdbcHiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
            JdbcProject(s_store_sk=[$0], s_store_id=[$1], s_store_name=[$2])
              JdbcFilter(condition=[AND(=($3, -6:DECIMAL(1, 0)), IS NOT NULL($0))])
                JdbcProject(s_store_sk=[$0], s_store_id=[$1], s_store_name=[$5], s_gmt_offset=[$27])
                  JdbcHiveTableScan(table=[[default, store]], table:alias=[store])
          JdbcProject(d_date_sk=[$0], ==[=($2, _UTF-16LE'Sunday')], =2=[=($2, _UTF-16LE'Monday')], =3=[=($2, _UTF-16LE'Tuesday')], =4=[=($2, _UTF-16LE'Wednesday')], =5=[=($2, _UTF-16LE'Thursday')], =6=[=($2, _UTF-16LE'Friday')], =7=[=($2, _UTF-16LE'Saturday')])
            JdbcFilter(condition=[AND(=($1, 1998), IS NOT NULL($0))])
              JdbcProject(d_date_sk=[$0], d_year=[$6], d_day_name=[$14])
                JdbcHiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

