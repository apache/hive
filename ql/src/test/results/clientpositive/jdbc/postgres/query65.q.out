PREHOOK: query: explain
select 
	s_store_name,
	i_item_desc,
	sc.revenue,
	i_current_price,
	i_wholesale_cost,
	i_brand
 from store, item,
     (select ss_store_sk, avg(revenue) as ave
 	from
 	    (select  ss_store_sk, ss_item_sk, 
 		     sum(ss_sales_price) as revenue
 		from store_sales, date_dim
 		where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11
 		group by ss_store_sk, ss_item_sk) sa
 	group by ss_store_sk) sb,
     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue
 	from store_sales, date_dim
 	where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11
 	group by ss_store_sk, ss_item_sk) sc
 where sb.ss_store_sk = sc.ss_store_sk and 
       sc.revenue <= 0.1 * sb.ave and
       s_store_sk = sc.ss_store_sk and
       i_item_sk = sc.ss_item_sk
 order by s_store_name, i_item_desc
limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@item
PREHOOK: Input: default@store
PREHOOK: Input: default@store_sales
#### A masked pattern was here ####
POSTHOOK: query: explain
select 
	s_store_name,
	i_item_desc,
	sc.revenue,
	i_current_price,
	i_wholesale_cost,
	i_brand
 from store, item,
     (select ss_store_sk, avg(revenue) as ave
 	from
 	    (select  ss_store_sk, ss_item_sk, 
 		     sum(ss_sales_price) as revenue
 		from store_sales, date_dim
 		where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11
 		group by ss_store_sk, ss_item_sk) sa
 	group by ss_store_sk) sb,
     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue
 	from store_sales, date_dim
 	where ss_sold_date_sk = d_date_sk and d_month_seq between 1212 and 1212+11
 	group by ss_store_sk, ss_item_sk) sc
 where sb.ss_store_sk = sc.ss_store_sk and 
       sc.revenue <= 0.1 * sb.ave and
       s_store_sk = sc.ss_store_sk and
       i_item_sk = sc.ss_item_sk
 order by s_store_name, i_item_desc
limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@item
POSTHOOK: Input: default@store
POSTHOOK: Input: default@store_sales
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: store_sales
          properties:
            hive.sql.query SELECT "t26"."s_store_name", "t26"."i_item_desc", "t26"."revenue", "t26"."i_current_price", "t26"."i_wholesale_cost", "t26"."i_brand"
FROM (SELECT "t11"."s_store_name", "t24"."i_item_desc", "t8"."$f2" AS "revenue", "t24"."i_current_price", "t24"."i_wholesale_cost", "t24"."i_brand"
FROM (SELECT "ss_store_sk", "ss_item_sk", "$f2"
FROM (SELECT "t1"."ss_store_sk", "t1"."ss_item_sk", SUM("t1"."ss_sales_price") AS "$f2"
FROM (SELECT "ss_sold_date_sk", "ss_item_sk", "ss_store_sk", "ss_sales_price"
FROM (SELECT "ss_sold_date_sk", "ss_item_sk", "ss_store_sk", "ss_sales_price"
FROM "store_sales") AS "t"
WHERE "ss_sold_date_sk" IS NOT NULL AND ("ss_store_sk" IS NOT NULL AND "ss_item_sk" IS NOT NULL)) AS "t1"
INNER JOIN (SELECT "d_date_sk"
FROM (SELECT "d_date_sk", "d_month_seq"
FROM "date_dim") AS "t2"
WHERE "d_month_seq" BETWEEN 1212 AND 1223 AND "d_date_sk" IS NOT NULL) AS "t4" ON "t1"."ss_sold_date_sk" = "t4"."d_date_sk"
GROUP BY "t1"."ss_item_sk", "t1"."ss_store_sk") AS "t6"
WHERE "t6"."$f2" IS NOT NULL) AS "t8"
INNER JOIN (SELECT "s_store_sk", "s_store_name"
FROM (SELECT "s_store_sk", "s_store_name"
FROM "store") AS "t9"
WHERE "s_store_sk" IS NOT NULL) AS "t11" ON "t8"."ss_store_sk" = "t11"."s_store_sk"
INNER JOIN (SELECT "t18"."ss_store_sk" AS "$f0", 0.1 * CAST(SUM("t18"."$f2") / COUNT("t18"."$f2") AS DECIMAL(21, 6)) AS "*"
FROM (SELECT "t14"."ss_item_sk", "t14"."ss_store_sk", SUM("t14"."ss_sales_price") AS "$f2"
FROM (SELECT "ss_sold_date_sk", "ss_item_sk", "ss_store_sk", "ss_sales_price"
FROM (SELECT "ss_sold_date_sk", "ss_item_sk", "ss_store_sk", "ss_sales_price"
FROM "store_sales") AS "t12"
WHERE "ss_sold_date_sk" IS NOT NULL AND "ss_store_sk" IS NOT NULL) AS "t14"
INNER JOIN (SELECT "d_date_sk"
FROM (SELECT "d_date_sk", "d_month_seq"
FROM "date_dim") AS "t15"
WHERE "d_month_seq" BETWEEN 1212 AND 1223 AND "d_date_sk" IS NOT NULL) AS "t17" ON "t14"."ss_sold_date_sk" = "t17"."d_date_sk"
GROUP BY "t14"."ss_item_sk", "t14"."ss_store_sk") AS "t18"
GROUP BY "t18"."ss_store_sk"
HAVING CAST(SUM("t18"."$f2") / COUNT("t18"."$f2") AS DECIMAL(21, 6)) IS NOT NULL) AS "t21" ON "t8"."ss_store_sk" = "t21"."$f0" AND "t8"."$f2" <= "t21"."""*"""
INNER JOIN (SELECT "i_item_sk", "i_item_desc", "i_current_price", "i_wholesale_cost", "i_brand"
FROM (SELECT "i_item_sk", "i_item_desc", "i_current_price", "i_wholesale_cost", "i_brand"
FROM "item") AS "t22"
WHERE "i_item_sk" IS NOT NULL) AS "t24" ON "t8"."ss_item_sk" = "t24"."i_item_sk"
ORDER BY "t11"."s_store_name", "t24"."i_item_desc"
FETCH NEXT 100 ROWS ONLY) AS "t26"
            hive.sql.query.fieldNames s_store_name,i_item_desc,revenue,i_current_price,i_wholesale_cost,i_brand
            hive.sql.query.fieldTypes string,string,decimal(17,2),decimal(7,2),decimal(7,2),string
            hive.sql.query.split false
          Select Operator
            expressions: s_store_name (type: string), i_item_desc (type: string), revenue (type: decimal(17,2)), i_current_price (type: decimal(7,2)), i_wholesale_cost (type: decimal(7,2)), i_brand (type: string)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            ListSink

