CTE Suggestion:
JdbcFilter(condition=[IS NOT NULL($0)])
  JdbcProject(c_customer_sk=[$0], c_first_name=[$8], c_last_name=[$9])
    JdbcHiveTableScan(table=[[default, customer]], table:alias=[customer])

CTE Suggestion:
JdbcProject(d_date_sk=[$0], d_date=[$1])
  JdbcFilter(condition=[AND(BETWEEN(false, $2, 1212, 1223), IS NOT NULL($0))])
    JdbcProject(d_date_sk=[$0], d_date=[$2], d_month_seq=[$3])
      JdbcHiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

PREHOOK: query: explain cbo
select count(*) 
from ((select distinct c_last_name, c_first_name, d_date
       from store_sales, date_dim, customer
       where store_sales.ss_sold_date_sk = date_dim.d_date_sk
         and store_sales.ss_customer_sk = customer.c_customer_sk
         and d_month_seq between 1212 and 1212+11)
       except
      (select distinct c_last_name, c_first_name, d_date
       from catalog_sales, date_dim, customer
       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk
         and d_month_seq between 1212 and 1212+11)
       except
      (select distinct c_last_name, c_first_name, d_date
       from web_sales, date_dim, customer
       where web_sales.ws_sold_date_sk = date_dim.d_date_sk
         and web_sales.ws_bill_customer_sk = customer.c_customer_sk
         and d_month_seq between 1212 and 1212+11)
) cool_cust
PREHOOK: type: QUERY
PREHOOK: Input: default@catalog_sales
PREHOOK: Input: default@customer
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@store_sales
PREHOOK: Input: default@web_sales
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) 
from ((select distinct c_last_name, c_first_name, d_date
       from store_sales, date_dim, customer
       where store_sales.ss_sold_date_sk = date_dim.d_date_sk
         and store_sales.ss_customer_sk = customer.c_customer_sk
         and d_month_seq between 1212 and 1212+11)
       except
      (select distinct c_last_name, c_first_name, d_date
       from catalog_sales, date_dim, customer
       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk
         and d_month_seq between 1212 and 1212+11)
       except
      (select distinct c_last_name, c_first_name, d_date
       from web_sales, date_dim, customer
       where web_sales.ws_sold_date_sk = date_dim.d_date_sk
         and web_sales.ws_bill_customer_sk = customer.c_customer_sk
         and d_month_seq between 1212 and 1212+11)
) cool_cust
POSTHOOK: type: QUERY
POSTHOOK: Input: default@catalog_sales
POSTHOOK: Input: default@customer
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@store_sales
POSTHOOK: Input: default@web_sales
#### A masked pattern was here ####
CBO PLAN:
HiveJdbcConverter(convention=[JDBC.POSTGRES])
  JdbcAggregate(group=[{}], agg#0=[count()])
    JdbcProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4])
      JdbcFilter(condition=[AND(>($3, 0), =(*($3, 2), $4))])
        JdbcAggregate(group=[{0, 1, 2}], agg#0=[sum($3)], agg#1=[sum($4)])
          JdbcProject($f0=[$0], $f1=[$1], $f2=[$2], $f4=[$4], $f5=[*($3, $4)])
            JdbcUnion(all=[true])
              JdbcProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[2:BIGINT], $f4=[$3])
                JdbcAggregate(group=[{0, 1, 2}], agg#0=[count()])
                  JdbcProject($f0=[$0], $f1=[$1], $f2=[$2], $f3=[$3], $f4=[$4])
                    JdbcFilter(condition=[AND(>($3, 0), =(*($3, 2), $4))])
                      JdbcAggregate(group=[{0, 1, 2}], agg#0=[sum($3)], agg#1=[sum($4)])
                        JdbcProject($f0=[$0], $f1=[$1], $f2=[$2], $f4=[$4], $f5=[*($3, $4)])
                          JdbcUnion(all=[true])
                            JdbcProject($f0=[$2], $f1=[$1], $f2=[$0], $f3=[2:BIGINT], $f4=[$3])
                              JdbcAggregate(group=[{0, 1, 2}], agg#0=[count()])
                                JdbcAggregate(group=[{3, 5, 6}])
                                  JdbcJoin(condition=[=($1, $4)], joinType=[inner])
                                    JdbcJoin(condition=[=($0, $2)], joinType=[inner])
                                      JdbcProject(ss_sold_date_sk=[$0], ss_customer_sk=[$1])
                                        JdbcFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($1))])
                                          JdbcProject(ss_sold_date_sk=[$0], ss_customer_sk=[$3])
                                            JdbcHiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                                      JdbcProject(d_date_sk=[$0], d_date=[$1])
                                        JdbcFilter(condition=[AND(BETWEEN(false, $2, 1212, 1223), IS NOT NULL($0))])
                                          JdbcProject(d_date_sk=[$0], d_date=[$2], d_month_seq=[$3])
                                            JdbcHiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                                    JdbcProject(c_customer_sk=[$0], c_first_name=[$1], c_last_name=[$2])
                                      JdbcFilter(condition=[IS NOT NULL($0)])
                                        JdbcProject(c_customer_sk=[$0], c_first_name=[$8], c_last_name=[$9])
                                          JdbcHiveTableScan(table=[[default, customer]], table:alias=[customer])
                            JdbcProject($f0=[$2], $f1=[$1], $f2=[$0], $f3=[1:BIGINT], $f4=[$3])
                              JdbcAggregate(group=[{0, 1, 2}], agg#0=[count()])
                                JdbcAggregate(group=[{3, 5, 6}])
                                  JdbcJoin(condition=[=($1, $4)], joinType=[inner])
                                    JdbcJoin(condition=[=($0, $2)], joinType=[inner])
                                      JdbcProject(cs_sold_date_sk=[$0], cs_bill_customer_sk=[$1])
                                        JdbcFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($1))])
                                          JdbcProject(cs_sold_date_sk=[$0], cs_bill_customer_sk=[$3])
                                            JdbcHiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                                      JdbcProject(d_date_sk=[$0], d_date=[$1])
                                        JdbcFilter(condition=[AND(BETWEEN(false, $2, 1212, 1223), IS NOT NULL($0))])
                                          JdbcProject(d_date_sk=[$0], d_date=[$2], d_month_seq=[$3])
                                            JdbcHiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                                    JdbcProject(c_customer_sk=[$0], c_first_name=[$1], c_last_name=[$2])
                                      JdbcFilter(condition=[IS NOT NULL($0)])
                                        JdbcProject(c_customer_sk=[$0], c_first_name=[$8], c_last_name=[$9])
                                          JdbcHiveTableScan(table=[[default, customer]], table:alias=[customer])
              JdbcProject($f0=[$2], $f1=[$1], $f2=[$0], $f3=[1:BIGINT], $f4=[$3])
                JdbcAggregate(group=[{0, 1, 2}], agg#0=[count()])
                  JdbcAggregate(group=[{3, 5, 6}])
                    JdbcJoin(condition=[=($1, $4)], joinType=[inner])
                      JdbcJoin(condition=[=($0, $2)], joinType=[inner])
                        JdbcProject(ws_sold_date_sk=[$0], ws_bill_customer_sk=[$1])
                          JdbcFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($1))])
                            JdbcProject(ws_sold_date_sk=[$0], ws_bill_customer_sk=[$4])
                              JdbcHiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                        JdbcProject(d_date_sk=[$0], d_date=[$1])
                          JdbcFilter(condition=[AND(BETWEEN(false, $2, 1212, 1223), IS NOT NULL($0))])
                            JdbcProject(d_date_sk=[$0], d_date=[$2], d_month_seq=[$3])
                              JdbcHiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                      JdbcProject(c_customer_sk=[$0], c_first_name=[$1], c_last_name=[$2])
                        JdbcFilter(condition=[IS NOT NULL($0)])
                          JdbcProject(c_customer_sk=[$0], c_first_name=[$8], c_last_name=[$9])
                            JdbcHiveTableScan(table=[[default, customer]], table:alias=[customer])

