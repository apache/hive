PREHOOK: query: explain
select avg(ss_quantity)
       ,avg(ss_ext_sales_price)
       ,avg(ss_ext_wholesale_cost)
       ,sum(ss_ext_wholesale_cost)
 from store_sales
     ,store
     ,customer_demographics
     ,household_demographics
     ,customer_address
     ,date_dim
 where s_store_sk = ss_store_sk
 and  ss_sold_date_sk = d_date_sk and d_year = 2001
 and((ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'M'
  and cd_education_status = '4 yr Degree'
  and ss_sales_price between 100.00 and 150.00
  and hd_dep_count = 3   
     )or
     (ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'D'
  and cd_education_status = 'Primary'
  and ss_sales_price between 50.00 and 100.00   
  and hd_dep_count = 1
     ) or 
     (ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'U'
  and cd_education_status = 'Advanced Degree'
  and ss_sales_price between 150.00 and 200.00 
  and hd_dep_count = 1  
     ))
 and((ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('KY', 'GA', 'NM')
  and ss_net_profit between 100 and 200  
     ) or
     (ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('MT', 'OR', 'IN')
  and ss_net_profit between 150 and 300  
     ) or
     (ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('WI', 'MO', 'WV')
  and ss_net_profit between 50 and 250  
     ))
PREHOOK: type: QUERY
PREHOOK: Input: default@customer_address
PREHOOK: Input: default@customer_demographics
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@household_demographics
PREHOOK: Input: default@store
PREHOOK: Input: default@store_sales
#### A masked pattern was here ####
POSTHOOK: query: explain
select avg(ss_quantity)
       ,avg(ss_ext_sales_price)
       ,avg(ss_ext_wholesale_cost)
       ,sum(ss_ext_wholesale_cost)
 from store_sales
     ,store
     ,customer_demographics
     ,household_demographics
     ,customer_address
     ,date_dim
 where s_store_sk = ss_store_sk
 and  ss_sold_date_sk = d_date_sk and d_year = 2001
 and((ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'M'
  and cd_education_status = '4 yr Degree'
  and ss_sales_price between 100.00 and 150.00
  and hd_dep_count = 3   
     )or
     (ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'D'
  and cd_education_status = 'Primary'
  and ss_sales_price between 50.00 and 100.00   
  and hd_dep_count = 1
     ) or 
     (ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'U'
  and cd_education_status = 'Advanced Degree'
  and ss_sales_price between 150.00 and 200.00 
  and hd_dep_count = 1  
     ))
 and((ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('KY', 'GA', 'NM')
  and ss_net_profit between 100 and 200  
     ) or
     (ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('MT', 'OR', 'IN')
  and ss_net_profit between 150 and 300  
     ) or
     (ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('WI', 'MO', 'WV')
  and ss_net_profit between 50 and 250  
     ))
POSTHOOK: type: QUERY
POSTHOOK: Input: default@customer_address
POSTHOOK: Input: default@customer_demographics
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@household_demographics
POSTHOOK: Input: default@store
POSTHOOK: Input: default@store_sales
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: store_sales
          properties:
            hive.sql.query SELECT CAST(SUM("t1"."ss_quantity") AS DOUBLE PRECISION) / COUNT("t1"."ss_quantity") AS "_o__c0", CAST(SUM("t1"."ss_ext_sales_price") / COUNT("t1"."ss_ext_sales_price") AS DECIMAL(11, 6)) AS "_o__c1", CAST(SUM("t1"."ss_ext_wholesale_cost") / COUNT("t1"."ss_ext_wholesale_cost") AS DECIMAL(11, 6)) AS "_o__c2", SUM("t1"."ss_ext_wholesale_cost") AS "_o__c3"
FROM (SELECT "ss_sold_date_sk", "ss_cdemo_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_store_sk", "ss_quantity", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_net_profit" BETWEEN 100 AND 200 AS "BETWEEN", "ss_net_profit" BETWEEN 150 AND 300 AS "BETWEEN9", "ss_net_profit" BETWEEN 50 AND 250 AS "BETWEEN10", "ss_sales_price" BETWEEN 100 AND 150 AS "BETWEEN11", "ss_sales_price" BETWEEN 50 AND 100 AS "BETWEEN12", "ss_sales_price" BETWEEN 150 AND 200 AS "BETWEEN13"
FROM (SELECT "ss_sold_date_sk", "ss_cdemo_sk", "ss_hdemo_sk", "ss_addr_sk", "ss_store_sk", "ss_quantity", "ss_sales_price", "ss_ext_sales_price", "ss_ext_wholesale_cost", "ss_net_profit"
FROM "store_sales") AS "t"
WHERE (100 <= "ss_sales_price" OR ("ss_sales_price" <= 150 OR 50 <= "ss_sales_price") OR ("ss_sales_price" <= 100 OR (150 <= "ss_sales_price" OR "ss_sales_price" <= 200))) AND ((100 <= "ss_net_profit" OR ("ss_net_profit" <= 200 OR 150 <= "ss_net_profit") OR ("ss_net_profit" <= 300 OR (50 <= "ss_net_profit" OR "ss_net_profit" <= 250))) AND "ss_store_sk" IS NOT NULL) AND ("ss_cdemo_sk" IS NOT NULL AND "ss_hdemo_sk" IS NOT NULL AND ("ss_addr_sk" IS NOT NULL AND "ss_sold_date_sk" IS NOT NULL))) AS "t1"
INNER JOIN (SELECT "s_store_sk"
FROM (SELECT "s_store_sk"
FROM "store") AS "t2"
WHERE "s_store_sk" IS NOT NULL) AS "t4" ON "t1"."ss_store_sk" = "t4"."s_store_sk"
INNER JOIN (SELECT "d_date_sk"
FROM (SELECT "d_date_sk", "d_year"
FROM "date_dim") AS "t5"
WHERE "d_year" = 2001 AND "d_date_sk" IS NOT NULL) AS "t7" ON "t1"."ss_sold_date_sk" = "t7"."d_date_sk"
INNER JOIN (SELECT "hd_demo_sk", "hd_dep_count" = 3 AS "=", "hd_dep_count" = 1 AS "=2"
FROM (SELECT "hd_demo_sk", "hd_dep_count"
FROM "household_demographics") AS "t8"
WHERE "hd_dep_count" IN (3, 1) AND "hd_demo_sk" IS NOT NULL) AS "t10" ON "t1"."ss_hdemo_sk" = "t10"."hd_demo_sk"
INNER JOIN (SELECT "ca_address_sk", "ca_state" IN ('KY', 'GA', 'NM') AS "IN", "ca_state" IN ('MT', 'OR', 'IN') AS "IN2", "ca_state" IN ('WI', 'MO', 'WV') AS "IN3"
FROM (SELECT "ca_address_sk", "ca_state", "ca_country"
FROM "customer_address") AS "t11"
WHERE "ca_state" IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') AND ("ca_country" = 'United States' AND "ca_address_sk" IS NOT NULL)) AS "t13" ON "t1"."ss_addr_sk" = "t13"."ca_address_sk" AND ("t13"."IN" AND "t1"."BETWEEN" OR "t13"."IN2" AND "t1"."BETWEEN9" OR "t13"."IN3" AND "t1"."BETWEEN10")
INNER JOIN (SELECT "cd_demo_sk", "cd_marital_status" = 'M' AS "=", "cd_education_status" = '4 yr Degree' AS "=2", "cd_marital_status" = 'D' AS "=3", "cd_education_status" = 'Primary' AS "=4", "cd_marital_status" = 'U' AS "=5", "cd_education_status" = 'Advanced Degree' AS "=6"
FROM (SELECT "cd_demo_sk", "cd_marital_status", "cd_education_status"
FROM "customer_demographics") AS "t14"
WHERE "cd_marital_status" IN ('M', 'D', 'U') AND ("cd_education_status" IN ('4 yr Degree', 'Primary', 'Advanced Degree') AND "cd_demo_sk" IS NOT NULL)) AS "t16" ON "t1"."ss_cdemo_sk" = "t16"."cd_demo_sk" AND ("t16"."=" AND "t16"."=2" AND "t1"."BETWEEN11" AND "t10"."=" OR "t16"."=3" AND "t16"."=4" AND "t1"."BETWEEN12" AND "t10"."=2" OR "t16"."=5" AND "t16"."=6" AND "t1"."BETWEEN13" AND "t10"."=2")
            hive.sql.query.fieldNames _o__c0,_o__c1,_o__c2,_o__c3
            hive.sql.query.fieldTypes double,decimal(11,6),decimal(11,6),decimal(17,2)
            hive.sql.query.split false
          Select Operator
            expressions: _o__c0 (type: double), _o__c1 (type: decimal(11,6)), _o__c2 (type: decimal(11,6)), _o__c3 (type: decimal(17,2))
            outputColumnNames: _col0, _col1, _col2, _col3
            ListSink

