PREHOOK: query: explain cbo
select  dt.d_year 
       ,item.i_brand_id brand_id 
       ,item.i_brand brand
       ,sum(ss_ext_sales_price) sum_agg
 from  date_dim dt 
      ,store_sales
      ,item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
   and store_sales.ss_item_sk = item.i_item_sk
   and item.i_manufact_id = 436
   and dt.d_moy=12
 group by dt.d_year
      ,item.i_brand
      ,item.i_brand_id
 order by dt.d_year
         ,sum_agg desc
         ,brand_id
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@item
PREHOOK: Input: default@store_sales
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select  dt.d_year 
       ,item.i_brand_id brand_id 
       ,item.i_brand brand
       ,sum(ss_ext_sales_price) sum_agg
 from  date_dim dt 
      ,store_sales
      ,item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
   and store_sales.ss_item_sk = item.i_item_sk
   and item.i_manufact_id = 436
   and dt.d_moy=12
 group by dt.d_year
      ,item.i_brand
      ,item.i_brand_id
 order by dt.d_year
         ,sum_agg desc
         ,brand_id
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@item
POSTHOOK: Input: default@store_sales
#### A masked pattern was here ####
CBO PLAN:
HiveJdbcConverter(convention=[JDBC.POSTGRES])
  JdbcSort(sort0=[$0], sort1=[$3], sort2=[$1], dir0=[ASC], dir1=[DESC], dir2=[ASC], fetch=[100])
    JdbcAggregate(group=[{4, 6, 7}], agg#0=[sum($2)])
      JdbcJoin(condition=[=($1, $5)], joinType=[inner])
        JdbcJoin(condition=[=($3, $0)], joinType=[inner])
          JdbcProject(ss_sold_date_sk=[$0], ss_item_sk=[$1], ss_ext_sales_price=[$2])
            JdbcFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($1))])
              JdbcProject(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_ext_sales_price=[$15])
                JdbcHiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
          JdbcProject(d_date_sk=[$0], d_year=[$1])
            JdbcFilter(condition=[AND(=($2, 12), IS NOT NULL($0))])
              JdbcProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8])
                JdbcHiveTableScan(table=[[default, date_dim]], table:alias=[dt])
        JdbcProject(i_item_sk=[$0], i_brand_id=[$1], i_brand=[$2])
          JdbcFilter(condition=[AND(=($3, 436), IS NOT NULL($0))])
            JdbcProject(i_item_sk=[$0], i_brand_id=[$7], i_brand=[$8], i_manufact_id=[$13])
              JdbcHiveTableScan(table=[[default, item]], table:alias=[item])

