PREHOOK: query: explain cbo
select  ca_zip
       ,sum(cs_sales_price)
 from catalog_sales
     ,customer
     ,customer_address
     ,date_dim
 where cs_bill_customer_sk = c_customer_sk
 	and c_current_addr_sk = ca_address_sk 
 	and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',
                                   '85392', '85460', '80348', '81792')
 	      or ca_state in ('CA','WA','GA')
 	      or cs_sales_price > 500)
 	and cs_sold_date_sk = d_date_sk
 	and d_qoy = 2 and d_year = 2000
 group by ca_zip
 order by ca_zip
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@catalog_sales
PREHOOK: Input: default@customer
PREHOOK: Input: default@customer_address
PREHOOK: Input: default@date_dim
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select  ca_zip
       ,sum(cs_sales_price)
 from catalog_sales
     ,customer
     ,customer_address
     ,date_dim
 where cs_bill_customer_sk = c_customer_sk
 	and c_current_addr_sk = ca_address_sk 
 	and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',
                                   '85392', '85460', '80348', '81792')
 	      or ca_state in ('CA','WA','GA')
 	      or cs_sales_price > 500)
 	and cs_sold_date_sk = d_date_sk
 	and d_qoy = 2 and d_year = 2000
 group by ca_zip
 order by ca_zip
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@catalog_sales
POSTHOOK: Input: default@customer
POSTHOOK: Input: default@customer_address
POSTHOOK: Input: default@date_dim
#### A masked pattern was here ####
CBO PLAN:
HiveSortLimit(sort0=[$0], dir0=[ASC], fetch=[100])
  HiveProject(ca_zip=[$0], $f1=[$1])
    HiveAggregate(group=[{1}], agg#0=[sum($8)])
      HiveJoin(condition=[AND(OR($9, $2, $3), =($7, $4))], joinType=[inner], algorithm=[none], cost=[not available])
        HiveJoin(condition=[=($5, $0)], joinType=[inner], algorithm=[none], cost=[not available])
          HiveProject(ca_address_sk=[$0], ca_zip=[$2], IN=[IN(substr($2, 1, 5), _UTF-16LE'85669':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'86197':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'88274':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'83405':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'86475':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'85392':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'85460':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'80348':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'81792':VARCHAR(2147483647) CHARACTER SET "UTF-16LE")], IN3=[IN($1, _UTF-16LE'CA':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'WA':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'GA':VARCHAR(2147483647) CHARACTER SET "UTF-16LE")])
            HiveProject(ca_address_sk=[$0], ca_state=[$1], ca_zip=[$2])
              HiveJdbcConverter(convention=[JDBC.POSTGRES])
                JdbcFilter(condition=[IS NOT NULL($0)])
                  JdbcProject(ca_address_sk=[$0], ca_state=[$8], ca_zip=[$9])
                    JdbcHiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])
          HiveProject(c_customer_sk=[$0], c_current_addr_sk=[$1])
            HiveJdbcConverter(convention=[JDBC.POSTGRES])
              JdbcFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($1))])
                JdbcProject(c_customer_sk=[$0], c_current_addr_sk=[$4])
                  JdbcHiveTableScan(table=[[default, customer]], table:alias=[customer])
        HiveProject(cs_sold_date_sk=[$0], cs_bill_customer_sk=[$1], cs_sales_price=[$2], >=[$3], d_date_sk=[$4])
          HiveJdbcConverter(convention=[JDBC.POSTGRES])
            JdbcJoin(condition=[=($0, $4)], joinType=[inner])
              JdbcProject(cs_sold_date_sk=[$0], cs_bill_customer_sk=[$1], cs_sales_price=[$2], >=[>($2, 500:DECIMAL(3, 0))])
                JdbcFilter(condition=[AND(IS NOT NULL($1), IS NOT NULL($0))])
                  JdbcProject(cs_sold_date_sk=[$0], cs_bill_customer_sk=[$3], cs_sales_price=[$21])
                    JdbcHiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
              JdbcProject(d_date_sk=[$0])
                JdbcFilter(condition=[AND(=($2, 2), =($1, 2000), IS NOT NULL($0))])
                  JdbcProject(d_date_sk=[$0], d_year=[$6], d_qoy=[$10])
                    JdbcHiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

