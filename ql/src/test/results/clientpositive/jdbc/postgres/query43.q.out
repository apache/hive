PREHOOK: query: explain
select  s_store_name, s_store_id,
        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales
 from date_dim, store_sales, store
 where d_date_sk = ss_sold_date_sk and
       s_store_sk = ss_store_sk and
       s_gmt_offset = -6 and
       d_year = 1998 
 group by s_store_name, s_store_id
 order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@date_dim
PREHOOK: Input: default@store
PREHOOK: Input: default@store_sales
#### A masked pattern was here ####
POSTHOOK: query: explain
select  s_store_name, s_store_id,
        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales
 from date_dim, store_sales, store
 where d_date_sk = ss_sold_date_sk and
       s_store_sk = ss_store_sk and
       s_gmt_offset = -6 and
       d_year = 1998 
 group by s_store_name, s_store_id
 order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_dim
POSTHOOK: Input: default@store
POSTHOOK: Input: default@store_sales
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: store_sales
          properties:
            hive.sql.query SELECT "t10"."$f0", "t10"."$f1", "t10"."$f2", "t10"."$f3", "t10"."$f4", "t10"."$f5", "t10"."$f6", "t10"."$f7", "t10"."$f8"
FROM (SELECT "t4"."s_store_name" AS "$f0", "t4"."s_store_id" AS "$f1", SUM(CASE WHEN "t7"."=" THEN "t1"."ss_sales_price" ELSE NULL END) AS "$f2", SUM(CASE WHEN "t7"."=2" THEN "t1"."ss_sales_price" ELSE NULL END) AS "$f3", SUM(CASE WHEN "t7"."=3" THEN "t1"."ss_sales_price" ELSE NULL END) AS "$f4", SUM(CASE WHEN "t7"."=4" THEN "t1"."ss_sales_price" ELSE NULL END) AS "$f5", SUM(CASE WHEN "t7"."=5" THEN "t1"."ss_sales_price" ELSE NULL END) AS "$f6", SUM(CASE WHEN "t7"."=6" THEN "t1"."ss_sales_price" ELSE NULL END) AS "$f7", SUM(CASE WHEN "t7"."=7" THEN "t1"."ss_sales_price" ELSE NULL END) AS "$f8"
FROM (SELECT "ss_sold_date_sk", "ss_store_sk", "ss_sales_price"
FROM (SELECT "ss_sold_date_sk", "ss_store_sk", "ss_sales_price"
FROM "store_sales") AS "t"
WHERE "ss_sold_date_sk" IS NOT NULL AND "ss_store_sk" IS NOT NULL) AS "t1"
INNER JOIN (SELECT "s_store_sk", "s_store_id", "s_store_name"
FROM (SELECT "s_store_sk", "s_store_id", "s_store_name", "s_gmt_offset"
FROM "store") AS "t2"
WHERE "s_gmt_offset" = -6 AND "s_store_sk" IS NOT NULL) AS "t4" ON "t1"."ss_store_sk" = "t4"."s_store_sk"
INNER JOIN (SELECT "d_date_sk", "d_day_name" = 'Sunday' AS "=", "d_day_name" = 'Monday' AS "=2", "d_day_name" = 'Tuesday' AS "=3", "d_day_name" = 'Wednesday' AS "=4", "d_day_name" = 'Thursday' AS "=5", "d_day_name" = 'Friday' AS "=6", "d_day_name" = 'Saturday' AS "=7"
FROM (SELECT "d_date_sk", "d_year", "d_day_name"
FROM "date_dim") AS "t5"
WHERE "d_year" = 1998 AND "d_date_sk" IS NOT NULL) AS "t7" ON "t1"."ss_sold_date_sk" = "t7"."d_date_sk"
GROUP BY "t4"."s_store_name", "t4"."s_store_id"
ORDER BY "t4"."s_store_name", "t4"."s_store_id", SUM(CASE WHEN "t7"."=" THEN "t1"."ss_sales_price" ELSE NULL END), SUM(CASE WHEN "t7"."=2" THEN "t1"."ss_sales_price" ELSE NULL END), SUM(CASE WHEN "t7"."=3" THEN "t1"."ss_sales_price" ELSE NULL END), SUM(CASE WHEN "t7"."=4" THEN "t1"."ss_sales_price" ELSE NULL END), SUM(CASE WHEN "t7"."=5" THEN "t1"."ss_sales_price" ELSE NULL END), SUM(CASE WHEN "t7"."=6" THEN "t1"."ss_sales_price" ELSE NULL END), SUM(CASE WHEN "t7"."=7" THEN "t1"."ss_sales_price" ELSE NULL END)
FETCH NEXT 100 ROWS ONLY) AS "t10"
            hive.sql.query.fieldNames $f0,$f1,$f2,$f3,$f4,$f5,$f6,$f7,$f8
            hive.sql.query.fieldTypes string,string,decimal(17,2),decimal(17,2),decimal(17,2),decimal(17,2),decimal(17,2),decimal(17,2),decimal(17,2)
            hive.sql.query.split false
          Select Operator
            expressions: $f0 (type: string), $f1 (type: string), $f2 (type: decimal(17,2)), $f3 (type: decimal(17,2)), $f4 (type: decimal(17,2)), $f5 (type: decimal(17,2)), $f6 (type: decimal(17,2)), $f7 (type: decimal(17,2)), $f8 (type: decimal(17,2))
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
            ListSink

