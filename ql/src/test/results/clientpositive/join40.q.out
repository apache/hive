PREHOOK: query: EXPLAIN SELECT x.key, x.value, y.key, y.value
FROM src x left outer JOIN (select * from src where key <= 100) y ON (x.key = y.key)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN SELECT x.key, x.value, y.key, y.value
FROM src x left outer JOIN (select * from src where key <= 100) y ON (x.key = y.key)
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_TABREF src x) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF src)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (<= (TOK_TABLE_OR_COL key) 100)))) y) (= (. (TOK_TABLE_OR_COL x) key) (. (TOK_TABLE_OR_COL y) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL x) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL x) value)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL y) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL y) value)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        x 
          TableScan
            alias: x
            Reduce Output Operator
              key expressions:
                    expr: key
                    type: string
              sort order: +
              Map-reduce partition columns:
                    expr: key
                    type: string
              tag: 0
              value expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
        y:src 
          TableScan
            alias: src
            Filter Operator
              predicate:
                  expr: (key <= 100)
                  type: boolean
              Filter Operator
                predicate:
                    expr: (key <= 100)
                    type: boolean
                Select Operator
                  expressions:
                        expr: key
                        type: string
                        expr: value
                        type: string
                  outputColumnNames: _col0, _col1
                  Reduce Output Operator
                    key expressions:
                          expr: _col0
                          type: string
                    sort order: +
                    Map-reduce partition columns:
                          expr: _col0
                          type: string
                    tag: 1
                    value expressions:
                          expr: _col0
                          type: string
                          expr: _col1
                          type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          condition expressions:
            0 {VALUE._col0} {VALUE._col1}
            1 {VALUE._col0} {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col2, _col3
          Select Operator
            expressions:
                  expr: _col0
                  type: string
                  expr: _col1
                  type: string
                  expr: _col2
                  type: string
                  expr: _col3
                  type: string
            outputColumnNames: _col0, _col1, _col2, _col3
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: SELECT x.key, x.value, y.key, y.value
FROM src x left outer JOIN (select * from src where key <= 100) y ON (x.key = y.key)
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/1249230133/10000
POSTHOOK: query: SELECT x.key, x.value, y.key, y.value
FROM src x left outer JOIN (select * from src where key <= 100) y ON (x.key = y.key)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/1249230133/10000
0	val_0	0	val_0
0	val_0	0	val_0
0	val_0	0	val_0
0	val_0	0	val_0
0	val_0	0	val_0
0	val_0	0	val_0
0	val_0	0	val_0
0	val_0	0	val_0
0	val_0	0	val_0
10	val_10	10	val_10
100	val_100	100	val_100
100	val_100	100	val_100
100	val_100	100	val_100
100	val_100	100	val_100
103	val_103	NULL	NULL
103	val_103	NULL	NULL
104	val_104	NULL	NULL
104	val_104	NULL	NULL
105	val_105	NULL	NULL
11	val_11	11	val_11
111	val_111	NULL	NULL
113	val_113	NULL	NULL
113	val_113	NULL	NULL
114	val_114	NULL	NULL
116	val_116	NULL	NULL
118	val_118	NULL	NULL
118	val_118	NULL	NULL
119	val_119	NULL	NULL
119	val_119	NULL	NULL
119	val_119	NULL	NULL
12	val_12	12	val_12
12	val_12	12	val_12
12	val_12	12	val_12
12	val_12	12	val_12
120	val_120	NULL	NULL
120	val_120	NULL	NULL
125	val_125	NULL	NULL
125	val_125	NULL	NULL
126	val_126	NULL	NULL
128	val_128	NULL	NULL
128	val_128	NULL	NULL
128	val_128	NULL	NULL
129	val_129	NULL	NULL
129	val_129	NULL	NULL
131	val_131	NULL	NULL
133	val_133	NULL	NULL
134	val_134	NULL	NULL
134	val_134	NULL	NULL
136	val_136	NULL	NULL
137	val_137	NULL	NULL
137	val_137	NULL	NULL
138	val_138	NULL	NULL
138	val_138	NULL	NULL
138	val_138	NULL	NULL
138	val_138	NULL	NULL
143	val_143	NULL	NULL
145	val_145	NULL	NULL
146	val_146	NULL	NULL
146	val_146	NULL	NULL
149	val_149	NULL	NULL
149	val_149	NULL	NULL
15	val_15	15	val_15
15	val_15	15	val_15
15	val_15	15	val_15
15	val_15	15	val_15
150	val_150	NULL	NULL
152	val_152	NULL	NULL
152	val_152	NULL	NULL
153	val_153	NULL	NULL
155	val_155	NULL	NULL
156	val_156	NULL	NULL
157	val_157	NULL	NULL
158	val_158	NULL	NULL
160	val_160	NULL	NULL
162	val_162	NULL	NULL
163	val_163	NULL	NULL
164	val_164	NULL	NULL
164	val_164	NULL	NULL
165	val_165	NULL	NULL
165	val_165	NULL	NULL
166	val_166	NULL	NULL
167	val_167	NULL	NULL
167	val_167	NULL	NULL
167	val_167	NULL	NULL
168	val_168	NULL	NULL
169	val_169	NULL	NULL
169	val_169	NULL	NULL
169	val_169	NULL	NULL
169	val_169	NULL	NULL
17	val_17	17	val_17
170	val_170	NULL	NULL
172	val_172	NULL	NULL
172	val_172	NULL	NULL
174	val_174	NULL	NULL
174	val_174	NULL	NULL
175	val_175	NULL	NULL
175	val_175	NULL	NULL
176	val_176	NULL	NULL
176	val_176	NULL	NULL
177	val_177	NULL	NULL
178	val_178	NULL	NULL
179	val_179	NULL	NULL
179	val_179	NULL	NULL
18	val_18	18	val_18
18	val_18	18	val_18
18	val_18	18	val_18
18	val_18	18	val_18
180	val_180	NULL	NULL
181	val_181	NULL	NULL
183	val_183	NULL	NULL
186	val_186	NULL	NULL
187	val_187	NULL	NULL
187	val_187	NULL	NULL
187	val_187	NULL	NULL
189	val_189	NULL	NULL
19	val_19	19	val_19
190	val_190	NULL	NULL
191	val_191	NULL	NULL
191	val_191	NULL	NULL
192	val_192	NULL	NULL
193	val_193	NULL	NULL
193	val_193	NULL	NULL
193	val_193	NULL	NULL
194	val_194	NULL	NULL
195	val_195	NULL	NULL
195	val_195	NULL	NULL
196	val_196	NULL	NULL
197	val_197	NULL	NULL
197	val_197	NULL	NULL
199	val_199	NULL	NULL
199	val_199	NULL	NULL
199	val_199	NULL	NULL
2	val_2	2	val_2
20	val_20	20	val_20
200	val_200	NULL	NULL
200	val_200	NULL	NULL
201	val_201	NULL	NULL
202	val_202	NULL	NULL
203	val_203	NULL	NULL
203	val_203	NULL	NULL
205	val_205	NULL	NULL
205	val_205	NULL	NULL
207	val_207	NULL	NULL
207	val_207	NULL	NULL
208	val_208	NULL	NULL
208	val_208	NULL	NULL
208	val_208	NULL	NULL
209	val_209	NULL	NULL
209	val_209	NULL	NULL
213	val_213	NULL	NULL
213	val_213	NULL	NULL
214	val_214	NULL	NULL
216	val_216	NULL	NULL
216	val_216	NULL	NULL
217	val_217	NULL	NULL
217	val_217	NULL	NULL
218	val_218	NULL	NULL
219	val_219	NULL	NULL
219	val_219	NULL	NULL
221	val_221	NULL	NULL
221	val_221	NULL	NULL
222	val_222	NULL	NULL
223	val_223	NULL	NULL
223	val_223	NULL	NULL
224	val_224	NULL	NULL
224	val_224	NULL	NULL
226	val_226	NULL	NULL
228	val_228	NULL	NULL
229	val_229	NULL	NULL
229	val_229	NULL	NULL
230	val_230	NULL	NULL
230	val_230	NULL	NULL
230	val_230	NULL	NULL
230	val_230	NULL	NULL
230	val_230	NULL	NULL
233	val_233	NULL	NULL
233	val_233	NULL	NULL
235	val_235	NULL	NULL
237	val_237	NULL	NULL
237	val_237	NULL	NULL
238	val_238	NULL	NULL
238	val_238	NULL	NULL
239	val_239	NULL	NULL
239	val_239	NULL	NULL
24	val_24	24	val_24
24	val_24	24	val_24
24	val_24	24	val_24
24	val_24	24	val_24
241	val_241	NULL	NULL
242	val_242	NULL	NULL
242	val_242	NULL	NULL
244	val_244	NULL	NULL
247	val_247	NULL	NULL
248	val_248	NULL	NULL
249	val_249	NULL	NULL
252	val_252	NULL	NULL
255	val_255	NULL	NULL
255	val_255	NULL	NULL
256	val_256	NULL	NULL
256	val_256	NULL	NULL
257	val_257	NULL	NULL
258	val_258	NULL	NULL
26	val_26	26	val_26
26	val_26	26	val_26
26	val_26	26	val_26
26	val_26	26	val_26
260	val_260	NULL	NULL
262	val_262	NULL	NULL
263	val_263	NULL	NULL
265	val_265	NULL	NULL
265	val_265	NULL	NULL
266	val_266	NULL	NULL
27	val_27	27	val_27
272	val_272	NULL	NULL
272	val_272	NULL	NULL
273	val_273	NULL	NULL
273	val_273	NULL	NULL
273	val_273	NULL	NULL
274	val_274	NULL	NULL
275	val_275	NULL	NULL
277	val_277	NULL	NULL
277	val_277	NULL	NULL
277	val_277	NULL	NULL
277	val_277	NULL	NULL
278	val_278	NULL	NULL
278	val_278	NULL	NULL
28	val_28	28	val_28
280	val_280	NULL	NULL
280	val_280	NULL	NULL
281	val_281	NULL	NULL
281	val_281	NULL	NULL
282	val_282	NULL	NULL
282	val_282	NULL	NULL
283	val_283	NULL	NULL
284	val_284	NULL	NULL
285	val_285	NULL	NULL
286	val_286	NULL	NULL
287	val_287	NULL	NULL
288	val_288	NULL	NULL
288	val_288	NULL	NULL
289	val_289	NULL	NULL
291	val_291	NULL	NULL
292	val_292	NULL	NULL
296	val_296	NULL	NULL
298	val_298	NULL	NULL
298	val_298	NULL	NULL
298	val_298	NULL	NULL
30	val_30	30	val_30
302	val_302	NULL	NULL
305	val_305	NULL	NULL
306	val_306	NULL	NULL
307	val_307	NULL	NULL
307	val_307	NULL	NULL
308	val_308	NULL	NULL
309	val_309	NULL	NULL
309	val_309	NULL	NULL
310	val_310	NULL	NULL
311	val_311	NULL	NULL
311	val_311	NULL	NULL
311	val_311	NULL	NULL
315	val_315	NULL	NULL
316	val_316	NULL	NULL
316	val_316	NULL	NULL
316	val_316	NULL	NULL
317	val_317	NULL	NULL
317	val_317	NULL	NULL
318	val_318	NULL	NULL
318	val_318	NULL	NULL
318	val_318	NULL	NULL
321	val_321	NULL	NULL
321	val_321	NULL	NULL
322	val_322	NULL	NULL
322	val_322	NULL	NULL
323	val_323	NULL	NULL
325	val_325	NULL	NULL
325	val_325	NULL	NULL
327	val_327	NULL	NULL
327	val_327	NULL	NULL
327	val_327	NULL	NULL
33	val_33	33	val_33
331	val_331	NULL	NULL
331	val_331	NULL	NULL
332	val_332	NULL	NULL
333	val_333	NULL	NULL
333	val_333	NULL	NULL
335	val_335	NULL	NULL
336	val_336	NULL	NULL
338	val_338	NULL	NULL
339	val_339	NULL	NULL
34	val_34	34	val_34
341	val_341	NULL	NULL
342	val_342	NULL	NULL
342	val_342	NULL	NULL
344	val_344	NULL	NULL
344	val_344	NULL	NULL
345	val_345	NULL	NULL
348	val_348	NULL	NULL
348	val_348	NULL	NULL
348	val_348	NULL	NULL
348	val_348	NULL	NULL
348	val_348	NULL	NULL
35	val_35	35	val_35
35	val_35	35	val_35
35	val_35	35	val_35
35	val_35	35	val_35
35	val_35	35	val_35
35	val_35	35	val_35
35	val_35	35	val_35
35	val_35	35	val_35
35	val_35	35	val_35
351	val_351	NULL	NULL
353	val_353	NULL	NULL
353	val_353	NULL	NULL
356	val_356	NULL	NULL
360	val_360	NULL	NULL
362	val_362	NULL	NULL
364	val_364	NULL	NULL
365	val_365	NULL	NULL
366	val_366	NULL	NULL
367	val_367	NULL	NULL
367	val_367	NULL	NULL
368	val_368	NULL	NULL
369	val_369	NULL	NULL
369	val_369	NULL	NULL
369	val_369	NULL	NULL
37	val_37	37	val_37
37	val_37	37	val_37
37	val_37	37	val_37
37	val_37	37	val_37
373	val_373	NULL	NULL
374	val_374	NULL	NULL
375	val_375	NULL	NULL
377	val_377	NULL	NULL
378	val_378	NULL	NULL
379	val_379	NULL	NULL
382	val_382	NULL	NULL
382	val_382	NULL	NULL
384	val_384	NULL	NULL
384	val_384	NULL	NULL
384	val_384	NULL	NULL
386	val_386	NULL	NULL
389	val_389	NULL	NULL
392	val_392	NULL	NULL
393	val_393	NULL	NULL
394	val_394	NULL	NULL
395	val_395	NULL	NULL
395	val_395	NULL	NULL
396	val_396	NULL	NULL
396	val_396	NULL	NULL
396	val_396	NULL	NULL
397	val_397	NULL	NULL
397	val_397	NULL	NULL
399	val_399	NULL	NULL
399	val_399	NULL	NULL
4	val_4	4	val_4
400	val_400	NULL	NULL
401	val_401	NULL	NULL
401	val_401	NULL	NULL
401	val_401	NULL	NULL
401	val_401	NULL	NULL
401	val_401	NULL	NULL
402	val_402	NULL	NULL
403	val_403	NULL	NULL
403	val_403	NULL	NULL
403	val_403	NULL	NULL
404	val_404	NULL	NULL
404	val_404	NULL	NULL
406	val_406	NULL	NULL
406	val_406	NULL	NULL
406	val_406	NULL	NULL
406	val_406	NULL	NULL
407	val_407	NULL	NULL
409	val_409	NULL	NULL
409	val_409	NULL	NULL
409	val_409	NULL	NULL
41	val_41	41	val_41
411	val_411	NULL	NULL
413	val_413	NULL	NULL
413	val_413	NULL	NULL
414	val_414	NULL	NULL
414	val_414	NULL	NULL
417	val_417	NULL	NULL
417	val_417	NULL	NULL
417	val_417	NULL	NULL
418	val_418	NULL	NULL
419	val_419	NULL	NULL
42	val_42	42	val_42
42	val_42	42	val_42
42	val_42	42	val_42
42	val_42	42	val_42
421	val_421	NULL	NULL
424	val_424	NULL	NULL
424	val_424	NULL	NULL
427	val_427	NULL	NULL
429	val_429	NULL	NULL
429	val_429	NULL	NULL
43	val_43	43	val_43
430	val_430	NULL	NULL
430	val_430	NULL	NULL
430	val_430	NULL	NULL
431	val_431	NULL	NULL
431	val_431	NULL	NULL
431	val_431	NULL	NULL
432	val_432	NULL	NULL
435	val_435	NULL	NULL
436	val_436	NULL	NULL
437	val_437	NULL	NULL
438	val_438	NULL	NULL
438	val_438	NULL	NULL
438	val_438	NULL	NULL
439	val_439	NULL	NULL
439	val_439	NULL	NULL
44	val_44	44	val_44
443	val_443	NULL	NULL
444	val_444	NULL	NULL
446	val_446	NULL	NULL
448	val_448	NULL	NULL
449	val_449	NULL	NULL
452	val_452	NULL	NULL
453	val_453	NULL	NULL
454	val_454	NULL	NULL
454	val_454	NULL	NULL
454	val_454	NULL	NULL
455	val_455	NULL	NULL
457	val_457	NULL	NULL
458	val_458	NULL	NULL
458	val_458	NULL	NULL
459	val_459	NULL	NULL
459	val_459	NULL	NULL
460	val_460	NULL	NULL
462	val_462	NULL	NULL
462	val_462	NULL	NULL
463	val_463	NULL	NULL
463	val_463	NULL	NULL
466	val_466	NULL	NULL
466	val_466	NULL	NULL
466	val_466	NULL	NULL
467	val_467	NULL	NULL
468	val_468	NULL	NULL
468	val_468	NULL	NULL
468	val_468	NULL	NULL
468	val_468	NULL	NULL
469	val_469	NULL	NULL
469	val_469	NULL	NULL
469	val_469	NULL	NULL
469	val_469	NULL	NULL
469	val_469	NULL	NULL
47	val_47	47	val_47
470	val_470	NULL	NULL
472	val_472	NULL	NULL
475	val_475	NULL	NULL
477	val_477	NULL	NULL
478	val_478	NULL	NULL
478	val_478	NULL	NULL
479	val_479	NULL	NULL
480	val_480	NULL	NULL
480	val_480	NULL	NULL
480	val_480	NULL	NULL
481	val_481	NULL	NULL
482	val_482	NULL	NULL
483	val_483	NULL	NULL
484	val_484	NULL	NULL
485	val_485	NULL	NULL
487	val_487	NULL	NULL
489	val_489	NULL	NULL
489	val_489	NULL	NULL
489	val_489	NULL	NULL
489	val_489	NULL	NULL
490	val_490	NULL	NULL
491	val_491	NULL	NULL
492	val_492	NULL	NULL
492	val_492	NULL	NULL
493	val_493	NULL	NULL
494	val_494	NULL	NULL
495	val_495	NULL	NULL
496	val_496	NULL	NULL
497	val_497	NULL	NULL
498	val_498	NULL	NULL
498	val_498	NULL	NULL
498	val_498	NULL	NULL
5	val_5	5	val_5
5	val_5	5	val_5
5	val_5	5	val_5
5	val_5	5	val_5
5	val_5	5	val_5
5	val_5	5	val_5
5	val_5	5	val_5
5	val_5	5	val_5
5	val_5	5	val_5
51	val_51	51	val_51
51	val_51	51	val_51
51	val_51	51	val_51
51	val_51	51	val_51
53	val_53	53	val_53
54	val_54	54	val_54
57	val_57	57	val_57
58	val_58	58	val_58
58	val_58	58	val_58
58	val_58	58	val_58
58	val_58	58	val_58
64	val_64	64	val_64
65	val_65	65	val_65
66	val_66	66	val_66
67	val_67	67	val_67
67	val_67	67	val_67
67	val_67	67	val_67
67	val_67	67	val_67
69	val_69	69	val_69
70	val_70	70	val_70
70	val_70	70	val_70
70	val_70	70	val_70
70	val_70	70	val_70
70	val_70	70	val_70
70	val_70	70	val_70
70	val_70	70	val_70
70	val_70	70	val_70
70	val_70	70	val_70
72	val_72	72	val_72
72	val_72	72	val_72
72	val_72	72	val_72
72	val_72	72	val_72
74	val_74	74	val_74
76	val_76	76	val_76
76	val_76	76	val_76
76	val_76	76	val_76
76	val_76	76	val_76
77	val_77	77	val_77
78	val_78	78	val_78
8	val_8	8	val_8
80	val_80	80	val_80
82	val_82	82	val_82
83	val_83	83	val_83
83	val_83	83	val_83
83	val_83	83	val_83
83	val_83	83	val_83
84	val_84	84	val_84
84	val_84	84	val_84
84	val_84	84	val_84
84	val_84	84	val_84
85	val_85	85	val_85
86	val_86	86	val_86
87	val_87	87	val_87
9	val_9	9	val_9
90	val_90	90	val_90
90	val_90	90	val_90
90	val_90	90	val_90
90	val_90	90	val_90
90	val_90	90	val_90
90	val_90	90	val_90
90	val_90	90	val_90
90	val_90	90	val_90
90	val_90	90	val_90
92	val_92	92	val_92
95	val_95	95	val_95
95	val_95	95	val_95
95	val_95	95	val_95
95	val_95	95	val_95
96	val_96	96	val_96
97	val_97	97	val_97
97	val_97	97	val_97
97	val_97	97	val_97
97	val_97	97	val_97
98	val_98	98	val_98
98	val_98	98	val_98
98	val_98	98	val_98
98	val_98	98	val_98
PREHOOK: query: EXPLAIN select src1.key, src2.value 
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN select src1.key, src2.value 
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF src src1) (TOK_TABREF src src2) (= (. (TOK_TABLE_OR_COL src1) key) (. (TOK_TABLE_OR_COL src2) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src1) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src2) value)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        src2 
          TableScan
            alias: src2
            Reduce Output Operator
              key expressions:
                    expr: key
                    type: string
              sort order: +
              Map-reduce partition columns:
                    expr: key
                    type: string
              tag: 1
              value expressions:
                    expr: value
                    type: string
        src1 
          TableScan
            alias: src1
            Reduce Output Operator
              key expressions:
                    expr: key
                    type: string
              sort order: +
              Map-reduce partition columns:
                    expr: key
                    type: string
              tag: 0
              value expressions:
                    expr: key
                    type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          condition expressions:
            0 {VALUE._col0}
            1 {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col0, _col3
          Select Operator
            expressions:
                  expr: _col0
                  type: string
                  expr: _col3
                  type: string
            outputColumnNames: _col0, _col1
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: select src1.key, src2.value 
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/1169404066/10000
POSTHOOK: query: select src1.key, src2.value 
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/1169404066/10000
0	val_0
0	val_0
0	val_0
0	val_0
0	val_0
0	val_0
0	val_0
0	val_0
0	val_0
10	val_10
100	val_100
100	val_100
100	val_100
100	val_100
103	val_103
103	val_103
103	val_103
103	val_103
104	val_104
104	val_104
104	val_104
104	val_104
105	val_105
11	val_11
111	val_111
113	val_113
113	val_113
113	val_113
113	val_113
114	val_114
116	val_116
118	val_118
118	val_118
118	val_118
118	val_118
119	val_119
119	val_119
119	val_119
119	val_119
119	val_119
119	val_119
119	val_119
119	val_119
119	val_119
12	val_12
12	val_12
12	val_12
12	val_12
120	val_120
120	val_120
120	val_120
120	val_120
125	val_125
125	val_125
125	val_125
125	val_125
126	val_126
128	val_128
128	val_128
128	val_128
128	val_128
128	val_128
128	val_128
128	val_128
128	val_128
128	val_128
129	val_129
129	val_129
129	val_129
129	val_129
131	val_131
133	val_133
134	val_134
134	val_134
134	val_134
134	val_134
136	val_136
137	val_137
137	val_137
137	val_137
137	val_137
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
138	val_138
143	val_143
145	val_145
146	val_146
146	val_146
146	val_146
146	val_146
149	val_149
149	val_149
149	val_149
149	val_149
15	val_15
15	val_15
15	val_15
15	val_15
150	val_150
152	val_152
152	val_152
152	val_152
152	val_152
153	val_153
155	val_155
156	val_156
157	val_157
158	val_158
160	val_160
162	val_162
163	val_163
164	val_164
164	val_164
164	val_164
164	val_164
165	val_165
165	val_165
165	val_165
165	val_165
166	val_166
167	val_167
167	val_167
167	val_167
167	val_167
167	val_167
167	val_167
167	val_167
167	val_167
167	val_167
168	val_168
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
169	val_169
17	val_17
170	val_170
172	val_172
172	val_172
172	val_172
172	val_172
174	val_174
174	val_174
174	val_174
174	val_174
175	val_175
175	val_175
175	val_175
175	val_175
176	val_176
176	val_176
176	val_176
176	val_176
177	val_177
178	val_178
179	val_179
179	val_179
179	val_179
179	val_179
18	val_18
18	val_18
18	val_18
18	val_18
180	val_180
181	val_181
183	val_183
186	val_186
187	val_187
187	val_187
187	val_187
187	val_187
187	val_187
187	val_187
187	val_187
187	val_187
187	val_187
189	val_189
19	val_19
190	val_190
191	val_191
191	val_191
191	val_191
191	val_191
192	val_192
193	val_193
193	val_193
193	val_193
193	val_193
193	val_193
193	val_193
193	val_193
193	val_193
193	val_193
194	val_194
195	val_195
195	val_195
195	val_195
195	val_195
196	val_196
197	val_197
197	val_197
197	val_197
197	val_197
199	val_199
199	val_199
199	val_199
199	val_199
199	val_199
199	val_199
199	val_199
199	val_199
199	val_199
2	val_2
20	val_20
200	val_200
200	val_200
200	val_200
200	val_200
201	val_201
202	val_202
203	val_203
203	val_203
203	val_203
203	val_203
205	val_205
205	val_205
205	val_205
205	val_205
207	val_207
207	val_207
207	val_207
207	val_207
208	val_208
208	val_208
208	val_208
208	val_208
208	val_208
208	val_208
208	val_208
208	val_208
208	val_208
209	val_209
209	val_209
209	val_209
209	val_209
213	val_213
213	val_213
213	val_213
213	val_213
214	val_214
216	val_216
216	val_216
216	val_216
216	val_216
217	val_217
217	val_217
217	val_217
217	val_217
218	val_218
219	val_219
219	val_219
219	val_219
219	val_219
221	val_221
221	val_221
221	val_221
221	val_221
222	val_222
223	val_223
223	val_223
223	val_223
223	val_223
224	val_224
224	val_224
224	val_224
224	val_224
226	val_226
228	val_228
229	val_229
229	val_229
229	val_229
229	val_229
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
230	val_230
233	val_233
233	val_233
233	val_233
233	val_233
235	val_235
237	val_237
237	val_237
237	val_237
237	val_237
238	val_238
238	val_238
238	val_238
238	val_238
239	val_239
239	val_239
239	val_239
239	val_239
24	val_24
24	val_24
24	val_24
24	val_24
241	val_241
242	val_242
242	val_242
242	val_242
242	val_242
244	val_244
247	val_247
248	val_248
249	val_249
252	val_252
255	val_255
255	val_255
255	val_255
255	val_255
256	val_256
256	val_256
256	val_256
256	val_256
257	val_257
258	val_258
26	val_26
26	val_26
26	val_26
26	val_26
260	val_260
262	val_262
263	val_263
265	val_265
265	val_265
265	val_265
265	val_265
266	val_266
27	val_27
272	val_272
272	val_272
272	val_272
272	val_272
273	val_273
273	val_273
273	val_273
273	val_273
273	val_273
273	val_273
273	val_273
273	val_273
273	val_273
274	val_274
275	val_275
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
277	val_277
278	val_278
278	val_278
278	val_278
278	val_278
28	val_28
280	val_280
280	val_280
280	val_280
280	val_280
281	val_281
281	val_281
281	val_281
281	val_281
282	val_282
282	val_282
282	val_282
282	val_282
283	val_283
284	val_284
285	val_285
286	val_286
287	val_287
288	val_288
288	val_288
288	val_288
288	val_288
289	val_289
291	val_291
292	val_292
296	val_296
298	val_298
298	val_298
298	val_298
298	val_298
298	val_298
298	val_298
298	val_298
298	val_298
298	val_298
30	val_30
302	val_302
305	val_305
306	val_306
307	val_307
307	val_307
307	val_307
307	val_307
308	val_308
309	val_309
309	val_309
309	val_309
309	val_309
310	val_310
311	val_311
311	val_311
311	val_311
311	val_311
311	val_311
311	val_311
311	val_311
311	val_311
311	val_311
315	val_315
316	val_316
316	val_316
316	val_316
316	val_316
316	val_316
316	val_316
316	val_316
316	val_316
316	val_316
317	val_317
317	val_317
317	val_317
317	val_317
318	val_318
318	val_318
318	val_318
318	val_318
318	val_318
318	val_318
318	val_318
318	val_318
318	val_318
321	val_321
321	val_321
321	val_321
321	val_321
322	val_322
322	val_322
322	val_322
322	val_322
323	val_323
325	val_325
325	val_325
325	val_325
325	val_325
327	val_327
327	val_327
327	val_327
327	val_327
327	val_327
327	val_327
327	val_327
327	val_327
327	val_327
33	val_33
331	val_331
331	val_331
331	val_331
331	val_331
332	val_332
333	val_333
333	val_333
333	val_333
333	val_333
335	val_335
336	val_336
338	val_338
339	val_339
34	val_34
341	val_341
342	val_342
342	val_342
342	val_342
342	val_342
344	val_344
344	val_344
344	val_344
344	val_344
345	val_345
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
348	val_348
35	val_35
35	val_35
35	val_35
35	val_35
35	val_35
35	val_35
35	val_35
35	val_35
35	val_35
351	val_351
353	val_353
353	val_353
353	val_353
353	val_353
356	val_356
360	val_360
362	val_362
364	val_364
365	val_365
366	val_366
367	val_367
367	val_367
367	val_367
367	val_367
368	val_368
369	val_369
369	val_369
369	val_369
369	val_369
369	val_369
369	val_369
369	val_369
369	val_369
369	val_369
37	val_37
37	val_37
37	val_37
37	val_37
373	val_373
374	val_374
375	val_375
377	val_377
378	val_378
379	val_379
382	val_382
382	val_382
382	val_382
382	val_382
384	val_384
384	val_384
384	val_384
384	val_384
384	val_384
384	val_384
384	val_384
384	val_384
384	val_384
386	val_386
389	val_389
392	val_392
393	val_393
394	val_394
395	val_395
395	val_395
395	val_395
395	val_395
396	val_396
396	val_396
396	val_396
396	val_396
396	val_396
396	val_396
396	val_396
396	val_396
396	val_396
397	val_397
397	val_397
397	val_397
397	val_397
399	val_399
399	val_399
399	val_399
399	val_399
4	val_4
400	val_400
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
401	val_401
402	val_402
403	val_403
403	val_403
403	val_403
403	val_403
403	val_403
403	val_403
403	val_403
403	val_403
403	val_403
404	val_404
404	val_404
404	val_404
404	val_404
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
406	val_406
407	val_407
409	val_409
409	val_409
409	val_409
409	val_409
409	val_409
409	val_409
409	val_409
409	val_409
409	val_409
41	val_41
411	val_411
413	val_413
413	val_413
413	val_413
413	val_413
414	val_414
414	val_414
414	val_414
414	val_414
417	val_417
417	val_417
417	val_417
417	val_417
417	val_417
417	val_417
417	val_417
417	val_417
417	val_417
418	val_418
419	val_419
42	val_42
42	val_42
42	val_42
42	val_42
421	val_421
424	val_424
424	val_424
424	val_424
424	val_424
427	val_427
429	val_429
429	val_429
429	val_429
429	val_429
43	val_43
430	val_430
430	val_430
430	val_430
430	val_430
430	val_430
430	val_430
430	val_430
430	val_430
430	val_430
431	val_431
431	val_431
431	val_431
431	val_431
431	val_431
431	val_431
431	val_431
431	val_431
431	val_431
432	val_432
435	val_435
436	val_436
437	val_437
438	val_438
438	val_438
438	val_438
438	val_438
438	val_438
438	val_438
438	val_438
438	val_438
438	val_438
439	val_439
439	val_439
439	val_439
439	val_439
44	val_44
443	val_443
444	val_444
446	val_446
448	val_448
449	val_449
452	val_452
453	val_453
454	val_454
454	val_454
454	val_454
454	val_454
454	val_454
454	val_454
454	val_454
454	val_454
454	val_454
455	val_455
457	val_457
458	val_458
458	val_458
458	val_458
458	val_458
459	val_459
459	val_459
459	val_459
459	val_459
460	val_460
462	val_462
462	val_462
462	val_462
462	val_462
463	val_463
463	val_463
463	val_463
463	val_463
466	val_466
466	val_466
466	val_466
466	val_466
466	val_466
466	val_466
466	val_466
466	val_466
466	val_466
467	val_467
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
468	val_468
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
469	val_469
47	val_47
470	val_470
472	val_472
475	val_475
477	val_477
478	val_478
478	val_478
478	val_478
478	val_478
479	val_479
480	val_480
480	val_480
480	val_480
480	val_480
480	val_480
480	val_480
480	val_480
480	val_480
480	val_480
481	val_481
482	val_482
483	val_483
484	val_484
485	val_485
487	val_487
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
489	val_489
490	val_490
491	val_491
492	val_492
492	val_492
492	val_492
492	val_492
493	val_493
494	val_494
495	val_495
496	val_496
497	val_497
498	val_498
498	val_498
498	val_498
498	val_498
498	val_498
498	val_498
498	val_498
498	val_498
498	val_498
5	val_5
5	val_5
5	val_5
5	val_5
5	val_5
5	val_5
5	val_5
5	val_5
5	val_5
51	val_51
51	val_51
51	val_51
51	val_51
53	val_53
54	val_54
57	val_57
58	val_58
58	val_58
58	val_58
58	val_58
64	val_64
65	val_65
66	val_66
67	val_67
67	val_67
67	val_67
67	val_67
69	val_69
70	val_70
70	val_70
70	val_70
70	val_70
70	val_70
70	val_70
70	val_70
70	val_70
70	val_70
72	val_72
72	val_72
72	val_72
72	val_72
74	val_74
76	val_76
76	val_76
76	val_76
76	val_76
77	val_77
78	val_78
8	val_8
80	val_80
82	val_82
83	val_83
83	val_83
83	val_83
83	val_83
84	val_84
84	val_84
84	val_84
84	val_84
85	val_85
86	val_86
87	val_87
9	val_9
90	val_90
90	val_90
90	val_90
90	val_90
90	val_90
90	val_90
90	val_90
90	val_90
90	val_90
92	val_92
95	val_95
95	val_95
95	val_95
95	val_95
96	val_96
97	val_97
97	val_97
97	val_97
97	val_97
98	val_98
98	val_98
98	val_98
98	val_98
PREHOOK: query: EXPLAIN
SELECT * FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 10) RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 20)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT * FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 10) RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 20)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_RIGHTOUTERJOIN (TOK_JOIN (TOK_TABREF src src1) (TOK_TABREF src src2) (AND (= (. (TOK_TABLE_OR_COL src1) key) (. (TOK_TABLE_OR_COL src2) key)) (< (. (TOK_TABLE_OR_COL src1) key) 10))) (TOK_TABREF src src3) (AND (= (. (TOK_TABLE_OR_COL src1) key) (. (TOK_TABLE_OR_COL src3) key)) (< (. (TOK_TABLE_OR_COL src3) key) 20)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_SORTBY (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src1) key)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src1) value)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src2) key)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src2) value)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src3) key)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src3) value)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        src2 
          TableScan
            alias: src2
            Reduce Output Operator
              key expressions:
                    expr: key
                    type: string
              sort order: +
              Map-reduce partition columns:
                    expr: key
                    type: string
              tag: 1
              value expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
        src3 
          TableScan
            alias: src3
            Filter Operator
              predicate:
                  expr: (key < 20)
                  type: boolean
              Filter Operator
                predicate:
                    expr: (key < 20)
                    type: boolean
                Reduce Output Operator
                  key expressions:
                        expr: key
                        type: string
                  sort order: +
                  Map-reduce partition columns:
                        expr: key
                        type: string
                  tag: 2
                  value expressions:
                        expr: key
                        type: string
                        expr: value
                        type: string
        src1 
          TableScan
            alias: src1
            Filter Operator
              predicate:
                  expr: (key < 10)
                  type: boolean
              Filter Operator
                predicate:
                    expr: (key < 10)
                    type: boolean
                Reduce Output Operator
                  key expressions:
                        expr: key
                        type: string
                  sort order: +
                  Map-reduce partition columns:
                        expr: key
                        type: string
                  tag: 0
                  value expressions:
                        expr: key
                        type: string
                        expr: value
                        type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Right Outer Join0 to 2
          condition expressions:
            0 {VALUE._col0} {VALUE._col1}
            1 {VALUE._col0} {VALUE._col1}
            2 {VALUE._col0} {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Select Operator
            expressions:
                  expr: _col0
                  type: string
                  expr: _col1
                  type: string
                  expr: _col2
                  type: string
                  expr: _col3
                  type: string
                  expr: _col4
                  type: string
                  expr: _col5
                  type: string
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat

  Stage: Stage-2
    Map Reduce
      Alias -> Map Operator Tree:
        file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/1836147411/10002 
            Reduce Output Operator
              key expressions:
                    expr: _col0
                    type: string
                    expr: _col1
                    type: string
                    expr: _col2
                    type: string
                    expr: _col3
                    type: string
                    expr: _col4
                    type: string
                    expr: _col5
                    type: string
              sort order: ++++++
              tag: -1
              value expressions:
                    expr: _col0
                    type: string
                    expr: _col1
                    type: string
                    expr: _col2
                    type: string
                    expr: _col3
                    type: string
                    expr: _col4
                    type: string
                    expr: _col5
                    type: string
      Reduce Operator Tree:
        Extract
          File Output Operator
            compressed: false
            GlobalTableId: 0
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: SELECT * FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 10) RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 20)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/561269019/10000
POSTHOOK: query: SELECT * FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 10) RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 20)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/561269019/10000
NULL	NULL	NULL	NULL	10	val_10
NULL	NULL	NULL	NULL	11	val_11
NULL	NULL	NULL	NULL	12	val_12
NULL	NULL	NULL	NULL	12	val_12
NULL	NULL	NULL	NULL	15	val_15
NULL	NULL	NULL	NULL	15	val_15
NULL	NULL	NULL	NULL	17	val_17
NULL	NULL	NULL	NULL	18	val_18
NULL	NULL	NULL	NULL	18	val_18
NULL	NULL	NULL	NULL	19	val_19
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
2	val_2	2	val_2	2	val_2
4	val_4	4	val_4	4	val_4
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
8	val_8	8	val_8	8	val_8
9	val_9	9	val_9	9	val_9
PREHOOK: query: EXPLAIN
SELECT * FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 10 AND src2.key < 15) RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 20)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT * FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 10 AND src2.key < 15) RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 20)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_RIGHTOUTERJOIN (TOK_JOIN (TOK_TABREF src src1) (TOK_TABREF src src2) (AND (AND (= (. (TOK_TABLE_OR_COL src1) key) (. (TOK_TABLE_OR_COL src2) key)) (< (. (TOK_TABLE_OR_COL src1) key) 10)) (< (. (TOK_TABLE_OR_COL src2) key) 15))) (TOK_TABREF src src3) (AND (= (. (TOK_TABLE_OR_COL src1) key) (. (TOK_TABLE_OR_COL src3) key)) (< (. (TOK_TABLE_OR_COL src3) key) 20)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_SORTBY (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src1) key)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src1) value)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src2) key)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src2) value)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src3) key)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL src3) value)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        src2 
          TableScan
            alias: src2
            Filter Operator
              predicate:
                  expr: (key < 15)
                  type: boolean
              Filter Operator
                predicate:
                    expr: (key < 15)
                    type: boolean
                Reduce Output Operator
                  key expressions:
                        expr: key
                        type: string
                  sort order: +
                  Map-reduce partition columns:
                        expr: key
                        type: string
                  tag: 1
                  value expressions:
                        expr: key
                        type: string
                        expr: value
                        type: string
        src3 
          TableScan
            alias: src3
            Filter Operator
              predicate:
                  expr: (key < 20)
                  type: boolean
              Filter Operator
                predicate:
                    expr: (key < 20)
                    type: boolean
                Reduce Output Operator
                  key expressions:
                        expr: key
                        type: string
                  sort order: +
                  Map-reduce partition columns:
                        expr: key
                        type: string
                  tag: 2
                  value expressions:
                        expr: key
                        type: string
                        expr: value
                        type: string
        src1 
          TableScan
            alias: src1
            Filter Operator
              predicate:
                  expr: (key < 10)
                  type: boolean
              Filter Operator
                predicate:
                    expr: (key < 10)
                    type: boolean
                Reduce Output Operator
                  key expressions:
                        expr: key
                        type: string
                  sort order: +
                  Map-reduce partition columns:
                        expr: key
                        type: string
                  tag: 0
                  value expressions:
                        expr: key
                        type: string
                        expr: value
                        type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Right Outer Join0 to 2
          condition expressions:
            0 {VALUE._col0} {VALUE._col1}
            1 {VALUE._col0} {VALUE._col1}
            2 {VALUE._col0} {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Select Operator
            expressions:
                  expr: _col0
                  type: string
                  expr: _col1
                  type: string
                  expr: _col2
                  type: string
                  expr: _col3
                  type: string
                  expr: _col4
                  type: string
                  expr: _col5
                  type: string
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat

  Stage: Stage-2
    Map Reduce
      Alias -> Map Operator Tree:
        file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/1889892039/10002 
            Reduce Output Operator
              key expressions:
                    expr: _col0
                    type: string
                    expr: _col1
                    type: string
                    expr: _col2
                    type: string
                    expr: _col3
                    type: string
                    expr: _col4
                    type: string
                    expr: _col5
                    type: string
              sort order: ++++++
              tag: -1
              value expressions:
                    expr: _col0
                    type: string
                    expr: _col1
                    type: string
                    expr: _col2
                    type: string
                    expr: _col3
                    type: string
                    expr: _col4
                    type: string
                    expr: _col5
                    type: string
      Reduce Operator Tree:
        Extract
          File Output Operator
            compressed: false
            GlobalTableId: 0
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: SELECT * FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 10 AND src2.key < 15) RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 20)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/1597568732/10000
POSTHOOK: query: SELECT * FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key < 10 AND src2.key < 15) RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key < 20)
SORT BY src1.key, src1.value, src2.key, src2.value, src3.key, src3.value
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/1597568732/10000
NULL	NULL	NULL	NULL	10	val_10
NULL	NULL	NULL	NULL	11	val_11
NULL	NULL	NULL	NULL	12	val_12
NULL	NULL	NULL	NULL	12	val_12
NULL	NULL	NULL	NULL	15	val_15
NULL	NULL	NULL	NULL	15	val_15
NULL	NULL	NULL	NULL	17	val_17
NULL	NULL	NULL	NULL	18	val_18
NULL	NULL	NULL	NULL	18	val_18
NULL	NULL	NULL	NULL	19	val_19
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
0	val_0	0	val_0	0	val_0
2	val_2	2	val_2	2	val_2
4	val_4	4	val_4	4	val_4
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
5	val_5	5	val_5	5	val_5
8	val_8	8	val_8	8	val_8
9	val_9	9	val_9	9	val_9
PREHOOK: query: EXPLAIN 
SELECT /*+ MAPJOIN(y) */ x.key, x.value, y.key, y.value
FROM src x left outer JOIN (select * from src where key <= 100) y ON (x.key = y.key)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN 
SELECT /*+ MAPJOIN(y) */ x.key, x.value, y.key, y.value
FROM src x left outer JOIN (select * from src where key <= 100) y ON (x.key = y.key)
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_TABREF src x) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF src)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (<= (TOK_TABLE_OR_COL key) 100)))) y) (= (. (TOK_TABLE_OR_COL x) key) (. (TOK_TABLE_OR_COL y) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_HINTLIST (TOK_HINT TOK_MAPJOIN (TOK_HINTARGLIST y))) (TOK_SELEXPR (. (TOK_TABLE_OR_COL x) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL x) value)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL y) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL y) value)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        x 
          TableScan
            alias: x
            Common Join Operator
              condition map:
                   Left Outer Join0 to 1
              condition expressions:
                0 {key} {value}
                1 {_col0} {_col1}
              handleSkewJoin: false
              keys:
                0 [Column[key]]
                1 [Column[_col0]]
              outputColumnNames: _col0, _col1, _col2, _col3
              Position of Big Table: 0
              Select Operator
                expressions:
                      expr: _col0
                      type: string
                      expr: _col1
                      type: string
                      expr: _col2
                      type: string
                      expr: _col3
                      type: string
                outputColumnNames: _col0, _col1, _col2, _col3
                Select Operator
                  expressions:
                        expr: _col0
                        type: string
                        expr: _col1
                        type: string
                        expr: _col2
                        type: string
                        expr: _col3
                        type: string
                  outputColumnNames: _col0, _col1, _col2, _col3
                  File Output Operator
                    compressed: false
                    GlobalTableId: 0
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
      Local Work:
        Map Reduce Local Work
          Alias -> Map Local Tables:
            y:src 
              Fetch Operator
                limit: -1
          Alias -> Map Local Operator Tree:
            y:src 
              TableScan
                alias: src
                Filter Operator
                  predicate:
                      expr: (key <= 100)
                      type: boolean
                  Filter Operator
                    predicate:
                        expr: (key <= 100)
                        type: boolean
                    Select Operator
                      expressions:
                            expr: key
                            type: string
                            expr: value
                            type: string
                      outputColumnNames: _col0, _col1
                      Common Join Operator
                        condition map:
                             Left Outer Join0 to 1
                        condition expressions:
                          0 {key} {value}
                          1 {_col0} {_col1}
                        handleSkewJoin: false
                        keys:
                          0 [Column[key]]
                          1 [Column[_col0]]
                        outputColumnNames: _col0, _col1, _col2, _col3
                        Position of Big Table: 0
                        Select Operator
                          expressions:
                                expr: _col0
                                type: string
                                expr: _col1
                                type: string
                                expr: _col2
                                type: string
                                expr: _col3
                                type: string
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Select Operator
                            expressions:
                                  expr: _col0
                                  type: string
                                  expr: _col1
                                  type: string
                                  expr: _col2
                                  type: string
                                  expr: _col3
                                  type: string
                            outputColumnNames: _col0, _col1, _col2, _col3
                            File Output Operator
                              compressed: false
                              GlobalTableId: 0
                              table:
                                  input format: org.apache.hadoop.mapred.TextInputFormat
                                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: SELECT /*+ MAPJOIN(y) */ x.key, x.value, y.key, y.value
FROM src x left outer JOIN (select * from src where key <= 100) y ON (x.key = y.key)
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/302774741/10000
POSTHOOK: query: SELECT /*+ MAPJOIN(y) */ x.key, x.value, y.key, y.value
FROM src x left outer JOIN (select * from src where key <= 100) y ON (x.key = y.key)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/302774741/10000
238	val_238	NULL	NULL
86	val_86	86	val_86
311	val_311	NULL	NULL
27	val_27	27	val_27
165	val_165	NULL	NULL
409	val_409	NULL	NULL
255	val_255	NULL	NULL
278	val_278	NULL	NULL
98	val_98	98	val_98
98	val_98	98	val_98
484	val_484	NULL	NULL
265	val_265	NULL	NULL
193	val_193	NULL	NULL
401	val_401	NULL	NULL
150	val_150	NULL	NULL
273	val_273	NULL	NULL
224	val_224	NULL	NULL
369	val_369	NULL	NULL
66	val_66	66	val_66
128	val_128	NULL	NULL
213	val_213	NULL	NULL
146	val_146	NULL	NULL
406	val_406	NULL	NULL
429	val_429	NULL	NULL
374	val_374	NULL	NULL
152	val_152	NULL	NULL
469	val_469	NULL	NULL
145	val_145	NULL	NULL
495	val_495	NULL	NULL
37	val_37	37	val_37
37	val_37	37	val_37
327	val_327	NULL	NULL
281	val_281	NULL	NULL
277	val_277	NULL	NULL
209	val_209	NULL	NULL
15	val_15	15	val_15
15	val_15	15	val_15
82	val_82	82	val_82
403	val_403	NULL	NULL
166	val_166	NULL	NULL
417	val_417	NULL	NULL
430	val_430	NULL	NULL
252	val_252	NULL	NULL
292	val_292	NULL	NULL
219	val_219	NULL	NULL
287	val_287	NULL	NULL
153	val_153	NULL	NULL
193	val_193	NULL	NULL
338	val_338	NULL	NULL
446	val_446	NULL	NULL
459	val_459	NULL	NULL
394	val_394	NULL	NULL
237	val_237	NULL	NULL
482	val_482	NULL	NULL
174	val_174	NULL	NULL
413	val_413	NULL	NULL
494	val_494	NULL	NULL
207	val_207	NULL	NULL
199	val_199	NULL	NULL
466	val_466	NULL	NULL
208	val_208	NULL	NULL
174	val_174	NULL	NULL
399	val_399	NULL	NULL
396	val_396	NULL	NULL
247	val_247	NULL	NULL
417	val_417	NULL	NULL
489	val_489	NULL	NULL
162	val_162	NULL	NULL
377	val_377	NULL	NULL
397	val_397	NULL	NULL
309	val_309	NULL	NULL
365	val_365	NULL	NULL
266	val_266	NULL	NULL
439	val_439	NULL	NULL
342	val_342	NULL	NULL
367	val_367	NULL	NULL
325	val_325	NULL	NULL
167	val_167	NULL	NULL
195	val_195	NULL	NULL
475	val_475	NULL	NULL
17	val_17	17	val_17
113	val_113	NULL	NULL
155	val_155	NULL	NULL
203	val_203	NULL	NULL
339	val_339	NULL	NULL
0	val_0	0	val_0
0	val_0	0	val_0
0	val_0	0	val_0
455	val_455	NULL	NULL
128	val_128	NULL	NULL
311	val_311	NULL	NULL
316	val_316	NULL	NULL
57	val_57	57	val_57
302	val_302	NULL	NULL
205	val_205	NULL	NULL
149	val_149	NULL	NULL
438	val_438	NULL	NULL
345	val_345	NULL	NULL
129	val_129	NULL	NULL
170	val_170	NULL	NULL
20	val_20	20	val_20
489	val_489	NULL	NULL
157	val_157	NULL	NULL
378	val_378	NULL	NULL
221	val_221	NULL	NULL
92	val_92	92	val_92
111	val_111	NULL	NULL
47	val_47	47	val_47
72	val_72	72	val_72
72	val_72	72	val_72
4	val_4	4	val_4
280	val_280	NULL	NULL
35	val_35	35	val_35
35	val_35	35	val_35
35	val_35	35	val_35
427	val_427	NULL	NULL
277	val_277	NULL	NULL
208	val_208	NULL	NULL
356	val_356	NULL	NULL
399	val_399	NULL	NULL
169	val_169	NULL	NULL
382	val_382	NULL	NULL
498	val_498	NULL	NULL
125	val_125	NULL	NULL
386	val_386	NULL	NULL
437	val_437	NULL	NULL
469	val_469	NULL	NULL
192	val_192	NULL	NULL
286	val_286	NULL	NULL
187	val_187	NULL	NULL
176	val_176	NULL	NULL
54	val_54	54	val_54
459	val_459	NULL	NULL
51	val_51	51	val_51
51	val_51	51	val_51
138	val_138	NULL	NULL
103	val_103	NULL	NULL
239	val_239	NULL	NULL
213	val_213	NULL	NULL
216	val_216	NULL	NULL
430	val_430	NULL	NULL
278	val_278	NULL	NULL
176	val_176	NULL	NULL
289	val_289	NULL	NULL
221	val_221	NULL	NULL
65	val_65	65	val_65
318	val_318	NULL	NULL
332	val_332	NULL	NULL
311	val_311	NULL	NULL
275	val_275	NULL	NULL
137	val_137	NULL	NULL
241	val_241	NULL	NULL
83	val_83	83	val_83
83	val_83	83	val_83
333	val_333	NULL	NULL
180	val_180	NULL	NULL
284	val_284	NULL	NULL
12	val_12	12	val_12
12	val_12	12	val_12
230	val_230	NULL	NULL
181	val_181	NULL	NULL
67	val_67	67	val_67
67	val_67	67	val_67
260	val_260	NULL	NULL
404	val_404	NULL	NULL
384	val_384	NULL	NULL
489	val_489	NULL	NULL
353	val_353	NULL	NULL
373	val_373	NULL	NULL
272	val_272	NULL	NULL
138	val_138	NULL	NULL
217	val_217	NULL	NULL
84	val_84	84	val_84
84	val_84	84	val_84
348	val_348	NULL	NULL
466	val_466	NULL	NULL
58	val_58	58	val_58
58	val_58	58	val_58
8	val_8	8	val_8
411	val_411	NULL	NULL
230	val_230	NULL	NULL
208	val_208	NULL	NULL
348	val_348	NULL	NULL
24	val_24	24	val_24
24	val_24	24	val_24
463	val_463	NULL	NULL
431	val_431	NULL	NULL
179	val_179	NULL	NULL
172	val_172	NULL	NULL
42	val_42	42	val_42
42	val_42	42	val_42
129	val_129	NULL	NULL
158	val_158	NULL	NULL
119	val_119	NULL	NULL
496	val_496	NULL	NULL
0	val_0	0	val_0
0	val_0	0	val_0
0	val_0	0	val_0
322	val_322	NULL	NULL
197	val_197	NULL	NULL
468	val_468	NULL	NULL
393	val_393	NULL	NULL
454	val_454	NULL	NULL
100	val_100	100	val_100
100	val_100	100	val_100
298	val_298	NULL	NULL
199	val_199	NULL	NULL
191	val_191	NULL	NULL
418	val_418	NULL	NULL
96	val_96	96	val_96
26	val_26	26	val_26
26	val_26	26	val_26
165	val_165	NULL	NULL
327	val_327	NULL	NULL
230	val_230	NULL	NULL
205	val_205	NULL	NULL
120	val_120	NULL	NULL
131	val_131	NULL	NULL
51	val_51	51	val_51
51	val_51	51	val_51
404	val_404	NULL	NULL
43	val_43	43	val_43
436	val_436	NULL	NULL
156	val_156	NULL	NULL
469	val_469	NULL	NULL
468	val_468	NULL	NULL
308	val_308	NULL	NULL
95	val_95	95	val_95
95	val_95	95	val_95
196	val_196	NULL	NULL
288	val_288	NULL	NULL
481	val_481	NULL	NULL
457	val_457	NULL	NULL
98	val_98	98	val_98
98	val_98	98	val_98
282	val_282	NULL	NULL
197	val_197	NULL	NULL
187	val_187	NULL	NULL
318	val_318	NULL	NULL
318	val_318	NULL	NULL
409	val_409	NULL	NULL
470	val_470	NULL	NULL
137	val_137	NULL	NULL
369	val_369	NULL	NULL
316	val_316	NULL	NULL
169	val_169	NULL	NULL
413	val_413	NULL	NULL
85	val_85	85	val_85
77	val_77	77	val_77
0	val_0	0	val_0
0	val_0	0	val_0
0	val_0	0	val_0
490	val_490	NULL	NULL
87	val_87	87	val_87
364	val_364	NULL	NULL
179	val_179	NULL	NULL
118	val_118	NULL	NULL
134	val_134	NULL	NULL
395	val_395	NULL	NULL
282	val_282	NULL	NULL
138	val_138	NULL	NULL
238	val_238	NULL	NULL
419	val_419	NULL	NULL
15	val_15	15	val_15
15	val_15	15	val_15
118	val_118	NULL	NULL
72	val_72	72	val_72
72	val_72	72	val_72
90	val_90	90	val_90
90	val_90	90	val_90
90	val_90	90	val_90
307	val_307	NULL	NULL
19	val_19	19	val_19
435	val_435	NULL	NULL
10	val_10	10	val_10
277	val_277	NULL	NULL
273	val_273	NULL	NULL
306	val_306	NULL	NULL
224	val_224	NULL	NULL
309	val_309	NULL	NULL
389	val_389	NULL	NULL
327	val_327	NULL	NULL
242	val_242	NULL	NULL
369	val_369	NULL	NULL
392	val_392	NULL	NULL
272	val_272	NULL	NULL
331	val_331	NULL	NULL
401	val_401	NULL	NULL
242	val_242	NULL	NULL
452	val_452	NULL	NULL
177	val_177	NULL	NULL
226	val_226	NULL	NULL
5	val_5	5	val_5
5	val_5	5	val_5
5	val_5	5	val_5
497	val_497	NULL	NULL
402	val_402	NULL	NULL
396	val_396	NULL	NULL
317	val_317	NULL	NULL
395	val_395	NULL	NULL
58	val_58	58	val_58
58	val_58	58	val_58
35	val_35	35	val_35
35	val_35	35	val_35
35	val_35	35	val_35
336	val_336	NULL	NULL
95	val_95	95	val_95
95	val_95	95	val_95
11	val_11	11	val_11
168	val_168	NULL	NULL
34	val_34	34	val_34
229	val_229	NULL	NULL
233	val_233	NULL	NULL
143	val_143	NULL	NULL
472	val_472	NULL	NULL
322	val_322	NULL	NULL
498	val_498	NULL	NULL
160	val_160	NULL	NULL
195	val_195	NULL	NULL
42	val_42	42	val_42
42	val_42	42	val_42
321	val_321	NULL	NULL
430	val_430	NULL	NULL
119	val_119	NULL	NULL
489	val_489	NULL	NULL
458	val_458	NULL	NULL
78	val_78	78	val_78
76	val_76	76	val_76
76	val_76	76	val_76
41	val_41	41	val_41
223	val_223	NULL	NULL
492	val_492	NULL	NULL
149	val_149	NULL	NULL
449	val_449	NULL	NULL
218	val_218	NULL	NULL
228	val_228	NULL	NULL
138	val_138	NULL	NULL
453	val_453	NULL	NULL
30	val_30	30	val_30
209	val_209	NULL	NULL
64	val_64	64	val_64
468	val_468	NULL	NULL
76	val_76	76	val_76
76	val_76	76	val_76
74	val_74	74	val_74
342	val_342	NULL	NULL
69	val_69	69	val_69
230	val_230	NULL	NULL
33	val_33	33	val_33
368	val_368	NULL	NULL
103	val_103	NULL	NULL
296	val_296	NULL	NULL
113	val_113	NULL	NULL
216	val_216	NULL	NULL
367	val_367	NULL	NULL
344	val_344	NULL	NULL
167	val_167	NULL	NULL
274	val_274	NULL	NULL
219	val_219	NULL	NULL
239	val_239	NULL	NULL
485	val_485	NULL	NULL
116	val_116	NULL	NULL
223	val_223	NULL	NULL
256	val_256	NULL	NULL
263	val_263	NULL	NULL
70	val_70	70	val_70
70	val_70	70	val_70
70	val_70	70	val_70
487	val_487	NULL	NULL
480	val_480	NULL	NULL
401	val_401	NULL	NULL
288	val_288	NULL	NULL
191	val_191	NULL	NULL
5	val_5	5	val_5
5	val_5	5	val_5
5	val_5	5	val_5
244	val_244	NULL	NULL
438	val_438	NULL	NULL
128	val_128	NULL	NULL
467	val_467	NULL	NULL
432	val_432	NULL	NULL
202	val_202	NULL	NULL
316	val_316	NULL	NULL
229	val_229	NULL	NULL
469	val_469	NULL	NULL
463	val_463	NULL	NULL
280	val_280	NULL	NULL
2	val_2	2	val_2
35	val_35	35	val_35
35	val_35	35	val_35
35	val_35	35	val_35
283	val_283	NULL	NULL
331	val_331	NULL	NULL
235	val_235	NULL	NULL
80	val_80	80	val_80
44	val_44	44	val_44
193	val_193	NULL	NULL
321	val_321	NULL	NULL
335	val_335	NULL	NULL
104	val_104	NULL	NULL
466	val_466	NULL	NULL
366	val_366	NULL	NULL
175	val_175	NULL	NULL
403	val_403	NULL	NULL
483	val_483	NULL	NULL
53	val_53	53	val_53
105	val_105	NULL	NULL
257	val_257	NULL	NULL
406	val_406	NULL	NULL
409	val_409	NULL	NULL
190	val_190	NULL	NULL
406	val_406	NULL	NULL
401	val_401	NULL	NULL
114	val_114	NULL	NULL
258	val_258	NULL	NULL
90	val_90	90	val_90
90	val_90	90	val_90
90	val_90	90	val_90
203	val_203	NULL	NULL
262	val_262	NULL	NULL
348	val_348	NULL	NULL
424	val_424	NULL	NULL
12	val_12	12	val_12
12	val_12	12	val_12
396	val_396	NULL	NULL
201	val_201	NULL	NULL
217	val_217	NULL	NULL
164	val_164	NULL	NULL
431	val_431	NULL	NULL
454	val_454	NULL	NULL
478	val_478	NULL	NULL
298	val_298	NULL	NULL
125	val_125	NULL	NULL
431	val_431	NULL	NULL
164	val_164	NULL	NULL
424	val_424	NULL	NULL
187	val_187	NULL	NULL
382	val_382	NULL	NULL
5	val_5	5	val_5
5	val_5	5	val_5
5	val_5	5	val_5
70	val_70	70	val_70
70	val_70	70	val_70
70	val_70	70	val_70
397	val_397	NULL	NULL
480	val_480	NULL	NULL
291	val_291	NULL	NULL
24	val_24	24	val_24
24	val_24	24	val_24
351	val_351	NULL	NULL
255	val_255	NULL	NULL
104	val_104	NULL	NULL
70	val_70	70	val_70
70	val_70	70	val_70
70	val_70	70	val_70
163	val_163	NULL	NULL
438	val_438	NULL	NULL
119	val_119	NULL	NULL
414	val_414	NULL	NULL
200	val_200	NULL	NULL
491	val_491	NULL	NULL
237	val_237	NULL	NULL
439	val_439	NULL	NULL
360	val_360	NULL	NULL
248	val_248	NULL	NULL
479	val_479	NULL	NULL
305	val_305	NULL	NULL
417	val_417	NULL	NULL
199	val_199	NULL	NULL
444	val_444	NULL	NULL
120	val_120	NULL	NULL
429	val_429	NULL	NULL
169	val_169	NULL	NULL
443	val_443	NULL	NULL
323	val_323	NULL	NULL
325	val_325	NULL	NULL
277	val_277	NULL	NULL
230	val_230	NULL	NULL
478	val_478	NULL	NULL
178	val_178	NULL	NULL
468	val_468	NULL	NULL
310	val_310	NULL	NULL
317	val_317	NULL	NULL
333	val_333	NULL	NULL
493	val_493	NULL	NULL
460	val_460	NULL	NULL
207	val_207	NULL	NULL
249	val_249	NULL	NULL
265	val_265	NULL	NULL
480	val_480	NULL	NULL
83	val_83	83	val_83
83	val_83	83	val_83
136	val_136	NULL	NULL
353	val_353	NULL	NULL
172	val_172	NULL	NULL
214	val_214	NULL	NULL
462	val_462	NULL	NULL
233	val_233	NULL	NULL
406	val_406	NULL	NULL
133	val_133	NULL	NULL
175	val_175	NULL	NULL
189	val_189	NULL	NULL
454	val_454	NULL	NULL
375	val_375	NULL	NULL
401	val_401	NULL	NULL
421	val_421	NULL	NULL
407	val_407	NULL	NULL
384	val_384	NULL	NULL
256	val_256	NULL	NULL
26	val_26	26	val_26
26	val_26	26	val_26
134	val_134	NULL	NULL
67	val_67	67	val_67
67	val_67	67	val_67
384	val_384	NULL	NULL
379	val_379	NULL	NULL
18	val_18	18	val_18
18	val_18	18	val_18
462	val_462	NULL	NULL
492	val_492	NULL	NULL
100	val_100	100	val_100
100	val_100	100	val_100
298	val_298	NULL	NULL
9	val_9	9	val_9
341	val_341	NULL	NULL
498	val_498	NULL	NULL
146	val_146	NULL	NULL
458	val_458	NULL	NULL
362	val_362	NULL	NULL
186	val_186	NULL	NULL
285	val_285	NULL	NULL
348	val_348	NULL	NULL
167	val_167	NULL	NULL
18	val_18	18	val_18
18	val_18	18	val_18
273	val_273	NULL	NULL
183	val_183	NULL	NULL
281	val_281	NULL	NULL
344	val_344	NULL	NULL
97	val_97	97	val_97
97	val_97	97	val_97
469	val_469	NULL	NULL
315	val_315	NULL	NULL
84	val_84	84	val_84
84	val_84	84	val_84
28	val_28	28	val_28
37	val_37	37	val_37
37	val_37	37	val_37
448	val_448	NULL	NULL
152	val_152	NULL	NULL
348	val_348	NULL	NULL
307	val_307	NULL	NULL
194	val_194	NULL	NULL
414	val_414	NULL	NULL
477	val_477	NULL	NULL
222	val_222	NULL	NULL
126	val_126	NULL	NULL
90	val_90	90	val_90
90	val_90	90	val_90
90	val_90	90	val_90
169	val_169	NULL	NULL
403	val_403	NULL	NULL
400	val_400	NULL	NULL
200	val_200	NULL	NULL
97	val_97	97	val_97
97	val_97	97	val_97
PREHOOK: query: EXPLAIN
SELECT COUNT(1) FROM SRC A JOIN SRC B ON (A.KEY=B.KEY)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT COUNT(1) FROM SRC A JOIN SRC B ON (A.KEY=B.KEY)
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF SRC A) (TOK_TABREF SRC B) (= (. (TOK_TABLE_OR_COL A) KEY) (. (TOK_TABLE_OR_COL B) KEY)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION COUNT 1)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        b 
          TableScan
            alias: b
            Reduce Output Operator
              key expressions:
                    expr: key
                    type: string
              sort order: +
              Map-reduce partition columns:
                    expr: key
                    type: string
              tag: 1
        a 
          TableScan
            alias: a
            Reduce Output Operator
              key expressions:
                    expr: key
                    type: string
              sort order: +
              Map-reduce partition columns:
                    expr: key
                    type: string
              tag: 0
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          condition expressions:
            0 
            1 
          handleSkewJoin: false
          Select Operator
            Group By Operator
              aggregations:
                    expr: count(1)
              bucketGroup: false
              mode: hash
              outputColumnNames: _col0
              File Output Operator
                compressed: false
                GlobalTableId: 0
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat

  Stage: Stage-2
    Map Reduce
      Alias -> Map Operator Tree:
        file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/1375711979/10002 
            Reduce Output Operator
              sort order: 
              tag: -1
              value expressions:
                    expr: _col0
                    type: bigint
      Reduce Operator Tree:
        Group By Operator
          aggregations:
                expr: count(VALUE._col0)
          bucketGroup: false
          mode: mergepartial
          outputColumnNames: _col0
          Select Operator
            expressions:
                  expr: _col0
                  type: bigint
            outputColumnNames: _col0
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: SELECT COUNT(1) FROM SRC A JOIN SRC B ON (A.KEY=B.KEY)
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/991321663/10000
POSTHOOK: query: SELECT COUNT(1) FROM SRC A JOIN SRC B ON (A.KEY=B.KEY)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: file:/data/users/heyongqiang/hive-trunk/.ptest_0/build/ql/tmp/991321663/10000
1028
