PREHOOK: query: -- Test timestamp functions in vectorized mode to verify they run correctly end-to-end.

CREATE TABLE date_udf_flight (
  origin_city_name STRING,
  dest_city_name STRING,
  fl_date DATE,
  arr_delay FLOAT,
  fl_num INT
)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@date_udf_flight
POSTHOOK: query: -- Test timestamp functions in vectorized mode to verify they run correctly end-to-end.

CREATE TABLE date_udf_flight (
  origin_city_name STRING,
  dest_city_name STRING,
  fl_date DATE,
  arr_delay FLOAT,
  fl_num INT
)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@date_udf_flight
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/flights_tiny.txt.1' OVERWRITE INTO TABLE date_udf_flight
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@date_udf_flight
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/flights_tiny.txt.1' OVERWRITE INTO TABLE date_udf_flight
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@date_udf_flight
PREHOOK: query: CREATE TABLE date_udf_flight_orc (
  fl_date DATE,
  fl_time TIMESTAMP
) STORED AS ORC
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@date_udf_flight_orc
POSTHOOK: query: CREATE TABLE date_udf_flight_orc (
  fl_date DATE,
  fl_time TIMESTAMP
) STORED AS ORC
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@date_udf_flight_orc
PREHOOK: query: INSERT INTO TABLE date_udf_flight_orc SELECT fl_date, to_utc_timestamp(fl_date, 'America/Los_Angeles') FROM date_udf_flight
PREHOOK: type: QUERY
PREHOOK: Input: default@date_udf_flight
PREHOOK: Output: default@date_udf_flight_orc
POSTHOOK: query: INSERT INTO TABLE date_udf_flight_orc SELECT fl_date, to_utc_timestamp(fl_date, 'America/Los_Angeles') FROM date_udf_flight
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_udf_flight
POSTHOOK: Output: default@date_udf_flight_orc
POSTHOOK: Lineage: date_udf_flight_orc.fl_date SIMPLE [(date_udf_flight)date_udf_flight.FieldSchema(name:fl_date, type:date, comment:null), ]
POSTHOOK: Lineage: date_udf_flight_orc.fl_time EXPRESSION [(date_udf_flight)date_udf_flight.FieldSchema(name:fl_date, type:date, comment:null), ]
PREHOOK: query: SELECT * FROM date_udf_flight_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
POSTHOOK: query: SELECT * FROM date_udf_flight_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
2010-10-20	2010-10-20 07:00:00
2010-10-20	2010-10-20 07:00:00
2010-10-20	2010-10-20 07:00:00
2010-10-20	2010-10-20 07:00:00
2010-10-20	2010-10-20 07:00:00
2010-10-20	2010-10-20 07:00:00
2010-10-20	2010-10-20 07:00:00
2010-10-20	2010-10-20 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-31	2010-10-31 07:00:00
2010-10-31	2010-10-31 07:00:00
2010-10-31	2010-10-31 07:00:00
2010-10-31	2010-10-31 07:00:00
2010-10-31	2010-10-31 07:00:00
2010-10-31	2010-10-31 07:00:00
2010-10-31	2010-10-31 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-22	2010-10-22 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-20	2010-10-20 07:00:00
2010-10-20	2010-10-20 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-30	2010-10-30 07:00:00
2010-10-20	2010-10-20 07:00:00
2010-10-21	2010-10-21 07:00:00
2010-10-23	2010-10-23 07:00:00
2010-10-24	2010-10-24 07:00:00
2010-10-25	2010-10-25 07:00:00
2010-10-26	2010-10-26 07:00:00
2010-10-27	2010-10-27 07:00:00
2010-10-28	2010-10-28 07:00:00
2010-10-29	2010-10-29 07:00:00
2010-10-31	2010-10-31 07:00:00
PREHOOK: query: EXPLAIN SELECT
  to_unix_timestamp(fl_time),
  year(fl_time),
  month(fl_time),
  day(fl_time),
  dayofmonth(fl_time),
  weekofyear(fl_time),
  date(fl_time),
  to_date(fl_time),
  date_add(fl_time, 2),
  date_sub(fl_time, 2),
  datediff(fl_time, "2000-01-01")
FROM date_udf_flight_orc
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN SELECT
  to_unix_timestamp(fl_time),
  year(fl_time),
  month(fl_time),
  day(fl_time),
  dayofmonth(fl_time),
  weekofyear(fl_time),
  date(fl_time),
  to_date(fl_time),
  date_add(fl_time, 2),
  date_sub(fl_time, 2),
  datediff(fl_time, "2000-01-01")
FROM date_udf_flight_orc
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_udf_flight_orc
            Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: to_unix_timestamp(fl_time) (type: bigint), year(fl_time) (type: int), month(fl_time) (type: int), day(fl_time) (type: int), dayofmonth(fl_time) (type: int), weekofyear(fl_time) (type: int), CAST( fl_time AS DATE) (type: date), to_date(fl_time) (type: string), date_add(fl_time, 2) (type: string), date_sub(fl_time, 2) (type: string), datediff(fl_time, '2000-01-01') (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
              Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Execution mode: vectorized

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: SELECT
  to_unix_timestamp(fl_time),
  year(fl_time),
  month(fl_time),
  day(fl_time),
  dayofmonth(fl_time),
  weekofyear(fl_time),
  date(fl_time),
  to_date(fl_time),
  date_add(fl_time, 2),
  date_sub(fl_time, 2),
  datediff(fl_time, "2000-01-01")
FROM date_udf_flight_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
POSTHOOK: query: SELECT
  to_unix_timestamp(fl_time),
  year(fl_time),
  month(fl_time),
  day(fl_time),
  dayofmonth(fl_time),
  weekofyear(fl_time),
  date(fl_time),
  to_date(fl_time),
  date_add(fl_time, 2),
  date_sub(fl_time, 2),
  datediff(fl_time, "2000-01-01")
FROM date_udf_flight_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288533600	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288533600	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288533600	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288533600	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288533600	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288533600	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288533600	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287756000	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288447200	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1287583200	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287669600	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287842400	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287928800	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1288015200	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288101600	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288188000	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288274400	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288360800	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288533600	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
PREHOOK: query: EXPLAIN SELECT
  to_unix_timestamp(fl_date),
  year(fl_date),
  month(fl_date),
  day(fl_date),
  dayofmonth(fl_date),
  weekofyear(fl_date),
  date(fl_date),
  to_date(fl_date),
  date_add(fl_date, 2),
  date_sub(fl_date, 2),
  datediff(fl_date, "2000-01-01")
FROM date_udf_flight_orc
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN SELECT
  to_unix_timestamp(fl_date),
  year(fl_date),
  month(fl_date),
  day(fl_date),
  dayofmonth(fl_date),
  weekofyear(fl_date),
  date(fl_date),
  to_date(fl_date),
  date_add(fl_date, 2),
  date_sub(fl_date, 2),
  datediff(fl_date, "2000-01-01")
FROM date_udf_flight_orc
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_udf_flight_orc
            Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: to_unix_timestamp(fl_date) (type: bigint), year(fl_date) (type: int), month(fl_date) (type: int), day(fl_date) (type: int), dayofmonth(fl_date) (type: int), weekofyear(fl_date) (type: int), fl_date (type: date), to_date(fl_date) (type: string), date_add(fl_date, 2) (type: string), date_sub(fl_date, 2) (type: string), datediff(fl_date, '2000-01-01') (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
              Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Execution mode: vectorized

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: SELECT
  to_unix_timestamp(fl_date),
  year(fl_date),
  month(fl_date),
  day(fl_date),
  dayofmonth(fl_date),
  weekofyear(fl_date),
  date(fl_date),
  to_date(fl_date),
  date_add(fl_date, 2),
  date_sub(fl_date, 2),
  datediff(fl_date, "2000-01-01")
FROM date_udf_flight_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
POSTHOOK: query: SELECT
  to_unix_timestamp(fl_date),
  year(fl_date),
  month(fl_date),
  day(fl_date),
  dayofmonth(fl_date),
  weekofyear(fl_date),
  date(fl_date),
  to_date(fl_date),
  date_add(fl_date, 2),
  date_sub(fl_date, 2),
  datediff(fl_date, "2000-01-01")
FROM date_udf_flight_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288508400	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288508400	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288508400	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288508400	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288508400	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288508400	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288508400	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287730800	2010	10	22	22	42	2010-10-22	2010-10-22	2010-10-24	2010-10-20	3947
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1288422000	2010	10	30	30	43	2010-10-30	2010-10-30	2010-11-01	2010-10-28	3955
1287558000	2010	10	20	20	42	2010-10-20	2010-10-20	2010-10-22	2010-10-18	3945
1287644400	2010	10	21	21	42	2010-10-21	2010-10-21	2010-10-23	2010-10-19	3946
1287817200	2010	10	23	23	42	2010-10-23	2010-10-23	2010-10-25	2010-10-21	3948
1287903600	2010	10	24	24	42	2010-10-24	2010-10-24	2010-10-26	2010-10-22	3949
1287990000	2010	10	25	25	43	2010-10-25	2010-10-25	2010-10-27	2010-10-23	3950
1288076400	2010	10	26	26	43	2010-10-26	2010-10-26	2010-10-28	2010-10-24	3951
1288162800	2010	10	27	27	43	2010-10-27	2010-10-27	2010-10-29	2010-10-25	3952
1288249200	2010	10	28	28	43	2010-10-28	2010-10-28	2010-10-30	2010-10-26	3953
1288335600	2010	10	29	29	43	2010-10-29	2010-10-29	2010-10-31	2010-10-27	3954
1288508400	2010	10	31	31	43	2010-10-31	2010-10-31	2010-11-02	2010-10-29	3956
PREHOOK: query: EXPLAIN SELECT
  year(fl_time) = year(fl_date),
  month(fl_time) = month(fl_date),
  day(fl_time) = day(fl_date),
  dayofmonth(fl_time) = dayofmonth(fl_date),
  weekofyear(fl_time) = weekofyear(fl_date),
  date(fl_time) = date(fl_date),
  to_date(fl_time) = to_date(fl_date),
  date_add(fl_time, 2) = date_add(fl_date, 2),
  date_sub(fl_time, 2) = date_sub(fl_date, 2),
  datediff(fl_time, "2000-01-01") = datediff(fl_date, "2000-01-01")
FROM date_udf_flight_orc
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN SELECT
  year(fl_time) = year(fl_date),
  month(fl_time) = month(fl_date),
  day(fl_time) = day(fl_date),
  dayofmonth(fl_time) = dayofmonth(fl_date),
  weekofyear(fl_time) = weekofyear(fl_date),
  date(fl_time) = date(fl_date),
  to_date(fl_time) = to_date(fl_date),
  date_add(fl_time, 2) = date_add(fl_date, 2),
  date_sub(fl_time, 2) = date_sub(fl_date, 2),
  datediff(fl_time, "2000-01-01") = datediff(fl_date, "2000-01-01")
FROM date_udf_flight_orc
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_udf_flight_orc
            Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: (year(fl_time) = year(fl_date)) (type: boolean), (month(fl_time) = month(fl_date)) (type: boolean), (day(fl_time) = day(fl_date)) (type: boolean), (dayofmonth(fl_time) = dayofmonth(fl_date)) (type: boolean), (weekofyear(fl_time) = weekofyear(fl_date)) (type: boolean), (CAST( fl_time AS DATE) = fl_date) (type: boolean), (to_date(fl_time) = to_date(fl_date)) (type: boolean), (date_add(fl_time, 2) = date_add(fl_date, 2)) (type: boolean), (date_sub(fl_time, 2) = date_sub(fl_date, 2)) (type: boolean), (datediff(fl_time, '2000-01-01') = datediff(fl_date, '2000-01-01')) (type: boolean)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
              Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Execution mode: vectorized

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: -- Should all be true or NULL
SELECT
  year(fl_time) = year(fl_date),
  month(fl_time) = month(fl_date),
  day(fl_time) = day(fl_date),
  dayofmonth(fl_time) = dayofmonth(fl_date),
  weekofyear(fl_time) = weekofyear(fl_date),
  date(fl_time) = date(fl_date),
  to_date(fl_time) = to_date(fl_date),
  date_add(fl_time, 2) = date_add(fl_date, 2),
  date_sub(fl_time, 2) = date_sub(fl_date, 2),
  datediff(fl_time, "2000-01-01") = datediff(fl_date, "2000-01-01")
FROM date_udf_flight_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
POSTHOOK: query: -- Should all be true or NULL
SELECT
  year(fl_time) = year(fl_date),
  month(fl_time) = month(fl_date),
  day(fl_time) = day(fl_date),
  dayofmonth(fl_time) = dayofmonth(fl_date),
  weekofyear(fl_time) = weekofyear(fl_date),
  date(fl_time) = date(fl_date),
  to_date(fl_time) = to_date(fl_date),
  date_add(fl_time, 2) = date_add(fl_date, 2),
  date_sub(fl_time, 2) = date_sub(fl_date, 2),
  datediff(fl_time, "2000-01-01") = datediff(fl_date, "2000-01-01")
FROM date_udf_flight_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
true	true	true	true	true	true	true	true	true	true
PREHOOK: query: EXPLAIN SELECT 
  fl_date, 
  to_date(date_add(fl_date, 2)), 
  to_date(date_sub(fl_date, 2)),
  datediff(fl_date, date_add(fl_date, 2)), 
  datediff(fl_date, date_sub(fl_date, 2)),
  datediff(date_add(fl_date, 2), date_sub(fl_date, 2)) 
FROM date_udf_flight_orc LIMIT 10
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN SELECT 
  fl_date, 
  to_date(date_add(fl_date, 2)), 
  to_date(date_sub(fl_date, 2)),
  datediff(fl_date, date_add(fl_date, 2)), 
  datediff(fl_date, date_sub(fl_date, 2)),
  datediff(date_add(fl_date, 2), date_sub(fl_date, 2)) 
FROM date_udf_flight_orc LIMIT 10
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_udf_flight_orc
            Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: fl_date (type: date), to_date(date_add(fl_date, 2)) (type: string), to_date(date_sub(fl_date, 2)) (type: string), datediff(fl_date, date_add(fl_date, 2)) (type: int), datediff(fl_date, date_sub(fl_date, 2)) (type: int), datediff(date_add(fl_date, 2), date_sub(fl_date, 2)) (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
              Limit
                Number of rows: 10
                Statistics: Num rows: 10 Data size: 960 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 10 Data size: 960 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Execution mode: vectorized

  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        ListSink

PREHOOK: query: SELECT 
  fl_date, 
  to_date(date_add(fl_date, 2)), 
  to_date(date_sub(fl_date, 2)),
  datediff(fl_date, date_add(fl_date, 2)), 
  datediff(fl_date, date_sub(fl_date, 2)),
  datediff(date_add(fl_date, 2), date_sub(fl_date, 2)) 
FROM date_udf_flight_orc LIMIT 10
PREHOOK: type: QUERY
PREHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
POSTHOOK: query: SELECT 
  fl_date, 
  to_date(date_add(fl_date, 2)), 
  to_date(date_sub(fl_date, 2)),
  datediff(fl_date, date_add(fl_date, 2)), 
  datediff(fl_date, date_sub(fl_date, 2)),
  datediff(date_add(fl_date, 2), date_sub(fl_date, 2)) 
FROM date_udf_flight_orc LIMIT 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
2010-10-20	2010-10-22	2010-10-18	-2	2	4
2010-10-20	2010-10-22	2010-10-18	-2	2	4
2010-10-20	2010-10-22	2010-10-18	-2	2	4
2010-10-20	2010-10-22	2010-10-18	-2	2	4
2010-10-20	2010-10-22	2010-10-18	-2	2	4
2010-10-20	2010-10-22	2010-10-18	-2	2	4
2010-10-20	2010-10-22	2010-10-18	-2	2	4
2010-10-20	2010-10-22	2010-10-18	-2	2	4
2010-10-21	2010-10-23	2010-10-19	-2	2	4
2010-10-21	2010-10-23	2010-10-19	-2	2	4
PREHOOK: query: -- Test extracting the date part of expression that includes time
SELECT to_date('2009-07-30 04:17:52') FROM date_udf_flight_orc LIMIT 1
PREHOOK: type: QUERY
PREHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
POSTHOOK: query: -- Test extracting the date part of expression that includes time
SELECT to_date('2009-07-30 04:17:52') FROM date_udf_flight_orc LIMIT 1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
2009-07-30
PREHOOK: query: EXPLAIN SELECT
  min(fl_date) AS c1,
  max(fl_date),
  count(fl_date),
  count(*)
FROM date_udf_flight_orc
ORDER BY c1
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN SELECT
  min(fl_date) AS c1,
  max(fl_date),
  count(fl_date),
  count(*)
FROM date_udf_flight_orc
ORDER BY c1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_udf_flight_orc
            Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: fl_date (type: date)
              outputColumnNames: fl_date
              Statistics: Num rows: 137 Data size: 13152 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: min(fl_date), max(fl_date), count(fl_date), count()
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  sort order: 
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: date), _col1 (type: date), _col2 (type: bigint), _col3 (type: bigint)
      Execution mode: vectorized
      Reduce Operator Tree:
        Group By Operator
          aggregations: min(VALUE._col0), max(VALUE._col1), count(VALUE._col2), count(VALUE._col3)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: date)
              sort order: +
              Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: date), _col2 (type: bigint), _col3 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: date), VALUE._col0 (type: date), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: SELECT
  min(fl_date) AS c1,
  max(fl_date),
  count(fl_date),
  count(*)
FROM date_udf_flight_orc
ORDER BY c1
PREHOOK: type: QUERY
PREHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
POSTHOOK: query: SELECT
  min(fl_date) AS c1,
  max(fl_date),
  count(fl_date),
  count(*)
FROM date_udf_flight_orc
ORDER BY c1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@date_udf_flight_orc
#### A masked pattern was here ####
2010-10-20	2010-10-31	137	137
