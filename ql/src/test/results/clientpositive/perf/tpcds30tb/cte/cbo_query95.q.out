CBO PLAN:
HiveProject(order count=[$0], total shipping cost=[$1], total net profit=[$2])
  HiveAggregate(group=[{}], agg#0=[count(DISTINCT $3)], agg#1=[sum($4)], agg#2=[sum($5)])
    HiveSemiJoin(condition=[=($3, $12)], joinType=[semi])
      HiveSemiJoin(condition=[=($3, $12)], joinType=[semi])
        HiveProject(ws_ship_date_sk=[$2], ws_ship_addr_sk=[$3], ws_web_site_sk=[$4], ws_order_number=[$5], ws_ext_ship_cost=[$6], ws_net_profit=[$7], d_date_sk=[$8], d_date=[$9], ca_address_sk=[$0], ca_state=[$1], web_site_sk=[$10], web_company_name=[$11])
          HiveJoin(condition=[=($4, $10)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveJoin(condition=[=($3, $0)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(ca_address_sk=[$0], ca_state=[CAST(_UTF-16LE'TX'):CHAR(2) CHARACTER SET "UTF-16LE"])
                HiveFilter(condition=[=($8, _UTF-16LE'TX')])
                  HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])
              HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(ws_ship_date_sk=[$1], ws_ship_addr_sk=[$10], ws_web_site_sk=[$12], ws_order_number=[$16], ws_ext_ship_cost=[$27], ws_net_profit=[$32])
                  HiveFilter(condition=[AND(IS NOT NULL($10), IS NOT NULL($12), IS NOT NULL($1))])
                    HiveTableScan(table=[[default, web_sales]], table:alias=[ws1])
                HiveProject(d_date_sk=[$0], d_date=[$2])
                  HiveFilter(condition=[BETWEEN(false, CAST($2):TIMESTAMP(9), 1999-05-01 00:00:00:TIMESTAMP(9), 1999-06-30 00:00:00:TIMESTAMP(9))])
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
            HiveProject(web_site_sk=[$0], web_company_name=[CAST(_UTF-16LE'pri                                               '):CHAR(50) CHARACTER SET "UTF-16LE"])
              HiveFilter(condition=[=($14, _UTF-16LE'pri                                               ')])
                HiveTableScan(table=[[default, web_site]], table:alias=[web_site])
        HiveProject(ws_order_number=[$1])
          HiveJoin(condition=[AND(=($1, $3), <>($0, $2))], joinType=[inner], algorithm=[none], cost=[not available])
            HiveProject(ws_warehouse_sk=[$14], ws_order_number=[$16])
              HiveTableScan(table=[[default, web_sales]], table:alias=[ws1])
            HiveProject(ws_warehouse_sk=[$14], ws_order_number=[$16])
              HiveTableScan(table=[[default, web_sales]], table:alias=[ws2])
      HiveProject(wr_order_number=[$2])
        HiveJoin(condition=[AND(=($1, $4), <>($0, $3))], joinType=[inner], algorithm=[none], cost=[not available])
          HiveJoin(condition=[=($2, $1)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveProject(ws_warehouse_sk=[$14], ws_order_number=[$16])
              HiveTableScan(table=[[default, web_sales]], table:alias=[ws1])
            HiveProject(wr_order_number=[$12])
              HiveTableScan(table=[[default, web_returns]], table:alias=[web_returns])
          HiveProject(ws_warehouse_sk=[$14], ws_order_number=[$16])
            HiveTableScan(table=[[default, web_sales]], table:alias=[ws2])

