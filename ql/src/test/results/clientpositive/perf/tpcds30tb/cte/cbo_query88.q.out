CTE Suggestion:
HiveProject(hd_demo_sk=[$0])
  HiveFilter(condition=[AND(IN($3, 0, 1, 3), <=($4, 5), OR(AND(=($3, 3), IS NOT NULL($4)), AND(=($3, 0), <=($4, 2)), AND(=($3, 1), <=($4, 3))))])
    HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])

CTE Suggestion:
HiveProject(s_store_sk=[$0])
  HiveFilter(condition=[=($5, _UTF-16LE'ese')])
    HiveTableScan(table=[[default, store]], table:alias=[store])

CTE Suggestion:
HiveProject(ss_sold_time_sk=[$0], ss_hdemo_sk=[$4], ss_store_sk=[$6])
  HiveFilter(condition=[AND(IS NOT NULL($4), IS NOT NULL($0), IS NOT NULL($6))])
    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])

Warning: Map Join MAPJOIN[589][bigTable=?] in task 'Reducer 25' is a cross product
Warning: Map Join MAPJOIN[588][bigTable=?] in task 'Reducer 25' is a cross product
Warning: Map Join MAPJOIN[587][bigTable=?] in task 'Reducer 25' is a cross product
Warning: Map Join MAPJOIN[586][bigTable=?] in task 'Reducer 25' is a cross product
Warning: Map Join MAPJOIN[585][bigTable=?] in task 'Reducer 25' is a cross product
Warning: Map Join MAPJOIN[584][bigTable=?] in task 'Reducer 25' is a cross product
Warning: Map Join MAPJOIN[583][bigTable=?] in task 'Reducer 25' is a cross product
CBO PLAN:
HiveProject(s1.h8_30_to_9=[$0], s2.h9_to_9_30=[$7], s3.h9_30_to_10=[$6], s4.h10_to_10_30=[$5], s5.h10_30_to_11=[$4], s6.h11_to_11_30=[$3], s7.h11_30_to_12=[$2], s8.h12_to_12_30=[$1])
  HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
    HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
      HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
        HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
          HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
            HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject($f0=[$0])
                  HiveAggregate(group=[{}], agg#0=[count()])
                    HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveJoin(condition=[=($1, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                        HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                          HiveTableSpool(table=[[cte, cte_suggestion_2]])
                            HiveProject(ss_sold_time_sk=[$0], ss_hdemo_sk=[$4], ss_store_sk=[$6])
                              HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($4), IS NOT NULL($0))])
                                HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                          HiveProject(t_time_sk=[$0])
                            HiveFilter(condition=[AND(=($3, 8), >=($4, 30))])
                              HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])
                        HiveProject(hd_demo_sk=[$0])
                          HiveFilter(condition=[AND(<=($4, 5), OR(=($3, 0), =($3, 1), =($3, 3)), OR(AND(=($3, 3), IS NOT NULL($4)), AND(=($3, 0), <=($4, 2)), AND(=($3, 1), <=($4, 3))))])
                            HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])
                      HiveTableSpool(table=[[cte, cte_suggestion_1]])
                        HiveProject(s_store_sk=[$0])
                          HiveFilter(condition=[=($5, _UTF-16LE'ese')])
                            HiveTableScan(table=[[default, store]], table:alias=[store])
                HiveProject($f0=[$0])
                  HiveAggregate(group=[{}], agg#0=[count()])
                    HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveJoin(condition=[=($1, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                        HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                          HiveTableScan(table=[[cte, cte_suggestion_2]], table:alias=[cte_suggestion_2])
                          HiveProject(t_time_sk=[$0])
                            HiveFilter(condition=[AND(=($3, 12), <($4, 30))])
                              HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])
                        HiveProject(hd_demo_sk=[$0])
                          HiveFilter(condition=[AND(<=($4, 5), OR(=($3, 0), =($3, 1), =($3, 3)), OR(AND(=($3, 3), IS NOT NULL($4)), AND(=($3, 0), <=($4, 2)), AND(=($3, 1), <=($4, 3))))])
                            HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])
                      HiveTableScan(table=[[cte, cte_suggestion_1]], table:alias=[cte_suggestion_1])
              HiveProject($f0=[$0])
                HiveAggregate(group=[{}], agg#0=[count()])
                  HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveJoin(condition=[=($1, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                        HiveTableScan(table=[[cte, cte_suggestion_2]], table:alias=[cte_suggestion_2])
                        HiveProject(t_time_sk=[$0])
                          HiveFilter(condition=[AND(=($3, 11), >=($4, 30))])
                            HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])
                      HiveProject(hd_demo_sk=[$0])
                        HiveFilter(condition=[AND(<=($4, 5), OR(=($3, 0), =($3, 1), =($3, 3)), OR(AND(=($3, 3), IS NOT NULL($4)), AND(=($3, 0), <=($4, 2)), AND(=($3, 1), <=($4, 3))))])
                          HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])
                    HiveTableScan(table=[[cte, cte_suggestion_1]], table:alias=[cte_suggestion_1])
            HiveProject($f0=[$0])
              HiveAggregate(group=[{}], agg#0=[count()])
                HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveJoin(condition=[=($1, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveTableScan(table=[[cte, cte_suggestion_2]], table:alias=[cte_suggestion_2])
                      HiveProject(t_time_sk=[$0])
                        HiveFilter(condition=[AND(=($3, 11), <($4, 30))])
                          HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])
                    HiveProject(hd_demo_sk=[$0])
                      HiveFilter(condition=[AND(<=($4, 5), OR(=($3, 0), =($3, 1), =($3, 3)), OR(AND(=($3, 3), IS NOT NULL($4)), AND(=($3, 0), <=($4, 2)), AND(=($3, 1), <=($4, 3))))])
                        HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])
                  HiveTableScan(table=[[cte, cte_suggestion_1]], table:alias=[cte_suggestion_1])
          HiveProject($f0=[$0])
            HiveAggregate(group=[{}], agg#0=[count()])
              HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($1, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveTableScan(table=[[cte, cte_suggestion_2]], table:alias=[cte_suggestion_2])
                    HiveProject(t_time_sk=[$0])
                      HiveFilter(condition=[AND(=($3, 10), >=($4, 30))])
                        HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])
                  HiveProject(hd_demo_sk=[$0])
                    HiveFilter(condition=[AND(<=($4, 5), OR(=($3, 0), =($3, 1), =($3, 3)), OR(AND(=($3, 3), IS NOT NULL($4)), AND(=($3, 0), <=($4, 2)), AND(=($3, 1), <=($4, 3))))])
                      HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])
                HiveTableScan(table=[[cte, cte_suggestion_1]], table:alias=[cte_suggestion_1])
        HiveProject($f0=[$0])
          HiveAggregate(group=[{}], agg#0=[count()])
            HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[=($1, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveTableScan(table=[[cte, cte_suggestion_2]], table:alias=[cte_suggestion_2])
                  HiveProject(t_time_sk=[$0])
                    HiveFilter(condition=[AND(=($3, 10), <($4, 30))])
                      HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])
                HiveProject(hd_demo_sk=[$0])
                  HiveFilter(condition=[AND(<=($4, 5), OR(=($3, 0), =($3, 1), =($3, 3)), OR(AND(=($3, 3), IS NOT NULL($4)), AND(=($3, 0), <=($4, 2)), AND(=($3, 1), <=($4, 3))))])
                    HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])
              HiveTableScan(table=[[cte, cte_suggestion_1]], table:alias=[cte_suggestion_1])
      HiveProject($f0=[$0])
        HiveAggregate(group=[{}], agg#0=[count()])
          HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveJoin(condition=[=($1, $4)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveTableScan(table=[[cte, cte_suggestion_2]], table:alias=[cte_suggestion_2])
                HiveProject(t_time_sk=[$0])
                  HiveFilter(condition=[AND(=($3, 9), >=($4, 30))])
                    HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])
              HiveProject(hd_demo_sk=[$0])
                HiveFilter(condition=[AND(<=($4, 5), OR(=($3, 0), =($3, 1), =($3, 3)), OR(AND(=($3, 3), IS NOT NULL($4)), AND(=($3, 0), <=($4, 2)), AND(=($3, 1), <=($4, 3))))])
                  HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])
            HiveTableScan(table=[[cte, cte_suggestion_1]], table:alias=[cte_suggestion_1])
    HiveProject($f0=[$0])
      HiveAggregate(group=[{}], agg#0=[count()])
        HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[not available])
          HiveJoin(condition=[=($1, $4)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveTableScan(table=[[cte, cte_suggestion_2]], table:alias=[cte_suggestion_2])
              HiveProject(t_time_sk=[$0])
                HiveFilter(condition=[AND(=($3, 9), <($4, 30))])
                  HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])
            HiveProject(hd_demo_sk=[$0])
              HiveFilter(condition=[AND(<=($4, 5), OR(=($3, 0), =($3, 1), =($3, 3)), OR(AND(=($3, 3), IS NOT NULL($4)), AND(=($3, 0), <=($4, 2)), AND(=($3, 1), <=($4, 3))))])
                HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])
          HiveTableScan(table=[[cte, cte_suggestion_1]], table:alias=[cte_suggestion_1])

