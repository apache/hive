CTE Suggestion:
HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
  HiveProject(ws_sold_time_sk=[$0], ws_ship_hdemo_sk=[$9], ws_web_page_sk=[$11])
    HiveFilter(condition=[AND(IS NOT NULL($9), IS NOT NULL($0), IS NOT NULL($11))])
      HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
  HiveProject(wp_web_page_sk=[$0])
    HiveFilter(condition=[BETWEEN(false, $10, 5000, 5200)])
      HiveTableScan(table=[[default, web_page]], table:alias=[web_page])

CTE Suggestion:
HiveProject(hd_demo_sk=[$0])
  HiveFilter(condition=[=($3, 8)])
    HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])

Warning: Map Join MAPJOIN[153][bigTable=?] in task 'Reducer 7' is a cross product
CBO PLAN:
HiveProject(am_pm_ratio=[/(CAST($0):DECIMAL(15, 4), CAST($1):DECIMAL(15, 4))])
  HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject($f0=[$0])
      HiveAggregate(group=[{}], agg#0=[count()])
        HiveJoin(condition=[=($1, $5)], joinType=[inner], algorithm=[none], cost=[not available])
          HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(ws_sold_time_sk=[$0], ws_ship_hdemo_sk=[$9], ws_web_page_sk=[$11])
                HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($11), IS NOT NULL($9))])
                  HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
              HiveProject(wp_web_page_sk=[$0])
                HiveFilter(condition=[AND(<=(5000, $10), <=($10, 5200))])
                  HiveTableScan(table=[[default, web_page]], table:alias=[web_page])
            HiveProject(t_time_sk=[$0])
              HiveFilter(condition=[AND(<=(6, $3), <=($3, 7))])
                HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])
          HiveTableSpool(table=[[cte, cte_suggestion_1]])
            HiveProject(hd_demo_sk=[$0])
              HiveFilter(condition=[=($3, 8)])
                HiveTableScan(table=[[default, household_demographics]], table:alias=[household_demographics])
    HiveProject($f0=[$0])
      HiveAggregate(group=[{}], agg#0=[count()])
        HiveJoin(condition=[=($1, $5)], joinType=[inner], algorithm=[none], cost=[not available])
          HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(ws_sold_time_sk=[$0], ws_ship_hdemo_sk=[$9], ws_web_page_sk=[$11])
                HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($11), IS NOT NULL($9))])
                  HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
              HiveProject(wp_web_page_sk=[$0])
                HiveFilter(condition=[AND(<=(5000, $10), <=($10, 5200))])
                  HiveTableScan(table=[[default, web_page]], table:alias=[web_page])
            HiveProject(t_time_sk=[$0])
              HiveFilter(condition=[AND(<=(14, $3), <=($3, 15))])
                HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])
          HiveTableScan(table=[[cte, cte_suggestion_1]], table:alias=[cte_suggestion_1])

