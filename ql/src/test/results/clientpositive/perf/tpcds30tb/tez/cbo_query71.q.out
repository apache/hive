CBO PLAN:
HiveProject(brand_id=[$0], brand=[$1], t_hour=[$2], t_minute=[$3], ext_price=[$4])
  HiveSortLimit(sort0=[$4], sort1=[$5], dir0=[DESC], dir1=[ASC])
    HiveProject(brand_id=[$0], brand=[$1], t_hour=[$2], t_minute=[$3], ext_price=[$4], (tok_table_or_col i_brand_id)=[$0])
      HiveAggregate(group=[{4, 5, 7, 8}], agg#0=[sum($0)])
        HiveJoin(condition=[=($2, $6)], joinType=[inner], algorithm=[none], cost=[not available])
          HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveProject(ext_price=[$0], sold_item_sk=[$1], time_sk=[$2])
              HiveUnion(all=[true])
                HiveProject(ext_price=[$2], sold_item_sk=[$1], time_sk=[$0])
                  HiveJoin(condition=[=($4, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(ws_sold_time_sk=[$0], ws_item_sk=[$2], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33])
                      HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($33))])
                        HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                    HiveProject(d_date_sk=[$0])
                      HiveFilter(condition=[AND(=($6, 2001), =($8, 12))])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                HiveProject(ext_price=[$2], sold_item_sk=[$1], time_sk=[$0])
                  HiveJoin(condition=[=($4, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(cs_sold_time_sk=[$0], cs_item_sk=[$14], cs_ext_sales_price=[$22], cs_sold_date_sk=[$33])
                      HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($33))])
                        HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                    HiveProject(d_date_sk=[$0])
                      HiveFilter(condition=[AND(=($6, 2001), =($8, 12))])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                HiveProject(ext_price=[$2], sold_item_sk=[$1], time_sk=[$0])
                  HiveJoin(condition=[=($4, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(ss_sold_time_sk=[$0], ss_item_sk=[$1], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
                      HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($22))])
                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                    HiveProject(d_date_sk=[$0])
                      HiveFilter(condition=[AND(=($6, 2001), =($8, 12))])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
            HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_brand=[$8])
              HiveFilter(condition=[=($20, 1)])
                HiveTableScan(table=[[default, item]], table:alias=[item])
          HiveProject(t_time_sk=[$0], t_hour=[$3], t_minute=[$4])
            HiveFilter(condition=[IN($9, _UTF-16LE'breakfast           ', _UTF-16LE'dinner              ')])
              HiveTableScan(table=[[default, time_dim]], table:alias=[time_dim])

