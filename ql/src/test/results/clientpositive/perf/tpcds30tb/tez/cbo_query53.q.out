CBO PLAN:
HiveSortLimit(sort0=[$2], sort1=[$1], sort2=[$0], dir0=[ASC], dir1=[ASC], dir2=[ASC], fetch=[100])
  HiveProject((tok_table_or_col i_manufact_id)=[$0], (tok_function sum (tok_table_or_col ss_sales_price))=[$1], avg_window_0=[$2])
    HiveFilter(condition=[CASE(>($2, 0:DECIMAL(1, 0)), >(/(ABS(-($1, $2)), $2), 0.1:DECIMAL(1, 1)), false)])
      HiveProject((tok_table_or_col i_manufact_id)=[$0], (tok_function sum (tok_table_or_col ss_sales_price))=[$2], avg_window_0=[avg($2) OVER (PARTITION BY $0 ORDER BY $0 NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
        HiveProject(i_manufact_id=[$0], d_qoy=[$1], $f2=[$2])
          HiveAggregate(group=[{4, 6}], agg#0=[sum($1)])
            HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(ss_item_sk=[$1], ss_sales_price=[$12], ss_sold_date_sk=[$22])
                  HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($22))])
                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                HiveProject(i_item_sk=[$0], i_manufact_id=[$13])
                  HiveFilter(condition=[AND(IN($8, _UTF-16LE'scholaramalgamalg #14                             ', _UTF-16LE'scholaramalgamalg #7                              ', _UTF-16LE'exportiunivamalg #9                               ', _UTF-16LE'scholaramalgamalg #9                              ', _UTF-16LE'amalgimporto #1                                   ', _UTF-16LE'edu packscholar #1                                ', _UTF-16LE'exportiimporto #1                                 ', _UTF-16LE'importoamalg #1                                   '), IN($10, _UTF-16LE'personal                                          ', _UTF-16LE'portable                                          ', _UTF-16LE'reference                                         ', _UTF-16LE'self-help                                         ', _UTF-16LE'accessories                                       ', _UTF-16LE'classical                                         ', _UTF-16LE'fragrances                                        ', _UTF-16LE'pants                                             '), IN($12, _UTF-16LE'Books                                             ', _UTF-16LE'Children                                          ', _UTF-16LE'Electronics                                       ', _UTF-16LE'Women                                             ', _UTF-16LE'Music                                             ', _UTF-16LE'Men                                               '), OR(AND(IN($12, _UTF-16LE'Books                                             ', _UTF-16LE'Children                                          ', _UTF-16LE'Electronics                                       '), IN($10, _UTF-16LE'personal                                          ', _UTF-16LE'portable                                          ', _UTF-16LE'reference                                         ', _UTF-16LE'self-help                                         '), IN($8, _UTF-16LE'scholaramalgamalg #14                             ', _UTF-16LE'scholaramalgamalg #7                              ', _UTF-16LE'exportiunivamalg #9                               ', _UTF-16LE'scholaramalgamalg #9                              ')), AND(IN($12, _UTF-16LE'Women                                             ', _UTF-16LE'Music                                             ', _UTF-16LE'Men                                               '), IN($10, _UTF-16LE'accessories                                       ', _UTF-16LE'classical                                         ', _UTF-16LE'fragrances                                        ', _UTF-16LE'pants                                             '), IN($8, _UTF-16LE'amalgimporto #1                                   ', _UTF-16LE'edu packscholar #1                                ', _UTF-16LE'exportiimporto #1                                 ', _UTF-16LE'importoamalg #1                                   '))))])
                    HiveTableScan(table=[[default, item]], table:alias=[item])
              HiveProject(d_date_sk=[$0], d_qoy=[$10])
                HiveFilter(condition=[IN($3, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223)])
                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

