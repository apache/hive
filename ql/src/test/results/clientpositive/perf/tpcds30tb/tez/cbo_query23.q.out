CTE Suggestion 0:HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
  HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
  HiveTableScan(table=[[default, customer]], table:alias=[customer])

CTE Suggestion 1:HiveAggregate(group=[{0}])
  HiveProject(item_sk=[$1])
    HiveProject(itemdesc=[$0], item_sk=[$1], solddate=[$2], cnt=[$3])
      HiveFilter(condition=[>($3, CAST(4:BIGINT):BIGINT)])
        HiveAggregate(group=[{0, 1, 2}], agg#0=[count()])
          HiveProject($f0=[substr($63, 1, 30)], $f1=[$59], $f2=[$29])
            HiveFilter(condition=[AND(=($22, $27), =($1, $59), OR(=($33, CAST(1999):INTEGER), =($33, +(1999, 1)), =($33, +(1999, 2)), =($33, +(1999, 3))))])
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                HiveTableScan(table=[[default, item]], table:alias=[item])

CTE Suggestion 2:HiveProject(c_customer_sk=[$0])
  HiveProject(c_customer_sk=[$0], ssales=[$1])
    HiveProject($f0=[$0], $f1=[$1])
      HiveFilter(condition=[>($1, *(/(95:DECIMAL(10, 0), 100:DECIMAL(3, 0)), $2))])
        HiveJoin(condition=[true], joinType=[left], algorithm=[none], cost=[not available])
          HiveAggregate(group=[{0}], agg#0=[sum($1)])
            HiveProject($f0=[$27], $f1=[*(CAST($9):DECIMAL(10, 0), $12)])
              HiveFilter(condition=[=($2, $27)])
                HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                  HiveTableScan(table=[[default, customer]], table:alias=[customer])
          HiveProject(tpcds_cmax=[$0])
            HiveProject(tpcds_cmax=[$0])
              HiveAggregate(group=[{}], agg#0=[max($0)])
                HiveProject($f0=[$1])
                  HiveProject(c_customer_sk=[$0], csales=[$1])
                    HiveAggregate(group=[{0}], agg#0=[sum($1)])
                      HiveProject($f0=[$27], $f1=[*(CAST($9):DECIMAL(10, 0), $12)])
                        HiveFilter(condition=[AND(=($2, $27), =($22, $49), OR(=($55, CAST(1999):INTEGER), =($55, +(1999, 1)), =($55, +(1999, 2)), =($55, +(1999, 3))))])
                          HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                            HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                              HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                              HiveTableScan(table=[[default, customer]], table:alias=[customer])
                            HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

Warning: Map Join MAPJOIN[318][bigTable=?] in task 'Reducer 7' is a cross product
CBO PLAN:
HiveAggregate(group=[{}], agg#0=[sum($0)])
  HiveProject(sales=[$0])
    HiveUnion(all=[true])
      HiveProject(sales=[*(CAST($2):DECIMAL(10, 0), $3)])
        HiveSemiJoin(condition=[=($0, $8)], joinType=[semi])
          HiveSemiJoin(condition=[=($1, $8)], joinType=[semi])
            HiveJoin(condition=[=($4, $5)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(cs_bill_customer_sk=[$2], cs_item_sk=[$14], cs_quantity=[$17], cs_list_price=[$19], cs_sold_date_sk=[$33])
                HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($33))])
                  HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
              HiveProject(d_date_sk=[$0], d_year=[CAST(1999):INTEGER], d_moy=[CAST(1):INTEGER])
                HiveFilter(condition=[AND(=($6, 1999), =($8, 1))])
                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
            HiveProject($f1=[$0])
              HiveFilter(condition=[>($2, 4)])
                HiveProject(i_item_sk=[$3], d_date=[$1], $f2=[$2])
                  HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(ss_item_sk=[$0], d_date=[$1], $f2=[$2])
                      HiveAggregate(group=[{0, 3}], agg#0=[count()])
                        HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                          HiveProject(ss_item_sk=[$1], ss_sold_date_sk=[$22])
                            HiveFilter(condition=[IS NOT NULL($22)])
                              HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                          HiveProject(d_date_sk=[$0], d_date=[$2])
                            HiveFilter(condition=[IN($6, 1999, 2000, 2001, 2002)])
                              HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                    HiveProject(i_item_sk=[$0])
                      HiveTableScan(table=[[default, item]], table:alias=[item])
          HiveProject(c_customer_sk=[$0])
            HiveJoin(condition=[>($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(ss_customer_sk=[$0], $f1=[$1])
                HiveFilter(condition=[IS NOT NULL($1)])
                  HiveAggregate(group=[{0}], agg#0=[sum($1)])
                    HiveProject(ss_customer_sk=[CAST($2):BIGINT NOT NULL], *=[*(CAST($9):DECIMAL(10, 0), $12)])
                      HiveFilter(condition=[IS NOT NULL($2)])
                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
              HiveProject(*=[*(0.95:DECIMAL(16, 6), $0)])
                HiveFilter(condition=[IS NOT NULL($0)])
                  HiveProject($f0=[$0])
                    HiveAggregate(group=[{}], agg#0=[max($1)])
                      HiveProject(ss_customer_sk=[$0], $f1=[$1])
                        HiveAggregate(group=[{1}], agg#0=[sum($2)])
                          HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                            HiveProject(ss_sold_date_sk=[$22], ss_customer_sk=[CAST($2):BIGINT NOT NULL], *=[*(CAST($9):DECIMAL(10, 0), $12)])
                              HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))])
                                HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                            HiveProject(d_date_sk=[$0])
                              HiveFilter(condition=[IN($6, 1999, 2000, 2001, 2002)])
                                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
      HiveProject(sales=[*(CAST($2):DECIMAL(10, 0), $3)])
        HiveSemiJoin(condition=[=($1, $8)], joinType=[semi])
          HiveSemiJoin(condition=[=($0, $8)], joinType=[semi])
            HiveJoin(condition=[=($4, $5)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(ws_item_sk=[$2], ws_bill_customer_sk=[$3], ws_quantity=[$17], ws_list_price=[$19], ws_sold_date_sk=[$33])
                HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))])
                  HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
              HiveProject(d_date_sk=[$0], d_year=[CAST(1999):INTEGER], d_moy=[CAST(1):INTEGER])
                HiveFilter(condition=[AND(=($6, 1999), =($8, 1))])
                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
            HiveProject($f1=[$0])
              HiveFilter(condition=[>($2, 4)])
                HiveProject(i_item_sk=[$3], d_date=[$1], $f2=[$2])
                  HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(ss_item_sk=[$0], d_date=[$1], $f2=[$2])
                      HiveAggregate(group=[{0, 3}], agg#0=[count()])
                        HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                          HiveProject(ss_item_sk=[$1], ss_sold_date_sk=[$22])
                            HiveFilter(condition=[IS NOT NULL($22)])
                              HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                          HiveProject(d_date_sk=[$0], d_date=[$2])
                            HiveFilter(condition=[IN($6, 1999, 2000, 2001, 2002)])
                              HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                    HiveProject(i_item_sk=[$0])
                      HiveTableScan(table=[[default, item]], table:alias=[item])
          HiveProject(c_customer_sk=[$0])
            HiveJoin(condition=[>($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(ss_customer_sk=[$0], $f1=[$1])
                HiveFilter(condition=[IS NOT NULL($1)])
                  HiveAggregate(group=[{0}], agg#0=[sum($1)])
                    HiveProject(ss_customer_sk=[CAST($2):BIGINT NOT NULL], *=[*(CAST($9):DECIMAL(10, 0), $12)])
                      HiveFilter(condition=[IS NOT NULL($2)])
                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
              HiveProject(*=[*(0.95:DECIMAL(16, 6), $0)])
                HiveFilter(condition=[IS NOT NULL($0)])
                  HiveProject($f0=[$0])
                    HiveAggregate(group=[{}], agg#0=[max($1)])
                      HiveProject(ss_customer_sk=[$0], $f1=[$1])
                        HiveAggregate(group=[{1}], agg#0=[sum($2)])
                          HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                            HiveProject(ss_sold_date_sk=[$22], ss_customer_sk=[CAST($2):BIGINT NOT NULL], *=[*(CAST($9):DECIMAL(10, 0), $12)])
                              HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))])
                                HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                            HiveProject(d_date_sk=[$0])
                              HiveFilter(condition=[IN($6, 1999, 2000, 2001, 2002)])
                                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

