CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100])
  HiveProject(s_store_name=[$4], i_item_desc=[$6], revenue=[$2], i_current_price=[$7], i_wholesale_cost=[$8], i_brand=[$9])
    HiveJoin(condition=[AND(=($10, $0), <=($2, $11))], joinType=[inner], algorithm=[none], cost=[not available])
      HiveJoin(condition=[=($5, $1)], joinType=[inner], algorithm=[none], cost=[not available])
        HiveJoin(condition=[=($3, $0)], joinType=[inner], algorithm=[none], cost=[not available])
          HiveProject(ss_store_sk=[$0], ss_item_sk=[$1], revenue=[$2])
            HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($2))])
              HiveTableScan(table=[[cte, cte_suggestion_0]], table:alias=[cte_suggestion_0])
          HiveProject(s_store_sk=[$0], s_store_name=[$5])
            HiveTableScan(table=[[default, store]], table:alias=[store])
        HiveProject(i_item_sk=[$0], i_item_desc=[$4], i_current_price=[$5], i_wholesale_cost=[$6], i_brand=[$8])
          HiveTableScan(table=[[default, item]], table:alias=[item])
      HiveProject($f0=[$0], *=[*(0.1:DECIMAL(1, 1), CAST(/($1, $2)):DECIMAL(21, 6))])
        HiveFilter(condition=[IS NOT NULL(CAST(/($1, $2)):DECIMAL(21, 6))])
          HiveAggregate(group=[{0}], agg#0=[sum($2)], agg#1=[count($2)])
            HiveFilter(condition=[IS NOT NULL($0)])
              HiveTableSpool(readType=[LAZY], writeType=[LAZY], table=[[cte, cte_suggestion_0]])
                HiveProject(ss_store_sk=[$1], ss_item_sk=[$0], revenue=[$2])
                  HiveAggregate(group=[{0, 1}], agg#0=[sum($2)])
                    HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveProject(ss_item_sk=[$1], ss_store_sk=[$6], ss_sales_price=[$12], ss_sold_date_sk=[$22])
                        HiveFilter(condition=[IS NOT NULL($22)])
                          HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                      HiveProject(d_date_sk=[$0])
                        HiveFilter(condition=[BETWEEN(false, $3, 1212, 1223)])
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

