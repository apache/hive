CBO PLAN:
HiveProject(prev_year=[CAST(2001):INTEGER], year=[CAST(2002):INTEGER], i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], prev_yr_cnt=[$4], curr_yr_cnt=[$5], sales_cnt_diff=[$6], sales_amt_diff=[$7])
  HiveSortLimit(sort0=[$6], dir0=[ASC], fetch=[100])
    HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], prev_yr_cnt=[$4], curr_yr_cnt=[$10], sales_cnt_diff=[-($10, $4)], sales_amt_diff=[-($11, $5)])
      HiveJoin(condition=[AND(=($6, $0), =($7, $1), =($8, $2), =($9, $3), <(/(CAST($10):DECIMAL(17, 2), CAST($4):DECIMAL(17, 2)), 0.9:DECIMAL(1, 1)))], joinType=[inner], algorithm=[none], cost=[not available])
        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], $f4=[$4], $f5=[$5])
          HiveAggregate(group=[{0, 1, 2, 3}], agg#0=[sum($4)], agg#1=[sum($5)])
            HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], sales_cnt=[$4], sales_amt=[$5])
              HiveAggregate(group=[{0, 1, 2, 3, 4, 5}])
                HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], sales_cnt=[$4], sales_amt=[$5])
                  HiveUnion(all=[true])
                    HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], sales_cnt=[$4], sales_amt=[$5])
                      HiveAggregate(group=[{0, 1, 2, 3, 4, 5}])
                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], sales_cnt=[$4], sales_amt=[$5])
                          HiveUnion(all=[true])
                            HiveProject(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($6, CASE(IS NOT NULL($2), $2, 0))], sales_amt=[-($7, CASE(IS NOT NULL($3), $3, 0:DECIMAL(1, 0)))])
                              HiveJoin(condition=[AND(=($5, $1), =($4, $0))], joinType=[right], algorithm=[none], cost=[not available])
                                HiveProject(cr_item_sk=[$1], cr_order_number=[$15], cr_return_quantity=[$16], cr_return_amount=[$17])
                                  HiveTableScan(table=[[default, catalog_returns]], table:alias=[catalog_returns])
                                HiveJoin(condition=[=($6, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                                  HiveJoin(condition=[=($5, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                                    HiveProject(cs_item_sk=[$14], cs_order_number=[$16], cs_quantity=[$17], cs_ext_sales_price=[$22], cs_sold_date_sk=[$33])
                                      HiveFilter(condition=[IS NOT NULL($33)])
                                        HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                                    HiveProject(d_date_sk=[$0])
                                      HiveFilter(condition=[=($6, 2001)])
                                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                                  HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                                    HiveFilter(condition=[AND(=($12, _UTF-16LE'Sports                                            '), IS NOT NULL($13), IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))])
                                      HiveTableScan(table=[[default, item]], table:alias=[item])
                            HiveProject(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($6, CASE(IS NOT NULL($2), $2, 0))], sales_amt=[-($7, CASE(IS NOT NULL($3), $3, 0:DECIMAL(1, 0)))])
                              HiveJoin(condition=[AND(=($5, $1), =($4, $0))], joinType=[right], algorithm=[none], cost=[not available])
                                HiveProject(sr_item_sk=[$1], sr_ticket_number=[$8], sr_return_quantity=[$9], sr_return_amt=[$10])
                                  HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns])
                                HiveJoin(condition=[=($6, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                                  HiveJoin(condition=[=($5, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                                    HiveProject(ss_item_sk=[$1], ss_ticket_number=[$8], ss_quantity=[$9], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
                                      HiveFilter(condition=[IS NOT NULL($22)])
                                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                                    HiveProject(d_date_sk=[$0])
                                      HiveFilter(condition=[=($6, 2001)])
                                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                                  HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                                    HiveFilter(condition=[AND(=($12, _UTF-16LE'Sports                                            '), IS NOT NULL($13), IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))])
                                      HiveTableScan(table=[[default, item]], table:alias=[item])
                    HiveProject(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($6, CASE(IS NOT NULL($2), $2, 0))], sales_amt=[-($7, CASE(IS NOT NULL($3), $3, 0:DECIMAL(1, 0)))])
                      HiveJoin(condition=[AND(=($5, $1), =($4, $0))], joinType=[right], algorithm=[none], cost=[not available])
                        HiveProject(wr_item_sk=[$1], wr_order_number=[$12], wr_return_quantity=[$13], wr_return_amt=[$14])
                          HiveTableScan(table=[[default, web_returns]], table:alias=[web_returns])
                        HiveJoin(condition=[=($6, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                          HiveJoin(condition=[=($5, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                            HiveProject(ws_item_sk=[$2], ws_order_number=[$16], ws_quantity=[$17], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33])
                              HiveFilter(condition=[IS NOT NULL($33)])
                                HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                            HiveProject(d_date_sk=[$0])
                              HiveFilter(condition=[=($6, 2001)])
                                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                          HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                            HiveFilter(condition=[AND(=($12, _UTF-16LE'Sports                                            '), IS NOT NULL($13), IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))])
                              HiveTableScan(table=[[default, item]], table:alias=[item])
        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], $f4=[$4], $f5=[$5])
          HiveAggregate(group=[{0, 1, 2, 3}], agg#0=[sum($4)], agg#1=[sum($5)])
            HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], sales_cnt=[$4], sales_amt=[$5])
              HiveAggregate(group=[{0, 1, 2, 3, 4, 5}])
                HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], sales_cnt=[$4], sales_amt=[$5])
                  HiveUnion(all=[true])
                    HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], sales_cnt=[$4], sales_amt=[$5])
                      HiveAggregate(group=[{0, 1, 2, 3, 4, 5}])
                        HiveProject(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], sales_cnt=[$4], sales_amt=[$5])
                          HiveUnion(all=[true])
                            HiveProject(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($6, CASE(IS NOT NULL($2), $2, 0))], sales_amt=[-($7, CASE(IS NOT NULL($3), $3, 0:DECIMAL(1, 0)))])
                              HiveJoin(condition=[AND(=($5, $1), =($4, $0))], joinType=[right], algorithm=[none], cost=[not available])
                                HiveProject(cr_item_sk=[$1], cr_order_number=[$15], cr_return_quantity=[$16], cr_return_amount=[$17])
                                  HiveTableScan(table=[[default, catalog_returns]], table:alias=[catalog_returns])
                                HiveJoin(condition=[=($6, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                                  HiveJoin(condition=[=($5, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                                    HiveProject(cs_item_sk=[$14], cs_order_number=[$16], cs_quantity=[$17], cs_ext_sales_price=[$22], cs_sold_date_sk=[$33])
                                      HiveFilter(condition=[IS NOT NULL($33)])
                                        HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                                    HiveProject(d_date_sk=[$0])
                                      HiveFilter(condition=[=($6, 2002)])
                                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                                  HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                                    HiveFilter(condition=[AND(=($12, _UTF-16LE'Sports                                            '), IS NOT NULL($13), IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))])
                                      HiveTableScan(table=[[default, item]], table:alias=[item])
                            HiveProject(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($6, CASE(IS NOT NULL($2), $2, 0))], sales_amt=[-($7, CASE(IS NOT NULL($3), $3, 0:DECIMAL(1, 0)))])
                              HiveJoin(condition=[AND(=($5, $1), =($4, $0))], joinType=[right], algorithm=[none], cost=[not available])
                                HiveProject(sr_item_sk=[$1], sr_ticket_number=[$8], sr_return_quantity=[$9], sr_return_amt=[$10])
                                  HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns])
                                HiveJoin(condition=[=($6, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                                  HiveJoin(condition=[=($5, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                                    HiveProject(ss_item_sk=[$1], ss_ticket_number=[$8], ss_quantity=[$9], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
                                      HiveFilter(condition=[IS NOT NULL($22)])
                                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                                    HiveProject(d_date_sk=[$0])
                                      HiveFilter(condition=[=($6, 2002)])
                                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                                  HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                                    HiveFilter(condition=[AND(=($12, _UTF-16LE'Sports                                            '), IS NOT NULL($13), IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))])
                                      HiveTableScan(table=[[default, item]], table:alias=[item])
                    HiveProject(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($6, CASE(IS NOT NULL($2), $2, 0))], sales_amt=[-($7, CASE(IS NOT NULL($3), $3, 0:DECIMAL(1, 0)))])
                      HiveJoin(condition=[AND(=($5, $1), =($4, $0))], joinType=[right], algorithm=[none], cost=[not available])
                        HiveProject(wr_item_sk=[$1], wr_order_number=[$12], wr_return_quantity=[$13], wr_return_amt=[$14])
                          HiveTableScan(table=[[default, web_returns]], table:alias=[web_returns])
                        HiveJoin(condition=[=($6, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                          HiveJoin(condition=[=($5, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                            HiveProject(ws_item_sk=[$2], ws_order_number=[$16], ws_quantity=[$17], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33])
                              HiveFilter(condition=[IS NOT NULL($33)])
                                HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                            HiveProject(d_date_sk=[$0])
                              HiveFilter(condition=[=($6, 2002)])
                                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                          HiveProject(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                            HiveFilter(condition=[AND(=($12, _UTF-16LE'Sports                                            '), IS NOT NULL($13), IS NOT NULL($11), IS NOT NULL($7), IS NOT NULL($9))])
                              HiveTableScan(table=[[default, item]], table:alias=[item])

