CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100])
  HiveProject(customer_id=[$13], customer_first_name=[$14], customer_last_name=[$15], customer_birth_country=[$16])
    HiveJoin(condition=[AND(=($13, $2), CASE($4, CASE($10, >(/($1, $9), /($17, $3)), false), false))], joinType=[inner], algorithm=[none], cost=[not available])
      HiveJoin(condition=[AND(=($2, $11), CASE($7, CASE($10, >(/($1, $9), /($12, $6)), false), false))], joinType=[inner], algorithm=[none], cost=[not available])
        HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[not available])
          HiveProject(c_customer_id=[$0], $f1=[$1])
            HiveAggregate(group=[{5}], agg#0=[sum($2)])
              HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(cs_bill_customer_sk=[$2], cs_sold_date_sk=[$33], $f8=[/(+(-(-($24, $23), $21), $22), 2:DECIMAL(10, 0))])
                    HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($33))])
                      HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                  HiveProject(d_date_sk=[$0])
                    HiveFilter(condition=[=($6, 2000)])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16])
                  HiveTableScan(table=[[default, customer]], table:alias=[customer])
          HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(customer_id=[$0], year_total=[$1], EXPR$131=[>($1, 0:DECIMAL(1, 0))])
                HiveFilter(condition=[>($1, 0:DECIMAL(1, 0))])
                  HiveAggregate(group=[{5}], agg#0=[sum($2)])
                    HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                        HiveProject(ss_customer_sk=[$2], ss_sold_date_sk=[$22], $f8=[/(+(-(-($16, $15), $13), $14), 2:DECIMAL(10, 0))])
                          HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))])
                            HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                        HiveProject(d_date_sk=[$0])
                          HiveFilter(condition=[=($6, 1999)])
                            HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                      HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16])
                        HiveTableScan(table=[[default, customer]], table:alias=[customer])
              HiveProject(customer_id=[$0], year_total=[$1], EXPR$0=[>($1, 0:DECIMAL(1, 0))])
                HiveFilter(condition=[>($1, 0:DECIMAL(1, 0))])
                  HiveAggregate(group=[{5}], agg#0=[sum($2)])
                    HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                        HiveProject(ws_bill_customer_sk=[$3], ws_sold_date_sk=[$33], $f8=[/(+(-(-($24, $23), $21), $22), 2:DECIMAL(10, 0))])
                          HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))])
                            HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                        HiveProject(d_date_sk=[$0])
                          HiveFilter(condition=[=($6, 1999)])
                            HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                      HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16])
                        HiveTableScan(table=[[default, customer]], table:alias=[customer])
            HiveProject(customer_id=[$0], year_total=[$1], EXPR$1=[>($1, 0:DECIMAL(1, 0))])
              HiveFilter(condition=[>($1, 0:DECIMAL(1, 0))])
                HiveAggregate(group=[{5}], agg#0=[sum($2)])
                  HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveProject(cs_bill_customer_sk=[$2], cs_sold_date_sk=[$33], $f8=[/(+(-(-($24, $23), $21), $22), 2:DECIMAL(10, 0))])
                        HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($33))])
                          HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                      HiveProject(d_date_sk=[$0])
                        HiveFilter(condition=[=($6, 1999)])
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                    HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16])
                      HiveTableScan(table=[[default, customer]], table:alias=[customer])
        HiveProject(c_customer_id=[$0], $f1=[$1])
          HiveAggregate(group=[{5}], agg#0=[sum($2)])
            HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(ws_bill_customer_sk=[$3], ws_sold_date_sk=[$33], $f8=[/(+(-(-($24, $23), $21), $22), 2:DECIMAL(10, 0))])
                  HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))])
                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                HiveProject(d_date_sk=[$0])
                  HiveFilter(condition=[=($6, 2000)])
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
              HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16])
                HiveTableScan(table=[[default, customer]], table:alias=[customer])
      HiveProject(c_customer_id=[$0], c_first_name=[$1], c_last_name=[$2], c_birth_country=[$3], $f4=[$4])
        HiveAggregate(group=[{5, 6, 7, 9}], agg#0=[sum($2)])
          HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(ss_customer_sk=[$2], ss_sold_date_sk=[$22], $f8=[/(+(-(-($16, $15), $13), $14), 2:DECIMAL(10, 0))])
                HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))])
                  HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
              HiveProject(d_date_sk=[$0])
                HiveFilter(condition=[=($6, 2000)])
                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
            HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_preferred_cust_flag=[$10], c_birth_country=[$14], c_login=[$15], c_email_address=[$16])
              HiveTableScan(table=[[default, customer]], table:alias=[customer])

