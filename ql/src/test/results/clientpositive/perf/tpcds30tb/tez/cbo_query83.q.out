CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100])
  HiveProject(item_id=[$0], sr_item_qty=[$3], sr_dev=[*(/(/(CAST($3):DOUBLE, CAST(+(+($3, $1), $5)):DOUBLE), 3), 100)], cr_item_qty=[$1], cr_dev=[*(/(/(CAST($1):DOUBLE, CAST(+(+($3, $1), $5)):DOUBLE), 3), 100)], wr_item_qty=[$5], wr_dev=[*(/(/($6, CAST(+(+($3, $1), $5)):DOUBLE), 3), 100)], average=[/(CAST(+(+($3, $1), $5)):DECIMAL(19, 0), 3:DECIMAL(1, 0))])
    HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[not available])
      HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[not available])
        HiveProject(i_item_id=[$0], $f1=[$1])
          HiveAggregate(group=[{6}], agg#0=[sum($1)])
            HiveJoin(condition=[=($0, $5)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveSemiJoin(condition=[=($4, $5)], joinType=[semi])
                HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(cr_item_sk=[$1], cr_return_quantity=[$16], cr_returned_date_sk=[$26])
                    HiveFilter(condition=[IS NOT NULL($26)])
                      HiveTableScan(table=[[default, catalog_returns]], table:alias=[catalog_returns])
                  HiveProject(d_date_sk=[$0], d_date=[$2])
                    HiveFilter(condition=[IS NOT NULL($2)])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                HiveProject(d_date=[$0])
                  HiveSemiJoin(condition=[=($1, $2)], joinType=[semi])
                    HiveProject(d_date=[$2], d_week_seq=[$4])
                      HiveFilter(condition=[AND(IS NOT NULL($4), IS NOT NULL($2))])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                    HiveProject(d_week_seq=[$4])
                      HiveFilter(condition=[AND(IN($2, 1998-01-02:DATE, 1998-10-15:DATE, 1998-11-10:DATE), IS NOT NULL($4))])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
              HiveProject(i_item_sk=[$0], i_item_id=[$1])
                HiveTableScan(table=[[default, item]], table:alias=[item])
        HiveProject(i_item_id=[$0], $f1=[$1])
          HiveAggregate(group=[{6}], agg#0=[sum($1)])
            HiveJoin(condition=[=($0, $5)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveSemiJoin(condition=[=($4, $5)], joinType=[semi])
                HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(sr_item_sk=[$1], sr_return_quantity=[$9], sr_returned_date_sk=[$19])
                    HiveFilter(condition=[IS NOT NULL($19)])
                      HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns])
                  HiveProject(d_date_sk=[$0], d_date=[$2])
                    HiveFilter(condition=[IS NOT NULL($2)])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                HiveProject(d_date=[$0])
                  HiveSemiJoin(condition=[=($1, $2)], joinType=[semi])
                    HiveProject(d_date=[$2], d_week_seq=[$4])
                      HiveFilter(condition=[AND(IS NOT NULL($4), IS NOT NULL($2))])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                    HiveProject(d_week_seq=[$4])
                      HiveFilter(condition=[AND(IN($2, 1998-01-02:DATE, 1998-10-15:DATE, 1998-11-10:DATE), IS NOT NULL($4))])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
              HiveProject(i_item_sk=[$0], i_item_id=[$1])
                HiveTableScan(table=[[default, item]], table:alias=[item])
      HiveProject(item_id=[$0], wr_item_qty=[$1], CAST=[CAST($1):DOUBLE])
        HiveAggregate(group=[{6}], agg#0=[sum($1)])
          HiveJoin(condition=[=($0, $5)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveSemiJoin(condition=[=($4, $5)], joinType=[semi])
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(wr_item_sk=[$1], wr_return_quantity=[$13], wr_returned_date_sk=[$23])
                  HiveFilter(condition=[IS NOT NULL($23)])
                    HiveTableScan(table=[[default, web_returns]], table:alias=[web_returns])
                HiveProject(d_date_sk=[$0], d_date=[$2])
                  HiveFilter(condition=[IS NOT NULL($2)])
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
              HiveProject(d_date=[$0])
                HiveSemiJoin(condition=[=($1, $2)], joinType=[semi])
                  HiveProject(d_date=[$2], d_week_seq=[$4])
                    HiveFilter(condition=[AND(IS NOT NULL($4), IS NOT NULL($2))])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                  HiveProject(d_week_seq=[$4])
                    HiveFilter(condition=[AND(IN($2, 1998-01-02:DATE, 1998-10-15:DATE, 1998-11-10:DATE), IS NOT NULL($4))])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
            HiveProject(i_item_sk=[$0], i_item_id=[$1])
              HiveTableScan(table=[[default, item]], table:alias=[item])

