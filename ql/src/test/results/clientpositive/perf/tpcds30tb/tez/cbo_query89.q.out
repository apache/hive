CBO PLAN:
HiveProject(i_category=[$0], i_class=[$1], i_brand=[$2], s_store_name=[$3], s_company_name=[$4], d_moy=[$5], sum_sales=[$6], avg_monthly_sales=[$7])
  HiveSortLimit(sort0=[$8], sort1=[$3], dir0=[ASC], dir1=[ASC], fetch=[100])
    HiveProject(i_category=[$0], i_class=[$1], i_brand=[$2], s_store_name=[$3], s_company_name=[$4], d_moy=[$5], sum_sales=[$6], avg_monthly_sales=[$7], (- (tok_table_or_col sum_sales) (tok_table_or_col avg_monthly_sales))=[-($6, $7)])
      HiveFilter(condition=[CASE(<>($7, 0:DECIMAL(1, 0)), >(/(ABS(-($6, $7)), $7), 0.1:DECIMAL(1, 1)), false)])
        HiveProject((tok_table_or_col i_category)=[$2], (tok_table_or_col i_class)=[$1], (tok_table_or_col i_brand)=[$0], (tok_table_or_col s_store_name)=[$4], (tok_table_or_col s_company_name)=[$5], (tok_table_or_col d_moy)=[$3], (tok_function sum (tok_table_or_col ss_sales_price))=[$6], avg_window_0=[avg($6) OVER (PARTITION BY $2, $0, $4, $5 ORDER BY $2 NULLS FIRST, $0 NULLS FIRST, $4 NULLS FIRST, $5 NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)])
          HiveProject(i_brand=[$0], i_class=[$1], i_category=[$2], d_moy=[$3], s_store_name=[$4], s_company_name=[$5], $f6=[$6])
            HiveAggregate(group=[{5, 6, 7, 9, 11, 12}], agg#0=[sum($2)])
              HiveJoin(condition=[=($1, $10)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($3, $8)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(ss_item_sk=[$1], ss_store_sk=[$6], ss_sales_price=[$12], ss_sold_date_sk=[$22])
                      HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($22))])
                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                    HiveProject(i_item_sk=[$0], i_brand=[$8], i_class=[$10], i_category=[$12])
                      HiveFilter(condition=[AND(IN($10, _UTF-16LE'wallpaper                                         ', _UTF-16LE'parenting                                         ', _UTF-16LE'musical                                           ', _UTF-16LE'womens                                            ', _UTF-16LE'birdal                                            ', _UTF-16LE'pants                                             '), IN($12, _UTF-16LE'Home                                              ', _UTF-16LE'Books                                             ', _UTF-16LE'Electronics                                       ', _UTF-16LE'Shoes                                             ', _UTF-16LE'Jewelry                                           ', _UTF-16LE'Men                                               '), OR(AND(IN($12, _UTF-16LE'Home                                              ', _UTF-16LE'Books                                             ', _UTF-16LE'Electronics                                       '), IN($10, _UTF-16LE'wallpaper                                         ', _UTF-16LE'parenting                                         ', _UTF-16LE'musical                                           ')), AND(IN($12, _UTF-16LE'Shoes                                             ', _UTF-16LE'Jewelry                                           ', _UTF-16LE'Men                                               '), IN($10, _UTF-16LE'womens                                            ', _UTF-16LE'birdal                                            ', _UTF-16LE'pants                                             '))))])
                        HiveTableScan(table=[[default, item]], table:alias=[item])
                  HiveProject(d_date_sk=[$0], d_moy=[$8])
                    HiveFilter(condition=[=($6, 2000)])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                HiveProject(s_store_sk=[$0], s_store_name=[$5], s_company_name=[$17])
                  HiveTableScan(table=[[default, store]], table:alias=[store])

