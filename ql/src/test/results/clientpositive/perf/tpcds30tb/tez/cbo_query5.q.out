CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100])
  HiveProject(channel=[$0], id=[$1], $f2=[$2], $f3=[$3], $f4=[$4])
    HiveAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)])
      HiveProject(channel=[$0], id=[$1], sales=[$2], returns=[$3], profit=[$4])
        HiveUnion(all=[true])
          HiveProject(channel=[_UTF-16LE'store channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[||(_UTF-16LE'store':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", $0)], sales=[$1], returns=[$3], profit=[-($2, $4)])
            HiveAggregate(group=[{7}], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)], agg#3=[sum($5)])
              HiveJoin(condition=[=($1, $8)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(store_sk=[$0], date_sk=[$1], sales_price=[$2], profit=[$3], return_amt=[$4], net_loss=[$5])
                    HiveUnion(all=[true])
                      HiveProject(store_sk=[$6], date_sk=[$22], sales_price=[$14], profit=[$21], return_amt=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)], net_loss=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)])
                        HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($22))])
                          HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                      HiveProject(store_sk=[$6], date_sk=[$19], sales_price=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)], profit=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)], return_amt=[$10], net_loss=[$18])
                        HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($19))])
                          HiveTableScan(table=[[default, store_returns]], table:alias=[store_returns])
                  HiveProject(s_store_sk=[$0], s_store_id=[$1])
                    HiveTableScan(table=[[default, store]], table:alias=[store])
                HiveProject(d_date_sk=[$0])
                  HiveFilter(condition=[BETWEEN(false, CAST($2):TIMESTAMP(9), 1998-08-04 00:00:00:TIMESTAMP(9), 1998-08-18 00:00:00:TIMESTAMP(9))])
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
          HiveProject(channel=[_UTF-16LE'catalog channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[||(_UTF-16LE'catalog_page':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", $0)], sales=[$1], returns=[$3], profit=[-($2, $4)])
            HiveAggregate(group=[{7}], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)], agg#3=[sum($5)])
              HiveJoin(condition=[=($1, $8)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(page_sk=[$0], date_sk=[$1], sales_price=[$2], profit=[$3], return_amt=[$4], net_loss=[$5])
                    HiveUnion(all=[true])
                      HiveProject(page_sk=[$11], date_sk=[$33], sales_price=[$22], profit=[$32], return_amt=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)], net_loss=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)])
                        HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($33))])
                          HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                      HiveProject(page_sk=[$11], date_sk=[$26], sales_price=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)], profit=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)], return_amt=[$17], net_loss=[$25])
                        HiveFilter(condition=[AND(IS NOT NULL($11), IS NOT NULL($26))])
                          HiveTableScan(table=[[default, catalog_returns]], table:alias=[catalog_returns])
                  HiveProject(cp_catalog_page_sk=[$0], cp_catalog_page_id=[$1])
                    HiveTableScan(table=[[default, catalog_page]], table:alias=[catalog_page])
                HiveProject(d_date_sk=[$0])
                  HiveFilter(condition=[BETWEEN(false, CAST($2):TIMESTAMP(9), 1998-08-04 00:00:00:TIMESTAMP(9), 1998-08-18 00:00:00:TIMESTAMP(9))])
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
          HiveProject(channel=[_UTF-16LE'web channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[||(_UTF-16LE'web_site':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", $0)], sales=[$1], returns=[$3], profit=[-($2, $4)])
            HiveAggregate(group=[{7}], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)], agg#3=[sum($5)])
              HiveJoin(condition=[=($1, $8)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(wsr_web_site_sk=[$0], date_sk=[$1], sales_price=[$2], profit=[$3], return_amt=[$4], net_loss=[$5])
                    HiveUnion(all=[true])
                      HiveProject(wsr_web_site_sk=[$12], date_sk=[$33], sales_price=[$22], profit=[$32], return_amt=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)], net_loss=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)])
                        HiveFilter(condition=[AND(IS NOT NULL($12), IS NOT NULL($33))])
                          HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                      HiveProject(ws_web_site_sk=[$1], wr_returned_date_sk=[$7], $f2=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)], $f3=[CAST(0:DECIMAL(7, 2)):DECIMAL(7, 2)], wr_return_amt=[$5], wr_net_loss=[$6])
                        HiveJoin(condition=[AND(=($3, $0), =($4, $2))], joinType=[inner], algorithm=[none], cost=[not available])
                          HiveProject(ws_item_sk=[$2], ws_web_site_sk=[$12], ws_order_number=[$16])
                            HiveFilter(condition=[IS NOT NULL($12)])
                              HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                          HiveProject(wr_item_sk=[$1], wr_order_number=[$12], wr_return_amt=[$14], wr_net_loss=[$22], wr_returned_date_sk=[$23])
                            HiveFilter(condition=[IS NOT NULL($23)])
                              HiveTableScan(table=[[default, web_returns]], table:alias=[web_returns])
                  HiveProject(web_site_sk=[$0], web_site_id=[$1])
                    HiveTableScan(table=[[default, web_site]], table:alias=[web_site])
                HiveProject(d_date_sk=[$0])
                  HiveFilter(condition=[BETWEEN(false, CAST($2):TIMESTAMP(9), 1998-08-04 00:00:00:TIMESTAMP(9), 1998-08-18 00:00:00:TIMESTAMP(9))])
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

