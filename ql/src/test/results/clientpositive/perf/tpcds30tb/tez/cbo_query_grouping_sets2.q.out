CBO PLAN:
HiveSortLimit(fetch=[100])
  HiveProject(ca_country=[$1], ca_state=[$0], i_item_id=[$2], agg1=[CAST(/($3, $4)):DECIMAL(16, 6)], agg6=[CAST(/($5, $6)):DECIMAL(16, 6)], agg7=[CAST(/($7, $8)):DECIMAL(16, 6)])
    HiveAggregate(group=[{12, 13, 15}], groups=[[{13}, {15}]], agg#0=[sum($4)], agg#1=[count($4)], agg#2=[sum($10)], agg#3=[count($10)], agg#4=[sum($7)], agg#5=[count($7)])
      HiveJoin(condition=[=($2, $14)], joinType=[inner], algorithm=[none], cost=[not available])
        HiveJoin(condition=[=($0, $8)], joinType=[inner], algorithm=[none], cost=[not available])
          HiveJoin(condition=[=($1, $6)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveJoin(condition=[=($3, $5)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(cs_bill_customer_sk=[$2], cs_bill_cdemo_sk=[$3], cs_item_sk=[$14], cs_sold_date_sk=[$33], CAST=[CAST($17):DECIMAL(12, 2)])
                HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($2), IS NOT NULL($33))])
                  HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
              HiveProject(d_date_sk=[$0])
                HiveFilter(condition=[=($6, 2001)])
                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
            HiveProject(cd_demo_sk=[$0], CAST=[CAST($6):DECIMAL(12, 2)])
              HiveFilter(condition=[AND(=($1, _UTF-16LE'M'), =($3, _UTF-16LE'College             '))])
                HiveTableScan(table=[[default, customer_demographics]], table:alias=[cd1])
          HiveProject(c_customer_sk=[$0], c_current_addr_sk=[$1], CAST=[$2], ca_address_sk=[$3], ca_state=[$4], ca_country=[$5])
            HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(c_customer_sk=[$0], c_current_addr_sk=[$4], CAST=[CAST($13):DECIMAL(12, 2)])
                HiveFilter(condition=[AND(IN($12, 9, 5), IS NOT NULL($4))])
                  HiveTableScan(table=[[default, customer]], table:alias=[customer])
              HiveProject(ca_address_sk=[$0], ca_state=[$8], ca_country=[$10])
                HiveFilter(condition=[IN($8, _UTF-16LE'AL', _UTF-16LE'MS', _UTF-16LE'TN')])
                  HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])
        HiveProject(i_item_sk=[$0], i_item_id=[$1])
          HiveTableScan(table=[[default, item]], table:alias=[item])

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Map 5 <- Map 6 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_bill_cdemo_sk is not null and cs_bill_customer_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_110_container, bigKeyColName:cs_bill_cdemo_sk, smallTablePos:1, keyRatio:2.6028186542889482E-5
                  Statistics: Num rows: 43005109025 Data size: 1546048714044 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_bill_cdemo_sk is not null and cs_bill_customer_sk is not null) (type: boolean)
                    Statistics: Num rows: 42792357238 Data size: 1538400212872 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_bill_cdemo_sk (type: bigint), cs_item_sk (type: bigint), cs_sold_date_sk (type: bigint), CAST( cs_quantity AS decimal(12,2)) (type: decimal(12,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 42792357238 Data size: 6148393041760 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col4
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 8539738749 Data size: 1147698069352 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col4, _col7
                          input vertices:
                            1 Map 4
                          Statistics: Num rows: 609981367 Data size: 133543278328 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col4, _col7, _col10, _col12, _col13
                            input vertices:
                              1 Map 5
                            Statistics: Num rows: 34527248 Data size: 14276566416 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col2 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col4, _col7, _col10, _col12, _col13, _col15
                              input vertices:
                                1 Map 7
                              Statistics: Num rows: 34527248 Data size: 17453073232 Basic stats: COMPLETE Column stats: COMPLETE
                              Top N Key Operator
                                sort order: +++
                                keys: _col12 (type: char(2)), _col13 (type: varchar(20)), _col15 (type: string)
                                null sort order: zzz
                                Statistics: Num rows: 34527248 Data size: 17453073232 Basic stats: COMPLETE Column stats: COMPLETE
                                top n: 100
                                Group By Operator
                                  aggregations: sum(_col4), count(_col4), sum(_col10), count(_col10), sum(_col7), count(_col7)
                                  keys: _col12 (type: char(2)), _col13 (type: varchar(20)), _col15 (type: string), 0L (type: bigint)
                                  grouping sets: 5, 6
                                  minReductionHashAggr: 0.9898616
                                  mode: hash
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                                  Statistics: Num rows: 34527248 Data size: 22477238448 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: char(2)), _col1 (type: varchar(20)), _col2 (type: string), _col3 (type: bigint)
                                    null sort order: zzzz
                                    sort order: ++++
                                    Map-reduce partition columns: _col0 (type: char(2)), _col1 (type: varchar(20)), _col2 (type: string), _col3 (type: bigint)
                                    Statistics: Num rows: 34527248 Data size: 22477238448 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions: _col4 (type: decimal(22,2)), _col5 (type: bigint), _col6 (type: decimal(22,2)), _col7 (type: bigint), _col8 (type: decimal(22,2)), _col9 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2001) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2001) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: z
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.4
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: cd1
                  filterExpr: ((cd_gender = 'M') and (cd_education_status = 'College             ')) (type: boolean)
                  Statistics: Num rows: 1920800 Data size: 366872800 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cd_gender = 'M') and (cd_education_status = 'College             ')) (type: boolean)
                    Statistics: Num rows: 137200 Data size: 26205200 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cd_demo_sk (type: bigint), CAST( cd_dep_count AS decimal(12,2)) (type: decimal(12,2))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 137200 Data size: 16464000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: z
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 137200 Data size: 16464000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: decimal(12,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: customer
                  filterExpr: ((c_birth_month) IN (9, 5) and c_current_addr_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_111_container, bigKeyColName:c_current_addr_sk, smallTablePos:1, keyRatio:0.0094339625
                  Statistics: Num rows: 80000000 Data size: 1897604572 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((c_birth_month) IN (9, 5) and c_current_addr_sk is not null) (type: boolean)
                    Statistics: Num rows: 13333333 Data size: 316267428 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_addr_sk (type: bigint), CAST( c_birth_year AS decimal(12,2)) (type: decimal(12,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 13333333 Data size: 1654425008 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col4, _col5
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 754717 Data size: 176437635 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: z
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 754717 Data size: 176437635 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(12,2)), _col4 (type: char(2)), _col5 (type: varchar(20))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_state) IN ('AL', 'MS', 'TN') (type: boolean)
                  Statistics: Num rows: 40000000 Data size: 7640000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_state) IN ('AL', 'MS', 'TN') (type: boolean)
                    Statistics: Num rows: 2264151 Data size: 432452841 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint), ca_state (type: char(2)), ca_country (type: varchar(20))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 2264151 Data size: 432452841 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: z
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 2264151 Data size: 432452841 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(2)), _col2 (type: varchar(20))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 462000 Data size: 49896000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_item_id (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 462000 Data size: 49896000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: z
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 462000 Data size: 49896000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), count(VALUE._col3), sum(VALUE._col4), count(VALUE._col5)
                keys: KEY._col0 (type: char(2)), KEY._col1 (type: varchar(20)), KEY._col2 (type: string), KEY._col3 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 990096 Data size: 644552496 Basic stats: COMPLETE Column stats: COMPLETE
                pruneGroupingSetId: true
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 65100 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col1 (type: varchar(20)), _col0 (type: char(2)), _col2 (type: string), CAST( (_col4 / _col5) AS decimal(16,6)) (type: decimal(16,6)), CAST( (_col6 / _col7) AS decimal(16,6)) (type: decimal(16,6)), CAST( (_col8 / _col9) AS decimal(16,6)) (type: decimal(16,6))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 100 Data size: 61900 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      Statistics: Num rows: 100 Data size: 61900 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

