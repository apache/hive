CTE Suggestion 0:HiveProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=[$9])
  HiveUnion(all=[true])
    HiveProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=[_UTF-16LE's':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"])
      HiveAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], agg#0=[sum($8)])
        HiveProject($f0=[$1], $f1=[$8], $f2=[$9], $f3=[$10], $f4=[$14], $f5=[$15], $f6=[$16], $f7=[$55], $f8=[-($38, $35)])
          HiveFilter(condition=[AND(=($0, $24), =($44, $49))])
            HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                HiveTableScan(table=[[default, customer]], table:alias=[customer])
                HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
              HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
    HiveProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], customer_preferred_cust_flag=[$3], customer_birth_country=[$4], customer_login=[$5], customer_email_address=[$6], dyear=[$7], year_total=[$8], sale_type=[_UTF-16LE'w':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"])
      HiveAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7}], agg#0=[sum($8)])
        HiveProject($f0=[$1], $f1=[$8], $f2=[$9], $f3=[$10], $f4=[$14], $f5=[$15], $f6=[$16], $f7=[$66], $f8=[-($46, $43)])
          HiveFilter(condition=[AND(=($0, $25), =($55, $60))])
            HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                HiveTableScan(table=[[default, customer]], table:alias=[customer])
                HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
              HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100])
  HiveProject(customer_id=[$0], customer_first_name=[$2], customer_last_name=[$3], customer_birth_country=[$4])
    HiveJoin(condition=[=($0, $1)], joinType=[inner], algorithm=[none], cost=[not available])
      HiveProject(customer_id=[$0])
        HiveJoin(condition=[AND(CASE($5, CASE($10, >(/($7, $9), /($2, $4)), >(0:DECIMAL(1, 0), /($2, $4))), CASE($10, >(/($7, $9), 0:DECIMAL(1, 0)), false)), =($0, $8))], joinType=[inner], algorithm=[none], cost=[not available])
          HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
            HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(c_customer_id=[$0], c_birth_country=[$1], $f2=[$2])
                HiveAggregate(group=[{5, 8}], agg#0=[sum($2)])
                  HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveProject(ss_customer_sk=[$0], ss_sold_date_sk=[$3], -=[-($2, $1)])
                        HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($3))])
                          HiveProject(ss_customer_sk=[$2], ss_ext_discount_amt=[$13], ss_ext_list_price=[$16], ss_sold_date_sk=[$22])
                            HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                      HiveProject(d_date_sk=[$0])
                        HiveFilter(condition=[=($1, 2000)])
                          HiveProject(d_date_sk=[$0], d_year=[$6])
                            HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                    HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_birth_country=[$14])
                      HiveTableScan(table=[[default, customer]], table:alias=[customer])
              HiveProject(customer_id=[$0], year_total=[$1], >=[>($1, 0:DECIMAL(1, 0))])
                HiveFilter(condition=[>($1, 0:DECIMAL(1, 0))])
                  HiveAggregate(group=[{5}], agg#0=[sum($2)])
                    HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                      HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                        HiveProject(ss_customer_sk=[$0], ss_sold_date_sk=[$3], -=[-($2, $1)])
                          HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($3))])
                            HiveProject(ss_customer_sk=[$2], ss_ext_discount_amt=[$13], ss_ext_list_price=[$16], ss_sold_date_sk=[$22])
                              HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                        HiveProject(d_date_sk=[$0])
                          HiveFilter(condition=[=($1, 1999)])
                            HiveProject(d_date_sk=[$0], d_year=[$6])
                              HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                      HiveProject(c_customer_sk=[$0], c_customer_id=[$1])
                        HiveTableScan(table=[[default, customer]], table:alias=[customer])
            HiveProject(c_customer_id=[$0], $f1=[$1])
              HiveAggregate(group=[{5}], agg#0=[sum($2)])
                HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(ws_bill_customer_sk=[$0], ws_sold_date_sk=[$3], -=[-($2, $1)])
                      HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($3))])
                        HiveProject(ws_bill_customer_sk=[$3], ws_ext_discount_amt=[$21], ws_ext_list_price=[$24], ws_sold_date_sk=[$33])
                          HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                    HiveProject(d_date_sk=[$0])
                      HiveFilter(condition=[=($1, 2000)])
                        HiveProject(d_date_sk=[$0], d_year=[$6])
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                  HiveProject(c_customer_sk=[$0], c_customer_id=[$1])
                    HiveTableScan(table=[[default, customer]], table:alias=[customer])
          HiveProject(customer_id=[$0], year_total=[$1], >=[>($1, 0:DECIMAL(1, 0))])
            HiveFilter(condition=[>($1, 0:DECIMAL(1, 0))])
              HiveAggregate(group=[{5}], agg#0=[sum($2)])
                HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(ws_bill_customer_sk=[$0], ws_sold_date_sk=[$3], -=[-($2, $1)])
                      HiveFilter(condition=[AND(IS NOT NULL($0), IS NOT NULL($3))])
                        HiveProject(ws_bill_customer_sk=[$3], ws_ext_discount_amt=[$21], ws_ext_list_price=[$24], ws_sold_date_sk=[$33])
                          HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                    HiveProject(d_date_sk=[$0])
                      HiveFilter(condition=[=($1, 1999)])
                        HiveProject(d_date_sk=[$0], d_year=[$6])
                          HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                  HiveProject(c_customer_sk=[$0], c_customer_id=[$1])
                    HiveTableScan(table=[[default, customer]], table:alias=[customer])
      HiveProject(c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9], c_birth_country=[$14])
        HiveTableScan(table=[[default, customer]], table:alias=[customer])

