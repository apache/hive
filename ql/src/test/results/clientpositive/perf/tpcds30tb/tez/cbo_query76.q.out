CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], fetch=[100])
  HiveProject($f0=[$0], $f1=[$1], d_year=[$2], d_qoy=[$3], i_category=[$4], $f5=[$5], $f6=[$6])
    HiveAggregate(group=[{0, 1, 2, 3, 4}], agg#0=[count()], agg#1=[sum($5)])
      HiveProject($f0=[$0], $f1=[$1], d_year=[$2], d_qoy=[$3], i_category=[$4], ss_ext_sales_price=[$5])
        HiveUnion(all=[true])
          HiveProject($f0=[_UTF-16LE'store':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], $f1=[_UTF-16LE'ss_addr_sk':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], d_year=[$1], d_qoy=[$2], i_category=[$4], ss_ext_sales_price=[$6])
            HiveJoin(condition=[=($7, $0)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(d_date_sk=[$0], d_year=[$6], d_qoy=[$10])
                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
              HiveJoin(condition=[=($2, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(i_item_sk=[$0], i_category=[$12])
                  HiveTableSpool(readType=[LAZY], writeType=[LAZY], table=[[cte, cte_suggestion_0]])
                    HiveProject(i_item_sk=[$0], i_item_id=[$1], i_rec_start_date=[$2], i_rec_end_date=[$3], i_item_desc=[$4], i_current_price=[$5], i_wholesale_cost=[$6], i_brand_id=[$7], i_brand=[$8], i_class_id=[$9], i_class=[$10], i_category_id=[$11], i_category=[$12], i_manufact_id=[$13], i_manufact=[$14], i_size=[$15], i_formulation=[$16], i_color=[$17], i_units=[$18], i_container=[$19], i_manager_id=[$20], i_product_name=[$21], BLOCK__OFFSET__INSIDE__FILE=[$22], INPUT__FILE__NAME=[$23], ROW__ID=[$24], ROW__IS__DELETED=[$25])
                      HiveTableScan(table=[[default, item]], table:alias=[item])
                HiveProject(ss_item_sk=[$1], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
                  HiveFilter(condition=[AND(IS NULL($5), IS NOT NULL($22))])
                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
          HiveProject(channel=[_UTF-16LE'web':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], col_name=[_UTF-16LE'ws_web_page_sk':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], d_year=[$4], d_qoy=[$5], i_category=[$7], ext_sales_price=[$1])
            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(ws_item_sk=[$2], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33])
                  HiveFilter(condition=[AND(IS NULL($11), IS NOT NULL($33))])
                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                HiveProject(d_date_sk=[$0], d_year=[$6], d_qoy=[$10])
                  HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
              HiveProject(i_item_sk=[$0], i_category=[$12])
                HiveTableScan(table=[[default, item]], table:alias=[item])
          HiveProject($f0=[_UTF-16LE'catalog':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], $f1=[_UTF-16LE'cs_warehouse_sk':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], d_year=[$6], d_qoy=[$7], i_category=[$4], cs_ext_sales_price=[$1])
            HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(cs_item_sk=[$14], cs_ext_sales_price=[$22], cs_sold_date_sk=[$33])
                  HiveFilter(condition=[AND(IS NULL($13), IS NOT NULL($33))])
                    HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                HiveProject(i_item_sk=[$0], i_category=[$12])
                  HiveTableScan(table=[[cte, cte_suggestion_0]], table:alias=[cte_suggestion_0])
              HiveProject(d_date_sk=[$0], d_year=[$6], d_qoy=[$10])
                HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

