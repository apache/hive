CBO PLAN:
HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], fetch=[100])
  HiveProject($f0=[$0], $f1=[$1], d_year=[$2], d_qoy=[$3], i_category=[$4], $f5=[$5], $f6=[$6])
    HiveAggregate(group=[{0, 1, 2, 3, 4}], agg#0=[count()], agg#1=[sum($5)])
      HiveProject($f0=[$0], $f1=[$1], d_year=[$2], d_qoy=[$3], i_category=[$4], ss_ext_sales_price=[$5])
        HiveUnion(all=[true])
          HiveProject($f0=[_UTF-16LE'store':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], $f1=[_UTF-16LE'ss_addr_sk':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], d_year=[$3], d_qoy=[$4], i_category=[$1], ss_ext_sales_price=[$6])
            HiveJoin(condition=[=($5, $0)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(i_item_sk=[$0], i_category=[$12])
                HiveTableScan(table=[[default, item]], table:alias=[item])
              HiveJoin(condition=[=($5, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(d_date_sk=[$0], d_year=[$6], d_qoy=[$10])
                  HiveTableSpool(readType=[LAZY], writeType=[LAZY], table=[[cte, cte_suggestion_0]])
                    HiveProject(d_date_sk=[$0], d_date_id=[$1], d_date=[$2], d_month_seq=[$3], d_week_seq=[$4], d_quarter_seq=[$5], d_year=[$6], d_dow=[$7], d_moy=[$8], d_dom=[$9], d_qoy=[$10], d_fy_year=[$11], d_fy_quarter_seq=[$12], d_fy_week_seq=[$13], d_day_name=[$14], d_quarter_name=[$15], d_holiday=[$16], d_weekend=[$17], d_following_holiday=[$18], d_first_dom=[$19], d_last_dom=[$20], d_same_day_ly=[$21], d_same_day_lq=[$22], d_current_day=[$23], d_current_week=[$24], d_current_month=[$25], d_current_quarter=[$26], d_current_year=[$27], BLOCK__OFFSET__INSIDE__FILE=[$28], INPUT__FILE__NAME=[$29], ROW__ID=[$30], ROW__IS__DELETED=[$31])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                HiveProject(ss_item_sk=[$1], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
                  HiveFilter(condition=[AND(IS NULL($5), IS NOT NULL($22))])
                    HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
          HiveProject($f0=[_UTF-16LE'web':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], $f1=[_UTF-16LE'ws_web_page_sk':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], d_year=[$4], d_qoy=[$5], i_category=[$7], ws_ext_sales_price=[$1])
            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(ws_item_sk=[$2], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33])
                  HiveFilter(condition=[AND(IS NULL($11), IS NOT NULL($33))])
                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                HiveProject(d_date_sk=[$0], d_year=[$6], d_qoy=[$10])
                  HiveTableScan(table=[[cte, cte_suggestion_0]], table:alias=[cte_suggestion_0])
              HiveProject(i_item_sk=[$0], i_category=[$12])
                HiveTableScan(table=[[default, item]], table:alias=[item])
          HiveProject($f0=[_UTF-16LE'catalog':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], $f1=[_UTF-16LE'cs_warehouse_sk':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], d_year=[$4], d_qoy=[$5], i_category=[$7], cs_ext_sales_price=[$1])
            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(cs_item_sk=[$14], cs_ext_sales_price=[$22], cs_sold_date_sk=[$33])
                  HiveFilter(condition=[AND(IS NULL($13), IS NOT NULL($33))])
                    HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                HiveProject(d_date_sk=[$0], d_year=[$6], d_qoy=[$10])
                  HiveTableScan(table=[[cte, cte_suggestion_0]], table:alias=[cte_suggestion_0])
              HiveProject(i_item_sk=[$0], i_category=[$12])
                HiveTableScan(table=[[default, item]], table:alias=[item])

