CTE Suggestion 0:HiveProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], year=[$3], year_total=[$4], sale_type=[$5])
  HiveUnion(all=[true])
    HiveProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], year=[$3], year_total=[$4], sale_type=[_UTF-16LE's':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"])
      HiveAggregate(group=[{0, 1, 2, 3}], agg#0=[sum($4)])
        HiveProject($f0=[$1], $f1=[$8], $f2=[$9], $f3=[$55], $f4=[$41])
          HiveFilter(condition=[AND(=($0, $24), =($44, $49), OR(=($55, CAST(1998):INTEGER), =($55, +(1998, 1))))])
            HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                HiveTableScan(table=[[default, customer]], table:alias=[customer])
                HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
              HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
    HiveProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2], year=[$3], year_total=[$4], sale_type=[_UTF-16LE'w':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"])
      HiveAggregate(group=[{0, 1, 2, 3}], agg#0=[sum($4)])
        HiveProject($f0=[$1], $f1=[$8], $f2=[$9], $f3=[$66], $f4=[$50])
          HiveFilter(condition=[AND(=($0, $25), =($55, $60), OR(=($66, CAST(1998):INTEGER), =($66, +(1998, 1))))])
            HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
                HiveTableScan(table=[[default, customer]], table:alias=[customer])
                HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
              HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveSortLimit(sort0=[$2], sort1=[$0], sort2=[$1], dir0=[ASC], dir1=[ASC], dir2=[ASC], fetch=[100])
  HiveProject(customer_id=[$0], customer_first_name=[$1], customer_last_name=[$2])
    HiveJoin(condition=[AND(CASE($6, CASE($11, >(/($8, $10), /($3, $5)), false), false), =($0, $9))], joinType=[inner], algorithm=[none], cost=[not available])
      HiveJoin(condition=[=($0, $7)], joinType=[inner], algorithm=[none], cost=[not available])
        HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[not available])
          HiveProject(c_customer_id=[$0], c_first_name=[$1], c_last_name=[$2], $f3=[$3])
            HiveAggregate(group=[{5, 6, 7}], agg#0=[sum($1)])
              HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveProject(ss_customer_sk=[$2], ss_net_paid=[$19], ss_sold_date_sk=[$22])
                    HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))])
                      HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                  HiveProject(d_date_sk=[$0])
                    HiveFilter(condition=[=($6, 1999)])
                      HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9])
                  HiveTableScan(table=[[default, customer]], table:alias=[customer])
          HiveProject(customer_id=[$0], year_total=[$1], >=[>($1, 0:DECIMAL(1, 0))])
            HiveFilter(condition=[>($1, 0:DECIMAL(1, 0))])
              HiveAggregate(group=[{5}], agg#0=[sum($1)])
                HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(ss_customer_sk=[$2], ss_net_paid=[$19], ss_sold_date_sk=[$22])
                      HiveFilter(condition=[AND(IS NOT NULL($2), IS NOT NULL($22))])
                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                    HiveProject(d_date_sk=[$0])
                      HiveFilter(condition=[=($6, 1998)])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                  HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9])
                    HiveTableScan(table=[[default, customer]], table:alias=[customer])
        HiveProject(c_customer_id=[$0], $f1=[$1])
          HiveAggregate(group=[{5}], agg#0=[sum($1)])
            HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(ws_bill_customer_sk=[$3], ws_net_paid=[$28], ws_sold_date_sk=[$33])
                  HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))])
                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                HiveProject(d_date_sk=[$0])
                  HiveFilter(condition=[=($6, 1999)])
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
              HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9])
                HiveTableScan(table=[[default, customer]], table:alias=[customer])
      HiveProject(customer_id=[$0], year_total=[$1], >=[>($1, 0:DECIMAL(1, 0))])
        HiveFilter(condition=[>($1, 0:DECIMAL(1, 0))])
          HiveAggregate(group=[{5}], agg#0=[sum($1)])
            HiveJoin(condition=[=($4, $0)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveJoin(condition=[=($2, $3)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveProject(ws_bill_customer_sk=[$3], ws_net_paid=[$28], ws_sold_date_sk=[$33])
                  HiveFilter(condition=[AND(IS NOT NULL($3), IS NOT NULL($33))])
                    HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                HiveProject(d_date_sk=[$0])
                  HiveFilter(condition=[=($6, 1998)])
                    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
              HiveProject(c_customer_sk=[$0], c_customer_id=[$1], c_first_name=[$8], c_last_name=[$9])
                HiveTableScan(table=[[default, customer]], table:alias=[customer])

