CTE Suggestion:
HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
  HiveProject(i_item_sk=[$0], i_manufact_id=[$13])
    HiveFilter(condition=[IS NOT NULL($13)])
      HiveTableScan(table=[[default, item]], table:alias=[item])
  HiveAggregate(group=[{13}])
    HiveFilter(condition=[AND(=($12, _UTF-16LE'Books                                             '), IS NOT NULL($13))])
      HiveTableScan(table=[[default, item]], table:alias=[item])

CTE Suggestion:
HiveProject(ca_address_sk=[$0])
  HiveFilter(condition=[=($11, -6:DECIMAL(1, 0))])
    HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])

CTE Suggestion:
HiveProject(d_date_sk=[$0])
  HiveFilter(condition=[AND(=($6, 1999), =($8, 3))])
    HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])

CBO PLAN:
HiveSortLimit(sort0=[$1], dir0=[ASC], fetch=[100])
  HiveProject(i_manufact_id=[$0], $f1=[$1])
    HiveAggregate(group=[{0}], agg#0=[sum($1)])
      HiveProject(i_manufact_id=[$0], $f1=[$1])
        HiveUnion(all=[true])
          HiveProject(i_manufact_id=[$0], $f1=[$1])
            HiveAggregate(group=[{7}], agg#0=[sum($2)])
              HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($1, $5)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(ss_item_sk=[$1], ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
                      HiveFilter(condition=[AND(IS NOT NULL($5), IS NOT NULL($22))])
                        HiveTableScan(table=[[default, store_sales]], table:alias=[store_sales])
                    HiveProject(d_date_sk=[$0])
                      HiveFilter(condition=[AND(=($6, 1999), =($8, 3))])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                  HiveProject(ca_address_sk=[$0])
                    HiveFilter(condition=[=($11, -6:DECIMAL(1, 0))])
                      HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])
                HiveProject(i_item_sk=[$0], i_manufact_id=[$1], i_manufact_id0=[$2])
                  HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(i_item_sk=[$0], i_manufact_id=[$13])
                      HiveFilter(condition=[IS NOT NULL($13)])
                        HiveTableScan(table=[[default, item]], table:alias=[item])
                    HiveProject(i_manufact_id=[$0])
                      HiveAggregate(group=[{13}])
                        HiveFilter(condition=[AND(=($12, _UTF-16LE'Books                                             '), IS NOT NULL($13))])
                          HiveTableScan(table=[[default, item]], table:alias=[item])
          HiveProject(i_manufact_id=[$0], $f1=[$1])
            HiveAggregate(group=[{7}], agg#0=[sum($2)])
              HiveJoin(condition=[=($1, $6)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($0, $5)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(cs_bill_addr_sk=[$5], cs_item_sk=[$14], cs_ext_sales_price=[$22], cs_sold_date_sk=[$33])
                      HiveFilter(condition=[AND(IS NOT NULL($5), IS NOT NULL($33))])
                        HiveTableScan(table=[[default, catalog_sales]], table:alias=[catalog_sales])
                    HiveProject(d_date_sk=[$0])
                      HiveFilter(condition=[AND(=($6, 1999), =($8, 3))])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                  HiveProject(ca_address_sk=[$0])
                    HiveFilter(condition=[=($11, -6:DECIMAL(1, 0))])
                      HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])
                HiveProject(i_item_sk=[$0], i_manufact_id=[$1], i_manufact_id0=[$2])
                  HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(i_item_sk=[$0], i_manufact_id=[$13])
                      HiveFilter(condition=[IS NOT NULL($13)])
                        HiveTableScan(table=[[default, item]], table:alias=[item])
                    HiveProject(i_manufact_id=[$0])
                      HiveAggregate(group=[{13}])
                        HiveFilter(condition=[AND(=($12, _UTF-16LE'Books                                             '), IS NOT NULL($13))])
                          HiveTableScan(table=[[default, item]], table:alias=[item])
          HiveProject(i_manufact_id=[$0], $f1=[$1])
            HiveAggregate(group=[{7}], agg#0=[sum($2)])
              HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[not available])
                HiveJoin(condition=[=($1, $5)], joinType=[inner], algorithm=[none], cost=[not available])
                  HiveJoin(condition=[=($3, $4)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(ws_item_sk=[$2], ws_bill_addr_sk=[$6], ws_ext_sales_price=[$22], ws_sold_date_sk=[$33])
                      HiveFilter(condition=[AND(IS NOT NULL($6), IS NOT NULL($33))])
                        HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
                    HiveProject(d_date_sk=[$0])
                      HiveFilter(condition=[AND(=($6, 1999), =($8, 3))])
                        HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                  HiveProject(ca_address_sk=[$0])
                    HiveFilter(condition=[=($11, -6:DECIMAL(1, 0))])
                      HiveTableScan(table=[[default, customer_address]], table:alias=[customer_address])
                HiveProject(i_item_sk=[$0], i_manufact_id=[$1], i_manufact_id0=[$2])
                  HiveJoin(condition=[=($1, $2)], joinType=[inner], algorithm=[none], cost=[not available])
                    HiveProject(i_item_sk=[$0], i_manufact_id=[$13])
                      HiveFilter(condition=[IS NOT NULL($13)])
                        HiveTableScan(table=[[default, item]], table:alias=[item])
                    HiveProject(i_manufact_id=[$0])
                      HiveAggregate(group=[{13}])
                        HiveFilter(condition=[AND(=($12, _UTF-16LE'Books                                             '), IS NOT NULL($13))])
                          HiveTableScan(table=[[default, item]], table:alias=[item])

