CBO PLAN:
HiveAggregate(group=[{}], agg#0=[sum($2)])
  HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(d_date_sk=[$0])
      HiveTableSpool(readType=[LAZY], writeType=[LAZY], table=[[cte, cte_suggestion_0]])
        HiveProject(d_date_sk=[$0], d_date_id=[$1], d_date=[$2], d_month_seq=[$3], d_week_seq=[$4], d_quarter_seq=[$5], d_year=[$6], d_dow=[$7], d_moy=[$8], d_dom=[$9], d_qoy=[$10], d_fy_year=[$11], d_fy_quarter_seq=[$12], d_fy_week_seq=[$13], d_day_name=[$14], d_quarter_name=[$15], d_holiday=[$16], d_weekend=[$17], d_following_holiday=[$18], d_first_dom=[$19], d_last_dom=[$20], d_same_day_ly=[$21], d_same_day_lq=[$22], d_current_day=[$23], d_current_week=[$24], d_current_month=[$25], d_current_quarter=[$26], d_current_year=[$27], BLOCK__OFFSET__INSIDE__FILE=[$28], INPUT__FILE__NAME=[$29], ROW__ID=[$30], ROW__IS__DELETED=[$31])
          HiveFilter(condition=[BETWEEN(false, CAST($2):TIMESTAMP(9), 1998-03-18 00:00:00:TIMESTAMP(9), 1998-06-16 00:00:00:TIMESTAMP(9))])
            HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
    HiveJoin(condition=[AND(=($5, $3), >($1, $4))], joinType=[inner], algorithm=[none], cost=[not available])
      HiveJoin(condition=[=($3, $0)], joinType=[inner], algorithm=[none], cost=[not available])
        HiveProject(ws_item_sk=[$2], ws_ext_discount_amt=[$21], ws_sold_date_sk=[$33])
          HiveFilter(condition=[AND(IS NOT NULL($21), IS NOT NULL($33))])
            HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
        HiveProject(i_item_sk=[$0])
          HiveFilter(condition=[=($13, 269)])
            HiveTableScan(table=[[default, item]], table:alias=[item])
      HiveProject(_o__c0=[*(1.3:DECIMAL(2, 1), CAST(/($1, $2)):DECIMAL(11, 6))], ws_item_sk=[$0])
        HiveFilter(condition=[IS NOT NULL(CAST(/($1, $2)):DECIMAL(11, 6))])
          HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[count($1)])
            HiveJoin(condition=[=($3, $2)], joinType=[inner], algorithm=[none], cost=[not available])
              HiveProject(ws_item_sk=[$2], ws_ext_discount_amt=[$21], ws_sold_date_sk=[$33])
                HiveFilter(condition=[IS NOT NULL($33)])
                  HiveTableScan(table=[[default, web_sales]], table:alias=[web_sales])
              HiveProject(d_date_sk=[$0])
                HiveTableScan(table=[[cte, cte_suggestion_0]], table:alias=[cte_suggestion_0])

