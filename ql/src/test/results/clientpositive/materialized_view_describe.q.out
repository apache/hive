PREHOOK: query: create table cmv_basetable (a int, b varchar(256), c decimal(10,2))
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@cmv_basetable
POSTHOOK: query: create table cmv_basetable (a int, b varchar(256), c decimal(10,2))
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@cmv_basetable
PREHOOK: query: insert into cmv_basetable values (1, 'alfred', 10.30),(2, 'bob', 3.14),(2, 'bonnie', 172342.2),(3, 'calvin', 978.76),(3, 'charlie', 9.8)
PREHOOK: type: QUERY
PREHOOK: Input: default@values__tmp__table__1
PREHOOK: Output: default@cmv_basetable
POSTHOOK: query: insert into cmv_basetable values (1, 'alfred', 10.30),(2, 'bob', 3.14),(2, 'bonnie', 172342.2),(3, 'calvin', 978.76),(3, 'charlie', 9.8)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@values__tmp__table__1
POSTHOOK: Output: default@cmv_basetable
POSTHOOK: Lineage: cmv_basetable.a EXPRESSION [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col1, type:string, comment:), ]
POSTHOOK: Lineage: cmv_basetable.b EXPRESSION [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col2, type:string, comment:), ]
POSTHOOK: Lineage: cmv_basetable.c EXPRESSION [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col3, type:string, comment:), ]
PREHOOK: query: create materialized view cmv_mat_view
comment 'this is the first view'
tblproperties ('key'='foo') as select a, c from cmv_basetable
PREHOOK: type: CREATE_MATERIALIZED_VIEW
PREHOOK: Input: default@cmv_basetable
PREHOOK: Output: database:default
PREHOOK: Output: default@cmv_mat_view
POSTHOOK: query: create materialized view cmv_mat_view
comment 'this is the first view'
tblproperties ('key'='foo') as select a, c from cmv_basetable
POSTHOOK: type: CREATE_MATERIALIZED_VIEW
POSTHOOK: Input: default@cmv_basetable
POSTHOOK: Output: database:default
POSTHOOK: Output: default@cmv_mat_view
PREHOOK: query: describe cmv_mat_view
PREHOOK: type: DESCTABLE
PREHOOK: Input: default@cmv_mat_view
POSTHOOK: query: describe cmv_mat_view
POSTHOOK: type: DESCTABLE
POSTHOOK: Input: default@cmv_mat_view
a                   	int                 	                    
c                   	decimal(10,2)       	                    
PREHOOK: query: describe extended cmv_mat_view
PREHOOK: type: DESCTABLE
PREHOOK: Input: default@cmv_mat_view
POSTHOOK: query: describe extended cmv_mat_view
POSTHOOK: type: DESCTABLE
POSTHOOK: Input: default@cmv_mat_view
a                   	int                 	                    
c                   	decimal(10,2)       	                    
	 	 
#### A masked pattern was here ####
PREHOOK: query: describe formatted cmv_mat_view
PREHOOK: type: DESCTABLE
PREHOOK: Input: default@cmv_mat_view
POSTHOOK: query: describe formatted cmv_mat_view
POSTHOOK: type: DESCTABLE
POSTHOOK: Input: default@cmv_mat_view
# col_name            	data_type           	comment             
	 	 
a                   	int                 	                    
c                   	decimal(10,2)       	                    
	 	 
# Detailed Table Information	 	 
Database:           	default             	 
#### A masked pattern was here ####
Retention:          	0                   	 
#### A masked pattern was here ####
Table Type:         	MATERIALIZED_VIEW   	 
Table Parameters:	 	 
	comment             	this is the first view
	key                 	foo                 
	numFiles            	1                   
	totalSize           	346                 
#### A masked pattern was here ####
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.ql.io.orc.OrcSerde	 
InputFormat:        	org.apache.hadoop.hive.ql.io.orc.OrcInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
PREHOOK: query: show tblproperties cmv_mat_view
PREHOOK: type: SHOW_TBLPROPERTIES
POSTHOOK: query: show tblproperties cmv_mat_view
POSTHOOK: type: SHOW_TBLPROPERTIES
comment	this is the first view
key	foo
numFiles	1
totalSize	346
#### A masked pattern was here ####
PREHOOK: query: select a, c from cmv_mat_view
PREHOOK: type: QUERY
PREHOOK: Input: default@cmv_mat_view
#### A masked pattern was here ####
POSTHOOK: query: select a, c from cmv_mat_view
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cmv_mat_view
#### A masked pattern was here ####
1	10.30
2	3.14
2	172342.20
3	978.76
3	9.80
PREHOOK: query: drop materialized view cmv_mat_view
PREHOOK: type: DROP_MATERIALIZED_VIEW
PREHOOK: Input: default@cmv_mat_view
PREHOOK: Output: default@cmv_mat_view
POSTHOOK: query: drop materialized view cmv_mat_view
POSTHOOK: type: DROP_MATERIALIZED_VIEW
POSTHOOK: Input: default@cmv_mat_view
POSTHOOK: Output: default@cmv_mat_view
PREHOOK: query: create materialized view cmv_mat_view2
comment 'this is the second view'
stored as textfile
tblproperties ('key'='alice','key2'='bob') as select a from cmv_basetable
PREHOOK: type: CREATE_MATERIALIZED_VIEW
PREHOOK: Input: default@cmv_basetable
PREHOOK: Output: database:default
PREHOOK: Output: default@cmv_mat_view2
POSTHOOK: query: create materialized view cmv_mat_view2
comment 'this is the second view'
stored as textfile
tblproperties ('key'='alice','key2'='bob') as select a from cmv_basetable
POSTHOOK: type: CREATE_MATERIALIZED_VIEW
POSTHOOK: Input: default@cmv_basetable
POSTHOOK: Output: database:default
POSTHOOK: Output: default@cmv_mat_view2
PREHOOK: query: describe formatted cmv_mat_view2
PREHOOK: type: DESCTABLE
PREHOOK: Input: default@cmv_mat_view2
POSTHOOK: query: describe formatted cmv_mat_view2
POSTHOOK: type: DESCTABLE
POSTHOOK: Input: default@cmv_mat_view2
# col_name            	data_type           	comment             
	 	 
a                   	int                 	                    
	 	 
# Detailed Table Information	 	 
Database:           	default             	 
#### A masked pattern was here ####
Retention:          	0                   	 
#### A masked pattern was here ####
Table Type:         	MATERIALIZED_VIEW   	 
Table Parameters:	 	 
	comment             	this is the second view
	key                 	alice               
	key2                	bob                 
	numFiles            	1                   
	totalSize           	10                  
#### A masked pattern was here ####
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe	 
InputFormat:        	org.apache.hadoop.mapred.TextInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
PREHOOK: query: select a from cmv_mat_view2
PREHOOK: type: QUERY
PREHOOK: Input: default@cmv_mat_view2
#### A masked pattern was here ####
POSTHOOK: query: select a from cmv_mat_view2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cmv_mat_view2
#### A masked pattern was here ####
1
2
2
3
3
PREHOOK: query: drop materialized view cmv_mat_view2
PREHOOK: type: DROP_MATERIALIZED_VIEW
PREHOOK: Input: default@cmv_mat_view2
PREHOOK: Output: default@cmv_mat_view2
POSTHOOK: query: drop materialized view cmv_mat_view2
POSTHOOK: type: DROP_MATERIALIZED_VIEW
POSTHOOK: Input: default@cmv_mat_view2
POSTHOOK: Output: default@cmv_mat_view2
PREHOOK: query: create materialized view cmv_mat_view3
comment 'this is the third view'
row format
  delimited fields terminated by '\t'
as select * from cmv_basetable
PREHOOK: type: CREATE_MATERIALIZED_VIEW
PREHOOK: Input: default@cmv_basetable
PREHOOK: Output: database:default
PREHOOK: Output: default@cmv_mat_view3
POSTHOOK: query: create materialized view cmv_mat_view3
comment 'this is the third view'
row format
  delimited fields terminated by '\t'
as select * from cmv_basetable
POSTHOOK: type: CREATE_MATERIALIZED_VIEW
POSTHOOK: Input: default@cmv_basetable
POSTHOOK: Output: database:default
POSTHOOK: Output: default@cmv_mat_view3
PREHOOK: query: describe formatted cmv_mat_view3
PREHOOK: type: DESCTABLE
PREHOOK: Input: default@cmv_mat_view3
POSTHOOK: query: describe formatted cmv_mat_view3
POSTHOOK: type: DESCTABLE
POSTHOOK: Input: default@cmv_mat_view3
# col_name            	data_type           	comment             
	 	 
a                   	int                 	                    
b                   	varchar(256)        	                    
c                   	decimal(10,2)       	                    
	 	 
# Detailed Table Information	 	 
Database:           	default             	 
#### A masked pattern was here ####
Retention:          	0                   	 
#### A masked pattern was here ####
Table Type:         	MATERIALIZED_VIEW   	 
Table Parameters:	 	 
	comment             	this is the third view
	numFiles            	1                   
	totalSize           	497                 
#### A masked pattern was here ####
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.ql.io.orc.OrcSerde	 
InputFormat:        	org.apache.hadoop.hive.ql.io.orc.OrcInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
PREHOOK: query: select a, b, c from cmv_mat_view3
PREHOOK: type: QUERY
PREHOOK: Input: default@cmv_mat_view3
#### A masked pattern was here ####
POSTHOOK: query: select a, b, c from cmv_mat_view3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cmv_mat_view3
#### A masked pattern was here ####
1	alfred	10.30
2	bob	3.14
2	bonnie	172342.20
3	calvin	978.76
3	charlie	9.80
PREHOOK: query: select distinct a from cmv_mat_view3
PREHOOK: type: QUERY
PREHOOK: Input: default@cmv_mat_view3
#### A masked pattern was here ####
POSTHOOK: query: select distinct a from cmv_mat_view3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cmv_mat_view3
#### A masked pattern was here ####
1
2
3
PREHOOK: query: drop materialized view cmv_mat_view3
PREHOOK: type: DROP_MATERIALIZED_VIEW
PREHOOK: Input: default@cmv_mat_view3
PREHOOK: Output: default@cmv_mat_view3
POSTHOOK: query: drop materialized view cmv_mat_view3
POSTHOOK: type: DROP_MATERIALIZED_VIEW
POSTHOOK: Input: default@cmv_mat_view3
POSTHOOK: Output: default@cmv_mat_view3
PREHOOK: query: create materialized view cmv_mat_view4
comment 'this is the last view'
stored as textfile
#### A masked pattern was here ####
as select a from cmv_basetable
PREHOOK: type: CREATE_MATERIALIZED_VIEW
PREHOOK: Input: default@cmv_basetable
#### A masked pattern was here ####
PREHOOK: Output: database:default
PREHOOK: Output: default@cmv_mat_view4
POSTHOOK: query: create materialized view cmv_mat_view4
comment 'this is the last view'
stored as textfile
#### A masked pattern was here ####
as select a from cmv_basetable
POSTHOOK: type: CREATE_MATERIALIZED_VIEW
POSTHOOK: Input: default@cmv_basetable
#### A masked pattern was here ####
POSTHOOK: Output: database:default
POSTHOOK: Output: default@cmv_mat_view4
PREHOOK: query: describe formatted cmv_mat_view4
PREHOOK: type: DESCTABLE
PREHOOK: Input: default@cmv_mat_view4
POSTHOOK: query: describe formatted cmv_mat_view4
POSTHOOK: type: DESCTABLE
POSTHOOK: Input: default@cmv_mat_view4
# col_name            	data_type           	comment             
	 	 
a                   	int                 	                    
	 	 
# Detailed Table Information	 	 
Database:           	default             	 
#### A masked pattern was here ####
Retention:          	0                   	 
#### A masked pattern was here ####
Table Type:         	MATERIALIZED_VIEW   	 
Table Parameters:	 	 
	comment             	this is the last view
	numFiles            	1                   
	totalSize           	10                  
#### A masked pattern was here ####
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe	 
InputFormat:        	org.apache.hadoop.mapred.TextInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
PREHOOK: query: select a from cmv_mat_view4
PREHOOK: type: QUERY
PREHOOK: Input: default@cmv_mat_view4
#### A masked pattern was here ####
POSTHOOK: query: select a from cmv_mat_view4
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cmv_mat_view4
#### A masked pattern was here ####
1
2
2
3
3
PREHOOK: query: drop materialized view cmv_mat_view4
PREHOOK: type: DROP_MATERIALIZED_VIEW
PREHOOK: Input: default@cmv_mat_view4
PREHOOK: Output: default@cmv_mat_view4
POSTHOOK: query: drop materialized view cmv_mat_view4
POSTHOOK: type: DROP_MATERIALIZED_VIEW
POSTHOOK: Input: default@cmv_mat_view4
POSTHOOK: Output: default@cmv_mat_view4
