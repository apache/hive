PREHOOK: query: create table sorted_mod_4 stored as orc
as select ctinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
order by ctinyint
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@sorted_mod_4
POSTHOOK: query: create table sorted_mod_4 stored as orc
as select ctinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
order by ctinyint
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@sorted_mod_4
POSTHOOK: Lineage: sorted_mod_4.cmodint EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
POSTHOOK: Lineage: sorted_mod_4.ctinyint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
PREHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: default@sorted_mod_4
POSTHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: default@sorted_mod_4
PREHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
PREHOOK: query: create table small_table stored
as orc as select ctinyint, cbigint from alltypesorc limit 100
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@small_table
POSTHOOK: query: create table small_table stored
as orc as select ctinyint, cbigint from alltypesorc limit 100
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@small_table
POSTHOOK: Lineage: small_table.cbigint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cbigint, type:bigint, comment:null), ]
POSTHOOK: Lineage: small_table.ctinyint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
PREHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Output: default@small_table
POSTHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Output: default@small_table
PREHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@small_table
PREHOOK: Output: default@small_table
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@small_table
POSTHOOK: Output: default@small_table
POSTHOOK: Output: hdfs://### HDFS PATH ###
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
{"CBOPlan":"###Masked###","optimizedSQL":"SELECT COUNT(*) AS `$f0`\nFROM (SELECT `ctinyint`\nFROM `default`.`sorted_mod_4`) AS `t`\nLEFT JOIN (SELECT `ctinyint`\nFROM `default`.`small_table`\nWHERE `ctinyint` IS NOT NULL) AS `t1` ON `t`.`ctinyint` = `t1`.`ctinyint`","PLAN VECTORIZATION":{"enabled":true,"enabledConditionsMet":["hive.vectorized.execution.enabled IS true"]},"cboInfo":"Plan optimized by CBO.","STAGE DEPENDENCIES":{"Stage-2":{"ROOT STAGE":"TRUE"},"Stage-1":{"DEPENDENT STAGES":"Stage-2"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-2":{"Spark":{"DagName:":"###Masked###","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"s","columns:":["ctinyint"],"database:":"default","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"sorted_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_0","children":{"Select Operator":{"expressions:":"ctinyint (type: tinyint)","columnExprMap:":{"_col0":"ctinyint"},"outputColumnNames:":["_col0"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0]"},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_19","children":{"Map Join Operator":{"condition map:":[{"":"Left Outer Join 0 to 1"}],"keys:":{"0":"_col0 (type: tinyint)","1":"_col0 (type: tinyint)"},"Map Join Vectorization:":{"bigTableKeyColumns:":["0:tinyint"],"bigTableRetainColumnNums:":"[]","className:":"VectorMapJoinOuterLongOperator","native:":"true","nativeConditionsMet:":["hive.mapjoin.optimized.hashtable IS true","hive.vectorized.execution.mapjoin.native.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","One MapJoin Condition IS true","No nullsafe IS true","Small table vectorizes IS true","Outer Join has keys IS true","Optimized Table and Supports Key Types IS true"],"hashTableImplementationType:":"OPTIMIZED"},"input vertices:":{"1":"Map 3"},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_20","children":{"Group By Operator":{"aggregations:":["count()"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountStar(*) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"HASH","native:":"false","vectorProcessingMode:":"HASH","projectedOutputColumnNums:":"[0]"},"minReductionHashAggr:":"0.99","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_21","children":{"Reduce Output Operator":{"columnExprMap:":{"VALUE._col0":"_col0"},"sort order:":"","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkEmptyKeyOperator","native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"],"valueColumns:":["0:bigint"]},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_22","outputname:":"Reducer 2","outputOperator:":["GBY_23"]}}}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0]","dataColumns:":["ctinyint:tinyint","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Local Work:":{"Map Reduce Local Work":{}}},"Reducer 2":{"Execution mode:":"vectorized","Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"reduceColumnNullOrder:":"","reduceColumnSortOrder:":"","allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"1","dataColumns:":["VALUE._col0:bigint"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountMerge(col 0:bigint) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"MERGEPARTIAL","native:":"false","vectorProcessingMode:":"GLOBAL","projectedOutputColumnNums:":"[0]"},"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_23","children":{"File Output Operator":{"compressed:":"false","File Sink Vectorization:":{"className:":"VectorFileSinkOperator","native:":"false"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_24"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_29"}}}}}}
PREHOOK: query: select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
6876
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
{"CBOPlan":"###Masked###","optimizedSQL":"SELECT COUNT(*) AS `$f0`\nFROM (SELECT `ctinyint`, `cmodint` = 2 AS `=`\nFROM `default`.`sorted_mod_4`) AS `t`\nLEFT JOIN (SELECT `ctinyint`\nFROM `default`.`small_table`\nWHERE `ctinyint` IS NOT NULL) AS `t1` ON `t`.`ctinyint` = `t1`.`ctinyint` AND `t`.`=`","PLAN VECTORIZATION":{"enabled":true,"enabledConditionsMet":["hive.vectorized.execution.enabled IS true"]},"cboInfo":"Plan optimized by CBO.","STAGE DEPENDENCIES":{"Stage-2":{"ROOT STAGE":"TRUE"},"Stage-1":{"DEPENDENT STAGES":"Stage-2"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-2":{"Spark":{"DagName:":"###Masked###","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"s","columns:":["ctinyint","cmodint"],"database:":"default","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"sorted_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_0","children":{"Select Operator":{"expressions:":"ctinyint (type: tinyint), (cmodint = 2) (type: boolean)","columnExprMap:":{"_col0":"ctinyint","_col1":"(cmodint = 2)"},"outputColumnNames:":["_col0","_col1"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0, 3]","selectExpressions:":["LongColEqualLongScalar(col 1:int, val 2) -> 3:boolean"]},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_19","children":{"Map Join Operator":{"condition map:":[{"":"Left Outer Join 0 to 1"}],"filter predicates:":{"0":"{_col1}","1":""},"keys:":{"0":"_col0 (type: tinyint)","1":"_col0 (type: tinyint)"},"Map Join Vectorization:":{"bigTableFilterExpressions:":["SelectColumnIsTrue(col 3:boolean)"],"bigTableKeyColumns:":["0:tinyint"],"bigTableRetainColumnNums:":"[]","className:":"VectorMapJoinOuterLongOperator","native:":"true","nativeConditionsMet:":["hive.mapjoin.optimized.hashtable IS true","hive.vectorized.execution.mapjoin.native.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","One MapJoin Condition IS true","No nullsafe IS true","Small table vectorizes IS true","Outer Join has keys IS true","Optimized Table and Supports Key Types IS true"],"hashTableImplementationType:":"OPTIMIZED"},"input vertices:":{"1":"Map 3"},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_20","children":{"Group By Operator":{"aggregations:":["count()"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountStar(*) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"HASH","native:":"false","vectorProcessingMode:":"HASH","projectedOutputColumnNums:":"[0]"},"minReductionHashAggr:":"0.99","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_21","children":{"Reduce Output Operator":{"columnExprMap:":{"VALUE._col0":"_col0"},"sort order:":"","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkEmptyKeyOperator","native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"],"valueColumns:":["0:bigint"]},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_22","outputname:":"Reducer 2","outputOperator:":["GBY_23"]}}}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0, 1]","dataColumns:":["ctinyint:tinyint","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[bigint]"}},"Local Work:":{"Map Reduce Local Work":{}}},"Reducer 2":{"Execution mode:":"vectorized","Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"reduceColumnNullOrder:":"","reduceColumnSortOrder:":"","allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"1","dataColumns:":["VALUE._col0:bigint"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountMerge(col 0:bigint) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"MERGEPARTIAL","native:":"false","vectorProcessingMode:":"GLOBAL","projectedOutputColumnNums:":"[0]"},"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_23","children":{"File Output Operator":{"compressed:":"false","File Sink Vectorization:":{"className:":"VectorFileSinkOperator","native:":"false"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_24"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_29"}}}}}}
PREHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
6058
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
{"CBOPlan":"###Masked###","optimizedSQL":"SELECT COUNT(*) AS `$f0`\nFROM (SELECT `ctinyint`, PMOD(CAST(`ctinyint` AS INTEGER), 4) = `cmodint` AS `=`\nFROM `default`.`sorted_mod_4`) AS `t`\nLEFT JOIN (SELECT `ctinyint`\nFROM `default`.`small_table`\nWHERE `ctinyint` IS NOT NULL) AS `t1` ON `t`.`ctinyint` = `t1`.`ctinyint` AND `t`.`=`","PLAN VECTORIZATION":{"enabled":true,"enabledConditionsMet":["hive.vectorized.execution.enabled IS true"]},"cboInfo":"Plan optimized by CBO.","STAGE DEPENDENCIES":{"Stage-2":{"ROOT STAGE":"TRUE"},"Stage-1":{"DEPENDENT STAGES":"Stage-2"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-2":{"Spark":{"DagName:":"###Masked###","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"s","columns:":["ctinyint","cmodint"],"database:":"default","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"sorted_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_0","children":{"Select Operator":{"expressions:":"ctinyint (type: tinyint), ((UDFToInteger(ctinyint) pmod 4) = cmodint) (type: boolean)","columnExprMap:":{"_col0":"ctinyint","_col1":"((UDFToInteger(ctinyint) pmod 4) = cmodint)"},"outputColumnNames:":["_col0","_col1"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0, 4]","selectExpressions:":["LongColEqualLongColumn(col 3:int, col 1:int)(children: PosModLongToLong(col 0, divisor 4)(children: col 0:tinyint) -> 3:int) -> 4:boolean"]},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_19","children":{"Map Join Operator":{"condition map:":[{"":"Left Outer Join 0 to 1"}],"filter predicates:":{"0":"{_col1}","1":""},"keys:":{"0":"_col0 (type: tinyint)","1":"_col0 (type: tinyint)"},"Map Join Vectorization:":{"bigTableFilterExpressions:":["SelectColumnIsTrue(col 4:boolean)"],"bigTableKeyColumns:":["0:tinyint"],"bigTableRetainColumnNums:":"[]","className:":"VectorMapJoinOuterLongOperator","native:":"true","nativeConditionsMet:":["hive.mapjoin.optimized.hashtable IS true","hive.vectorized.execution.mapjoin.native.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","One MapJoin Condition IS true","No nullsafe IS true","Small table vectorizes IS true","Outer Join has keys IS true","Optimized Table and Supports Key Types IS true"],"hashTableImplementationType:":"OPTIMIZED"},"input vertices:":{"1":"Map 3"},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_20","children":{"Group By Operator":{"aggregations:":["count()"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountStar(*) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"HASH","native:":"false","vectorProcessingMode:":"HASH","projectedOutputColumnNums:":"[0]"},"minReductionHashAggr:":"0.99","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_21","children":{"Reduce Output Operator":{"columnExprMap:":{"VALUE._col0":"_col0"},"sort order:":"","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkEmptyKeyOperator","native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"],"valueColumns:":["0:bigint"]},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_22","outputname:":"Reducer 2","outputOperator:":["GBY_23"]}}}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0, 1]","dataColumns:":["ctinyint:tinyint","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[bigint, bigint]"}},"Local Work:":{"Map Reduce Local Work":{}}},"Reducer 2":{"Execution mode:":"vectorized","Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"reduceColumnNullOrder:":"","reduceColumnSortOrder:":"","allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"1","dataColumns:":["VALUE._col0:bigint"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountMerge(col 0:bigint) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"MERGEPARTIAL","native:":"false","vectorProcessingMode:":"GLOBAL","projectedOutputColumnNums:":"[0]"},"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_23","children":{"File Output Operator":{"compressed:":"false","File Sink Vectorization:":{"className:":"VectorFileSinkOperator","native:":"false"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_24"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_29"}}}}}}
PREHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
6248
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
{"CBOPlan":"###Masked###","optimizedSQL":"SELECT COUNT(*) AS `$f0`\nFROM (SELECT `ctinyint`, `ctinyint` < 100 AS `<`\nFROM `default`.`sorted_mod_4`) AS `t`\nLEFT JOIN (SELECT `ctinyint`\nFROM `default`.`small_table`\nWHERE `ctinyint` IS NOT NULL) AS `t1` ON `t`.`ctinyint` = `t1`.`ctinyint` AND `t`.`<`","PLAN VECTORIZATION":{"enabled":true,"enabledConditionsMet":["hive.vectorized.execution.enabled IS true"]},"cboInfo":"Plan optimized by CBO.","STAGE DEPENDENCIES":{"Stage-2":{"ROOT STAGE":"TRUE"},"Stage-1":{"DEPENDENT STAGES":"Stage-2"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-2":{"Spark":{"DagName:":"###Masked###","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"s","columns:":["ctinyint"],"database:":"default","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"sorted_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_0","children":{"Select Operator":{"expressions:":"ctinyint (type: tinyint), (ctinyint < 100Y) (type: boolean)","columnExprMap:":{"_col0":"ctinyint","_col1":"(ctinyint < 100Y)"},"outputColumnNames:":["_col0","_col1"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0, 3]","selectExpressions:":["LongColLessLongScalar(col 0:tinyint, val 100) -> 3:boolean"]},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_19","children":{"Map Join Operator":{"condition map:":[{"":"Left Outer Join 0 to 1"}],"filter predicates:":{"0":"{_col1}","1":""},"keys:":{"0":"_col0 (type: tinyint)","1":"_col0 (type: tinyint)"},"Map Join Vectorization:":{"bigTableFilterExpressions:":["SelectColumnIsTrue(col 3:boolean)"],"bigTableKeyColumns:":["0:tinyint"],"bigTableRetainColumnNums:":"[]","className:":"VectorMapJoinOuterLongOperator","native:":"true","nativeConditionsMet:":["hive.mapjoin.optimized.hashtable IS true","hive.vectorized.execution.mapjoin.native.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","One MapJoin Condition IS true","No nullsafe IS true","Small table vectorizes IS true","Outer Join has keys IS true","Optimized Table and Supports Key Types IS true"],"hashTableImplementationType:":"OPTIMIZED"},"input vertices:":{"1":"Map 3"},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_20","children":{"Group By Operator":{"aggregations:":["count()"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountStar(*) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"HASH","native:":"false","vectorProcessingMode:":"HASH","projectedOutputColumnNums:":"[0]"},"minReductionHashAggr:":"0.99","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_21","children":{"Reduce Output Operator":{"columnExprMap:":{"VALUE._col0":"_col0"},"sort order:":"","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkEmptyKeyOperator","native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"],"valueColumns:":["0:bigint"]},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_22","outputname:":"Reducer 2","outputOperator:":["GBY_23"]}}}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0]","dataColumns:":["ctinyint:tinyint","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[bigint]"}},"Local Work:":{"Map Reduce Local Work":{}}},"Reducer 2":{"Execution mode:":"vectorized","Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"reduceColumnNullOrder:":"","reduceColumnSortOrder:":"","allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"1","dataColumns:":["VALUE._col0:bigint"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountMerge(col 0:bigint) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"MERGEPARTIAL","native:":"false","vectorProcessingMode:":"GLOBAL","projectedOutputColumnNums:":"[0]"},"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_23","children":{"File Output Operator":{"compressed:":"false","File Sink Vectorization:":{"className:":"VectorFileSinkOperator","native:":"false"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_24"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_29"}}}}}}
PREHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
6876
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
{"CBOPlan":"###Masked###","optimizedSQL":"SELECT COUNT(*) AS `$f0`\nFROM (SELECT `ctinyint`, CAST(`cmodint` AS BIGINT) AS `CAST`\nFROM `default`.`sorted_mod_4`) AS `t`\nLEFT JOIN (SELECT `cbigint`\nFROM `default`.`small_table`\nWHERE PMOD(`cbigint`, 8) IS NOT NULL) AS `t1` ON PMOD(`t1`.`cbigint`, 8) = `t`.`CAST`\nLEFT JOIN (SELECT `ctinyint`\nFROM `default`.`sorted_mod_4`\nWHERE `ctinyint` IS NOT NULL) AS `t3` ON `t`.`ctinyint` = `t3`.`ctinyint`","PLAN VECTORIZATION":{"enabled":true,"enabledConditionsMet":["hive.vectorized.execution.enabled IS true"]},"cboInfo":"Plan optimized by CBO.","STAGE DEPENDENCIES":{"Stage-2":{"ROOT STAGE":"TRUE"},"Stage-1":{"DEPENDENT STAGES":"Stage-2"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-2":{"Spark":{"DagName:":"###Masked###","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"s","columns:":["ctinyint","cmodint"],"database:":"default","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"sorted_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_0","children":{"Select Operator":{"expressions:":"ctinyint (type: tinyint), UDFToLong(cmodint) (type: bigint)","columnExprMap:":{"_col0":"ctinyint","_col1":"UDFToLong(cmodint)"},"outputColumnNames:":["_col0","_col1"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0, 1]"},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_26","children":{"Map Join Operator":{"columnExprMap:":{"_col0":"0:_col0"},"condition map:":[{"":"Left Outer Join 0 to 1"}],"keys:":{"0":"_col1 (type: bigint)","1":"(_col0 pmod 8L) (type: bigint)"},"Map Join Vectorization:":{"bigTableKeyColumns:":["1:bigint"],"bigTableRetainColumnNums:":"[0]","bigTableValueColumns:":["0:tinyint"],"className:":"VectorMapJoinOuterLongOperator","native:":"true","nativeConditionsMet:":["hive.mapjoin.optimized.hashtable IS true","hive.vectorized.execution.mapjoin.native.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","One MapJoin Condition IS true","No nullsafe IS true","Small table vectorizes IS true","Outer Join has keys IS true","Optimized Table and Supports Key Types IS true"],"projectedOutput:":["0:tinyint"],"hashTableImplementationType:":"OPTIMIZED"},"outputColumnNames:":["_col0"],"input vertices:":{"1":"Map 4"},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_27","children":{"Reduce Output Operator":{"columnExprMap:":{"KEY.reducesinkkey0":"_col0"},"key expressions:":"_col0 (type: tinyint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: tinyint)","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkLongOperator","keyColumns:":["0:tinyint"],"native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"]},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"RS_28","outputname:":"Reducer 2","outputOperator:":["JOIN_13"]}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"true","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0, 1]","dataColumns:":["ctinyint:tinyint","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Local Work:":{"Map Reduce Local Work":{}}},"Map 5":{"Map Operator Tree:":[{"TableScan":{"alias:":"s2","columns:":["ctinyint"],"database:":"default","filterExpr:":"ctinyint is not null (type: boolean)","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"sorted_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_5","children":{"Filter Operator":{"Filter Vectorization:":{"className:":"VectorFilterOperator","native:":"true","predicateExpression:":"SelectColumnIsNotNull(col 0:tinyint)"},"predicate:":"ctinyint is not null (type: boolean)","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"FIL_29","children":{"Select Operator":{"expressions:":"ctinyint (type: tinyint)","columnExprMap:":{"_col0":"ctinyint"},"outputColumnNames:":["_col0"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0]"},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_30","children":{"Reduce Output Operator":{"columnExprMap:":{"KEY.reducesinkkey0":"_col0"},"key expressions:":"_col0 (type: tinyint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: tinyint)","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkLongOperator","keyColumns:":["0:tinyint"],"native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"]},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"RS_31","outputname:":"Reducer 2","outputOperator:":["JOIN_13"]}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"true","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0]","dataColumns:":["ctinyint:tinyint","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}}},"Reducer 2":{"Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"notVectorizedReason:":"Tagging not supported","vectorized:":"false"},"Reduce Operator Tree:":{"Join Operator":{"condition map:":[{"":"Left Outer Join 0 to 1"}],"keys:":{"0":"_col0 (type: tinyint)","1":"_col0 (type: tinyint)"},"Statistics:":"Num rows: 7329 Data size: 58641 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"JOIN_13","children":{"Group By Operator":{"aggregations:":["count()"],"minReductionHashAggr:":"0.99","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_15","children":{"Reduce Output Operator":{"columnExprMap:":{"VALUE._col0":"_col0"},"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_16","outputname:":"Reducer 3","outputOperator:":["GBY_32"]}}}}}}},"Reducer 3":{"Execution mode:":"vectorized","Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"reduceColumnNullOrder:":"","reduceColumnSortOrder:":"","allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"1","dataColumns:":["VALUE._col0:bigint"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountMerge(col 0:bigint) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"MERGEPARTIAL","native:":"false","vectorProcessingMode:":"GLOBAL","projectedOutputColumnNums:":"[0]"},"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_32","children":{"File Output Operator":{"compressed:":"false","File Sink Vectorization:":{"className:":"VectorFileSinkOperator","native:":"false"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_33"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_38"}}}}}}
PREHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
3268334
PREHOOK: query: create table mod_8_mod_4 stored as orc
as select pmod(ctinyint, 8) as cmodtinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@mod_8_mod_4
POSTHOOK: query: create table mod_8_mod_4 stored as orc
as select pmod(ctinyint, 8) as cmodtinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@mod_8_mod_4
POSTHOOK: Lineage: mod_8_mod_4.cmodint EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
POSTHOOK: Lineage: mod_8_mod_4.cmodtinyint EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
PREHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Output: default@mod_8_mod_4
POSTHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Output: default@mod_8_mod_4
PREHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Output: default@mod_8_mod_4
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Output: default@mod_8_mod_4
POSTHOOK: Output: hdfs://### HDFS PATH ###
PREHOOK: query: create table small_table2 stored
as orc as select pmod(ctinyint, 16) as cmodtinyint, cbigint from alltypesorc limit 100
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@small_table2
POSTHOOK: query: create table small_table2 stored
as orc as select pmod(ctinyint, 16) as cmodtinyint, cbigint from alltypesorc limit 100
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@small_table2
POSTHOOK: Lineage: small_table2.cbigint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cbigint, type:bigint, comment:null), ]
POSTHOOK: Lineage: small_table2.cmodtinyint EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
PREHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table2
PREHOOK: Output: default@small_table2
POSTHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: default@small_table2
PREHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@small_table2
PREHOOK: Output: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
{"CBOPlan":"###Masked###","optimizedSQL":"SELECT COUNT(*) AS `$f0`\nFROM (SELECT `cmodtinyint`\nFROM `default`.`mod_8_mod_4`) AS `t`\nLEFT JOIN (SELECT `cmodtinyint`\nFROM `default`.`small_table2`\nWHERE `cmodtinyint` IS NOT NULL) AS `t1` ON `t`.`cmodtinyint` = `t1`.`cmodtinyint`","PLAN VECTORIZATION":{"enabled":true,"enabledConditionsMet":["hive.vectorized.execution.enabled IS true"]},"cboInfo":"Plan optimized by CBO.","STAGE DEPENDENCIES":{"Stage-2":{"ROOT STAGE":"TRUE"},"Stage-1":{"DEPENDENT STAGES":"Stage-2"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-2":{"Spark":{"DagName:":"###Masked###","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"s","columns:":["cmodtinyint"],"database:":"default","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"mod_8_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_0","children":{"Select Operator":{"expressions:":"cmodtinyint (type: int)","columnExprMap:":{"_col0":"cmodtinyint"},"outputColumnNames:":["_col0"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0]"},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_19","children":{"Map Join Operator":{"condition map:":[{"":"Left Outer Join 0 to 1"}],"keys:":{"0":"_col0 (type: int)","1":"_col0 (type: int)"},"Map Join Vectorization:":{"bigTableKeyColumns:":["0:int"],"bigTableRetainColumnNums:":"[]","className:":"VectorMapJoinOuterLongOperator","native:":"true","nativeConditionsMet:":["hive.mapjoin.optimized.hashtable IS true","hive.vectorized.execution.mapjoin.native.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","One MapJoin Condition IS true","No nullsafe IS true","Small table vectorizes IS true","Outer Join has keys IS true","Optimized Table and Supports Key Types IS true"],"hashTableImplementationType:":"OPTIMIZED"},"input vertices:":{"1":"Map 3"},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_20","children":{"Group By Operator":{"aggregations:":["count()"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountStar(*) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"HASH","native:":"false","vectorProcessingMode:":"HASH","projectedOutputColumnNums:":"[0]"},"minReductionHashAggr:":"0.99","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_21","children":{"Reduce Output Operator":{"columnExprMap:":{"VALUE._col0":"_col0"},"sort order:":"","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkEmptyKeyOperator","native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"],"valueColumns:":["0:bigint"]},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_22","outputname:":"Reducer 2","outputOperator:":["GBY_23"]}}}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0]","dataColumns:":["cmodtinyint:int","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Local Work:":{"Map Reduce Local Work":{}}},"Reducer 2":{"Execution mode:":"vectorized","Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"reduceColumnNullOrder:":"","reduceColumnSortOrder:":"","allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"1","dataColumns:":["VALUE._col0:bigint"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountMerge(col 0:bigint) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"MERGEPARTIAL","native:":"false","vectorProcessingMode:":"GLOBAL","projectedOutputColumnNums:":"[0]"},"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_23","children":{"File Output Operator":{"compressed:":"false","File Sink Vectorization:":{"className:":"VectorFileSinkOperator","native:":"false"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_24"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_29"}}}}}}
PREHOOK: query: select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
39112
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
{"CBOPlan":"###Masked###","optimizedSQL":"SELECT COUNT(*) AS `$f0`\nFROM (SELECT `cmodtinyint`, `cmodint` = 2 AS `=`\nFROM `default`.`mod_8_mod_4`) AS `t`\nLEFT JOIN (SELECT `cmodtinyint`\nFROM `default`.`small_table2`\nWHERE `cmodtinyint` IS NOT NULL) AS `t1` ON `t`.`cmodtinyint` = `t1`.`cmodtinyint` AND `t`.`=`","PLAN VECTORIZATION":{"enabled":true,"enabledConditionsMet":["hive.vectorized.execution.enabled IS true"]},"cboInfo":"Plan optimized by CBO.","STAGE DEPENDENCIES":{"Stage-2":{"ROOT STAGE":"TRUE"},"Stage-1":{"DEPENDENT STAGES":"Stage-2"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-2":{"Spark":{"DagName:":"###Masked###","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"s","columns:":["cmodtinyint","cmodint"],"database:":"default","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"mod_8_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_0","children":{"Select Operator":{"expressions:":"cmodtinyint (type: int), (cmodint = 2) (type: boolean)","columnExprMap:":{"_col0":"cmodtinyint","_col1":"(cmodint = 2)"},"outputColumnNames:":["_col0","_col1"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0, 3]","selectExpressions:":["LongColEqualLongScalar(col 1:int, val 2) -> 3:boolean"]},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_19","children":{"Map Join Operator":{"condition map:":[{"":"Left Outer Join 0 to 1"}],"filter predicates:":{"0":"{_col1}","1":""},"keys:":{"0":"_col0 (type: int)","1":"_col0 (type: int)"},"Map Join Vectorization:":{"bigTableFilterExpressions:":["SelectColumnIsTrue(col 3:boolean)"],"bigTableKeyColumns:":["0:int"],"bigTableRetainColumnNums:":"[]","className:":"VectorMapJoinOuterLongOperator","native:":"true","nativeConditionsMet:":["hive.mapjoin.optimized.hashtable IS true","hive.vectorized.execution.mapjoin.native.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","One MapJoin Condition IS true","No nullsafe IS true","Small table vectorizes IS true","Outer Join has keys IS true","Optimized Table and Supports Key Types IS true"],"hashTableImplementationType:":"OPTIMIZED"},"input vertices:":{"1":"Map 3"},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_20","children":{"Group By Operator":{"aggregations:":["count()"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountStar(*) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"HASH","native:":"false","vectorProcessingMode:":"HASH","projectedOutputColumnNums:":"[0]"},"minReductionHashAggr:":"0.99","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_21","children":{"Reduce Output Operator":{"columnExprMap:":{"VALUE._col0":"_col0"},"sort order:":"","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkEmptyKeyOperator","native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"],"valueColumns:":["0:bigint"]},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_22","outputname:":"Reducer 2","outputOperator:":["GBY_23"]}}}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0, 1]","dataColumns:":["cmodtinyint:int","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[bigint]"}},"Local Work:":{"Map Reduce Local Work":{}}},"Reducer 2":{"Execution mode:":"vectorized","Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"reduceColumnNullOrder:":"","reduceColumnSortOrder:":"","allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"1","dataColumns:":["VALUE._col0:bigint"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountMerge(col 0:bigint) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"MERGEPARTIAL","native:":"false","vectorProcessingMode:":"GLOBAL","projectedOutputColumnNums:":"[0]"},"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_23","children":{"File Output Operator":{"compressed:":"false","File Sink Vectorization:":{"className:":"VectorFileSinkOperator","native:":"false"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_24"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_29"}}}}}}
PREHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
11171
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
{"CBOPlan":"###Masked###","optimizedSQL":"SELECT COUNT(*) AS `$f0`\nFROM (SELECT `cmodtinyint`, PMOD(`cmodtinyint`, 4) = `cmodint` AS `=`\nFROM `default`.`mod_8_mod_4`) AS `t`\nLEFT JOIN (SELECT `cmodtinyint`\nFROM `default`.`small_table2`\nWHERE `cmodtinyint` IS NOT NULL) AS `t1` ON `t`.`cmodtinyint` = `t1`.`cmodtinyint` AND `t`.`=`","PLAN VECTORIZATION":{"enabled":true,"enabledConditionsMet":["hive.vectorized.execution.enabled IS true"]},"cboInfo":"Plan optimized by CBO.","STAGE DEPENDENCIES":{"Stage-2":{"ROOT STAGE":"TRUE"},"Stage-1":{"DEPENDENT STAGES":"Stage-2"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-2":{"Spark":{"DagName:":"###Masked###","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"s","columns:":["cmodtinyint","cmodint"],"database:":"default","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"mod_8_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_0","children":{"Select Operator":{"expressions:":"cmodtinyint (type: int), ((cmodtinyint pmod 4) = cmodint) (type: boolean)","columnExprMap:":{"_col0":"cmodtinyint","_col1":"((cmodtinyint pmod 4) = cmodint)"},"outputColumnNames:":["_col0","_col1"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0, 4]","selectExpressions:":["LongColEqualLongColumn(col 3:int, col 1:int)(children: PosModLongToLong(col 0, divisor 4) -> 3:int) -> 4:boolean"]},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_19","children":{"Map Join Operator":{"condition map:":[{"":"Left Outer Join 0 to 1"}],"filter predicates:":{"0":"{_col1}","1":""},"keys:":{"0":"_col0 (type: int)","1":"_col0 (type: int)"},"Map Join Vectorization:":{"bigTableFilterExpressions:":["SelectColumnIsTrue(col 4:boolean)"],"bigTableKeyColumns:":["0:int"],"bigTableRetainColumnNums:":"[]","className:":"VectorMapJoinOuterLongOperator","native:":"true","nativeConditionsMet:":["hive.mapjoin.optimized.hashtable IS true","hive.vectorized.execution.mapjoin.native.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","One MapJoin Condition IS true","No nullsafe IS true","Small table vectorizes IS true","Outer Join has keys IS true","Optimized Table and Supports Key Types IS true"],"hashTableImplementationType:":"OPTIMIZED"},"input vertices:":{"1":"Map 3"},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_20","children":{"Group By Operator":{"aggregations:":["count()"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountStar(*) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"HASH","native:":"false","vectorProcessingMode:":"HASH","projectedOutputColumnNums:":"[0]"},"minReductionHashAggr:":"0.99","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_21","children":{"Reduce Output Operator":{"columnExprMap:":{"VALUE._col0":"_col0"},"sort order:":"","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkEmptyKeyOperator","native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"],"valueColumns:":["0:bigint"]},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_22","outputname:":"Reducer 2","outputOperator:":["GBY_23"]}}}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0, 1]","dataColumns:":["cmodtinyint:int","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[bigint, bigint]"}},"Local Work:":{"Map Reduce Local Work":{}}},"Reducer 2":{"Execution mode:":"vectorized","Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"reduceColumnNullOrder:":"","reduceColumnSortOrder:":"","allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"1","dataColumns:":["VALUE._col0:bigint"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountMerge(col 0:bigint) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"MERGEPARTIAL","native:":"false","vectorProcessingMode:":"GLOBAL","projectedOutputColumnNums:":"[0]"},"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_23","children":{"File Output Operator":{"compressed:":"false","File Sink Vectorization:":{"className:":"VectorFileSinkOperator","native:":"false"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_24"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_29"}}}}}}
PREHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
14371
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
{"CBOPlan":"###Masked###","optimizedSQL":"SELECT COUNT(*) AS `$f0`\nFROM (SELECT `cmodtinyint`, `cmodtinyint` < 3 AS `<`\nFROM `default`.`mod_8_mod_4`) AS `t`\nLEFT JOIN (SELECT `cmodtinyint`\nFROM `default`.`small_table2`\nWHERE `cmodtinyint` IS NOT NULL) AS `t1` ON `t`.`cmodtinyint` = `t1`.`cmodtinyint` AND `t`.`<`","PLAN VECTORIZATION":{"enabled":true,"enabledConditionsMet":["hive.vectorized.execution.enabled IS true"]},"cboInfo":"Plan optimized by CBO.","STAGE DEPENDENCIES":{"Stage-2":{"ROOT STAGE":"TRUE"},"Stage-1":{"DEPENDENT STAGES":"Stage-2"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-2":{"Spark":{"DagName:":"###Masked###","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"s","columns:":["cmodtinyint"],"database:":"default","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"mod_8_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_0","children":{"Select Operator":{"expressions:":"cmodtinyint (type: int), (cmodtinyint < 3) (type: boolean)","columnExprMap:":{"_col0":"cmodtinyint","_col1":"(cmodtinyint < 3)"},"outputColumnNames:":["_col0","_col1"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0, 3]","selectExpressions:":["LongColLessLongScalar(col 0:int, val 3) -> 3:boolean"]},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_19","children":{"Map Join Operator":{"condition map:":[{"":"Left Outer Join 0 to 1"}],"filter predicates:":{"0":"{_col1}","1":""},"keys:":{"0":"_col0 (type: int)","1":"_col0 (type: int)"},"Map Join Vectorization:":{"bigTableFilterExpressions:":["SelectColumnIsTrue(col 3:boolean)"],"bigTableKeyColumns:":["0:int"],"bigTableRetainColumnNums:":"[]","className:":"VectorMapJoinOuterLongOperator","native:":"true","nativeConditionsMet:":["hive.mapjoin.optimized.hashtable IS true","hive.vectorized.execution.mapjoin.native.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","One MapJoin Condition IS true","No nullsafe IS true","Small table vectorizes IS true","Outer Join has keys IS true","Optimized Table and Supports Key Types IS true"],"hashTableImplementationType:":"OPTIMIZED"},"input vertices:":{"1":"Map 3"},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_20","children":{"Group By Operator":{"aggregations:":["count()"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountStar(*) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"HASH","native:":"false","vectorProcessingMode:":"HASH","projectedOutputColumnNums:":"[0]"},"minReductionHashAggr:":"0.99","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_21","children":{"Reduce Output Operator":{"columnExprMap:":{"VALUE._col0":"_col0"},"sort order:":"","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkEmptyKeyOperator","native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"],"valueColumns:":["0:bigint"]},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_22","outputname:":"Reducer 2","outputOperator:":["GBY_23"]}}}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0]","dataColumns:":["cmodtinyint:int","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[bigint]"}},"Local Work:":{"Map Reduce Local Work":{}}},"Reducer 2":{"Execution mode:":"vectorized","Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"reduceColumnNullOrder:":"","reduceColumnSortOrder:":"","allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"1","dataColumns:":["VALUE._col0:bigint"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountMerge(col 0:bigint) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"MERGEPARTIAL","native:":"false","vectorProcessingMode:":"GLOBAL","projectedOutputColumnNums:":"[0]"},"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_23","children":{"File Output Operator":{"compressed:":"false","File Sink Vectorization:":{"className:":"VectorFileSinkOperator","native:":"false"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_24"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_29"}}}}}}
PREHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
17792
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
{"CBOPlan":"###Masked###","optimizedSQL":"SELECT COUNT(*) AS `$f0`\nFROM (SELECT `cmodtinyint`, CAST(`cmodint` AS BIGINT) AS `CAST`\nFROM `default`.`mod_8_mod_4`) AS `t`\nLEFT JOIN (SELECT `cbigint`\nFROM `default`.`small_table2`\nWHERE PMOD(`cbigint`, 8) IS NOT NULL) AS `t1` ON PMOD(`t1`.`cbigint`, 8) = `t`.`CAST`\nLEFT JOIN (SELECT `cmodtinyint`\nFROM `default`.`mod_8_mod_4`\nWHERE `cmodtinyint` IS NOT NULL) AS `t3` ON `t`.`cmodtinyint` = `t3`.`cmodtinyint`","PLAN VECTORIZATION":{"enabled":true,"enabledConditionsMet":["hive.vectorized.execution.enabled IS true"]},"cboInfo":"Plan optimized by CBO.","STAGE DEPENDENCIES":{"Stage-2":{"ROOT STAGE":"TRUE"},"Stage-1":{"DEPENDENT STAGES":"Stage-2"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-2":{"Spark":{"DagName:":"###Masked###","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"s","columns:":["cmodtinyint","cmodint"],"database:":"default","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"mod_8_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_0","children":{"Select Operator":{"expressions:":"cmodtinyint (type: int), UDFToLong(cmodint) (type: bigint)","columnExprMap:":{"_col0":"cmodtinyint","_col1":"UDFToLong(cmodint)"},"outputColumnNames:":["_col0","_col1"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0, 1]"},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_26","children":{"Map Join Operator":{"columnExprMap:":{"_col0":"0:_col0"},"condition map:":[{"":"Left Outer Join 0 to 1"}],"keys:":{"0":"_col1 (type: bigint)","1":"(_col0 pmod 8L) (type: bigint)"},"Map Join Vectorization:":{"bigTableKeyColumns:":["1:bigint"],"bigTableRetainColumnNums:":"[0]","bigTableValueColumns:":["0:int"],"className:":"VectorMapJoinOuterLongOperator","native:":"true","nativeConditionsMet:":["hive.mapjoin.optimized.hashtable IS true","hive.vectorized.execution.mapjoin.native.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","One MapJoin Condition IS true","No nullsafe IS true","Small table vectorizes IS true","Outer Join has keys IS true","Optimized Table and Supports Key Types IS true"],"projectedOutput:":["0:int"],"hashTableImplementationType:":"OPTIMIZED"},"outputColumnNames:":["_col0"],"input vertices:":{"1":"Map 4"},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_27","children":{"Reduce Output Operator":{"columnExprMap:":{"KEY.reducesinkkey0":"_col0"},"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkLongOperator","keyColumns:":["0:int"],"native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"]},"Statistics:":"Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"RS_28","outputname:":"Reducer 2","outputOperator:":["JOIN_13"]}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"true","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0, 1]","dataColumns:":["cmodtinyint:int","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Local Work:":{"Map Reduce Local Work":{}}},"Map 5":{"Map Operator Tree:":[{"TableScan":{"alias:":"s2","columns:":["cmodtinyint"],"database:":"default","filterExpr:":"cmodtinyint is not null (type: boolean)","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","table:":"mod_8_mod_4","TableScan Vectorization:":{"native:":"true","vectorizationSchemaColumns:":"[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>]"},"isTempTable:":"false","OperatorId:":"TS_5","children":{"Filter Operator":{"Filter Vectorization:":{"className:":"VectorFilterOperator","native:":"true","predicateExpression:":"SelectColumnIsNotNull(col 0:int)"},"predicate:":"cmodtinyint is not null (type: boolean)","Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"FIL_29","children":{"Select Operator":{"expressions:":"cmodtinyint (type: int)","columnExprMap:":{"_col0":"cmodtinyint"},"outputColumnNames:":["_col0"],"Select Vectorization:":{"className:":"VectorSelectOperator","native:":"true","projectedOutputColumnNums:":"[0]"},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_30","children":{"Reduce Output Operator":{"columnExprMap:":{"KEY.reducesinkkey0":"_col0"},"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Reduce Sink Vectorization:":{"className:":"VectorReduceSinkLongOperator","keyColumns:":["0:int"],"native:":"true","nativeConditionsMet:":["hive.vectorized.execution.reducesink.new.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true","No PTF TopN IS true","No DISTINCT columns IS true","BinarySortableSerDe for keys IS true","LazyBinarySerDe for values IS true"]},"Statistics:":"Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"RS_31","outputname:":"Reducer 2","outputOperator:":["JOIN_13"]}}}}}}}}],"Execution mode:":"vectorized","Map Vectorization:":{"enabled:":"true","enabledConditionsMet:":["hive.vectorized.use.vectorized.input.format IS true"],"inputFormatFeatureSupport:":"[DECIMAL_64]","featureSupportInUse:":"[DECIMAL_64]","inputFileFormats:":["org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"],"allNative:":"true","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"2","includeColumns:":"[0]","dataColumns:":["cmodtinyint:int","cmodint:int"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}}},"Reducer 2":{"Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"notVectorizedReason:":"Tagging not supported","vectorized:":"false"},"Reduce Operator Tree:":{"Join Operator":{"condition map:":[{"":"Left Outer Join 0 to 1"}],"keys:":{"0":"_col0 (type: int)","1":"_col0 (type: int)"},"Statistics:":"Num rows: 7329 Data size: 58641 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"JOIN_13","children":{"Group By Operator":{"aggregations:":["count()"],"minReductionHashAggr:":"0.99","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_15","children":{"Reduce Output Operator":{"columnExprMap:":{"VALUE._col0":"_col0"},"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_16","outputname:":"Reducer 3","outputOperator:":["GBY_32"]}}}}}}},"Reducer 3":{"Execution mode:":"vectorized","Reduce Vectorization:":{"enabled:":"true","enableConditionsMet:":["hive.vectorized.execution.reduce.enabled IS true","hive.execution.engine spark IN [tez, spark] IS true"],"reduceColumnNullOrder:":"","reduceColumnSortOrder:":"","allNative:":"false","usesVectorUDFAdaptor:":"false","vectorized:":"true","rowBatchContext:":{"dataColumnCount:":"1","dataColumns:":["VALUE._col0:bigint"],"partitionColumnCount:":"0","scratchColumnTypeNames:":"[]"}},"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"Group By Vectorization:":{"aggregators:":["VectorUDAFCountMerge(col 0:bigint) -> bigint"],"className:":"VectorGroupByOperator","groupByMode:":"MERGEPARTIAL","native:":"false","vectorProcessingMode:":"GLOBAL","projectedOutputColumnNums:":"[0]"},"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_32","children":{"File Output Operator":{"compressed:":"false","File Sink Vectorization:":{"className:":"VectorFileSinkOperator","native:":"false"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_33"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_38"}}}}}}
PREHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: hdfs://### HDFS PATH ###
6524438
