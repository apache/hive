query: explain 
  select count(1) FROM (select s1.key as key, s1.value as value from src s1 UNION  ALL  
                        select s2.key as key, s2.value as value from src s2 UNION ALL
                        select s3.key as key, s3.value as value from src s3) unionsrc
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF src s1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL s1) key) key) (TOK_SELEXPR (. (TOK_TABLE_OR_COL s1) value) value)))) (TOK_QUERY (TOK_FROM (TOK_TABREF src s2)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL s2) key) key) (TOK_SELEXPR (. (TOK_TABLE_OR_COL s2) value) value))))) (TOK_QUERY (TOK_FROM (TOK_TABREF src s3)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL s3) key) key) (TOK_SELEXPR (. (TOK_TABLE_OR_COL s3) value) value))))) unionsrc)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION count 1)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        null-subquery1-subquery1:unionsrc-subquery1-subquery1:s1 
            Select Operator
              expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
              Union
                Group By Operator
                  aggregations:
                        expr: count(1)
                  mode: hash
                  Reduce Output Operator
                    sort order: 
                    tag: -1
                    value expressions:
                          expr: 0
                          type: bigint
        null-subquery1-subquery2:unionsrc-subquery1-subquery2:s2 
            Select Operator
              expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
              Union
                Group By Operator
                  aggregations:
                        expr: count(1)
                  mode: hash
                  Reduce Output Operator
                    sort order: 
                    tag: -1
                    value expressions:
                          expr: 0
                          type: bigint
        null-subquery2:unionsrc-subquery2:s3 
            Select Operator
              expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
              Union
                Group By Operator
                  aggregations:
                        expr: count(1)
                  mode: hash
                  Reduce Output Operator
                    sort order: 
                    tag: -1
                    value expressions:
                          expr: 0
                          type: bigint
      Reduce Operator Tree:
        Group By Operator
          aggregations:
                expr: count(VALUE.0)
          mode: mergepartial
          Select Operator
            expressions:
                  expr: 0
                  type: bigint
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


query: select count(1) FROM (select s1.key as key, s1.value as value from src s1 UNION  ALL  
                        select s2.key as key, s2.value as value from src s2 UNION ALL
                        select s3.key as key, s3.value as value from src s3) unionsrc
Input: default/src
Output: /data/users/athusoo/commits/hive_trunk_ws8/ql/../build/ql/tmp/371390513/112754866.10000
1500
