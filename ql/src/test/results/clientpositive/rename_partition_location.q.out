PREHOOK: query: -- This test verifies that if the tables location changes, renaming a partition will not change
-- the partition location accordingly

CREATE TABLE rename_partition_table (key STRING, value STRING) PARTITIONED BY (part STRING)
STORED AS RCFILE
#### A masked pattern was here ####
PREHOOK: type: CREATETABLE
POSTHOOK: query: -- This test verifies that if the tables location changes, renaming a partition will not change
-- the partition location accordingly

CREATE TABLE rename_partition_table (key STRING, value STRING) PARTITIONED BY (part STRING)
STORED AS RCFILE
#### A masked pattern was here ####
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@rename_partition_table
PREHOOK: query: INSERT OVERWRITE TABLE rename_partition_table PARTITION (part = '1') SELECT * FROM src
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@rename_partition_table@part=1
POSTHOOK: query: INSERT OVERWRITE TABLE rename_partition_table PARTITION (part = '1') SELECT * FROM src
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@rename_partition_table@part=1
POSTHOOK: Lineage: rename_partition_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: rename_partition_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
#### A masked pattern was here ####
PREHOOK: type: ALTERTABLE_LOCATION
PREHOOK: Input: default@rename_partition_table
PREHOOK: Output: default@rename_partition_table
#### A masked pattern was here ####
POSTHOOK: type: ALTERTABLE_LOCATION
POSTHOOK: Input: default@rename_partition_table
POSTHOOK: Output: default@rename_partition_table
POSTHOOK: Lineage: rename_partition_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: rename_partition_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: ALTER TABLE rename_partition_table PARTITION (part = '1') RENAME TO PARTITION (part = '2')
PREHOOK: type: ALTERTABLE_RENAMEPART
PREHOOK: Input: default@rename_partition_table
PREHOOK: Output: default@rename_partition_table@part=1
POSTHOOK: query: ALTER TABLE rename_partition_table PARTITION (part = '1') RENAME TO PARTITION (part = '2')
POSTHOOK: type: ALTERTABLE_RENAMEPART
POSTHOOK: Input: default@rename_partition_table
POSTHOOK: Input: default@rename_partition_table@part=1
POSTHOOK: Output: default@rename_partition_table@part=1
POSTHOOK: Output: default@rename_partition_table@part=2
POSTHOOK: Lineage: rename_partition_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: rename_partition_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: SELECT count(*) FROM rename_partition_table where part = '2'
PREHOOK: type: QUERY
PREHOOK: Input: default@rename_partition_table
PREHOOK: Input: default@rename_partition_table@part=2
#### A masked pattern was here ####
500
PREHOOK: query: DROP TABLE rename_partition_table
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@rename_partition_table
PREHOOK: Output: default@rename_partition_table
