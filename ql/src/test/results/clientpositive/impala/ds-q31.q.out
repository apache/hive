HMS CALL get_table_req FOR ss
HMS CALL get_table_req FOR ss
HMS CALL get_table_req FOR ss
HMS CALL get_table_req FOR ws
HMS CALL get_table_req FOR ws
HMS CALL get_table_req FOR ws
HMS CALL get_table_req FOR impala_tpcds_store_sales
HMS CALL get_table_req FOR impala_tpcds_date_dim
HMS CALL get_table_req FOR impala_tpcds_customer_address
HMS CALL get_table_req FOR impala_tpcds_web_sales
HMS CALL get_foreign_keys FOR impala_tpcds_store_sales
HMS CALL get_foreign_keys FOR impala_tpcds_date_dim
HMS CALL get_foreign_keys FOR impala_tpcds_customer_address
HMS CALL get_foreign_keys FOR impala_tpcds_web_sales
PREHOOK: query: explain cbo physical with ss as
 (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales
 from impala_tpcds_store_sales,impala_tpcds_date_dim,impala_tpcds_customer_address
 where ss_sold_date_sk = d_date_sk
  and ss_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year),
 ws as
 (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales
 from impala_tpcds_web_sales,impala_tpcds_date_dim,impala_tpcds_customer_address
 where ws_sold_date_sk = d_date_sk
  and ws_bill_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year)
 select 
        ss1.ca_county
       ,ss1.d_year
       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase
       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase
       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase
       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase
 from
        ss ss1
       ,ss ss2
       ,ss ss3
       ,ws ws1
       ,ws ws2
       ,ws ws3
 where
    ss1.d_qoy = 1
    and ss1.d_year = 1999
    and ss1.ca_county = ss2.ca_county
    and ss2.d_qoy = 2
    and ss2.d_year = 1999
 and ss2.ca_county = ss3.ca_county
    and ss3.d_qoy = 3
    and ss3.d_year = 1999
    and ss1.ca_county = ws1.ca_county
    and ws1.d_qoy = 1
    and ws1.d_year = 1999
    and ws1.ca_county = ws2.ca_county
    and ws2.d_qoy = 2
    and ws2.d_year = 1999
    and ws1.ca_county = ws3.ca_county
    and ws3.d_qoy = 3
    and ws3.d_year =1999
    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end 
       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end
    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end
       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end
 order by ss1.d_year
PREHOOK: type: QUERY
PREHOOK: Input: default@impala_tpcds_customer_address
PREHOOK: Input: default@impala_tpcds_date_dim
PREHOOK: Input: default@impala_tpcds_store_sales
PREHOOK: Input: default@impala_tpcds_web_sales
PREHOOK: Output: streaming
POSTHOOK: query: explain cbo physical with ss as
 (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales
 from impala_tpcds_store_sales,impala_tpcds_date_dim,impala_tpcds_customer_address
 where ss_sold_date_sk = d_date_sk
  and ss_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year),
 ws as
 (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales
 from impala_tpcds_web_sales,impala_tpcds_date_dim,impala_tpcds_customer_address
 where ws_sold_date_sk = d_date_sk
  and ws_bill_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year)
 select 
        ss1.ca_county
       ,ss1.d_year
       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase
       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase
       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase
       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase
 from
        ss ss1
       ,ss ss2
       ,ss ss3
       ,ws ws1
       ,ws ws2
       ,ws ws3
 where
    ss1.d_qoy = 1
    and ss1.d_year = 1999
    and ss1.ca_county = ss2.ca_county
    and ss2.d_qoy = 2
    and ss2.d_year = 1999
 and ss2.ca_county = ss3.ca_county
    and ss3.d_qoy = 3
    and ss3.d_year = 1999
    and ss1.ca_county = ws1.ca_county
    and ws1.d_qoy = 1
    and ws1.d_year = 1999
    and ws1.ca_county = ws2.ca_county
    and ws2.d_qoy = 2
    and ws2.d_year = 1999
    and ws1.ca_county = ws3.ca_county
    and ws3.d_qoy = 3
    and ws3.d_year =1999
    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end 
       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end
    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end
       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end
 order by ss1.d_year
POSTHOOK: type: QUERY
POSTHOOK: Input: default@impala_tpcds_customer_address
POSTHOOK: Input: default@impala_tpcds_date_dim
POSTHOOK: Input: default@impala_tpcds_store_sales
POSTHOOK: Input: default@impala_tpcds_web_sales
CBO PLAN:
ImpalaProjectPassthroughRel(ca_county=[$4], d_year=[CAST(1999):INTEGER], web_q1_q2_increase=[/($1, $3)], store_q1_q2_increase=[/($5, $7)], web_q2_q3_increase=[/($11, $1)], store_q2_q3_increase=[/($9, $5)])
  ImpalaJoinRel(condition=[AND(=($2, $10), >(/($11, $1), /($9, $5)))], joinType=[inner])
    ImpalaJoinRel(condition=[=($4, $8)], joinType=[inner])
      ImpalaJoinRel(condition=[AND(=($4, $2), >(/($1, $3), /($5, $7)))], joinType=[inner])
        ImpalaJoinRel(condition=[=($2, $0)], joinType=[inner])
          ImpalaAggregateRel(group=[{5}], agg#0=[sum($2)], condition=[>($1, 0)])
            ImpalaJoinRel(condition=[=($1, $4)], joinType=[inner])
              ImpalaJoinRel(condition=[=($0, $3)], joinType=[inner])
                ImpalaProjectPassthroughRel(ws_sold_date_sk=[$0], ws_bill_addr_sk=[$7], ws_ext_sales_price=[$23])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_sales]], condition=[AND(IS NOT NULL($7), IS NOT NULL($0))])
                ImpalaProjectPassthroughRel(d_date_sk=[$0])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($10, 2), =($6, 1999), IS NOT NULL($0))])
              ImpalaProjectPassthroughRel(ca_address_sk=[$0], ca_county=[$7])
                ImpalaHdfsScanRel(table=[[default, impala_tpcds_customer_address]], condition=[AND(IS NOT NULL($0), IS NOT NULL($7))])
          ImpalaAggregateRel(group=[{5}], agg#0=[sum($2)], condition=[>($1, 0)])
            ImpalaJoinRel(condition=[=($1, $4)], joinType=[inner])
              ImpalaJoinRel(condition=[=($0, $3)], joinType=[inner])
                ImpalaProjectPassthroughRel(ws_sold_date_sk=[$0], ws_bill_addr_sk=[$7], ws_ext_sales_price=[$23])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_sales]], condition=[AND(IS NOT NULL($7), IS NOT NULL($0))])
                ImpalaProjectPassthroughRel(d_date_sk=[$0])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($10, 1), =($6, 1999), IS NOT NULL($0))])
              ImpalaProjectPassthroughRel(ca_address_sk=[$0], ca_county=[$7])
                ImpalaHdfsScanRel(table=[[default, impala_tpcds_customer_address]], condition=[AND(IS NOT NULL($7), IS NOT NULL($0))])
        ImpalaJoinRel(condition=[=($2, $0)], joinType=[inner])
          ImpalaAggregateRel(group=[{5}], agg#0=[sum($1)], condition=[>($1, 0)])
            ImpalaJoinRel(condition=[=($0, $4)], joinType=[inner])
              ImpalaJoinRel(condition=[=($2, $3)], joinType=[inner])
                ImpalaProjectPassthroughRel(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_store_sales]], condition=[AND(IS NOT NULL($5), IS NOT NULL($22))])
                ImpalaProjectPassthroughRel(d_date_sk=[$0])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($10, 2), =($6, 1999), IS NOT NULL($0))])
              ImpalaProjectPassthroughRel(ca_address_sk=[$0], ca_county=[$7])
                ImpalaHdfsScanRel(table=[[default, impala_tpcds_customer_address]], condition=[AND(IS NOT NULL($0), IS NOT NULL($7))])
          ImpalaAggregateRel(group=[{5}], agg#0=[sum($1)], condition=[>($1, 0)])
            ImpalaJoinRel(condition=[=($0, $4)], joinType=[inner])
              ImpalaJoinRel(condition=[=($2, $3)], joinType=[inner])
                ImpalaProjectPassthroughRel(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_store_sales]], condition=[AND(IS NOT NULL($5), IS NOT NULL($22))])
                ImpalaProjectPassthroughRel(d_date_sk=[$0])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($10, 1), =($6, 1999), IS NOT NULL($0))])
              ImpalaProjectPassthroughRel(ca_address_sk=[$0], ca_county=[$7])
                ImpalaHdfsScanRel(table=[[default, impala_tpcds_customer_address]], condition=[AND(IS NOT NULL($7), IS NOT NULL($0))])
      ImpalaAggregateRel(group=[{5}], agg#0=[sum($1)])
        ImpalaJoinRel(condition=[=($0, $4)], joinType=[inner])
          ImpalaJoinRel(condition=[=($2, $3)], joinType=[inner])
            ImpalaProjectPassthroughRel(ss_addr_sk=[$5], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22])
              ImpalaHdfsScanRel(table=[[default, impala_tpcds_store_sales]], condition=[AND(IS NOT NULL($5), IS NOT NULL($22))])
            ImpalaProjectPassthroughRel(d_date_sk=[$0])
              ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($10, 3), =($6, 1999), IS NOT NULL($0))])
          ImpalaProjectPassthroughRel(ca_address_sk=[$0], ca_county=[$7])
            ImpalaHdfsScanRel(table=[[default, impala_tpcds_customer_address]], condition=[AND(IS NOT NULL($0), IS NOT NULL($7))])
    ImpalaAggregateRel(group=[{5}], agg#0=[sum($2)])
      ImpalaJoinRel(condition=[=($1, $4)], joinType=[inner])
        ImpalaJoinRel(condition=[=($0, $3)], joinType=[inner])
          ImpalaProjectPassthroughRel(ws_sold_date_sk=[$0], ws_bill_addr_sk=[$7], ws_ext_sales_price=[$23])
            ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_sales]], condition=[AND(IS NOT NULL($7), IS NOT NULL($0))])
          ImpalaProjectPassthroughRel(d_date_sk=[$0])
            ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($10, 3), =($6, 1999), IS NOT NULL($0))])
        ImpalaProjectPassthroughRel(ca_address_sk=[$0], ca_county=[$7])
          ImpalaHdfsScanRel(table=[[default, impala_tpcds_customer_address]], condition=[AND(IS NOT NULL($0), IS NOT NULL($7))])

HMS CALL get_table_req FOR ss
HMS CALL get_table_req FOR ss
HMS CALL get_table_req FOR ss
HMS CALL get_table_req FOR ws
HMS CALL get_table_req FOR ws
HMS CALL get_table_req FOR ws
HMS CALL get_table_req FOR impala_tpcds_store_sales
HMS CALL get_table_req FOR impala_tpcds_date_dim
HMS CALL get_table_req FOR impala_tpcds_customer_address
HMS CALL get_table_req FOR impala_tpcds_web_sales
HMS CALL get_foreign_keys FOR impala_tpcds_store_sales
HMS CALL get_foreign_keys FOR impala_tpcds_date_dim
HMS CALL get_foreign_keys FOR impala_tpcds_customer_address
HMS CALL get_foreign_keys FOR impala_tpcds_web_sales
PREHOOK: query: explain with ss as
 (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales
 from impala_tpcds_store_sales,impala_tpcds_date_dim,impala_tpcds_customer_address
 where ss_sold_date_sk = d_date_sk
  and ss_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year),
 ws as
 (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales
 from impala_tpcds_web_sales,impala_tpcds_date_dim,impala_tpcds_customer_address
 where ws_sold_date_sk = d_date_sk
  and ws_bill_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year)
 select 
        ss1.ca_county
       ,ss1.d_year
       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase
       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase
       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase
       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase
 from
        ss ss1
       ,ss ss2
       ,ss ss3
       ,ws ws1
       ,ws ws2
       ,ws ws3
 where
    ss1.d_qoy = 1
    and ss1.d_year = 1999
    and ss1.ca_county = ss2.ca_county
    and ss2.d_qoy = 2
    and ss2.d_year = 1999
 and ss2.ca_county = ss3.ca_county
    and ss3.d_qoy = 3
    and ss3.d_year = 1999
    and ss1.ca_county = ws1.ca_county
    and ws1.d_qoy = 1
    and ws1.d_year = 1999
    and ws1.ca_county = ws2.ca_county
    and ws2.d_qoy = 2
    and ws2.d_year = 1999
    and ws1.ca_county = ws3.ca_county
    and ws3.d_qoy = 3
    and ws3.d_year =1999
    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end 
       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end
    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end
       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end
 order by ss1.d_year
PREHOOK: type: QUERY
PREHOOK: Input: default@impala_tpcds_customer_address
PREHOOK: Input: default@impala_tpcds_date_dim
PREHOOK: Input: default@impala_tpcds_store_sales
PREHOOK: Input: default@impala_tpcds_web_sales
PREHOOK: Output: streaming
POSTHOOK: query: explain with ss as
 (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales
 from impala_tpcds_store_sales,impala_tpcds_date_dim,impala_tpcds_customer_address
 where ss_sold_date_sk = d_date_sk
  and ss_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year),
 ws as
 (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales
 from impala_tpcds_web_sales,impala_tpcds_date_dim,impala_tpcds_customer_address
 where ws_sold_date_sk = d_date_sk
  and ws_bill_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year)
 select 
        ss1.ca_county
       ,ss1.d_year
       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase
       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase
       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase
       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase
 from
        ss ss1
       ,ss ss2
       ,ss ss3
       ,ws ws1
       ,ws ws2
       ,ws ws3
 where
    ss1.d_qoy = 1
    and ss1.d_year = 1999
    and ss1.ca_county = ss2.ca_county
    and ss2.d_qoy = 2
    and ss2.d_year = 1999
 and ss2.ca_county = ss3.ca_county
    and ss3.d_qoy = 3
    and ss3.d_year = 1999
    and ss1.ca_county = ws1.ca_county
    and ws1.d_qoy = 1
    and ws1.d_year = 1999
    and ws1.ca_county = ws2.ca_county
    and ws2.d_qoy = 2
    and ws2.d_year = 1999
    and ws1.ca_county = ws3.ca_county
    and ws3.d_qoy = 3
    and ws3.d_year =1999
    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end 
       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end
    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end
       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end
 order by ss1.d_year
POSTHOOK: type: QUERY
POSTHOOK: Input: default@impala_tpcds_customer_address
POSTHOOK: Input: default@impala_tpcds_date_dim
POSTHOOK: Input: default@impala_tpcds_store_sales
POSTHOOK: Input: default@impala_tpcds_web_sales
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Impala
      Impala Plan: 
F24:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
Per-Host Resources: mem-estimate=192.00KB mem-reservation=0B thread-reservation=1
  PLAN-ROOT SINK
  |  output exprs: default.impala_tpcds_customer_address_1.ca_county, CAST(1999 AS INT), divide(_impala_builtins.sum(default.impala_tpcds_web_sales.ws_ext_sales_price), _impala_builtins.sum(default.impala_tpcds_web_sales_0.ws_ext_sales_price)), divide(_impala_builtins.sum(default.impala_tpcds_store_sales.ss_ext_sales_price), _impala_builtins.sum(default.impala_tpcds_store_sales_0.ss_ext_sales_price)), divide(_impala_builtins.sum(default.impala_tpcds_web_sales_1.ws_ext_sales_price), _impala_builtins.sum(default.impala_tpcds_web_sales.ws_ext_sales_price)), divide(_impala_builtins.sum(default.impala_tpcds_store_sales_1.ss_ext_sales_price), _impala_builtins.sum(default.impala_tpcds_store_sales.ss_ext_sales_price))
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |
  70:EXCHANGE [UNPARTITIONED]
     mem-estimate=192.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=6,13,19,25,31,38 row-size=168B cardinality=0
     in pipelines: 44(GETNEXT)

F03:PLAN FRAGMENT [HASH(default.impala_tpcds_customer_address.ca_county)] hosts=1 instances=1
Per-Host Resources: mem-estimate=135.94MB mem-reservation=41.75MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F24, EXCHANGE=70, UNPARTITIONED]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  40:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_customer_address_0.ca_county = default.impala_tpcds_customer_address_4.ca_county
  |  fk/pk conjuncts: assumed fk/pk
  |  other join predicates: divide(_impala_builtins.sum(default.impala_tpcds_web_sales_1.ws_ext_sales_price), _impala_builtins.sum(default.impala_tpcds_web_sales.ws_ext_sales_price)) > divide(_impala_builtins.sum(default.impala_tpcds_store_sales_1.ss_ext_sales_price), _impala_builtins.sum(default.impala_tpcds_store_sales.ss_ext_sales_price))
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=6,13,19,25,31,38 row-size=168B cardinality=0
  |  in pipelines: 44(GETNEXT), 68(OPEN)
  |
  |--69:EXCHANGE [BROADCAST]
  |     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=38 row-size=28B cardinality=0
  |     in pipelines: 68(GETNEXT)
  |
  33:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_customer_address_1.ca_county = default.impala_tpcds_customer_address_3.ca_county
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=6,13,19,25,31 row-size=140B cardinality=0
  |  in pipelines: 44(GETNEXT), 63(OPEN)
  |
  |--64:EXCHANGE [BROADCAST]
  |     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=31 row-size=28B cardinality=0
  |     in pipelines: 63(GETNEXT)
  |
  26:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_customer_address_0.ca_county = default.impala_tpcds_customer_address_1.ca_county
  |  fk/pk conjuncts: assumed fk/pk
  |  other join predicates: divide(_impala_builtins.sum(default.impala_tpcds_web_sales.ws_ext_sales_price), _impala_builtins.sum(default.impala_tpcds_web_sales_0.ws_ext_sales_price)) > divide(_impala_builtins.sum(default.impala_tpcds_store_sales.ss_ext_sales_price), _impala_builtins.sum(default.impala_tpcds_store_sales_0.ss_ext_sales_price))
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=6,13,19,25 row-size=112B cardinality=0
  |  in pipelines: 44(GETNEXT), 53(OPEN)
  |
  |--59:EXCHANGE [BROADCAST]
  |     mem-estimate=64.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=19,25 row-size=56B cardinality=0
  |     in pipelines: 53(GETNEXT)
  |
  12:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_customer_address.ca_county = default.impala_tpcds_customer_address_0.ca_county
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=6,13 row-size=56B cardinality=0
  |  in pipelines: 44(GETNEXT), 48(OPEN)
  |
  |--49:EXCHANGE [BROADCAST]
  |     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=13 row-size=28B cardinality=0
  |     in pipelines: 48(GETNEXT)
  |
  44:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(default.impala_tpcds_web_sales.ws_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address.ca_county
  |  having: _impala_builtins.sum(default.impala_tpcds_web_sales.ws_ext_sales_price) > CAST(0 AS DECIMAL(38,2))
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=6 row-size=28B cardinality=0
  |  in pipelines: 44(GETNEXT), 00(OPEN)
  |
  43:EXCHANGE [HASH(default.impala_tpcds_customer_address.ca_county)]
     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=6 row-size=28B cardinality=0
     in pipelines: 00(GETNEXT)

F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=131.91MB mem-reservation=37.88MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F03, EXCHANGE=43, HASH(default.impala_tpcds_customer_address.ca_county)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  05:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_web_sales.ws_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address.ca_county
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=6 row-size=28B cardinality=0
  |  in pipelines: 00(GETNEXT)
  |
  04:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_web_sales.ws_bill_addr_sk = default.impala_tpcds_customer_address.ca_address_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=0,2,4 row-size=40B cardinality=0
  |  in pipelines: 00(GETNEXT), 03(OPEN)
  |
  |--42:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=4 row-size=16B cardinality=0
  |     in pipelines: 03(GETNEXT)
  |
  02:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_web_sales.ws_sold_date_sk = default.impala_tpcds_date_dim.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=0,2 row-size=24B cardinality=0
  |  in pipelines: 00(GETNEXT), 01(OPEN)
  |
  |--41:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=2 row-size=12B cardinality=0
  |     in pipelines: 01(GETNEXT)
  |
  00:SCAN HDFS [default.impala_tpcds_web_sales, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_web_sales.ws_bill_addr_sk IS NOT NULL, default.impala_tpcds_web_sales.ws_sold_date_sk IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=0 row-size=12B cardinality=0
     in pipelines: 00(GETNEXT)

F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F00, EXCHANGE=41, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  01:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim.d_qoy = CAST(2 AS INT), default.impala_tpcds_date_dim.d_year = CAST(1999 AS INT)
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim.d_qoy = CAST(2 AS INT), default.impala_tpcds_date_dim.d_year = CAST(1999 AS INT)
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=2 row-size=12B cardinality=0
     in pipelines: 01(GETNEXT)

F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F00, EXCHANGE=42, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  03:SCAN HDFS [default.impala_tpcds_customer_address, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_customer_address.ca_address_sk IS NOT NULL, default.impala_tpcds_customer_address.ca_county IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=4 row-size=16B cardinality=0
     in pipelines: 03(GETNEXT)

F07:PLAN FRAGMENT [HASH(default.impala_tpcds_customer_address_0.ca_county)] hosts=1 instances=1
Per-Host Resources: mem-estimate=128.03MB mem-reservation=34.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F03, EXCHANGE=49, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  48:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(default.impala_tpcds_web_sales_0.ws_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address_0.ca_county
  |  having: _impala_builtins.sum(default.impala_tpcds_web_sales_0.ws_ext_sales_price) > CAST(0 AS DECIMAL(38,2))
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=13 row-size=28B cardinality=0
  |  in pipelines: 48(GETNEXT), 06(OPEN)
  |
  47:EXCHANGE [HASH(default.impala_tpcds_customer_address_0.ca_county)]
     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=13 row-size=28B cardinality=0
     in pipelines: 06(GETNEXT)

F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=131.91MB mem-reservation=37.88MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F07, EXCHANGE=47, HASH(default.impala_tpcds_customer_address_0.ca_county)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  11:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_web_sales_0.ws_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address_0.ca_county
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=13 row-size=28B cardinality=0
  |  in pipelines: 06(GETNEXT)
  |
  10:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_web_sales_0.ws_bill_addr_sk = default.impala_tpcds_customer_address_0.ca_address_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=7,9,11 row-size=40B cardinality=0
  |  in pipelines: 06(GETNEXT), 09(OPEN)
  |
  |--46:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=11 row-size=16B cardinality=0
  |     in pipelines: 09(GETNEXT)
  |
  08:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_web_sales_0.ws_sold_date_sk = default.impala_tpcds_date_dim_0.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=7,9 row-size=24B cardinality=0
  |  in pipelines: 06(GETNEXT), 07(OPEN)
  |
  |--45:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=9 row-size=12B cardinality=0
  |     in pipelines: 07(GETNEXT)
  |
  06:SCAN HDFS [default.impala_tpcds_web_sales, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_web_sales_0.ws_bill_addr_sk IS NOT NULL, default.impala_tpcds_web_sales_0.ws_sold_date_sk IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=7 row-size=12B cardinality=0
     in pipelines: 06(GETNEXT)

F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F04, EXCHANGE=45, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  07:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_0.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim_0.d_qoy = CAST(1 AS INT), default.impala_tpcds_date_dim_0.d_year = CAST(1999 AS INT)
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim_0.d_qoy = CAST(1 AS INT), default.impala_tpcds_date_dim_0.d_year = CAST(1999 AS INT)
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=9 row-size=12B cardinality=0
     in pipelines: 07(GETNEXT)

F06:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F04, EXCHANGE=46, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  09:SCAN HDFS [default.impala_tpcds_customer_address, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_customer_address_0.ca_address_sk IS NOT NULL, default.impala_tpcds_customer_address_0.ca_county IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=11 row-size=16B cardinality=0
     in pipelines: 09(GETNEXT)

F11:PLAN FRAGMENT [HASH(default.impala_tpcds_customer_address_1.ca_county)] hosts=1 instances=1
Per-Host Resources: mem-estimate=130.00MB mem-reservation=35.94MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F03, EXCHANGE=59, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  25:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_customer_address_1.ca_county = default.impala_tpcds_customer_address_2.ca_county
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=19,25 row-size=56B cardinality=0
  |  in pipelines: 53(GETNEXT), 57(OPEN)
  |
  |--58:EXCHANGE [BROADCAST]
  |     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=25 row-size=28B cardinality=0
  |     in pipelines: 57(GETNEXT)
  |
  53:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(default.impala_tpcds_store_sales.ss_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address_1.ca_county
  |  having: _impala_builtins.sum(default.impala_tpcds_store_sales.ss_ext_sales_price) > CAST(0 AS DECIMAL(38,2))
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=19 row-size=28B cardinality=0
  |  in pipelines: 53(GETNEXT), 13(OPEN)
  |
  52:EXCHANGE [HASH(default.impala_tpcds_customer_address_1.ca_county)]
     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=19 row-size=28B cardinality=0
     in pipelines: 13(GETNEXT)

F08:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=131.91MB mem-reservation=37.88MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F11, EXCHANGE=52, HASH(default.impala_tpcds_customer_address_1.ca_county)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  18:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_store_sales.ss_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address_1.ca_county
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=19 row-size=28B cardinality=0
  |  in pipelines: 13(GETNEXT)
  |
  17:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store_sales.ss_addr_sk = default.impala_tpcds_customer_address_1.ca_address_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=14,15,17 row-size=40B cardinality=0
  |  in pipelines: 13(GETNEXT), 16(OPEN)
  |
  |--51:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=17 row-size=16B cardinality=0
  |     in pipelines: 16(GETNEXT)
  |
  15:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store_sales.ss_sold_date_sk = default.impala_tpcds_date_dim_1.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=14,15 row-size=24B cardinality=0
  |  in pipelines: 13(GETNEXT), 14(OPEN)
  |
  |--50:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=15 row-size=12B cardinality=0
  |     in pipelines: 14(GETNEXT)
  |
  13:SCAN HDFS [default.impala_tpcds_store_sales, RANDOM]
     partition predicates: default.impala_tpcds_store_sales.ss_sold_date_sk IS NOT NULL
     partitions=0/0 files=0 size=0B
     predicates: default.impala_tpcds_store_sales.ss_addr_sk IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       partitions: 0/0 rows=unavailable
       columns missing stats: ss_addr_sk, ss_ext_sales_price
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=14 row-size=12B cardinality=0
     in pipelines: 13(GETNEXT)

F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F08, EXCHANGE=50, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  14:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_1.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim_1.d_qoy = CAST(2 AS INT), default.impala_tpcds_date_dim_1.d_year = CAST(1999 AS INT)
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim_1.d_qoy = CAST(2 AS INT), default.impala_tpcds_date_dim_1.d_year = CAST(1999 AS INT)
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=15 row-size=12B cardinality=0
     in pipelines: 14(GETNEXT)

F10:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F08, EXCHANGE=51, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  16:SCAN HDFS [default.impala_tpcds_customer_address, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_customer_address_1.ca_address_sk IS NOT NULL, default.impala_tpcds_customer_address_1.ca_county IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=17 row-size=16B cardinality=0
     in pipelines: 16(GETNEXT)

F15:PLAN FRAGMENT [HASH(default.impala_tpcds_customer_address_2.ca_county)] hosts=1 instances=1
Per-Host Resources: mem-estimate=128.03MB mem-reservation=34.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F11, EXCHANGE=58, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  57:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(default.impala_tpcds_store_sales_0.ss_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address_2.ca_county
  |  having: _impala_builtins.sum(default.impala_tpcds_store_sales_0.ss_ext_sales_price) > CAST(0 AS DECIMAL(38,2))
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=25 row-size=28B cardinality=0
  |  in pipelines: 57(GETNEXT), 19(OPEN)
  |
  56:EXCHANGE [HASH(default.impala_tpcds_customer_address_2.ca_county)]
     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=25 row-size=28B cardinality=0
     in pipelines: 19(GETNEXT)

F12:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=131.91MB mem-reservation=37.88MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F15, EXCHANGE=56, HASH(default.impala_tpcds_customer_address_2.ca_county)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  24:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_store_sales_0.ss_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address_2.ca_county
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=25 row-size=28B cardinality=0
  |  in pipelines: 19(GETNEXT)
  |
  23:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store_sales_0.ss_addr_sk = default.impala_tpcds_customer_address_2.ca_address_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=20,21,23 row-size=40B cardinality=0
  |  in pipelines: 19(GETNEXT), 22(OPEN)
  |
  |--55:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=23 row-size=16B cardinality=0
  |     in pipelines: 22(GETNEXT)
  |
  21:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store_sales_0.ss_sold_date_sk = default.impala_tpcds_date_dim_2.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=20,21 row-size=24B cardinality=0
  |  in pipelines: 19(GETNEXT), 20(OPEN)
  |
  |--54:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=21 row-size=12B cardinality=0
  |     in pipelines: 20(GETNEXT)
  |
  19:SCAN HDFS [default.impala_tpcds_store_sales, RANDOM]
     partition predicates: default.impala_tpcds_store_sales_0.ss_sold_date_sk IS NOT NULL
     partitions=0/0 files=0 size=0B
     predicates: default.impala_tpcds_store_sales_0.ss_addr_sk IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       partitions: 0/0 rows=unavailable
       columns missing stats: ss_addr_sk, ss_ext_sales_price
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=20 row-size=12B cardinality=0
     in pipelines: 19(GETNEXT)

F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F12, EXCHANGE=54, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  20:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_2.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim_2.d_qoy = CAST(1 AS INT), default.impala_tpcds_date_dim_2.d_year = CAST(1999 AS INT)
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim_2.d_qoy = CAST(1 AS INT), default.impala_tpcds_date_dim_2.d_year = CAST(1999 AS INT)
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=21 row-size=12B cardinality=0
     in pipelines: 20(GETNEXT)

F14:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F12, EXCHANGE=55, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  22:SCAN HDFS [default.impala_tpcds_customer_address, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_customer_address_2.ca_address_sk IS NOT NULL, default.impala_tpcds_customer_address_2.ca_county IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=23 row-size=16B cardinality=0
     in pipelines: 22(GETNEXT)

F19:PLAN FRAGMENT [HASH(default.impala_tpcds_customer_address_3.ca_county)] hosts=1 instances=1
Per-Host Resources: mem-estimate=128.03MB mem-reservation=34.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F03, EXCHANGE=64, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  63:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(default.impala_tpcds_store_sales_1.ss_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address_3.ca_county
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=31 row-size=28B cardinality=0
  |  in pipelines: 63(GETNEXT), 27(OPEN)
  |
  62:EXCHANGE [HASH(default.impala_tpcds_customer_address_3.ca_county)]
     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=31 row-size=28B cardinality=0
     in pipelines: 27(GETNEXT)

F16:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=131.91MB mem-reservation=37.88MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F19, EXCHANGE=62, HASH(default.impala_tpcds_customer_address_3.ca_county)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  32:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_store_sales_1.ss_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address_3.ca_county
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=31 row-size=28B cardinality=0
  |  in pipelines: 27(GETNEXT)
  |
  31:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store_sales_1.ss_addr_sk = default.impala_tpcds_customer_address_3.ca_address_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=26,27,29 row-size=40B cardinality=0
  |  in pipelines: 27(GETNEXT), 30(OPEN)
  |
  |--61:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=29 row-size=16B cardinality=0
  |     in pipelines: 30(GETNEXT)
  |
  29:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store_sales_1.ss_sold_date_sk = default.impala_tpcds_date_dim_3.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=26,27 row-size=24B cardinality=0
  |  in pipelines: 27(GETNEXT), 28(OPEN)
  |
  |--60:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=27 row-size=12B cardinality=0
  |     in pipelines: 28(GETNEXT)
  |
  27:SCAN HDFS [default.impala_tpcds_store_sales, RANDOM]
     partition predicates: default.impala_tpcds_store_sales_1.ss_sold_date_sk IS NOT NULL
     partitions=0/0 files=0 size=0B
     predicates: default.impala_tpcds_store_sales_1.ss_addr_sk IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       partitions: 0/0 rows=unavailable
       columns missing stats: ss_addr_sk, ss_ext_sales_price
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=26 row-size=12B cardinality=0
     in pipelines: 27(GETNEXT)

F17:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F16, EXCHANGE=60, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  28:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_3.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim_3.d_qoy = CAST(3 AS INT), default.impala_tpcds_date_dim_3.d_year = CAST(1999 AS INT)
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim_3.d_qoy = CAST(3 AS INT), default.impala_tpcds_date_dim_3.d_year = CAST(1999 AS INT)
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=27 row-size=12B cardinality=0
     in pipelines: 28(GETNEXT)

F18:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F16, EXCHANGE=61, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  30:SCAN HDFS [default.impala_tpcds_customer_address, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_customer_address_3.ca_address_sk IS NOT NULL, default.impala_tpcds_customer_address_3.ca_county IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=29 row-size=16B cardinality=0
     in pipelines: 30(GETNEXT)

F23:PLAN FRAGMENT [HASH(default.impala_tpcds_customer_address_4.ca_county)] hosts=1 instances=1
Per-Host Resources: mem-estimate=128.03MB mem-reservation=34.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F03, EXCHANGE=69, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  68:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(default.impala_tpcds_web_sales_1.ws_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address_4.ca_county
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=38 row-size=28B cardinality=0
  |  in pipelines: 68(GETNEXT), 34(OPEN)
  |
  67:EXCHANGE [HASH(default.impala_tpcds_customer_address_4.ca_county)]
     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=38 row-size=28B cardinality=0
     in pipelines: 34(GETNEXT)

F20:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=131.91MB mem-reservation=37.88MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F23, EXCHANGE=67, HASH(default.impala_tpcds_customer_address_4.ca_county)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  39:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_web_sales_1.ws_ext_sales_price)
  |  group by: default.impala_tpcds_customer_address_4.ca_county
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=38 row-size=28B cardinality=0
  |  in pipelines: 34(GETNEXT)
  |
  38:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_web_sales_1.ws_bill_addr_sk = default.impala_tpcds_customer_address_4.ca_address_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=32,34,36 row-size=40B cardinality=0
  |  in pipelines: 34(GETNEXT), 37(OPEN)
  |
  |--66:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=36 row-size=16B cardinality=0
  |     in pipelines: 37(GETNEXT)
  |
  36:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_web_sales_1.ws_sold_date_sk = default.impala_tpcds_date_dim_4.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=32,34 row-size=24B cardinality=0
  |  in pipelines: 34(GETNEXT), 35(OPEN)
  |
  |--65:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=34 row-size=12B cardinality=0
  |     in pipelines: 35(GETNEXT)
  |
  34:SCAN HDFS [default.impala_tpcds_web_sales, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_web_sales_1.ws_bill_addr_sk IS NOT NULL, default.impala_tpcds_web_sales_1.ws_sold_date_sk IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=32 row-size=12B cardinality=0
     in pipelines: 34(GETNEXT)

F21:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F20, EXCHANGE=65, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  35:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_4.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim_4.d_qoy = CAST(3 AS INT), default.impala_tpcds_date_dim_4.d_year = CAST(1999 AS INT)
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim_4.d_qoy = CAST(3 AS INT), default.impala_tpcds_date_dim_4.d_year = CAST(1999 AS INT)
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=34 row-size=12B cardinality=0
     in pipelines: 35(GETNEXT)

F22:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F20, EXCHANGE=66, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  37:SCAN HDFS [default.impala_tpcds_customer_address, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_customer_address_4.ca_address_sk IS NOT NULL, default.impala_tpcds_customer_address_4.ca_county IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=36 row-size=16B cardinality=0
     in pipelines: 37(GETNEXT)


  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

