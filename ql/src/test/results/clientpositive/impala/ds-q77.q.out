PREHOOK: query: explain cbo with ss as
 (select s_store_sk,
         sum(ss_ext_sales_price) as sales,
         sum(ss_net_profit) as profit
 from impala_tpcds_store_sales,
      impala_tpcds_date_dim,
      impala_tpcds_store
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date) 
                  and (cast('2000-08-16' as date) +  30 days) 
       and ss_store_sk = s_store_sk
 group by s_store_sk)
 ,
 sr as
 (select s_store_sk,
         sum(sr_return_amt) as returns,
         sum(sr_net_loss) as profit_loss
 from impala_tpcds_store_returns,
      impala_tpcds_date_dim,
      impala_tpcds_store
 where sr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and sr_store_sk = s_store_sk
 group by s_store_sk), 
 cs as
 (select cs_call_center_sk,
        sum(cs_ext_sales_price) as sales,
        sum(cs_net_profit) as profit
 from impala_tpcds_catalog_sales,
      impala_tpcds_date_dim
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
 group by cs_call_center_sk 
 ), 
 cr as
 (select cr_call_center_sk,
         sum(cr_return_amount) as returns,
         sum(cr_net_loss) as profit_loss
 from impala_tpcds_catalog_returns,
      impala_tpcds_date_dim
 where cr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
 group by cr_call_center_sk
 ), 
 ws as
 ( select wp_web_page_sk,
        sum(ws_ext_sales_price) as sales,
        sum(ws_net_profit) as profit
 from impala_tpcds_web_sales,
      impala_tpcds_date_dim,
      impala_tpcds_web_page
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and ws_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk), 
 wr as
 (select wp_web_page_sk,
        sum(wr_return_amt) as returns,
        sum(wr_net_loss) as profit_loss
 from impala_tpcds_web_returns,
      impala_tpcds_date_dim,
      impala_tpcds_web_page
 where wr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and wr_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , ss.s_store_sk as id
        , sales
        , coalesce(returns, 0) as returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ss left join sr
        on  ss.s_store_sk = sr.s_store_sk
 union all
 select 'catalog channel' as channel
        , cs_call_center_sk as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from  cs
       , cr
 union all
 select 'web channel' as channel
        , ws.wp_web_page_sk as id
        , sales
        , coalesce(returns, 0) returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ws left join wr
        on  ws.wp_web_page_sk = wr.wp_web_page_sk
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@impala_tpcds_catalog_returns
PREHOOK: Input: default@impala_tpcds_catalog_sales
PREHOOK: Input: default@impala_tpcds_date_dim
PREHOOK: Input: default@impala_tpcds_store
PREHOOK: Input: default@impala_tpcds_store_returns
PREHOOK: Input: default@impala_tpcds_store_sales
PREHOOK: Input: default@impala_tpcds_web_page
PREHOOK: Input: default@impala_tpcds_web_returns
PREHOOK: Input: default@impala_tpcds_web_sales
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain cbo with ss as
 (select s_store_sk,
         sum(ss_ext_sales_price) as sales,
         sum(ss_net_profit) as profit
 from impala_tpcds_store_sales,
      impala_tpcds_date_dim,
      impala_tpcds_store
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date) 
                  and (cast('2000-08-16' as date) +  30 days) 
       and ss_store_sk = s_store_sk
 group by s_store_sk)
 ,
 sr as
 (select s_store_sk,
         sum(sr_return_amt) as returns,
         sum(sr_net_loss) as profit_loss
 from impala_tpcds_store_returns,
      impala_tpcds_date_dim,
      impala_tpcds_store
 where sr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and sr_store_sk = s_store_sk
 group by s_store_sk), 
 cs as
 (select cs_call_center_sk,
        sum(cs_ext_sales_price) as sales,
        sum(cs_net_profit) as profit
 from impala_tpcds_catalog_sales,
      impala_tpcds_date_dim
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
 group by cs_call_center_sk 
 ), 
 cr as
 (select cr_call_center_sk,
         sum(cr_return_amount) as returns,
         sum(cr_net_loss) as profit_loss
 from impala_tpcds_catalog_returns,
      impala_tpcds_date_dim
 where cr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
 group by cr_call_center_sk
 ), 
 ws as
 ( select wp_web_page_sk,
        sum(ws_ext_sales_price) as sales,
        sum(ws_net_profit) as profit
 from impala_tpcds_web_sales,
      impala_tpcds_date_dim,
      impala_tpcds_web_page
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and ws_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk), 
 wr as
 (select wp_web_page_sk,
        sum(wr_return_amt) as returns,
        sum(wr_net_loss) as profit_loss
 from impala_tpcds_web_returns,
      impala_tpcds_date_dim,
      impala_tpcds_web_page
 where wr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and wr_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , ss.s_store_sk as id
        , sales
        , coalesce(returns, 0) as returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ss left join sr
        on  ss.s_store_sk = sr.s_store_sk
 union all
 select 'catalog channel' as channel
        , cs_call_center_sk as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from  cs
       , cr
 union all
 select 'web channel' as channel
        , ws.wp_web_page_sk as id
        , sales
        , coalesce(returns, 0) returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ws left join wr
        on  ws.wp_web_page_sk = wr.wp_web_page_sk
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@impala_tpcds_catalog_returns
POSTHOOK: Input: default@impala_tpcds_catalog_sales
POSTHOOK: Input: default@impala_tpcds_date_dim
POSTHOOK: Input: default@impala_tpcds_store
POSTHOOK: Input: default@impala_tpcds_store_returns
POSTHOOK: Input: default@impala_tpcds_store_sales
POSTHOOK: Input: default@impala_tpcds_web_page
POSTHOOK: Input: default@impala_tpcds_web_returns
POSTHOOK: Input: default@impala_tpcds_web_sales
POSTHOOK: Output: hdfs://### HDFS PATH ###
CBO PLAN:
ImpalaSortRel(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100])
  ImpalaAggregateRel(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], agg#0=[sum($2)], agg#1=[sum($3)], agg#2=[sum($4)])
    ImpalaUnionRel(all=[true])
      ImpalaProjectPassthroughRel(channel=[_UTF-16LE'store channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[$0], sales=[$1], returns=[COALESCE($4, 0:DECIMAL(3, 0))], profit=[-($2, COALESCE($5, 0:DECIMAL(3, 0)))])
        ImpalaJoinRel(condition=[=($0, $3)], joinType=[left])
          ImpalaAggregateRel(group=[{5}], agg#0=[sum($1)], agg#1=[sum($2)])
            ImpalaJoinRel(condition=[=($0, $5)], joinType=[inner])
              ImpalaJoinRel(condition=[=($3, $4)], joinType=[inner])
                ImpalaProjectPassthroughRel(ss_store_sk=[$6], ss_ext_sales_price=[$14], ss_net_profit=[$21], ss_sold_date_sk=[$22])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_store_sales]], condition=[AND(IS NOT NULL($22), IS NOT NULL($6))])
                ImpalaProjectPassthroughRel(d_date_sk=[$0])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(BETWEEN(false, CAST($2):TIMESTAMP(9), CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, +(CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, 2592000000.000000:INTERVAL MILLISECOND)), IS NOT NULL($0))])
              ImpalaProjectPassthroughRel(s_store_sk=[$0])
                ImpalaHdfsScanRel(table=[[default, impala_tpcds_store]], condition=[IS NOT NULL($0)])
          ImpalaAggregateRel(group=[{5}], agg#0=[sum($2)], agg#1=[sum($3)])
            ImpalaJoinRel(condition=[=($1, $5)], joinType=[inner])
              ImpalaJoinRel(condition=[=($0, $4)], joinType=[inner])
                ImpalaProjectPassthroughRel(sr_returned_date_sk=[$0], sr_store_sk=[$7], sr_return_amt=[$11], sr_net_loss=[$19])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_store_returns]], condition=[AND(IS NOT NULL($0), IS NOT NULL($7))])
                ImpalaProjectPassthroughRel(d_date_sk=[$0])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(BETWEEN(false, CAST($2):TIMESTAMP(9), CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, +(CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, 2592000000.000000:INTERVAL MILLISECOND)), IS NOT NULL($0))])
              ImpalaProjectPassthroughRel(s_store_sk=[$0])
                ImpalaHdfsScanRel(table=[[default, impala_tpcds_store]], condition=[IS NOT NULL($0)])
      ImpalaProjectPassthroughRel(channel=[_UTF-16LE'catalog channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[$0], sales=[$1], returns=[$3], profit=[-($2, $4)])
        ImpalaJoinRel(condition=[true], joinType=[inner])
          ImpalaAggregateRel(group=[{1}], agg#0=[sum($2)], agg#1=[sum($3)])
            ImpalaJoinRel(condition=[=($0, $4)], joinType=[inner])
              ImpalaProjectPassthroughRel(cs_sold_date_sk=[$0], cs_call_center_sk=[$11], cs_ext_sales_price=[$23], cs_net_profit=[$33])
                ImpalaHdfsScanRel(table=[[default, impala_tpcds_catalog_sales]], condition=[IS NOT NULL($0)])
              ImpalaProjectPassthroughRel(d_date_sk=[$0])
                ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(BETWEEN(false, CAST($2):TIMESTAMP(9), CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, +(CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, 2592000000.000000:INTERVAL MILLISECOND)), IS NOT NULL($0))])
          ImpalaProjectPassthroughRel(returns=[$1], profit_loss=[$2])
            ImpalaAggregateRel(group=[{1}], agg#0=[sum($2)], agg#1=[sum($3)])
              ImpalaJoinRel(condition=[=($0, $4)], joinType=[inner])
                ImpalaProjectPassthroughRel(cr_returned_date_sk=[$0], cr_call_center_sk=[$11], cr_return_amount=[$18], cr_net_loss=[$26])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_catalog_returns]], condition=[IS NOT NULL($0)])
                ImpalaProjectPassthroughRel(d_date_sk=[$0])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(BETWEEN(false, CAST($2):TIMESTAMP(9), CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, +(CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, 2592000000.000000:INTERVAL MILLISECOND)), IS NOT NULL($0))])
      ImpalaProjectPassthroughRel(channel=[_UTF-16LE'web channel':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"], id=[$0], sales=[$1], returns=[COALESCE($4, 0:DECIMAL(3, 0))], profit=[-($2, COALESCE($5, 0:DECIMAL(3, 0)))])
        ImpalaJoinRel(condition=[=($0, $3)], joinType=[left])
          ImpalaAggregateRel(group=[{5}], agg#0=[sum($2)], agg#1=[sum($3)])
            ImpalaJoinRel(condition=[=($1, $5)], joinType=[inner])
              ImpalaJoinRel(condition=[=($0, $4)], joinType=[inner])
                ImpalaProjectPassthroughRel(ws_sold_date_sk=[$0], ws_web_page_sk=[$12], ws_ext_sales_price=[$23], ws_net_profit=[$33])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_sales]], condition=[AND(IS NOT NULL($0), IS NOT NULL($12))])
                ImpalaProjectPassthroughRel(d_date_sk=[$0])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(BETWEEN(false, CAST($2):TIMESTAMP(9), CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, +(CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, 2592000000.000000:INTERVAL MILLISECOND)), IS NOT NULL($0))])
              ImpalaProjectPassthroughRel(wp_web_page_sk=[$0])
                ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_page]], condition=[IS NOT NULL($0)])
          ImpalaAggregateRel(group=[{5}], agg#0=[sum($2)], agg#1=[sum($3)])
            ImpalaJoinRel(condition=[=($1, $5)], joinType=[inner])
              ImpalaJoinRel(condition=[=($0, $4)], joinType=[inner])
                ImpalaProjectPassthroughRel(wr_returned_date_sk=[$0], wr_web_page_sk=[$11], wr_return_amt=[$15], wr_net_loss=[$23])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_returns]], condition=[AND(IS NOT NULL($0), IS NOT NULL($11))])
                ImpalaProjectPassthroughRel(d_date_sk=[$0])
                  ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(BETWEEN(false, CAST($2):TIMESTAMP(9), CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, +(CAST(CAST(_UTF-16LE'2000-08-16':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"):DATE NOT NULL):TIMESTAMP(9) NOT NULL, 2592000000.000000:INTERVAL MILLISECOND)), IS NOT NULL($0))])
              ImpalaProjectPassthroughRel(wp_web_page_sk=[$0])
                ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_page]], condition=[IS NOT NULL($0)])

PREHOOK: query: explain with ss as
 (select s_store_sk,
         sum(ss_ext_sales_price) as sales,
         sum(ss_net_profit) as profit
 from impala_tpcds_store_sales,
      impala_tpcds_date_dim,
      impala_tpcds_store
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date) 
                  and (cast('2000-08-16' as date) +  30 days) 
       and ss_store_sk = s_store_sk
 group by s_store_sk)
 ,
 sr as
 (select s_store_sk,
         sum(sr_return_amt) as returns,
         sum(sr_net_loss) as profit_loss
 from impala_tpcds_store_returns,
      impala_tpcds_date_dim,
      impala_tpcds_store
 where sr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and sr_store_sk = s_store_sk
 group by s_store_sk), 
 cs as
 (select cs_call_center_sk,
        sum(cs_ext_sales_price) as sales,
        sum(cs_net_profit) as profit
 from impala_tpcds_catalog_sales,
      impala_tpcds_date_dim
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
 group by cs_call_center_sk 
 ), 
 cr as
 (select cr_call_center_sk,
         sum(cr_return_amount) as returns,
         sum(cr_net_loss) as profit_loss
 from impala_tpcds_catalog_returns,
      impala_tpcds_date_dim
 where cr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
 group by cr_call_center_sk
 ), 
 ws as
 ( select wp_web_page_sk,
        sum(ws_ext_sales_price) as sales,
        sum(ws_net_profit) as profit
 from impala_tpcds_web_sales,
      impala_tpcds_date_dim,
      impala_tpcds_web_page
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and ws_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk), 
 wr as
 (select wp_web_page_sk,
        sum(wr_return_amt) as returns,
        sum(wr_net_loss) as profit_loss
 from impala_tpcds_web_returns,
      impala_tpcds_date_dim,
      impala_tpcds_web_page
 where wr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and wr_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , ss.s_store_sk as id
        , sales
        , coalesce(returns, 0) as returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ss left join sr
        on  ss.s_store_sk = sr.s_store_sk
 union all
 select 'catalog channel' as channel
        , cs_call_center_sk as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from  cs
       , cr
 union all
 select 'web channel' as channel
        , ws.wp_web_page_sk as id
        , sales
        , coalesce(returns, 0) returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ws left join wr
        on  ws.wp_web_page_sk = wr.wp_web_page_sk
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@impala_tpcds_catalog_returns
PREHOOK: Input: default@impala_tpcds_catalog_sales
PREHOOK: Input: default@impala_tpcds_date_dim
PREHOOK: Input: default@impala_tpcds_store
PREHOOK: Input: default@impala_tpcds_store_returns
PREHOOK: Input: default@impala_tpcds_store_sales
PREHOOK: Input: default@impala_tpcds_web_page
PREHOOK: Input: default@impala_tpcds_web_returns
PREHOOK: Input: default@impala_tpcds_web_sales
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain with ss as
 (select s_store_sk,
         sum(ss_ext_sales_price) as sales,
         sum(ss_net_profit) as profit
 from impala_tpcds_store_sales,
      impala_tpcds_date_dim,
      impala_tpcds_store
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date) 
                  and (cast('2000-08-16' as date) +  30 days) 
       and ss_store_sk = s_store_sk
 group by s_store_sk)
 ,
 sr as
 (select s_store_sk,
         sum(sr_return_amt) as returns,
         sum(sr_net_loss) as profit_loss
 from impala_tpcds_store_returns,
      impala_tpcds_date_dim,
      impala_tpcds_store
 where sr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and sr_store_sk = s_store_sk
 group by s_store_sk), 
 cs as
 (select cs_call_center_sk,
        sum(cs_ext_sales_price) as sales,
        sum(cs_net_profit) as profit
 from impala_tpcds_catalog_sales,
      impala_tpcds_date_dim
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
 group by cs_call_center_sk 
 ), 
 cr as
 (select cr_call_center_sk,
         sum(cr_return_amount) as returns,
         sum(cr_net_loss) as profit_loss
 from impala_tpcds_catalog_returns,
      impala_tpcds_date_dim
 where cr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
 group by cr_call_center_sk
 ), 
 ws as
 ( select wp_web_page_sk,
        sum(ws_ext_sales_price) as sales,
        sum(ws_net_profit) as profit
 from impala_tpcds_web_sales,
      impala_tpcds_date_dim,
      impala_tpcds_web_page
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and ws_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk), 
 wr as
 (select wp_web_page_sk,
        sum(wr_return_amt) as returns,
        sum(wr_net_loss) as profit_loss
 from impala_tpcds_web_returns,
      impala_tpcds_date_dim,
      impala_tpcds_web_page
 where wr_returned_date_sk = d_date_sk
       and d_date between cast('2000-08-16' as date)
                  and (cast('2000-08-16' as date) +  30 days)
       and wr_web_page_sk = wp_web_page_sk
 group by wp_web_page_sk)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from 
 (select 'store channel' as channel
        , ss.s_store_sk as id
        , sales
        , coalesce(returns, 0) as returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ss left join sr
        on  ss.s_store_sk = sr.s_store_sk
 union all
 select 'catalog channel' as channel
        , cs_call_center_sk as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from  cs
       , cr
 union all
 select 'web channel' as channel
        , ws.wp_web_page_sk as id
        , sales
        , coalesce(returns, 0) returns
        , (profit - coalesce(profit_loss,0)) as profit
 from   ws left join wr
        on  ws.wp_web_page_sk = wr.wp_web_page_sk
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@impala_tpcds_catalog_returns
POSTHOOK: Input: default@impala_tpcds_catalog_sales
POSTHOOK: Input: default@impala_tpcds_date_dim
POSTHOOK: Input: default@impala_tpcds_store
POSTHOOK: Input: default@impala_tpcds_store_returns
POSTHOOK: Input: default@impala_tpcds_store_sales
POSTHOOK: Input: default@impala_tpcds_web_page
POSTHOOK: Input: default@impala_tpcds_web_returns
POSTHOOK: Input: default@impala_tpcds_web_sales
POSTHOOK: Output: hdfs://### HDFS PATH ###
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Impala
      Impala Plan: 
F24:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
Per-Host Resources: mem-estimate=68.00KB mem-reservation=0B thread-reservation=1
  PLAN-ROOT SINK
  |  output exprs: CASE valid_tid(38,39,40) WHEN 38 THEN channel WHEN 39 THEN channel WHEN 40 THEN NULL END, CASE valid_tid(38,39,40) WHEN 38 THEN id WHEN 39 THEN NULL WHEN 40 THEN NULL END, aggif(valid_tid(38,39,40) IN (38, 39, 40), CASE valid_tid(38,39,40) WHEN 38 THEN _impala_builtins.sum(sales) WHEN 39 THEN sum(sales) WHEN 40 THEN sum(sales) END), aggif(valid_tid(38,39,40) IN (38, 39, 40), CASE valid_tid(38,39,40) WHEN 38 THEN _impala_builtins.sum(returns) WHEN 39 THEN sum(returns) WHEN 40 THEN sum(returns) END), aggif(valid_tid(38,39,40) IN (38, 39, 40), CASE valid_tid(38,39,40) WHEN 38 THEN _impala_builtins.sum(profit) WHEN 39 THEN sum(profit) WHEN 40 THEN sum(profit) END)
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |
  66:MERGING-EXCHANGE [UNPARTITIONED]
     order by: CASE valid_tid(38,39,40) WHEN 38 THEN channel WHEN 39 THEN channel WHEN 40 THEN NULL END ASC NULLS LAST, CASE valid_tid(38,39,40) WHEN 38 THEN id WHEN 39 THEN NULL WHEN 40 THEN NULL END ASC NULLS LAST
     limit: 100
     mem-estimate=68.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=42 row-size=64B cardinality=0
     in pipelines: 38(GETNEXT)

F23:PLAN FRAGMENT [HASH(CASE valid_tid(38,39,40) WHEN 38 THEN murmur_hash(channel) WHEN 39 THEN murmur_hash(channel) WHEN 40 THEN murmur_hash(NULL) END,CASE valid_tid(38,39,40) WHEN 38 THEN murmur_hash(id) WHEN 39 THEN murmur_hash(NULL) WHEN 40 THEN murmur_hash(NULL) END)] hosts=1 instances=1
Per-Host Resources: mem-estimate=394.00MB mem-reservation=103.94MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F24, EXCHANGE=66, UNPARTITIONED]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  38:TOP-N [LIMIT=100]
  |  order by: CASE valid_tid(38,39,40) WHEN 38 THEN channel WHEN 39 THEN channel WHEN 40 THEN NULL END ASC NULLS LAST, CASE valid_tid(38,39,40) WHEN 38 THEN id WHEN 39 THEN NULL WHEN 40 THEN NULL END ASC NULLS LAST
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |  tuple-ids=42 row-size=64B cardinality=0
  |  in pipelines: 38(GETNEXT), 37(OPEN)
  |
  37:AGGREGATE [FINALIZE]
  |  output: aggif(valid_tid(38,39,40) IN (CAST(38 AS INT), CAST(39 AS INT), CAST(40 AS INT)), CASE valid_tid(38,39,40) WHEN CAST(38 AS INT) THEN _impala_builtins.sum(sales) WHEN CAST(39 AS INT) THEN sum(sales) WHEN CAST(40 AS INT) THEN sum(sales) END), aggif(valid_tid(38,39,40) IN (CAST(38 AS INT), CAST(39 AS INT), CAST(40 AS INT)), CASE valid_tid(38,39,40) WHEN CAST(38 AS INT) THEN _impala_builtins.sum(returns) WHEN CAST(39 AS INT) THEN sum(returns) WHEN CAST(40 AS INT) THEN sum(returns) END), aggif(valid_tid(38,39,40) IN (CAST(38 AS INT), CAST(39 AS INT), CAST(40 AS INT)), CASE valid_tid(38,39,40) WHEN CAST(38 AS INT) THEN _impala_builtins.sum(profit) WHEN CAST(39 AS INT) THEN sum(profit) WHEN CAST(40 AS INT) THEN sum(profit) END)
  |  group by: CASE valid_tid(38,39,40) WHEN CAST(38 AS INT) THEN channel WHEN CAST(39 AS INT) THEN channel WHEN CAST(40 AS INT) THEN NULL END, CASE valid_tid(38,39,40) WHEN CAST(38 AS INT) THEN id WHEN CAST(39 AS INT) THEN NULL WHEN CAST(40 AS INT) THEN NULL END, CASE valid_tid(38,39,40) WHEN CAST(38 AS INT) THEN CAST(38 AS INT) WHEN CAST(39 AS INT) THEN CAST(39 AS INT) WHEN CAST(40 AS INT) THEN CAST(40 AS INT) END
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=41 row-size=68B cardinality=0
  |  in pipelines: 37(GETNEXT), 65(OPEN)
  |
  65:AGGREGATE [FINALIZE]
  |  Class 0
  |    output: _impala_builtins.sum:merge(sales), _impala_builtins.sum:merge(returns), _impala_builtins.sum:merge(profit)
  |    group by: channel, id
  |  Class 1
  |    output: sum:merge(sales), sum:merge(returns), sum:merge(profit)
  |    group by: channel, NULL
  |  Class 2
  |    output: sum:merge(sales), sum:merge(returns), sum:merge(profit)
  |    group by: NULL, NULL
  |  mem-estimate=266.00MB mem-reservation=69.94MB thread-reservation=0
  |  tuple-ids=38N,39N,40N row-size=192B cardinality=0
  |  in pipelines: 65(GETNEXT), 42(OPEN), 50(OPEN), 58(OPEN)
  |
  64:EXCHANGE [HASH(CASE valid_tid(38,39,40) WHEN 38 THEN murmur_hash(channel) WHEN 39 THEN murmur_hash(channel) WHEN 40 THEN murmur_hash(NULL) END,CASE valid_tid(38,39,40) WHEN 38 THEN murmur_hash(id) WHEN 39 THEN murmur_hash(NULL) WHEN 40 THEN murmur_hash(NULL) END)]
     mem-estimate=204.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=38N,39N,40N row-size=192B cardinality=0
     in pipelines: 42(GETNEXT), 50(GETNEXT), 58(GETNEXT)

F22:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=396.02MB mem-reservation=105.94MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F23, EXCHANGE=64, HASH(CASE valid_tid(38,39,40) WHEN 38 THEN murmur_hash(channel) WHEN 39 THEN murmur_hash(channel) WHEN 40 THEN murmur_hash(NULL) END,CASE valid_tid(38,39,40) WHEN 38 THEN murmur_hash(id) WHEN 39 THEN murmur_hash(NULL) WHEN 40 THEN murmur_hash(NULL) END)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  36:AGGREGATE [STREAMING]
  |  Class 0
  |    output: sum(sales), sum(returns), sum(profit)
  |    group by: channel, id
  |  Class 1
  |    output: sum(sales), sum(returns), sum(profit)
  |    group by: channel, NULL
  |  Class 2
  |    output: sum(sales), sum(returns), sum(profit)
  |    group by: NULL, NULL
  |  mem-estimate=266.00MB mem-reservation=70.00MB thread-reservation=0
  |  tuple-ids=38N,39N,40N row-size=192B cardinality=0
  |  in pipelines: 42(GETNEXT), 50(GETNEXT), 58(GETNEXT)
  |
  00:UNION
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |  tuple-ids=0 row-size=64B cardinality=0
  |  in pipelines: 42(GETNEXT), 50(GETNEXT), 58(GETNEXT)
  |
  |--35:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_web_page.wp_web_page_sk = default.impala_tpcds_web_page_0.wp_web_page_sk
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=30,37N row-size=72B cardinality=0
  |  |  in pipelines: 58(GETNEXT), 62(OPEN)
  |  |
  |  |--63:EXCHANGE [BROADCAST]
  |  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=37 row-size=36B cardinality=0
  |  |     in pipelines: 62(GETNEXT)
  |  |
  |  58:AGGREGATE [FINALIZE]
  |  |  output: _impala_builtins.sum:merge(default.impala_tpcds_web_sales.ws_ext_sales_price), _impala_builtins.sum:merge(default.impala_tpcds_web_sales.ws_net_profit)
  |  |  group by: default.impala_tpcds_web_page.wp_web_page_sk
  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  |  tuple-ids=30 row-size=36B cardinality=0
  |  |  in pipelines: 58(GETNEXT), 23(OPEN)
  |  |
  |  57:EXCHANGE [HASH(default.impala_tpcds_web_page.wp_web_page_sk)]
  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=30 row-size=36B cardinality=0
  |     in pipelines: 23(GETNEXT)
  |
  |--22:NESTED LOOP JOIN [CROSS JOIN, BROADCAST]
  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |  |  tuple-ids=18,23 row-size=72B cardinality=0
  |  |  in pipelines: 50(GETNEXT), 53(OPEN)
  |  |
  |  |--54:EXCHANGE [BROADCAST]
  |  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=23 row-size=36B cardinality=0
  |  |     in pipelines: 53(GETNEXT)
  |  |
  |  50:AGGREGATE [FINALIZE]
  |  |  output: _impala_builtins.sum:merge(default.impala_tpcds_catalog_sales.cs_ext_sales_price), _impala_builtins.sum:merge(default.impala_tpcds_catalog_sales.cs_net_profit)
  |  |  group by: default.impala_tpcds_catalog_sales.cs_call_center_sk
  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  |  tuple-ids=18 row-size=36B cardinality=0
  |  |  in pipelines: 50(GETNEXT), 14(OPEN)
  |  |
  |  49:EXCHANGE [HASH(default.impala_tpcds_catalog_sales.cs_call_center_sk)]
  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=18 row-size=36B cardinality=0
  |     in pipelines: 14(GETNEXT)
  |
  13:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store.s_store_sk = default.impala_tpcds_store_0.s_store_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=6,13N row-size=72B cardinality=0
  |  in pipelines: 42(GETNEXT), 46(OPEN)
  |
  |--47:EXCHANGE [BROADCAST]
  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=13 row-size=36B cardinality=0
  |     in pipelines: 46(GETNEXT)
  |
  42:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(default.impala_tpcds_store_sales.ss_ext_sales_price), _impala_builtins.sum:merge(default.impala_tpcds_store_sales.ss_net_profit)
  |  group by: default.impala_tpcds_store.s_store_sk
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=6 row-size=36B cardinality=0
  |  in pipelines: 42(GETNEXT), 01(OPEN)
  |
  41:EXCHANGE [HASH(default.impala_tpcds_store.s_store_sk)]
     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=6 row-size=36B cardinality=0
     in pipelines: 01(GETNEXT)

F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=131.91MB mem-reservation=37.88MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F22, EXCHANGE=41, HASH(default.impala_tpcds_store.s_store_sk)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  06:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_store_sales.ss_ext_sales_price), sum(default.impala_tpcds_store_sales.ss_net_profit)
  |  group by: default.impala_tpcds_store.s_store_sk
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=6 row-size=36B cardinality=0
  |  in pipelines: 01(GETNEXT)
  |
  05:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store_sales.ss_store_sk = default.impala_tpcds_store.s_store_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=1,2,4 row-size=36B cardinality=0
  |  in pipelines: 01(GETNEXT), 04(OPEN)
  |
  |--40:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=4 row-size=4B cardinality=0
  |     in pipelines: 04(GETNEXT)
  |
  03:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store_sales.ss_sold_date_sk = default.impala_tpcds_date_dim.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=1,2 row-size=32B cardinality=0
  |  in pipelines: 01(GETNEXT), 02(OPEN)
  |
  |--39:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=2 row-size=16B cardinality=0
  |     in pipelines: 02(GETNEXT)
  |
  01:SCAN HDFS [default.impala_tpcds_store_sales, RANDOM]
     partition predicates: default.impala_tpcds_store_sales.ss_sold_date_sk IS NOT NULL
     partitions=0/0 files=0 size=0B
     predicates: default.impala_tpcds_store_sales.ss_store_sk IS NOT NULL
     stored statistics:
       table: rows=unavailable size=unavailable
       partitions: 0/0 rows=unavailable
       columns missing stats: ss_store_sk, ss_ext_sales_price, ss_net_profit
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=1 row-size=16B cardinality=0
     in pipelines: 01(GETNEXT)

F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F00, EXCHANGE=39, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  02:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim.d_date_sk IS NOT NULL, _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim.d_date) >= _impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')) AND _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim.d_date) <= _IMPALA_BUILTINS.MILLISECONDS_ADD(_impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')), INTERVAL CAST(2592000000 AS BIGINT) MILLISECOND)
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=2 row-size=16B cardinality=0
     in pipelines: 02(GETNEXT)

F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F00, EXCHANGE=40, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  04:SCAN HDFS [default.impala_tpcds_store, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_store.s_store_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=4 row-size=4B cardinality=0
     in pipelines: 04(GETNEXT)

F07:PLAN FRAGMENT [HASH(default.impala_tpcds_store_0.s_store_sk)] hosts=1 instances=1
Per-Host Resources: mem-estimate=128.04MB mem-reservation=34.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F22, EXCHANGE=47, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  46:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(default.impala_tpcds_store_returns.sr_return_amt), _impala_builtins.sum:merge(default.impala_tpcds_store_returns.sr_net_loss)
  |  group by: default.impala_tpcds_store_0.s_store_sk
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=13 row-size=36B cardinality=0
  |  in pipelines: 46(GETNEXT), 07(OPEN)
  |
  45:EXCHANGE [HASH(default.impala_tpcds_store_0.s_store_sk)]
     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=13 row-size=36B cardinality=0
     in pipelines: 07(GETNEXT)

F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=131.91MB mem-reservation=37.88MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F07, EXCHANGE=45, HASH(default.impala_tpcds_store_0.s_store_sk)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  12:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_store_returns.sr_return_amt), sum(default.impala_tpcds_store_returns.sr_net_loss)
  |  group by: default.impala_tpcds_store_0.s_store_sk
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=13 row-size=36B cardinality=0
  |  in pipelines: 07(GETNEXT)
  |
  11:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store_returns.sr_store_sk = default.impala_tpcds_store_0.s_store_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=7,9,11 row-size=36B cardinality=0
  |  in pipelines: 07(GETNEXT), 10(OPEN)
  |
  |--44:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=11 row-size=4B cardinality=0
  |     in pipelines: 10(GETNEXT)
  |
  09:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_store_returns.sr_returned_date_sk = default.impala_tpcds_date_dim_0.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=7,9 row-size=32B cardinality=0
  |  in pipelines: 07(GETNEXT), 08(OPEN)
  |
  |--43:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=9 row-size=16B cardinality=0
  |     in pipelines: 08(GETNEXT)
  |
  07:SCAN HDFS [default.impala_tpcds_store_returns, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_store_returns.sr_returned_date_sk IS NOT NULL, default.impala_tpcds_store_returns.sr_store_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=7 row-size=16B cardinality=0
     in pipelines: 07(GETNEXT)

F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F04, EXCHANGE=43, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  08:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_0.d_date_sk IS NOT NULL, _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim_0.d_date) >= _impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')) AND _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim_0.d_date) <= _IMPALA_BUILTINS.MILLISECONDS_ADD(_impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')), INTERVAL CAST(2592000000 AS BIGINT) MILLISECOND)
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=9 row-size=16B cardinality=0
     in pipelines: 08(GETNEXT)

F06:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F04, EXCHANGE=44, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  10:SCAN HDFS [default.impala_tpcds_store, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_store_0.s_store_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=11 row-size=4B cardinality=0
     in pipelines: 10(GETNEXT)

F08:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=129.96MB mem-reservation=35.94MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F22, EXCHANGE=49, HASH(default.impala_tpcds_catalog_sales.cs_call_center_sk)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  17:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_catalog_sales.cs_ext_sales_price), sum(default.impala_tpcds_catalog_sales.cs_net_profit)
  |  group by: default.impala_tpcds_catalog_sales.cs_call_center_sk
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=18 row-size=36B cardinality=0
  |  in pipelines: 14(GETNEXT)
  |
  16:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_catalog_sales.cs_sold_date_sk = default.impala_tpcds_date_dim_1.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=14,16 row-size=32B cardinality=0
  |  in pipelines: 14(GETNEXT), 15(OPEN)
  |
  |--48:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=16 row-size=16B cardinality=0
  |     in pipelines: 15(GETNEXT)
  |
  14:SCAN HDFS [default.impala_tpcds_catalog_sales, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_catalog_sales.cs_sold_date_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=14 row-size=16B cardinality=0
     in pipelines: 14(GETNEXT)

F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F08, EXCHANGE=48, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  15:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_1.d_date_sk IS NOT NULL, _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim_1.d_date) >= _impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')) AND _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim_1.d_date) <= _IMPALA_BUILTINS.MILLISECONDS_ADD(_impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')), INTERVAL CAST(2592000000 AS BIGINT) MILLISECOND)
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=16 row-size=16B cardinality=0
     in pipelines: 15(GETNEXT)

F13:PLAN FRAGMENT [HASH(default.impala_tpcds_catalog_returns.cr_call_center_sk)] hosts=1 instances=1
Per-Host Resources: mem-estimate=128.04MB mem-reservation=34.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F22, EXCHANGE=54, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  53:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(default.impala_tpcds_catalog_returns.cr_return_amount), _impala_builtins.sum:merge(default.impala_tpcds_catalog_returns.cr_net_loss)
  |  group by: default.impala_tpcds_catalog_returns.cr_call_center_sk
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=23 row-size=36B cardinality=0
  |  in pipelines: 53(GETNEXT), 18(OPEN)
  |
  52:EXCHANGE [HASH(default.impala_tpcds_catalog_returns.cr_call_center_sk)]
     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=23 row-size=36B cardinality=0
     in pipelines: 18(GETNEXT)

F11:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=129.96MB mem-reservation=35.94MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F13, EXCHANGE=52, HASH(default.impala_tpcds_catalog_returns.cr_call_center_sk)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  21:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_catalog_returns.cr_return_amount), sum(default.impala_tpcds_catalog_returns.cr_net_loss)
  |  group by: default.impala_tpcds_catalog_returns.cr_call_center_sk
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=23 row-size=36B cardinality=0
  |  in pipelines: 18(GETNEXT)
  |
  20:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_catalog_returns.cr_returned_date_sk = default.impala_tpcds_date_dim_2.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=19,21 row-size=32B cardinality=0
  |  in pipelines: 18(GETNEXT), 19(OPEN)
  |
  |--51:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=21 row-size=16B cardinality=0
  |     in pipelines: 19(GETNEXT)
  |
  18:SCAN HDFS [default.impala_tpcds_catalog_returns, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_catalog_returns.cr_returned_date_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=19 row-size=16B cardinality=0
     in pipelines: 18(GETNEXT)

F12:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F11, EXCHANGE=51, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  19:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_2.d_date_sk IS NOT NULL, _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim_2.d_date) >= _impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')) AND _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim_2.d_date) <= _IMPALA_BUILTINS.MILLISECONDS_ADD(_impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')), INTERVAL CAST(2592000000 AS BIGINT) MILLISECOND)
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=21 row-size=16B cardinality=0
     in pipelines: 19(GETNEXT)

F14:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=131.91MB mem-reservation=37.88MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F22, EXCHANGE=57, HASH(default.impala_tpcds_web_page.wp_web_page_sk)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  28:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_web_sales.ws_ext_sales_price), sum(default.impala_tpcds_web_sales.ws_net_profit)
  |  group by: default.impala_tpcds_web_page.wp_web_page_sk
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=30 row-size=36B cardinality=0
  |  in pipelines: 23(GETNEXT)
  |
  27:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_web_sales.ws_web_page_sk = default.impala_tpcds_web_page.wp_web_page_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=24,26,28 row-size=36B cardinality=0
  |  in pipelines: 23(GETNEXT), 26(OPEN)
  |
  |--56:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=28 row-size=4B cardinality=0
  |     in pipelines: 26(GETNEXT)
  |
  25:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_web_sales.ws_sold_date_sk = default.impala_tpcds_date_dim_3.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=24,26 row-size=32B cardinality=0
  |  in pipelines: 23(GETNEXT), 24(OPEN)
  |
  |--55:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=26 row-size=16B cardinality=0
  |     in pipelines: 24(GETNEXT)
  |
  23:SCAN HDFS [default.impala_tpcds_web_sales, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_web_sales.ws_sold_date_sk IS NOT NULL, default.impala_tpcds_web_sales.ws_web_page_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=24 row-size=16B cardinality=0
     in pipelines: 23(GETNEXT)

F15:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F14, EXCHANGE=55, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  24:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_3.d_date_sk IS NOT NULL, _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim_3.d_date) >= _impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')) AND _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim_3.d_date) <= _IMPALA_BUILTINS.MILLISECONDS_ADD(_impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')), INTERVAL CAST(2592000000 AS BIGINT) MILLISECOND)
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=26 row-size=16B cardinality=0
     in pipelines: 24(GETNEXT)

F16:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F14, EXCHANGE=56, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  26:SCAN HDFS [default.impala_tpcds_web_page, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_web_page.wp_web_page_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=28 row-size=4B cardinality=0
     in pipelines: 26(GETNEXT)

F21:PLAN FRAGMENT [HASH(default.impala_tpcds_web_page_0.wp_web_page_sk)] hosts=1 instances=1
Per-Host Resources: mem-estimate=128.04MB mem-reservation=34.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F22, EXCHANGE=63, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  62:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(default.impala_tpcds_web_returns.wr_return_amt), _impala_builtins.sum:merge(default.impala_tpcds_web_returns.wr_net_loss)
  |  group by: default.impala_tpcds_web_page_0.wp_web_page_sk
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=37 row-size=36B cardinality=0
  |  in pipelines: 62(GETNEXT), 29(OPEN)
  |
  61:EXCHANGE [HASH(default.impala_tpcds_web_page_0.wp_web_page_sk)]
     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=37 row-size=36B cardinality=0
     in pipelines: 29(GETNEXT)

F18:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=131.91MB mem-reservation=37.88MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F21, EXCHANGE=61, HASH(default.impala_tpcds_web_page_0.wp_web_page_sk)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  34:AGGREGATE [STREAMING]
  |  output: sum(default.impala_tpcds_web_returns.wr_return_amt), sum(default.impala_tpcds_web_returns.wr_net_loss)
  |  group by: default.impala_tpcds_web_page_0.wp_web_page_sk
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=37 row-size=36B cardinality=0
  |  in pipelines: 29(GETNEXT)
  |
  33:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_web_returns.wr_web_page_sk = default.impala_tpcds_web_page_0.wp_web_page_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=31,33,35 row-size=36B cardinality=0
  |  in pipelines: 29(GETNEXT), 32(OPEN)
  |
  |--60:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=35 row-size=4B cardinality=0
  |     in pipelines: 32(GETNEXT)
  |
  31:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_web_returns.wr_returned_date_sk = default.impala_tpcds_date_dim_4.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=31,33 row-size=32B cardinality=0
  |  in pipelines: 29(GETNEXT), 30(OPEN)
  |
  |--59:EXCHANGE [BROADCAST]
  |     mem-estimate=20.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=33 row-size=16B cardinality=0
  |     in pipelines: 30(GETNEXT)
  |
  29:SCAN HDFS [default.impala_tpcds_web_returns, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_web_returns.wr_returned_date_sk IS NOT NULL, default.impala_tpcds_web_returns.wr_web_page_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=31 row-size=16B cardinality=0
     in pipelines: 29(GETNEXT)

F19:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F18, EXCHANGE=59, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  30:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_4.d_date_sk IS NOT NULL, _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim_4.d_date) >= _impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')) AND _impala_builtins.casttotimestamp(default.impala_tpcds_date_dim_4.d_date) <= _IMPALA_BUILTINS.MILLISECONDS_ADD(_impala_builtins.casttotimestamp(_impala_builtins.casttodate('2000-08-16')), INTERVAL CAST(2592000000 AS BIGINT) MILLISECOND)
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=33 row-size=16B cardinality=0
     in pipelines: 30(GETNEXT)

F20:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F18, EXCHANGE=60, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  32:SCAN HDFS [default.impala_tpcds_web_page, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_web_page_0.wp_web_page_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=35 row-size=4B cardinality=0
     in pipelines: 32(GETNEXT)


  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

