PREHOOK: query: explain SELECT  (1 + IF(7<0, PMOD((IF(7<0, PMOD(DATEDIFF(TO_DATE('1996-01-01'), '1995-01-01'),7)-7, PMOD(DATEDIFF(TO_DATE('1996-01-01'), '1995-01-01'), 7)) + 7),7)-7, PMOD((IF(7<0, PMOD(DATEDIFF(TO_DATE('1996-01-01'), '1995-01-01'),7)-7, PMOD(DATEDIFF(TO_DATE('1996-01-01'), '1995-01-01'), 7)) + 7), 7))) AS `sum_z_datepart_weekday_ok`
PREHOOK: type: QUERY
PREHOOK: Output: streaming
POSTHOOK: query: explain SELECT  (1 + IF(7<0, PMOD((IF(7<0, PMOD(DATEDIFF(TO_DATE('1996-01-01'), '1995-01-01'),7)-7, PMOD(DATEDIFF(TO_DATE('1996-01-01'), '1995-01-01'), 7)) + 7),7)-7, PMOD((IF(7<0, PMOD(DATEDIFF(TO_DATE('1996-01-01'), '1995-01-01'),7)-7, PMOD(DATEDIFF(TO_DATE('1996-01-01'), '1995-01-01'), 7)) + 7), 7))) AS `sum_z_datepart_weekday_ok`
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Impala
      Impala Plan: 
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  PLAN-ROOT SINK
  |  output exprs: add(CAST(1 AS BIGINT), if(FALSE, subtract(pmod(add(if(FALSE, subtract(pmod(casttobigint(datediff(casttodate(to_date(casttotimestamp('1996-01-01'))), casttodate('1995-01-01'))), CAST(7 AS BIGINT)), CAST(7 AS BIGINT)), pmod(casttobigint(datediff(casttodate(to_date(casttotimestamp('1996-01-01'))), casttodate('1995-01-01'))), CAST(7 AS BIGINT))), CAST(7 AS BIGINT)), CAST(7 AS BIGINT)), CAST(7 AS BIGINT)), pmod(add(if(FALSE, subtract(pmod(casttobigint(datediff(casttodate(to_date(casttotimestamp('1996-01-01'))), casttodate('1995-01-01'))), CAST(7 AS BIGINT)), CAST(7 AS BIGINT)), pmod(casttobigint(datediff(casttodate(to_date(casttotimestamp('1996-01-01'))), casttodate('1995-01-01'))), CAST(7 AS BIGINT))), CAST(7 AS BIGINT)), CAST(7 AS BIGINT))))
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |
  00:UNION
     constant-operands=1
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=0 row-size=0B cardinality=1
     in pipelines: <none>


  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

