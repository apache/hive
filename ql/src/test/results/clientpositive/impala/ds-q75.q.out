PREHOOK: query: explain cbo WITH all_sales AS (
 SELECT d_year
       ,i_brand_id
       ,i_class_id
       ,i_category_id
       ,i_manufact_id
       ,SUM(sales_cnt) AS sales_cnt
       ,SUM(sales_amt) AS sales_amt
 FROM (SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt
             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt
       FROM impala_tpcds_catalog_sales JOIN impala_tpcds_item ON i_item_sk=cs_item_sk
                          JOIN impala_tpcds_date_dim ON d_date_sk=cs_sold_date_sk
                          LEFT JOIN impala_tpcds_catalog_returns ON (cs_order_number=cr_order_number 
                                                    AND cs_item_sk=cr_item_sk)
       WHERE i_category='Sports'
       UNION
       SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt
             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt
       FROM impala_tpcds_store_sales JOIN impala_tpcds_item ON i_item_sk=ss_item_sk
                        JOIN impala_tpcds_date_dim ON d_date_sk=ss_sold_date_sk
                        LEFT JOIN impala_tpcds_store_returns ON (ss_ticket_number=sr_ticket_number 
                                                AND ss_item_sk=sr_item_sk)
       WHERE i_category='Sports'
       UNION
       SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt
             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt
       FROM impala_tpcds_web_sales JOIN impala_tpcds_item ON i_item_sk=ws_item_sk
                      JOIN impala_tpcds_date_dim ON d_date_sk=ws_sold_date_sk
                      LEFT JOIN impala_tpcds_web_returns ON (ws_order_number=wr_order_number 
                                            AND ws_item_sk=wr_item_sk)
       WHERE i_category='Sports') sales_detail
 GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)
 SELECT  prev_yr.d_year AS prev_year
                          ,curr_yr.d_year AS year
                          ,curr_yr.i_brand_id
                          ,curr_yr.i_class_id
                          ,curr_yr.i_category_id
                          ,curr_yr.i_manufact_id
                          ,prev_yr.sales_cnt AS prev_yr_cnt
                          ,curr_yr.sales_cnt AS curr_yr_cnt
                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff
                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff
 FROM all_sales curr_yr, all_sales prev_yr
 WHERE curr_yr.i_brand_id=prev_yr.i_brand_id
   AND curr_yr.i_class_id=prev_yr.i_class_id
   AND curr_yr.i_category_id=prev_yr.i_category_id
   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id
   AND curr_yr.d_year=2001
   AND prev_yr.d_year=2001-1
   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9
 ORDER BY sales_cnt_diff,sales_amt_diff
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@impala_tpcds_catalog_returns
PREHOOK: Input: default@impala_tpcds_catalog_sales
PREHOOK: Input: default@impala_tpcds_date_dim
PREHOOK: Input: default@impala_tpcds_item
PREHOOK: Input: default@impala_tpcds_store_returns
PREHOOK: Input: default@impala_tpcds_store_sales
PREHOOK: Input: default@impala_tpcds_web_returns
PREHOOK: Input: default@impala_tpcds_web_sales
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain cbo WITH all_sales AS (
 SELECT d_year
       ,i_brand_id
       ,i_class_id
       ,i_category_id
       ,i_manufact_id
       ,SUM(sales_cnt) AS sales_cnt
       ,SUM(sales_amt) AS sales_amt
 FROM (SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt
             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt
       FROM impala_tpcds_catalog_sales JOIN impala_tpcds_item ON i_item_sk=cs_item_sk
                          JOIN impala_tpcds_date_dim ON d_date_sk=cs_sold_date_sk
                          LEFT JOIN impala_tpcds_catalog_returns ON (cs_order_number=cr_order_number 
                                                    AND cs_item_sk=cr_item_sk)
       WHERE i_category='Sports'
       UNION
       SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt
             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt
       FROM impala_tpcds_store_sales JOIN impala_tpcds_item ON i_item_sk=ss_item_sk
                        JOIN impala_tpcds_date_dim ON d_date_sk=ss_sold_date_sk
                        LEFT JOIN impala_tpcds_store_returns ON (ss_ticket_number=sr_ticket_number 
                                                AND ss_item_sk=sr_item_sk)
       WHERE i_category='Sports'
       UNION
       SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt
             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt
       FROM impala_tpcds_web_sales JOIN impala_tpcds_item ON i_item_sk=ws_item_sk
                      JOIN impala_tpcds_date_dim ON d_date_sk=ws_sold_date_sk
                      LEFT JOIN impala_tpcds_web_returns ON (ws_order_number=wr_order_number 
                                            AND ws_item_sk=wr_item_sk)
       WHERE i_category='Sports') sales_detail
 GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)
 SELECT  prev_yr.d_year AS prev_year
                          ,curr_yr.d_year AS year
                          ,curr_yr.i_brand_id
                          ,curr_yr.i_class_id
                          ,curr_yr.i_category_id
                          ,curr_yr.i_manufact_id
                          ,prev_yr.sales_cnt AS prev_yr_cnt
                          ,curr_yr.sales_cnt AS curr_yr_cnt
                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff
                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff
 FROM all_sales curr_yr, all_sales prev_yr
 WHERE curr_yr.i_brand_id=prev_yr.i_brand_id
   AND curr_yr.i_class_id=prev_yr.i_class_id
   AND curr_yr.i_category_id=prev_yr.i_category_id
   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id
   AND curr_yr.d_year=2001
   AND prev_yr.d_year=2001-1
   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9
 ORDER BY sales_cnt_diff,sales_amt_diff
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@impala_tpcds_catalog_returns
POSTHOOK: Input: default@impala_tpcds_catalog_sales
POSTHOOK: Input: default@impala_tpcds_date_dim
POSTHOOK: Input: default@impala_tpcds_item
POSTHOOK: Input: default@impala_tpcds_store_returns
POSTHOOK: Input: default@impala_tpcds_store_sales
POSTHOOK: Input: default@impala_tpcds_web_returns
POSTHOOK: Input: default@impala_tpcds_web_sales
POSTHOOK: Output: hdfs://### HDFS PATH ###
CBO PLAN:
ImpalaProjectPassthroughRel(prev_year=[CAST(-(2001, 1)):INTEGER], year=[CAST(2001):INTEGER], i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], prev_yr_cnt=[$4], curr_yr_cnt=[$5], sales_cnt_diff=[$6], sales_amt_diff=[$7])
  ImpalaSortRel(sort0=[$6], sort1=[$7], dir0=[ASC], dir1=[ASC], fetch=[100])
    ImpalaProjectRel(i_brand_id=[$0], i_class_id=[$1], i_category_id=[$2], i_manufact_id=[$3], prev_yr_cnt=[$4], curr_yr_cnt=[$10], sales_cnt_diff=[-($10, $4)], sales_amt_diff=[-($11, $5)])
      ImpalaJoinRel(condition=[AND(=($6, $0), =($7, $1), =($8, $2), =($9, $3), <(/(CAST($10):DECIMAL(17, 2), CAST($4):DECIMAL(17, 2)), 0.9:DECIMAL(1, 1)))], joinType=[inner])
        ImpalaAggregateRel(group=[{0, 1, 2, 3}], agg#0=[sum($4)], agg#1=[sum($5)])
          ImpalaAggregateRel(group=[{0, 1, 2, 3, 4, 5}])
            ImpalaUnionRel(all=[true])
              ImpalaAggregateRel(group=[{0, 1, 2, 3, 4, 5}])
                ImpalaUnionRel(all=[true])
                  ImpalaProjectPassthroughRel(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($4, CAST(COALESCE($8, 0)):BIGINT)], sales_amt=[-($3, COALESCE($9, 0:DECIMAL(1, 0)))])
                    ImpalaJoinRel(condition=[=($10, $1)], joinType=[inner])
                      ImpalaJoinRel(condition=[AND(=($2, $7), =($1, $6))], joinType=[left])
                        ImpalaJoinRel(condition=[=($5, $0)], joinType=[inner])
                          ImpalaProjectPassthroughRel(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_order_number=[$17], cs_ext_sales_price=[$23], CAST=[CAST($18):BIGINT])
                            ImpalaHdfsScanRel(table=[[default, impala_tpcds_catalog_sales]], condition=[AND(IS NOT NULL($15), IS NOT NULL($0))])
                          ImpalaProjectPassthroughRel(d_date_sk=[$0])
                            ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($6, -(2001, 1)), IS NOT NULL($0))])
                        ImpalaProjectPassthroughRel(cr_item_sk=[$2], cr_order_number=[$16], cr_return_quantity=[$17], cr_return_amount=[$18])
                          ImpalaHdfsScanRel(table=[[default, impala_tpcds_catalog_returns]], condition=[AND(IS NOT NULL($16), IS NOT NULL($2))])
                      ImpalaProjectPassthroughRel(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                        ImpalaHdfsScanRel(table=[[default, impala_tpcds_item]], condition=[AND(=($12, _UTF-16LE'Sports'), IS NOT NULL($0), IS NOT NULL($7), IS NOT NULL($9), IS NOT NULL($11), IS NOT NULL($13))])
                  ImpalaProjectPassthroughRel(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($4, CAST(COALESCE($8, 0)):BIGINT)], sales_amt=[-($2, COALESCE($9, 0:DECIMAL(1, 0)))])
                    ImpalaJoinRel(condition=[=($10, $0)], joinType=[inner])
                      ImpalaJoinRel(condition=[AND(=($1, $7), =($0, $6))], joinType=[left])
                        ImpalaJoinRel(condition=[=($5, $3)], joinType=[inner])
                          ImpalaProjectPassthroughRel(ss_item_sk=[$1], ss_ticket_number=[$8], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22], CAST=[CAST($9):BIGINT])
                            ImpalaHdfsScanRel(table=[[default, impala_tpcds_store_sales]], condition=[AND(IS NOT NULL($1), IS NOT NULL($22))])
                          ImpalaProjectPassthroughRel(d_date_sk=[$0])
                            ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($6, -(2001, 1)), IS NOT NULL($0))])
                        ImpalaProjectPassthroughRel(sr_item_sk=[$2], sr_ticket_number=[$9], sr_return_quantity=[$10], sr_return_amt=[$11])
                          ImpalaHdfsScanRel(table=[[default, impala_tpcds_store_returns]], condition=[AND(IS NOT NULL($9), IS NOT NULL($2))])
                      ImpalaProjectPassthroughRel(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                        ImpalaHdfsScanRel(table=[[default, impala_tpcds_item]], condition=[AND(=($12, _UTF-16LE'Sports'), IS NOT NULL($0), IS NOT NULL($7), IS NOT NULL($9), IS NOT NULL($11), IS NOT NULL($13))])
              ImpalaProjectPassthroughRel(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($4, CAST(COALESCE($8, 0)):BIGINT)], sales_amt=[-($3, COALESCE($9, 0:DECIMAL(1, 0)))])
                ImpalaJoinRel(condition=[=($10, $1)], joinType=[inner])
                  ImpalaJoinRel(condition=[AND(=($2, $7), =($1, $6))], joinType=[left])
                    ImpalaJoinRel(condition=[=($5, $0)], joinType=[inner])
                      ImpalaProjectPassthroughRel(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_order_number=[$17], ws_ext_sales_price=[$23], CAST=[CAST($18):BIGINT])
                        ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_sales]], condition=[AND(IS NOT NULL($3), IS NOT NULL($0))])
                      ImpalaProjectPassthroughRel(d_date_sk=[$0])
                        ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($6, -(2001, 1)), IS NOT NULL($0))])
                    ImpalaProjectPassthroughRel(wr_item_sk=[$2], wr_order_number=[$13], wr_return_quantity=[$14], wr_return_amt=[$15])
                      ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_returns]], condition=[AND(IS NOT NULL($13), IS NOT NULL($2))])
                  ImpalaProjectPassthroughRel(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                    ImpalaHdfsScanRel(table=[[default, impala_tpcds_item]], condition=[AND(=($12, _UTF-16LE'Sports'), IS NOT NULL($0), IS NOT NULL($7), IS NOT NULL($9), IS NOT NULL($11), IS NOT NULL($13))])
        ImpalaAggregateRel(group=[{0, 1, 2, 3}], agg#0=[sum($4)], agg#1=[sum($5)])
          ImpalaAggregateRel(group=[{0, 1, 2, 3, 4, 5}])
            ImpalaUnionRel(all=[true])
              ImpalaAggregateRel(group=[{0, 1, 2, 3, 4, 5}])
                ImpalaUnionRel(all=[true])
                  ImpalaProjectPassthroughRel(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($4, CAST(COALESCE($8, 0)):BIGINT)], sales_amt=[-($3, COALESCE($9, 0:DECIMAL(1, 0)))])
                    ImpalaJoinRel(condition=[=($10, $1)], joinType=[inner])
                      ImpalaJoinRel(condition=[AND(=($2, $7), =($1, $6))], joinType=[left])
                        ImpalaJoinRel(condition=[=($5, $0)], joinType=[inner])
                          ImpalaProjectPassthroughRel(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_order_number=[$17], cs_ext_sales_price=[$23], CAST=[CAST($18):BIGINT])
                            ImpalaHdfsScanRel(table=[[default, impala_tpcds_catalog_sales]], condition=[AND(IS NOT NULL($15), IS NOT NULL($0))])
                          ImpalaProjectPassthroughRel(d_date_sk=[$0])
                            ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($6, 2001), IS NOT NULL($0))])
                        ImpalaProjectPassthroughRel(cr_item_sk=[$2], cr_order_number=[$16], cr_return_quantity=[$17], cr_return_amount=[$18])
                          ImpalaHdfsScanRel(table=[[default, impala_tpcds_catalog_returns]], condition=[AND(IS NOT NULL($16), IS NOT NULL($2))])
                      ImpalaProjectPassthroughRel(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                        ImpalaHdfsScanRel(table=[[default, impala_tpcds_item]], condition=[AND(=($12, _UTF-16LE'Sports'), IS NOT NULL($0), IS NOT NULL($7), IS NOT NULL($9), IS NOT NULL($11), IS NOT NULL($13))])
                  ImpalaProjectPassthroughRel(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($4, CAST(COALESCE($8, 0)):BIGINT)], sales_amt=[-($2, COALESCE($9, 0:DECIMAL(1, 0)))])
                    ImpalaJoinRel(condition=[=($10, $0)], joinType=[inner])
                      ImpalaJoinRel(condition=[AND(=($1, $7), =($0, $6))], joinType=[left])
                        ImpalaJoinRel(condition=[=($5, $3)], joinType=[inner])
                          ImpalaProjectPassthroughRel(ss_item_sk=[$1], ss_ticket_number=[$8], ss_ext_sales_price=[$14], ss_sold_date_sk=[$22], CAST=[CAST($9):BIGINT])
                            ImpalaHdfsScanRel(table=[[default, impala_tpcds_store_sales]], condition=[AND(IS NOT NULL($1), IS NOT NULL($22))])
                          ImpalaProjectPassthroughRel(d_date_sk=[$0])
                            ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($6, 2001), IS NOT NULL($0))])
                        ImpalaProjectPassthroughRel(sr_item_sk=[$2], sr_ticket_number=[$9], sr_return_quantity=[$10], sr_return_amt=[$11])
                          ImpalaHdfsScanRel(table=[[default, impala_tpcds_store_returns]], condition=[AND(IS NOT NULL($9), IS NOT NULL($2))])
                      ImpalaProjectPassthroughRel(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                        ImpalaHdfsScanRel(table=[[default, impala_tpcds_item]], condition=[AND(=($12, _UTF-16LE'Sports'), IS NOT NULL($0), IS NOT NULL($7), IS NOT NULL($9), IS NOT NULL($11), IS NOT NULL($13))])
              ImpalaProjectPassthroughRel(i_brand_id=[$11], i_class_id=[$12], i_category_id=[$13], i_manufact_id=[$14], sales_cnt=[-($4, CAST(COALESCE($8, 0)):BIGINT)], sales_amt=[-($3, COALESCE($9, 0:DECIMAL(1, 0)))])
                ImpalaJoinRel(condition=[=($10, $1)], joinType=[inner])
                  ImpalaJoinRel(condition=[AND(=($2, $7), =($1, $6))], joinType=[left])
                    ImpalaJoinRel(condition=[=($5, $0)], joinType=[inner])
                      ImpalaProjectPassthroughRel(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_order_number=[$17], ws_ext_sales_price=[$23], CAST=[CAST($18):BIGINT])
                        ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_sales]], condition=[AND(IS NOT NULL($3), IS NOT NULL($0))])
                      ImpalaProjectPassthroughRel(d_date_sk=[$0])
                        ImpalaHdfsScanRel(table=[[default, impala_tpcds_date_dim]], condition=[AND(=($6, 2001), IS NOT NULL($0))])
                    ImpalaProjectPassthroughRel(wr_item_sk=[$2], wr_order_number=[$13], wr_return_quantity=[$14], wr_return_amt=[$15])
                      ImpalaHdfsScanRel(table=[[default, impala_tpcds_web_returns]], condition=[AND(IS NOT NULL($13), IS NOT NULL($2))])
                  ImpalaProjectPassthroughRel(i_item_sk=[$0], i_brand_id=[$7], i_class_id=[$9], i_category_id=[$11], i_manufact_id=[$13])
                    ImpalaHdfsScanRel(table=[[default, impala_tpcds_item]], condition=[AND(=($12, _UTF-16LE'Sports'), IS NOT NULL($0), IS NOT NULL($7), IS NOT NULL($9), IS NOT NULL($11), IS NOT NULL($13))])

PREHOOK: query: explain WITH all_sales AS (
 SELECT d_year
       ,i_brand_id
       ,i_class_id
       ,i_category_id
       ,i_manufact_id
       ,SUM(sales_cnt) AS sales_cnt
       ,SUM(sales_amt) AS sales_amt
 FROM (SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt
             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt
       FROM impala_tpcds_catalog_sales JOIN impala_tpcds_item ON i_item_sk=cs_item_sk
                          JOIN impala_tpcds_date_dim ON d_date_sk=cs_sold_date_sk
                          LEFT JOIN impala_tpcds_catalog_returns ON (cs_order_number=cr_order_number 
                                                    AND cs_item_sk=cr_item_sk)
       WHERE i_category='Sports'
       UNION
       SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt
             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt
       FROM impala_tpcds_store_sales JOIN impala_tpcds_item ON i_item_sk=ss_item_sk
                        JOIN impala_tpcds_date_dim ON d_date_sk=ss_sold_date_sk
                        LEFT JOIN impala_tpcds_store_returns ON (ss_ticket_number=sr_ticket_number 
                                                AND ss_item_sk=sr_item_sk)
       WHERE i_category='Sports'
       UNION
       SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt
             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt
       FROM impala_tpcds_web_sales JOIN impala_tpcds_item ON i_item_sk=ws_item_sk
                      JOIN impala_tpcds_date_dim ON d_date_sk=ws_sold_date_sk
                      LEFT JOIN impala_tpcds_web_returns ON (ws_order_number=wr_order_number 
                                            AND ws_item_sk=wr_item_sk)
       WHERE i_category='Sports') sales_detail
 GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)
 SELECT  prev_yr.d_year AS prev_year
                          ,curr_yr.d_year AS year
                          ,curr_yr.i_brand_id
                          ,curr_yr.i_class_id
                          ,curr_yr.i_category_id
                          ,curr_yr.i_manufact_id
                          ,prev_yr.sales_cnt AS prev_yr_cnt
                          ,curr_yr.sales_cnt AS curr_yr_cnt
                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff
                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff
 FROM all_sales curr_yr, all_sales prev_yr
 WHERE curr_yr.i_brand_id=prev_yr.i_brand_id
   AND curr_yr.i_class_id=prev_yr.i_class_id
   AND curr_yr.i_category_id=prev_yr.i_category_id
   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id
   AND curr_yr.d_year=2001
   AND prev_yr.d_year=2001-1
   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9
 ORDER BY sales_cnt_diff,sales_amt_diff
 limit 100
PREHOOK: type: QUERY
PREHOOK: Input: default@impala_tpcds_catalog_returns
PREHOOK: Input: default@impala_tpcds_catalog_sales
PREHOOK: Input: default@impala_tpcds_date_dim
PREHOOK: Input: default@impala_tpcds_item
PREHOOK: Input: default@impala_tpcds_store_returns
PREHOOK: Input: default@impala_tpcds_store_sales
PREHOOK: Input: default@impala_tpcds_web_returns
PREHOOK: Input: default@impala_tpcds_web_sales
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: explain WITH all_sales AS (
 SELECT d_year
       ,i_brand_id
       ,i_class_id
       ,i_category_id
       ,i_manufact_id
       ,SUM(sales_cnt) AS sales_cnt
       ,SUM(sales_amt) AS sales_amt
 FROM (SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt
             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt
       FROM impala_tpcds_catalog_sales JOIN impala_tpcds_item ON i_item_sk=cs_item_sk
                          JOIN impala_tpcds_date_dim ON d_date_sk=cs_sold_date_sk
                          LEFT JOIN impala_tpcds_catalog_returns ON (cs_order_number=cr_order_number 
                                                    AND cs_item_sk=cr_item_sk)
       WHERE i_category='Sports'
       UNION
       SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt
             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt
       FROM impala_tpcds_store_sales JOIN impala_tpcds_item ON i_item_sk=ss_item_sk
                        JOIN impala_tpcds_date_dim ON d_date_sk=ss_sold_date_sk
                        LEFT JOIN impala_tpcds_store_returns ON (ss_ticket_number=sr_ticket_number 
                                                AND ss_item_sk=sr_item_sk)
       WHERE i_category='Sports'
       UNION
       SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt
             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt
       FROM impala_tpcds_web_sales JOIN impala_tpcds_item ON i_item_sk=ws_item_sk
                      JOIN impala_tpcds_date_dim ON d_date_sk=ws_sold_date_sk
                      LEFT JOIN impala_tpcds_web_returns ON (ws_order_number=wr_order_number 
                                            AND ws_item_sk=wr_item_sk)
       WHERE i_category='Sports') sales_detail
 GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)
 SELECT  prev_yr.d_year AS prev_year
                          ,curr_yr.d_year AS year
                          ,curr_yr.i_brand_id
                          ,curr_yr.i_class_id
                          ,curr_yr.i_category_id
                          ,curr_yr.i_manufact_id
                          ,prev_yr.sales_cnt AS prev_yr_cnt
                          ,curr_yr.sales_cnt AS curr_yr_cnt
                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff
                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff
 FROM all_sales curr_yr, all_sales prev_yr
 WHERE curr_yr.i_brand_id=prev_yr.i_brand_id
   AND curr_yr.i_class_id=prev_yr.i_class_id
   AND curr_yr.i_category_id=prev_yr.i_category_id
   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id
   AND curr_yr.d_year=2001
   AND prev_yr.d_year=2001-1
   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9
 ORDER BY sales_cnt_diff,sales_amt_diff
 limit 100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@impala_tpcds_catalog_returns
POSTHOOK: Input: default@impala_tpcds_catalog_sales
POSTHOOK: Input: default@impala_tpcds_date_dim
POSTHOOK: Input: default@impala_tpcds_item
POSTHOOK: Input: default@impala_tpcds_store_returns
POSTHOOK: Input: default@impala_tpcds_store_sales
POSTHOOK: Input: default@impala_tpcds_web_returns
POSTHOOK: Input: default@impala_tpcds_web_sales
POSTHOOK: Output: hdfs://### HDFS PATH ###
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Impala
      Impala Plan: 
F35:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
Per-Host Resources: mem-estimate=60.05KB mem-reservation=0B thread-reservation=1
  WRITE TO HDFS [_result_db_._result_table_, OVERWRITE=false]
  |  partitions=1
  |  output exprs: _impala_builtins.subtract(CAST(2001 AS INT), CAST(1 AS INT)), CAST(2001 AS INT), i_brand_id, i_class_id, i_category_id, i_manufact_id, prev_yr_cnt, curr_yr_cnt, sales_cnt_diff, sales_amt_diff
  |  mem-estimate=56B mem-reservation=0B thread-reservation=0
  |
  86:MERGING-EXCHANGE [UNPARTITIONED]
     order by: sales_cnt_diff ASC NULLS LAST, sales_amt_diff ASC NULLS LAST
     limit: 100
     mem-estimate=60.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=57 row-size=56B cardinality=0
     in pipelines: 54(GETNEXT)

F34:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=130.02MB mem-reservation=35.94MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F35, EXCHANGE=86, UNPARTITIONED]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  54:TOP-N [LIMIT=100]
  |  order by: sales_cnt_diff ASC NULLS LAST, sales_amt_diff ASC NULLS LAST
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |  tuple-ids=57 row-size=56B cardinality=0
  |  in pipelines: 54(GETNEXT), 69(OPEN)
  |
  00:UNION
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |  tuple-ids=56 row-size=56B cardinality=0
  |  in pipelines: 69(GETNEXT)
  |
  53:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: i_brand_id = i_brand_id, i_category_id = i_category_id, i_class_id = i_class_id, i_manufact_id = i_manufact_id
  |  fk/pk conjuncts: assumed fk/pk
  |  other join predicates: _impala_builtins.divide(_impala_builtins.casttodecimal(_impala_builtins.sum(sales_cnt)), _impala_builtins.casttodecimal(_impala_builtins.sum(sales_cnt))) < CAST(0.9 AS DECIMAL(1,1))
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=27,55 row-size=80B cardinality=0
  |  in pipelines: 69(GETNEXT), 84(OPEN)
  |
  |--85:EXCHANGE [BROADCAST]
  |     mem-estimate=44.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=55 row-size=40B cardinality=0
  |     in pipelines: 84(GETNEXT)
  |
  69:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(sales_cnt), _impala_builtins.sum:merge(sales_amt)
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=27 row-size=40B cardinality=0
  |  in pipelines: 69(GETNEXT), 67(OPEN)
  |
  68:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id)]
     mem-estimate=44.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=27 row-size=40B cardinality=0
     in pipelines: 67(GETNEXT)

F15:PLAN FRAGMENT [HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id,sales_cnt,sales_amt)] hosts=1 instances=1
Per-Host Resources: mem-estimate=256.03MB mem-reservation=68.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F34, EXCHANGE=68, HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  26:AGGREGATE [STREAMING]
  |  output: sum(sales_cnt), sum(sales_amt)
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=27 row-size=40B cardinality=0
  |  in pipelines: 67(GETNEXT)
  |
  67:AGGREGATE [FINALIZE]
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt, sales_amt
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=26 row-size=28B cardinality=0
  |  in pipelines: 67(GETNEXT), 62(OPEN), 18(OPEN)
  |
  66:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id,sales_cnt,sales_amt)]
     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=26 row-size=28B cardinality=0
     in pipelines: 62(GETNEXT), 18(GETNEXT)

F14:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=256.03MB mem-reservation=68.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F15, EXCHANGE=66, HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id,sales_cnt,sales_amt)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  25:AGGREGATE [STREAMING]
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt, sales_amt
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=26 row-size=28B cardinality=0
  |  in pipelines: 62(GETNEXT), 18(GETNEXT)
  |
  01:UNION
  |  pass-through-operands: 62
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |  tuple-ids=0 row-size=28B cardinality=0
  |  in pipelines: 62(GETNEXT), 18(GETNEXT)
  |
  |--24:HASH JOIN [INNER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_web_sales.ws_item_sk = default.impala_tpcds_item_1.i_item_sk
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=18,20,22N,24 row-size=96B cardinality=0
  |  |  in pipelines: 18(GETNEXT), 23(OPEN)
  |  |
  |  |--65:EXCHANGE [BROADCAST]
  |  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=24 row-size=36B cardinality=0
  |  |     in pipelines: 23(GETNEXT)
  |  |
  |  22:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_web_sales.ws_item_sk = default.impala_tpcds_web_returns.wr_item_sk, default.impala_tpcds_web_sales.ws_order_number = default.impala_tpcds_web_returns.wr_order_number
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=18,20,22N row-size=60B cardinality=0
  |  |  in pipelines: 18(GETNEXT), 21(OPEN)
  |  |
  |  |--64:EXCHANGE [BROADCAST]
  |  |     mem-estimate=28.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=22 row-size=24B cardinality=0
  |  |     in pipelines: 21(GETNEXT)
  |  |
  |  20:HASH JOIN [INNER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_web_sales.ws_sold_date_sk = default.impala_tpcds_date_dim_1.d_date_sk
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=18,20 row-size=36B cardinality=0
  |  |  in pipelines: 18(GETNEXT), 19(OPEN)
  |  |
  |  |--63:EXCHANGE [BROADCAST]
  |  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=20 row-size=8B cardinality=0
  |  |     in pipelines: 19(GETNEXT)
  |  |
  |  18:SCAN HDFS [default.impala_tpcds_web_sales, RANDOM]
  |     HDFS partitions=1/1 files=0 size=0B
  |     predicates: default.impala_tpcds_web_sales.ws_item_sk IS NOT NULL, default.impala_tpcds_web_sales.ws_sold_date_sk IS NOT NULL
  |     stored statistics:
  |       table: rows=0 size=0B
  |       columns: unavailable
  |     extrapolated-rows=disabled max-scan-range-rows=0
  |     mem-estimate=0B mem-reservation=0B thread-reservation=0
  |     tuple-ids=18 row-size=28B cardinality=0
  |     in pipelines: 18(GETNEXT)
  |
  62:AGGREGATE [FINALIZE]
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt, sales_amt
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=17 row-size=28B cardinality=0
  |  in pipelines: 62(GETNEXT), 03(OPEN), 10(OPEN)
  |
  61:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id,sales_cnt,sales_amt)]
     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=17 row-size=28B cardinality=0
     in pipelines: 03(GETNEXT), 10(GETNEXT)

F08:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=133.89MB mem-reservation=39.81MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F14, EXCHANGE=61, HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id,sales_cnt,sales_amt)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  17:AGGREGATE [STREAMING]
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt, sales_amt
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=17 row-size=28B cardinality=0
  |  in pipelines: 03(GETNEXT), 10(GETNEXT)
  |
  02:UNION
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |  tuple-ids=1 row-size=28B cardinality=0
  |  in pipelines: 03(GETNEXT), 10(GETNEXT)
  |
  |--16:HASH JOIN [INNER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_store_sales.ss_item_sk = default.impala_tpcds_item_0.i_item_sk
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=10,11,13N,15 row-size=96B cardinality=0
  |  |  in pipelines: 10(GETNEXT), 15(OPEN)
  |  |
  |  |--60:EXCHANGE [BROADCAST]
  |  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=15 row-size=36B cardinality=0
  |  |     in pipelines: 15(GETNEXT)
  |  |
  |  14:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_store_sales.ss_item_sk = default.impala_tpcds_store_returns.sr_item_sk, default.impala_tpcds_store_sales.ss_ticket_number = default.impala_tpcds_store_returns.sr_ticket_number
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=10,11,13N row-size=60B cardinality=0
  |  |  in pipelines: 10(GETNEXT), 13(OPEN)
  |  |
  |  |--59:EXCHANGE [BROADCAST]
  |  |     mem-estimate=28.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=13 row-size=24B cardinality=0
  |  |     in pipelines: 13(GETNEXT)
  |  |
  |  12:HASH JOIN [INNER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_store_sales.ss_sold_date_sk = default.impala_tpcds_date_dim_0.d_date_sk
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=10,11 row-size=36B cardinality=0
  |  |  in pipelines: 10(GETNEXT), 11(OPEN)
  |  |
  |  |--58:EXCHANGE [BROADCAST]
  |  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=11 row-size=8B cardinality=0
  |  |     in pipelines: 11(GETNEXT)
  |  |
  |  10:SCAN HDFS [default.impala_tpcds_store_sales, RANDOM]
  |     partition predicates: default.impala_tpcds_store_sales.ss_sold_date_sk IS NOT NULL
  |     partitions=0/0 files=0 size=0B
  |     predicates: default.impala_tpcds_store_sales.ss_item_sk IS NOT NULL
  |     stored statistics:
  |       table: rows=unavailable size=unavailable
  |       partitions: 0/0 rows=unavailable
  |       columns missing stats: ss_item_sk, ss_ticket_number, ss_quantity, ss_ext_sales_price
  |     extrapolated-rows=disabled max-scan-range-rows=0
  |     mem-estimate=0B mem-reservation=0B thread-reservation=0
  |     tuple-ids=10 row-size=28B cardinality=0
  |     in pipelines: 10(GETNEXT)
  |
  09:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_catalog_sales.cs_item_sk = default.impala_tpcds_item.i_item_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=2,4,6N,8 row-size=96B cardinality=0
  |  in pipelines: 03(GETNEXT), 08(OPEN)
  |
  |--57:EXCHANGE [BROADCAST]
  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=8 row-size=36B cardinality=0
  |     in pipelines: 08(GETNEXT)
  |
  07:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_catalog_sales.cs_item_sk = default.impala_tpcds_catalog_returns.cr_item_sk, default.impala_tpcds_catalog_sales.cs_order_number = default.impala_tpcds_catalog_returns.cr_order_number
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=2,4,6N row-size=60B cardinality=0
  |  in pipelines: 03(GETNEXT), 06(OPEN)
  |
  |--56:EXCHANGE [BROADCAST]
  |     mem-estimate=28.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=6 row-size=24B cardinality=0
  |     in pipelines: 06(GETNEXT)
  |
  05:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_catalog_sales.cs_sold_date_sk = default.impala_tpcds_date_dim.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=2,4 row-size=36B cardinality=0
  |  in pipelines: 03(GETNEXT), 04(OPEN)
  |
  |--55:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=4 row-size=8B cardinality=0
  |     in pipelines: 04(GETNEXT)
  |
  03:SCAN HDFS [default.impala_tpcds_catalog_sales, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_catalog_sales.cs_item_sk IS NOT NULL, default.impala_tpcds_catalog_sales.cs_sold_date_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=2 row-size=28B cardinality=0
     in pipelines: 03(GETNEXT)

F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F08, EXCHANGE=55, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  04:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim.d_year = _impala_builtins.subtract(CAST(2001 AS INT), CAST(1 AS INT))
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim.d_year = _impala_builtins.subtract(CAST(2001 AS INT), CAST(1 AS INT))
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=4 row-size=8B cardinality=0
     in pipelines: 04(GETNEXT)

F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F08, EXCHANGE=56, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  06:SCAN HDFS [default.impala_tpcds_catalog_returns, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_catalog_returns.cr_item_sk IS NOT NULL, default.impala_tpcds_catalog_returns.cr_order_number IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=6 row-size=24B cardinality=0
     in pipelines: 06(GETNEXT)

F03:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F08, EXCHANGE=57, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  08:SCAN HDFS [default.impala_tpcds_item, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_item.i_brand_id IS NOT NULL, default.impala_tpcds_item.i_category_id IS NOT NULL, default.impala_tpcds_item.i_class_id IS NOT NULL, default.impala_tpcds_item.i_item_sk IS NOT NULL, default.impala_tpcds_item.i_manufact_id IS NOT NULL, default.impala_tpcds_item.i_category = 'Sports'
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_item.i_category = 'Sports'
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=8 row-size=36B cardinality=0
     in pipelines: 08(GETNEXT)

F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F08, EXCHANGE=58, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  11:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_0.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim_0.d_year = _impala_builtins.subtract(CAST(2001 AS INT), CAST(1 AS INT))
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim_0.d_year = _impala_builtins.subtract(CAST(2001 AS INT), CAST(1 AS INT))
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=11 row-size=8B cardinality=0
     in pipelines: 11(GETNEXT)

F06:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F08, EXCHANGE=59, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  13:SCAN HDFS [default.impala_tpcds_store_returns, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_store_returns.sr_item_sk IS NOT NULL, default.impala_tpcds_store_returns.sr_ticket_number IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=13 row-size=24B cardinality=0
     in pipelines: 13(GETNEXT)

F07:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F08, EXCHANGE=60, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  15:SCAN HDFS [default.impala_tpcds_item, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_item_0.i_brand_id IS NOT NULL, default.impala_tpcds_item_0.i_category_id IS NOT NULL, default.impala_tpcds_item_0.i_class_id IS NOT NULL, default.impala_tpcds_item_0.i_item_sk IS NOT NULL, default.impala_tpcds_item_0.i_manufact_id IS NOT NULL, default.impala_tpcds_item_0.i_category = 'Sports'
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_item_0.i_category = 'Sports'
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=15 row-size=36B cardinality=0
     in pipelines: 15(GETNEXT)

F11:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F14, EXCHANGE=63, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  19:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_1.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim_1.d_year = _impala_builtins.subtract(CAST(2001 AS INT), CAST(1 AS INT))
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim_1.d_year = _impala_builtins.subtract(CAST(2001 AS INT), CAST(1 AS INT))
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=20 row-size=8B cardinality=0
     in pipelines: 19(GETNEXT)

F12:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F14, EXCHANGE=64, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  21:SCAN HDFS [default.impala_tpcds_web_returns, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_web_returns.wr_item_sk IS NOT NULL, default.impala_tpcds_web_returns.wr_order_number IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=22 row-size=24B cardinality=0
     in pipelines: 21(GETNEXT)

F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F14, EXCHANGE=65, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  23:SCAN HDFS [default.impala_tpcds_item, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_item_1.i_brand_id IS NOT NULL, default.impala_tpcds_item_1.i_category_id IS NOT NULL, default.impala_tpcds_item_1.i_class_id IS NOT NULL, default.impala_tpcds_item_1.i_item_sk IS NOT NULL, default.impala_tpcds_item_1.i_manufact_id IS NOT NULL, default.impala_tpcds_item_1.i_category = 'Sports'
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_item_1.i_category = 'Sports'
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=24 row-size=36B cardinality=0
     in pipelines: 23(GETNEXT)

F33:PLAN FRAGMENT [HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id)] hosts=1 instances=1
Per-Host Resources: mem-estimate=128.04MB mem-reservation=34.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F34, EXCHANGE=85, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  84:AGGREGATE [FINALIZE]
  |  output: _impala_builtins.sum:merge(sales_cnt), _impala_builtins.sum:merge(sales_amt)
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=55 row-size=40B cardinality=0
  |  in pipelines: 84(GETNEXT), 82(OPEN)
  |
  83:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id)]
     mem-estimate=44.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=55 row-size=40B cardinality=0
     in pipelines: 82(GETNEXT)

F32:PLAN FRAGMENT [HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id,sales_cnt,sales_amt)] hosts=1 instances=1
Per-Host Resources: mem-estimate=256.03MB mem-reservation=68.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F33, EXCHANGE=83, HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  52:AGGREGATE [STREAMING]
  |  output: sum(sales_cnt), sum(sales_amt)
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=55 row-size=40B cardinality=0
  |  in pipelines: 82(GETNEXT)
  |
  82:AGGREGATE [FINALIZE]
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt, sales_amt
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=54 row-size=28B cardinality=0
  |  in pipelines: 82(GETNEXT), 77(OPEN), 44(OPEN)
  |
  81:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id,sales_cnt,sales_amt)]
     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=54 row-size=28B cardinality=0
     in pipelines: 77(GETNEXT), 44(GETNEXT)

F31:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=256.03MB mem-reservation=68.00MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F32, EXCHANGE=81, HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id,sales_cnt,sales_amt)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  51:AGGREGATE [STREAMING]
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt, sales_amt
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=54 row-size=28B cardinality=0
  |  in pipelines: 77(GETNEXT), 44(GETNEXT)
  |
  27:UNION
  |  pass-through-operands: 77
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |  tuple-ids=28 row-size=28B cardinality=0
  |  in pipelines: 77(GETNEXT), 44(GETNEXT)
  |
  |--50:HASH JOIN [INNER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_web_sales_0.ws_item_sk = default.impala_tpcds_item_4.i_item_sk
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=46,48,50N,52 row-size=96B cardinality=0
  |  |  in pipelines: 44(GETNEXT), 49(OPEN)
  |  |
  |  |--80:EXCHANGE [BROADCAST]
  |  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=52 row-size=36B cardinality=0
  |  |     in pipelines: 49(GETNEXT)
  |  |
  |  48:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_web_sales_0.ws_item_sk = default.impala_tpcds_web_returns_0.wr_item_sk, default.impala_tpcds_web_sales_0.ws_order_number = default.impala_tpcds_web_returns_0.wr_order_number
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=46,48,50N row-size=60B cardinality=0
  |  |  in pipelines: 44(GETNEXT), 47(OPEN)
  |  |
  |  |--79:EXCHANGE [BROADCAST]
  |  |     mem-estimate=28.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=50 row-size=24B cardinality=0
  |  |     in pipelines: 47(GETNEXT)
  |  |
  |  46:HASH JOIN [INNER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_web_sales_0.ws_sold_date_sk = default.impala_tpcds_date_dim_4.d_date_sk
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=46,48 row-size=36B cardinality=0
  |  |  in pipelines: 44(GETNEXT), 45(OPEN)
  |  |
  |  |--78:EXCHANGE [BROADCAST]
  |  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=48 row-size=8B cardinality=0
  |  |     in pipelines: 45(GETNEXT)
  |  |
  |  44:SCAN HDFS [default.impala_tpcds_web_sales, RANDOM]
  |     HDFS partitions=1/1 files=0 size=0B
  |     predicates: default.impala_tpcds_web_sales_0.ws_item_sk IS NOT NULL, default.impala_tpcds_web_sales_0.ws_sold_date_sk IS NOT NULL
  |     stored statistics:
  |       table: rows=0 size=0B
  |       columns: unavailable
  |     extrapolated-rows=disabled max-scan-range-rows=0
  |     mem-estimate=0B mem-reservation=0B thread-reservation=0
  |     tuple-ids=46 row-size=28B cardinality=0
  |     in pipelines: 44(GETNEXT)
  |
  77:AGGREGATE [FINALIZE]
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt, sales_amt
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=45 row-size=28B cardinality=0
  |  in pipelines: 77(GETNEXT), 29(OPEN), 36(OPEN)
  |
  76:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id,sales_cnt,sales_amt)]
     mem-estimate=32.00KB mem-reservation=0B thread-reservation=0
     tuple-ids=45 row-size=28B cardinality=0
     in pipelines: 29(GETNEXT), 36(GETNEXT)

F25:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=133.89MB mem-reservation=39.81MB thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F31, EXCHANGE=76, HASH(i_brand_id,i_class_id,i_category_id,i_manufact_id,sales_cnt,sales_amt)]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  43:AGGREGATE [STREAMING]
  |  group by: i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt, sales_amt
  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
  |  tuple-ids=45 row-size=28B cardinality=0
  |  in pipelines: 29(GETNEXT), 36(GETNEXT)
  |
  28:UNION
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  |  tuple-ids=29 row-size=28B cardinality=0
  |  in pipelines: 29(GETNEXT), 36(GETNEXT)
  |
  |--42:HASH JOIN [INNER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_store_sales_0.ss_item_sk = default.impala_tpcds_item_3.i_item_sk
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=38,39,41N,43 row-size=96B cardinality=0
  |  |  in pipelines: 36(GETNEXT), 41(OPEN)
  |  |
  |  |--75:EXCHANGE [BROADCAST]
  |  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=43 row-size=36B cardinality=0
  |  |     in pipelines: 41(GETNEXT)
  |  |
  |  40:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_store_sales_0.ss_item_sk = default.impala_tpcds_store_returns_0.sr_item_sk, default.impala_tpcds_store_sales_0.ss_ticket_number = default.impala_tpcds_store_returns_0.sr_ticket_number
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=38,39,41N row-size=60B cardinality=0
  |  |  in pipelines: 36(GETNEXT), 39(OPEN)
  |  |
  |  |--74:EXCHANGE [BROADCAST]
  |  |     mem-estimate=28.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=41 row-size=24B cardinality=0
  |  |     in pipelines: 39(GETNEXT)
  |  |
  |  38:HASH JOIN [INNER JOIN, BROADCAST]
  |  |  hash predicates: default.impala_tpcds_store_sales_0.ss_sold_date_sk = default.impala_tpcds_date_dim_3.d_date_sk
  |  |  fk/pk conjuncts: assumed fk/pk
  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  |  tuple-ids=38,39 row-size=36B cardinality=0
  |  |  in pipelines: 36(GETNEXT), 37(OPEN)
  |  |
  |  |--73:EXCHANGE [BROADCAST]
  |  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |  |     tuple-ids=39 row-size=8B cardinality=0
  |  |     in pipelines: 37(GETNEXT)
  |  |
  |  36:SCAN HDFS [default.impala_tpcds_store_sales, RANDOM]
  |     partition predicates: default.impala_tpcds_store_sales_0.ss_sold_date_sk IS NOT NULL
  |     partitions=0/0 files=0 size=0B
  |     predicates: default.impala_tpcds_store_sales_0.ss_item_sk IS NOT NULL
  |     stored statistics:
  |       table: rows=unavailable size=unavailable
  |       partitions: 0/0 rows=unavailable
  |       columns missing stats: ss_item_sk, ss_ticket_number, ss_quantity, ss_ext_sales_price
  |     extrapolated-rows=disabled max-scan-range-rows=0
  |     mem-estimate=0B mem-reservation=0B thread-reservation=0
  |     tuple-ids=38 row-size=28B cardinality=0
  |     in pipelines: 36(GETNEXT)
  |
  35:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_catalog_sales_0.cs_item_sk = default.impala_tpcds_item_2.i_item_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=30,32,34N,36 row-size=96B cardinality=0
  |  in pipelines: 29(GETNEXT), 34(OPEN)
  |
  |--72:EXCHANGE [BROADCAST]
  |     mem-estimate=40.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=36 row-size=36B cardinality=0
  |     in pipelines: 34(GETNEXT)
  |
  33:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_catalog_sales_0.cs_item_sk = default.impala_tpcds_catalog_returns_0.cr_item_sk, default.impala_tpcds_catalog_sales_0.cs_order_number = default.impala_tpcds_catalog_returns_0.cr_order_number
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=30,32,34N row-size=60B cardinality=0
  |  in pipelines: 29(GETNEXT), 32(OPEN)
  |
  |--71:EXCHANGE [BROADCAST]
  |     mem-estimate=28.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=34 row-size=24B cardinality=0
  |     in pipelines: 32(GETNEXT)
  |
  31:HASH JOIN [INNER JOIN, BROADCAST]
  |  hash predicates: default.impala_tpcds_catalog_sales_0.cs_sold_date_sk = default.impala_tpcds_date_dim_2.d_date_sk
  |  fk/pk conjuncts: assumed fk/pk
  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
  |  tuple-ids=30,32 row-size=36B cardinality=0
  |  in pipelines: 29(GETNEXT), 30(OPEN)
  |
  |--70:EXCHANGE [BROADCAST]
  |     mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
  |     tuple-ids=32 row-size=8B cardinality=0
  |     in pipelines: 30(GETNEXT)
  |
  29:SCAN HDFS [default.impala_tpcds_catalog_sales, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_catalog_sales_0.cs_item_sk IS NOT NULL, default.impala_tpcds_catalog_sales_0.cs_sold_date_sk IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=30 row-size=28B cardinality=0
     in pipelines: 29(GETNEXT)

F18:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F25, EXCHANGE=70, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  30:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_2.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim_2.d_year = CAST(2001 AS INT)
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim_2.d_year = CAST(2001 AS INT)
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=32 row-size=8B cardinality=0
     in pipelines: 30(GETNEXT)

F19:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F25, EXCHANGE=71, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  32:SCAN HDFS [default.impala_tpcds_catalog_returns, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_catalog_returns_0.cr_item_sk IS NOT NULL, default.impala_tpcds_catalog_returns_0.cr_order_number IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=34 row-size=24B cardinality=0
     in pipelines: 32(GETNEXT)

F20:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F25, EXCHANGE=72, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  34:SCAN HDFS [default.impala_tpcds_item, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_item_2.i_brand_id IS NOT NULL, default.impala_tpcds_item_2.i_category_id IS NOT NULL, default.impala_tpcds_item_2.i_class_id IS NOT NULL, default.impala_tpcds_item_2.i_item_sk IS NOT NULL, default.impala_tpcds_item_2.i_manufact_id IS NOT NULL, default.impala_tpcds_item_2.i_category = 'Sports'
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_item_2.i_category = 'Sports'
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=36 row-size=36B cardinality=0
     in pipelines: 34(GETNEXT)

F22:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F25, EXCHANGE=73, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  37:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_3.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim_3.d_year = CAST(2001 AS INT)
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim_3.d_year = CAST(2001 AS INT)
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=39 row-size=8B cardinality=0
     in pipelines: 37(GETNEXT)

F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F25, EXCHANGE=74, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  39:SCAN HDFS [default.impala_tpcds_store_returns, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_store_returns_0.sr_item_sk IS NOT NULL, default.impala_tpcds_store_returns_0.sr_ticket_number IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=41 row-size=24B cardinality=0
     in pipelines: 39(GETNEXT)

F24:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F25, EXCHANGE=75, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  41:SCAN HDFS [default.impala_tpcds_item, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_item_3.i_brand_id IS NOT NULL, default.impala_tpcds_item_3.i_category_id IS NOT NULL, default.impala_tpcds_item_3.i_class_id IS NOT NULL, default.impala_tpcds_item_3.i_item_sk IS NOT NULL, default.impala_tpcds_item_3.i_manufact_id IS NOT NULL, default.impala_tpcds_item_3.i_category = 'Sports'
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_item_3.i_category = 'Sports'
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=43 row-size=36B cardinality=0
     in pipelines: 41(GETNEXT)

F28:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F31, EXCHANGE=78, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  45:SCAN HDFS [default.impala_tpcds_date_dim, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_date_dim_4.d_date_sk IS NOT NULL, default.impala_tpcds_date_dim_4.d_year = CAST(2001 AS INT)
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_date_dim_4.d_year = CAST(2001 AS INT)
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=48 row-size=8B cardinality=0
     in pipelines: 45(GETNEXT)

F29:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F31, EXCHANGE=79, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  47:SCAN HDFS [default.impala_tpcds_web_returns, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_web_returns_0.wr_item_sk IS NOT NULL, default.impala_tpcds_web_returns_0.wr_order_number IS NOT NULL
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=50 row-size=24B cardinality=0
     in pipelines: 47(GETNEXT)

F30:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
  DATASTREAM SINK [FRAGMENT=F31, EXCHANGE=80, BROADCAST]
  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
  49:SCAN HDFS [default.impala_tpcds_item, RANDOM]
     HDFS partitions=1/1 files=0 size=0B
     predicates: default.impala_tpcds_item_4.i_brand_id IS NOT NULL, default.impala_tpcds_item_4.i_category_id IS NOT NULL, default.impala_tpcds_item_4.i_class_id IS NOT NULL, default.impala_tpcds_item_4.i_item_sk IS NOT NULL, default.impala_tpcds_item_4.i_manufact_id IS NOT NULL, default.impala_tpcds_item_4.i_category = 'Sports'
     stored statistics:
       table: rows=0 size=0B
       columns: unavailable
     extrapolated-rows=disabled max-scan-range-rows=0
     parquet statistics predicates: default.impala_tpcds_item_4.i_category = 'Sports'
     mem-estimate=0B mem-reservation=0B thread-reservation=0
     tuple-ids=52 row-size=36B cardinality=0
     in pipelines: 49(GETNEXT)


  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

