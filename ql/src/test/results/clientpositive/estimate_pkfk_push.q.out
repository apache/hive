PREHOOK: query: select
    s.id
from
    ships s,
    ship_types st,
    torpedos t
where
    (st.id = 1 or st.id=2)
    and ship_type_id=st.id
    and ship_id=s.id
PREHOOK: type: QUERY
PREHOOK: Input: default@ship_types
PREHOOK: Input: default@ships
PREHOOK: Input: default@torpedos
#### A masked pattern was here ####
POSTHOOK: query: select
    s.id
from
    ships s,
    ship_types st,
    torpedos t
where
    (st.id = 1 or st.id=2)
    and ship_type_id=st.id
    and ship_id=s.id
POSTHOOK: type: QUERY
POSTHOOK: Input: default@ship_types
POSTHOOK: Input: default@ships
POSTHOOK: Input: default@torpedos
#### A masked pattern was here ####
PREHOOK: query: explain analyze
select
    s.id
from
    ships s,
    ship_types st,
    torpedos t
where
    (st.id = 1 or st.id=2)
    and ship_type_id=st.id
    and ship_id=s.id
PREHOOK: type: QUERY
PREHOOK: Input: default@ship_types
PREHOOK: Input: default@ships
PREHOOK: Input: default@torpedos
#### A masked pattern was here ####
POSTHOOK: query: explain analyze
select
    s.id
from
    ships s,
    ship_types st,
    torpedos t
where
    (st.id = 1 or st.id=2)
    and ship_type_id=st.id
    and ship_id=s.id
POSTHOOK: type: QUERY
POSTHOOK: Input: default@ship_types
POSTHOOK: Input: default@ships
POSTHOOK: Input: default@torpedos
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: s
            filterExpr: ((ship_type_id) IN (1, 2) and id is not null) (type: boolean)
            Statistics: Num rows: 100/100 Data size: 800 Basic stats: COMPLETE Column stats: COMPLETE
            Filter Operator
              predicate: ((ship_type_id) IN (1, 2) and id is not null) (type: boolean)
              Statistics: Num rows: 20/20 Data size: 160 Basic stats: COMPLETE Column stats: COMPLETE
              Select Operator
                expressions: id (type: int), ship_type_id (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 20/20 Data size: 160 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 20/20 Data size: 160 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int)
          TableScan
            alias: st
            filterExpr: (id) IN (1, 2) (type: boolean)
            Statistics: Num rows: 10/10 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
            Filter Operator
              predicate: (id) IN (1, 2) (type: boolean)
              Statistics: Num rows: 2/2 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
              Select Operator
                expressions: id (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2/2 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2/2 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0
          Statistics: Num rows: 5/20 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 5/20 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
          TableScan
            alias: t
            filterExpr: ship_id is not null (type: boolean)
            Statistics: Num rows: 1000/1000 Data size: 4000 Basic stats: COMPLETE Column stats: COMPLETE
            Filter Operator
              predicate: ship_id is not null (type: boolean)
              Statistics: Num rows: 1000/1000 Data size: 4000 Basic stats: COMPLETE Column stats: COMPLETE
              Select Operator
                expressions: ship_id (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1000/1000 Data size: 4000 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1000/1000 Data size: 4000 Basic stats: COMPLETE Column stats: COMPLETE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0
          Statistics: Num rows: 201/200 Data size: 804 Basic stats: COMPLETE Column stats: COMPLETE
          File Output Operator
            compressed: false
            Statistics: Num rows: 201/200 Data size: 804 Basic stats: COMPLETE Column stats: COMPLETE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

