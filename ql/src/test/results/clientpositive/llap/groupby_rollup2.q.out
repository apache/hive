PREHOOK: query: create table t (a integer)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@t
POSTHOOK: query: create table t (a integer)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t
PREHOOK: query: insert into t values (1),(2),(null)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@t
POSTHOOK: query: insert into t values (1),(2),(null)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@t
POSTHOOK: Lineage: t.a SCRIPT []
PREHOOK: query: select a,count(1),count(a) from t group by a with rollup
PREHOOK: type: QUERY
PREHOOK: Input: default@t
#### A masked pattern was here ####
POSTHOOK: query: select a,count(1),count(a) from t group by a with rollup
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t
#### A masked pattern was here ####
1	1	1
2	1	1
NULL	3	2
NULL	1	0
PREHOOK: query: select a,count(a) from t group by a GROUPING SETS ((),(a))
PREHOOK: type: QUERY
PREHOOK: Input: default@t
#### A masked pattern was here ####
POSTHOOK: query: select a,count(a) from t group by a GROUPING SETS ((),(a))
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t
#### A masked pattern was here ####
1	1
2	1
NULL	2
NULL	0
PREHOOK: query: explain
SELECT key, value, count(key) FROM src GROUP BY key, value with rollup
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: explain
SELECT key, value, count(key) FROM src GROUP BY key, value with rollup
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: key (type: string), value (type: string)
                    outputColumnNames: key, value
                    Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: count(key)
                      keys: key (type: string), value (type: string), 0L (type: bigint)
                      grouping sets: 0, 1, 3
                      minReductionHashAggr: 0.4
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 750 Data size: 145500 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        null sort order: zzz
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        Statistics: Num rows: 750 Data size: 145500 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col3 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col3
                Statistics: Num rows: 750 Data size: 145500 Basic stats: COMPLETE Column stats: COMPLETE
                pruneGroupingSetId: true
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col3 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 750 Data size: 139500 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 750 Data size: 139500 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: SELECT key, value, count(key) FROM src GROUP BY key, value with rollup
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: SELECT key, value, count(key) FROM src GROUP BY key, value with rollup
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
10	NULL	1
100	val_100	2
100	NULL	2
103	NULL	2
104	val_104	2
104	NULL	2
105	val_105	1
105	NULL	1
11	val_11	1
111	val_111	1
111	NULL	1
113	val_113	2
113	NULL	2
114	val_114	1
116	val_116	1
116	NULL	1
118	val_118	2
119	NULL	3
12	val_12	2
125	NULL	2
126	val_126	1
126	NULL	1
128	NULL	3
131	val_131	1
131	NULL	1
133	NULL	1
134	val_134	2
136	val_136	1
138	NULL	4
143	NULL	1
145	val_145	1
145	NULL	1
146	val_146	2
149	NULL	2
15	NULL	2
150	val_150	1
150	NULL	1
152	val_152	2
152	NULL	2
155	NULL	1
156	NULL	1
157	val_157	1
157	NULL	1
158	val_158	1
162	val_162	1
166	val_166	1
168	NULL	1
17	NULL	1
172	val_172	2
172	NULL	2
174	NULL	2
177	val_177	1
177	NULL	1
178	val_178	1
179	val_179	2
18	val_18	2
18	NULL	2
180	val_180	1
183	val_183	1
183	NULL	1
186	NULL	1
187	val_187	3
187	NULL	3
19	NULL	1
191	val_191	2
191	NULL	2
195	val_195	2
195	NULL	2
196	val_196	1
196	NULL	1
197	val_197	2
197	NULL	2
199	val_199	3
2	val_2	1
20	val_20	1
202	NULL	1
203	val_203	2
203	NULL	2
208	NULL	3
209	val_209	2
214	val_214	1
214	NULL	1
216	NULL	2
217	val_217	2
217	NULL	2
218	val_218	1
219	val_219	2
219	NULL	2
221	val_221	2
222	val_222	1
223	val_223	2
224	val_224	2
224	NULL	2
228	val_228	1
228	NULL	1
229	val_229	2
233	NULL	2
239	val_239	2
241	val_241	1
248	val_248	1
249	val_249	1
249	NULL	1
252	NULL	1
255	val_255	2
256	val_256	2
256	NULL	2
257	val_257	1
26	NULL	2
260	val_260	1
263	NULL	1
265	val_265	2
266	val_266	1
266	NULL	1
273	val_273	3
274	val_274	1
274	NULL	1
275	NULL	1
277	NULL	4
278	NULL	2
28	val_28	1
280	NULL	2
281	val_281	2
283	val_283	1
283	NULL	1
284	val_284	1
285	NULL	1
286	NULL	1
287	val_287	1
287	NULL	1
288	NULL	2
289	val_289	1
289	NULL	1
291	NULL	1
292	val_292	1
292	NULL	1
296	val_296	1
298	val_298	3
298	NULL	3
30	NULL	1
302	val_302	1
302	NULL	1
305	val_305	1
305	NULL	1
307	val_307	2
307	NULL	2
309	NULL	2
310	val_310	1
311	val_311	3
311	NULL	3
315	val_315	1
316	val_316	3
318	val_318	3
322	val_322	2
322	NULL	2
323	NULL	1
325	val_325	2
325	NULL	2
327	val_327	3
33	NULL	1
332	val_332	1
333	val_333	2
333	NULL	2
335	val_335	1
335	NULL	1
336	val_336	1
336	NULL	1
339	val_339	1
341	val_341	1
341	NULL	1
342	NULL	2
344	val_344	2
348	val_348	5
353	val_353	2
356	NULL	1
360	NULL	1
362	NULL	1
364	NULL	1
365	val_365	1
366	NULL	1
367	val_367	2
368	val_368	1
368	NULL	1
369	NULL	3
37	val_37	2
373	val_373	1
374	NULL	1
375	NULL	1
377	val_377	1
378	val_378	1
378	NULL	1
379	val_379	1
382	val_382	2
384	NULL	3
386	val_386	1
386	NULL	1
389	NULL	1
393	NULL	1
395	val_395	2
396	val_396	3
396	NULL	3
397	val_397	2
399	NULL	2
400	val_400	1
401	val_401	5
402	val_402	1
402	NULL	1
403	val_403	3
404	val_404	2
404	NULL	2
407	val_407	1
409	NULL	3
411	val_411	1
411	NULL	1
413	NULL	2
414	val_414	2
417	NULL	3
418	val_418	1
418	NULL	1
42	val_42	2
421	val_421	1
421	NULL	1
424	val_424	2
424	NULL	2
427	val_427	1
429	val_429	2
429	NULL	2
43	NULL	1
430	val_430	3
431	NULL	3
432	val_432	1
432	NULL	1
435	NULL	1
437	NULL	1
438	val_438	3
438	NULL	3
439	NULL	2
44	NULL	1
444	val_444	1
444	NULL	1
446	val_446	1
446	NULL	1
448	val_448	1
448	NULL	1
449	val_449	1
449	NULL	1
452	NULL	1
453	NULL	1
454	NULL	3
457	val_457	1
457	NULL	1
458	val_458	2
458	NULL	2
459	val_459	2
460	val_460	1
462	val_462	2
462	NULL	2
463	val_463	2
463	NULL	2
466	val_466	3
466	NULL	3
467	NULL	1
468	val_468	4
468	NULL	4
469	NULL	5
47	NULL	1
472	val_472	1
475	val_475	1
475	NULL	1
478	val_478	2
478	NULL	2
480	val_480	3
480	NULL	3
481	NULL	1
483	NULL	1
484	NULL	1
487	val_487	1
489	val_489	4
490	val_490	1
490	NULL	1
491	val_491	1
491	NULL	1
493	val_493	1
494	val_494	1
496	NULL	1
497	NULL	1
5	NULL	3
53	val_53	1
53	NULL	1
57	NULL	1
58	val_58	2
58	NULL	2
66	val_66	1
66	NULL	1
67	NULL	2
69	val_69	1
70	val_70	3
70	NULL	3
72	val_72	2
72	NULL	2
74	NULL	1
8	val_8	1
80	val_80	1
80	NULL	1
82	val_82	1
83	NULL	2
84	val_84	2
84	NULL	2
85	NULL	1
87	NULL	1
9	val_9	1
90	val_90	3
92	val_92	1
95	NULL	2
96	val_96	1
97	NULL	2
98	NULL	2
0	val_0	3
0	NULL	3
10	val_10	1
103	val_103	2
11	NULL	1
114	NULL	1
118	NULL	2
119	val_119	3
12	NULL	2
120	val_120	2
120	NULL	2
125	val_125	2
128	val_128	3
129	val_129	2
129	NULL	2
133	val_133	1
134	NULL	2
136	NULL	1
137	val_137	2
137	NULL	2
138	val_138	4
143	val_143	1
146	NULL	2
149	val_149	2
15	val_15	2
153	val_153	1
153	NULL	1
155	val_155	1
156	val_156	1
158	NULL	1
160	val_160	1
160	NULL	1
162	NULL	1
163	val_163	1
163	NULL	1
164	val_164	2
164	NULL	2
165	val_165	2
165	NULL	2
166	NULL	1
167	val_167	3
167	NULL	3
168	val_168	1
169	val_169	4
169	NULL	4
17	val_17	1
170	val_170	1
170	NULL	1
174	val_174	2
175	val_175	2
175	NULL	2
176	val_176	2
176	NULL	2
178	NULL	1
179	NULL	2
180	NULL	1
181	val_181	1
181	NULL	1
186	val_186	1
189	val_189	1
189	NULL	1
19	val_19	1
190	val_190	1
190	NULL	1
192	val_192	1
192	NULL	1
193	val_193	3
193	NULL	3
194	val_194	1
194	NULL	1
199	NULL	3
2	NULL	1
20	NULL	1
200	val_200	2
200	NULL	2
201	val_201	1
201	NULL	1
202	val_202	1
205	val_205	2
205	NULL	2
207	val_207	2
207	NULL	2
208	val_208	3
209	NULL	2
213	val_213	2
213	NULL	2
216	val_216	2
218	NULL	1
221	NULL	2
222	NULL	1
223	NULL	2
226	val_226	1
226	NULL	1
229	NULL	2
230	val_230	5
230	NULL	5
233	val_233	2
235	val_235	1
235	NULL	1
237	val_237	2
237	NULL	2
238	val_238	2
238	NULL	2
239	NULL	2
24	val_24	2
24	NULL	2
241	NULL	1
242	val_242	2
242	NULL	2
244	val_244	1
244	NULL	1
247	val_247	1
247	NULL	1
248	NULL	1
252	val_252	1
255	NULL	2
257	NULL	1
258	val_258	1
258	NULL	1
26	val_26	2
260	NULL	1
262	val_262	1
262	NULL	1
263	val_263	1
265	NULL	2
27	val_27	1
27	NULL	1
272	val_272	2
272	NULL	2
273	NULL	3
275	val_275	1
277	val_277	4
278	val_278	2
28	NULL	1
280	val_280	2
281	NULL	2
282	val_282	2
282	NULL	2
284	NULL	1
285	val_285	1
286	val_286	1
288	val_288	2
291	val_291	1
296	NULL	1
30	val_30	1
306	val_306	1
306	NULL	1
308	val_308	1
308	NULL	1
309	val_309	2
310	NULL	1
315	NULL	1
316	NULL	3
317	val_317	2
317	NULL	2
318	NULL	3
321	val_321	2
321	NULL	2
323	val_323	1
327	NULL	3
33	val_33	1
331	val_331	2
331	NULL	2
332	NULL	1
338	val_338	1
338	NULL	1
339	NULL	1
34	val_34	1
34	NULL	1
342	val_342	2
344	NULL	2
345	val_345	1
345	NULL	1
348	NULL	5
35	val_35	3
35	NULL	3
351	val_351	1
351	NULL	1
353	NULL	2
356	val_356	1
360	val_360	1
362	val_362	1
364	val_364	1
365	NULL	1
366	val_366	1
367	NULL	2
369	val_369	3
37	NULL	2
373	NULL	1
374	val_374	1
375	val_375	1
377	NULL	1
379	NULL	1
382	NULL	2
384	val_384	3
389	val_389	1
392	val_392	1
392	NULL	1
393	val_393	1
394	val_394	1
394	NULL	1
395	NULL	2
397	NULL	2
399	val_399	2
4	val_4	1
4	NULL	1
400	NULL	1
401	NULL	5
403	NULL	3
406	val_406	4
406	NULL	4
407	NULL	1
409	val_409	3
41	val_41	1
41	NULL	1
413	val_413	2
414	NULL	2
417	val_417	3
419	val_419	1
419	NULL	1
42	NULL	2
427	NULL	1
43	val_43	1
430	NULL	3
431	val_431	3
435	val_435	1
436	val_436	1
436	NULL	1
437	val_437	1
439	val_439	2
44	val_44	1
443	val_443	1
443	NULL	1
452	val_452	1
453	val_453	1
454	val_454	3
455	val_455	1
455	NULL	1
459	NULL	2
460	NULL	1
467	val_467	1
469	val_469	5
47	val_47	1
470	val_470	1
470	NULL	1
472	NULL	1
477	val_477	1
477	NULL	1
479	val_479	1
479	NULL	1
481	val_481	1
482	val_482	1
482	NULL	1
483	val_483	1
484	val_484	1
485	val_485	1
485	NULL	1
487	NULL	1
489	NULL	4
492	val_492	2
492	NULL	2
493	NULL	1
494	NULL	1
495	val_495	1
495	NULL	1
496	val_496	1
497	val_497	1
498	val_498	3
498	NULL	3
5	val_5	3
51	val_51	2
51	NULL	2
54	val_54	1
54	NULL	1
57	val_57	1
64	val_64	1
64	NULL	1
65	val_65	1
65	NULL	1
67	val_67	2
69	NULL	1
74	val_74	1
76	val_76	2
76	NULL	2
77	val_77	1
77	NULL	1
78	val_78	1
78	NULL	1
8	NULL	1
82	NULL	1
83	val_83	2
85	val_85	1
86	val_86	1
86	NULL	1
87	val_87	1
9	NULL	1
90	NULL	3
92	NULL	1
95	val_95	2
96	NULL	1
97	val_97	2
98	val_98	2
NULL	NULL	500
