PREHOOK: query: create table lvj_stats (id string, f1 string)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@lvj_stats
POSTHOOK: query: create table lvj_stats (id string, f1 string)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@lvj_stats
PREHOOK: query: insert into lvj_stats values
  ('a','v1'), ('a','v2'), ('a','v3'),
  ('b','v4'), ('b','v5'), ('b','v6')
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@lvj_stats
POSTHOOK: query: insert into lvj_stats values
  ('a','v1'), ('a','v2'), ('a','v3'),
  ('b','v4'), ('b','v5'), ('b','v6')
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@lvj_stats
POSTHOOK: Lineage: lvj_stats.f1 SCRIPT []
POSTHOOK: Lineage: lvj_stats.id SCRIPT []
PREHOOK: query: analyze table lvj_stats compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@lvj_stats
PREHOOK: Output: default@lvj_stats
POSTHOOK: query: analyze table lvj_stats compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@lvj_stats
POSTHOOK: Output: default@lvj_stats
PREHOOK: query: analyze table lvj_stats compute statistics for columns
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@lvj_stats
PREHOOK: Output: default@lvj_stats
#### A masked pattern was here ####
POSTHOOK: query: analyze table lvj_stats compute statistics for columns
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@lvj_stats
POSTHOOK: Output: default@lvj_stats
#### A masked pattern was here ####
PREHOOK: query: explain
select id, f1, count(*)
from (select id, f1 from lvj_stats group by id, f1) sub
lateral view posexplode(array(f1, f1)) t1 as pos1, val1
group by id, f1
PREHOOK: type: QUERY
PREHOOK: Input: default@lvj_stats
#### A masked pattern was here ####
POSTHOOK: query: explain
select id, f1, count(*)
from (select id, f1 from lvj_stats group by id, f1) sub
lateral view posexplode(array(f1, f1)) t1 as pos1, val1
group by id, f1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@lvj_stats
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: lvj_stats
                  Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: id (type: string), f1 (type: string)
                    outputColumnNames: id, f1
                    Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: id (type: string), f1 (type: string)
                      minReductionHashAggr: 0.4
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string)
                        null sort order: zz
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                        Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: string), KEY._col1 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                Lateral View Forward
                  Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                    Lateral View Join Operator
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 6 Data size: 12546 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: string), _col1 (type: string)
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 6 Data size: 12546 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count()
                          keys: _col0 (type: string), _col1 (type: string)
                          minReductionHashAggr: 0.4
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 6 Data size: 1074 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: string)
                            null sort order: zz
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                            Statistics: Num rows: 6 Data size: 1074 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: bigint)
                  Select Operator
                    expressions: array(_col1,_col1) (type: array<string>)
                    outputColumnNames: _col0
                    Statistics: Num rows: 6 Data size: 11520 Basic stats: COMPLETE Column stats: COMPLETE
                    UDTF Operator
                      Statistics: Num rows: 6 Data size: 11520 Basic stats: COMPLETE Column stats: COMPLETE
                      function name: posexplode
                      Lateral View Join Operator
                        outputColumnNames: _col0, _col1, _col2, _col3
                        Statistics: Num rows: 6 Data size: 12546 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col0 (type: string), _col1 (type: string)
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 6 Data size: 12546 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: count()
                            keys: _col0 (type: string), _col1 (type: string)
                            minReductionHashAggr: 0.4
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 6 Data size: 1074 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: string), _col1 (type: string)
                              null sort order: zz
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                              Statistics: Num rows: 6 Data size: 1074 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col2 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: string), KEY._col1 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 6 Data size: 1074 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 6 Data size: 1074 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select id, f1, count(*)
from (select id, f1 from lvj_stats group by id, f1) sub
lateral view posexplode(array(f1, f1)) t1 as pos1, val1
group by id, f1
PREHOOK: type: QUERY
PREHOOK: Input: default@lvj_stats
#### A masked pattern was here ####
POSTHOOK: query: select id, f1, count(*)
from (select id, f1 from lvj_stats group by id, f1) sub
lateral view posexplode(array(f1, f1)) t1 as pos1, val1
group by id, f1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@lvj_stats
#### A masked pattern was here ####
a	v1	2
a	v2	2
b	v6	2
a	v3	2
b	v4	2
b	v5	2
PREHOOK: query: alter table lvj_stats update statistics for column id set('numDVs'='0','numNulls'='0')
PREHOOK: type: ALTERTABLE_UPDATETABLESTATS
PREHOOK: Input: default@lvj_stats
PREHOOK: Output: default@lvj_stats
POSTHOOK: query: alter table lvj_stats update statistics for column id set('numDVs'='0','numNulls'='0')
POSTHOOK: type: ALTERTABLE_UPDATETABLESTATS
POSTHOOK: Input: default@lvj_stats
POSTHOOK: Output: default@lvj_stats
PREHOOK: query: explain
select id, count(*)
from (select id, f1 from lvj_stats group by id, f1) sub
lateral view posexplode(array(f1, f1)) t1 as pos1, val1
group by id
PREHOOK: type: QUERY
PREHOOK: Input: default@lvj_stats
#### A masked pattern was here ####
POSTHOOK: query: explain
select id, count(*)
from (select id, f1 from lvj_stats group by id, f1) sub
lateral view posexplode(array(f1, f1)) t1 as pos1, val1
group by id
POSTHOOK: type: QUERY
POSTHOOK: Input: default@lvj_stats
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: lvj_stats
                  Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: id (type: string), f1 (type: string)
                    outputColumnNames: id, f1
                    Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: id (type: string), f1 (type: string)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string)
                        null sort order: zz
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                        Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: string), KEY._col1 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                Lateral View Forward
                  Statistics: Num rows: 6 Data size: 1026 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string)
                    outputColumnNames: _col0
                    Statistics: Num rows: 6 Data size: 510 Basic stats: COMPLETE Column stats: COMPLETE
                    Lateral View Join Operator
                      outputColumnNames: _col0, _col2, _col3
                      Statistics: Num rows: 6 Data size: 12030 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: string)
                        outputColumnNames: _col0
                        Statistics: Num rows: 6 Data size: 12030 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count()
                          keys: _col0 (type: string)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 3 Data size: 279 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: string)
                            null sort order: z
                            sort order: +
                            Map-reduce partition columns: _col0 (type: string)
                            Statistics: Num rows: 3 Data size: 279 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: bigint)
                  Select Operator
                    expressions: array(_col1,_col1) (type: array<string>)
                    outputColumnNames: _col0
                    Statistics: Num rows: 6 Data size: 11520 Basic stats: COMPLETE Column stats: COMPLETE
                    UDTF Operator
                      Statistics: Num rows: 6 Data size: 11520 Basic stats: COMPLETE Column stats: COMPLETE
                      function name: posexplode
                      Lateral View Join Operator
                        outputColumnNames: _col0, _col2, _col3
                        Statistics: Num rows: 6 Data size: 12030 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col0 (type: string)
                          outputColumnNames: _col0
                          Statistics: Num rows: 6 Data size: 12030 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: count()
                            keys: _col0 (type: string)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 3 Data size: 279 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: string)
                              null sort order: z
                              sort order: +
                              Map-reduce partition columns: _col0 (type: string)
                              Statistics: Num rows: 3 Data size: 279 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select id, count(*)
from (select id, f1 from lvj_stats group by id, f1) sub
lateral view posexplode(array(f1, f1)) t1 as pos1, val1
group by id
PREHOOK: type: QUERY
PREHOOK: Input: default@lvj_stats
#### A masked pattern was here ####
POSTHOOK: query: select id, count(*)
from (select id, f1 from lvj_stats group by id, f1) sub
lateral view posexplode(array(f1, f1)) t1 as pos1, val1
group by id
POSTHOOK: type: QUERY
POSTHOOK: Input: default@lvj_stats
#### A masked pattern was here ####
a	6
b	6
