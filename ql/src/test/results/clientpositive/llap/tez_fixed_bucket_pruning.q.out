PREHOOK: query: CREATE TABLE l3_clarity__l3_snap_number_2018022300104(l3_snapshot_number bigint)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@l3_clarity__l3_snap_number_2018022300104
POSTHOOK: query: CREATE TABLE l3_clarity__l3_snap_number_2018022300104(l3_snapshot_number bigint)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@l3_clarity__l3_snap_number_2018022300104
PREHOOK: query: CREATE TABLE l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1(
  plan_detail_object_id bigint,
  project_object_id bigint,
  charge_code_object_id bigint,
  transclass_object_id bigint,
  resource_object_id bigint,
  slice_date varchar(50),
  split_amount varchar(50),
  split_units varchar(50),
  year_key varchar(20),
  quarter_key varchar(20),
  month_key varchar(50),
  week_key varchar(50),
  date_key varchar(50),
  fy_year_key varchar(50),
  fy_quarter_key string,
  fy_month_key string,
  supplier_object_id bigint,
  business_dept_object_id bigint,
  business_partner_percentage decimal(38,8))
ROW FORMAT SERDE
'org.apache.hadoop.hive.ql.io.orc.OrcSerde'
STORED AS INPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
POSTHOOK: query: CREATE TABLE l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1(
  plan_detail_object_id bigint,
  project_object_id bigint,
  charge_code_object_id bigint,
  transclass_object_id bigint,
  resource_object_id bigint,
  slice_date varchar(50),
  split_amount varchar(50),
  split_units varchar(50),
  year_key varchar(20),
  quarter_key varchar(20),
  month_key varchar(50),
  week_key varchar(50),
  date_key varchar(50),
  fy_year_key varchar(50),
  fy_quarter_key string,
  fy_month_key string,
  supplier_object_id bigint,
  business_dept_object_id bigint,
  business_partner_percentage decimal(38,8))
ROW FORMAT SERDE
'org.apache.hadoop.hive.ql.io.orc.OrcSerde'
STORED AS INPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
PREHOOK: query: CREATE TABLE l3_monthly_dw_dimplan(
  idp_warehouse_id bigint,
  idp_audit_id bigint,
  idp_data_date date,
  l3_snapshot_number bigint,
  plan_key bigint,
  project_key bigint,
  charge_code_key bigint,
  transclass_key bigint,
  resource_key bigint,
  finplan_detail_object_id bigint,
  project_object_id bigint,
  txn_class_object_id bigint,
  charge_code_object_id bigint,
  resoruce_object_id bigint,
  plan_name varchar(1500),
  plan_code varchar(500),
  plan_type varchar(50),
  period_type varchar(50),
  plan_description varchar(3000),
  plan_status varchar(50),
  period_start varchar(50),
  period_end varchar(50),
  plan_of_record varchar(1),
  percentage decimal(32,6),
  l3_created_date timestamp,
  bmo_cost_type varchar(30),
  bmo_fiscal_year varchar(50),
  clarity_updated_date timestamp,
  is_latest_snapshot bigint,
  latest_fiscal_budget_plan bigint,
  plan_category varchar(70),
  last_updated_by varchar(250))
CLUSTERED BY (
idp_data_date)
INTO 64 BUCKETS
ROW FORMAT SERDE
'org.apache.hadoop.hive.ql.io.orc.OrcSerde'
STORED AS INPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@l3_monthly_dw_dimplan
POSTHOOK: query: CREATE TABLE l3_monthly_dw_dimplan(
  idp_warehouse_id bigint,
  idp_audit_id bigint,
  idp_data_date date,
  l3_snapshot_number bigint,
  plan_key bigint,
  project_key bigint,
  charge_code_key bigint,
  transclass_key bigint,
  resource_key bigint,
  finplan_detail_object_id bigint,
  project_object_id bigint,
  txn_class_object_id bigint,
  charge_code_object_id bigint,
  resoruce_object_id bigint,
  plan_name varchar(1500),
  plan_code varchar(500),
  plan_type varchar(50),
  period_type varchar(50),
  plan_description varchar(3000),
  plan_status varchar(50),
  period_start varchar(50),
  period_end varchar(50),
  plan_of_record varchar(1),
  percentage decimal(32,6),
  l3_created_date timestamp,
  bmo_cost_type varchar(30),
  bmo_fiscal_year varchar(50),
  clarity_updated_date timestamp,
  is_latest_snapshot bigint,
  latest_fiscal_budget_plan bigint,
  plan_category varchar(70),
  last_updated_by varchar(250))
CLUSTERED BY (
idp_data_date)
INTO 64 BUCKETS
ROW FORMAT SERDE
'org.apache.hadoop.hive.ql.io.orc.OrcSerde'
STORED AS INPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@l3_monthly_dw_dimplan
PREHOOK: query: CREATE TABLE l3_monthly_dw_dimplan_unbucketed(
  idp_warehouse_id bigint,
  idp_audit_id bigint,
  idp_data_date date,
  l3_snapshot_number bigint,
  plan_key bigint,
  project_key bigint,
  charge_code_key bigint,
  transclass_key bigint,
  resource_key bigint,
  finplan_detail_object_id bigint,
  project_object_id bigint,
  txn_class_object_id bigint,
  charge_code_object_id bigint,
  resoruce_object_id bigint,
  plan_name varchar(1500),
  plan_code varchar(500),
  plan_type varchar(50),
  period_type varchar(50),
  plan_description varchar(3000),
  plan_status varchar(50),
  period_start varchar(50),
  period_end varchar(50),
  plan_of_record varchar(1),
  percentage decimal(32,6),
  l3_created_date timestamp,
  bmo_cost_type varchar(30),
  bmo_fiscal_year varchar(50),
  clarity_updated_date timestamp,
  is_latest_snapshot bigint,
  latest_fiscal_budget_plan bigint,
  plan_category varchar(70),
  last_updated_by varchar(250))
ROW FORMAT SERDE
'org.apache.hadoop.hive.ql.io.orc.OrcSerde'
STORED AS INPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@l3_monthly_dw_dimplan_unbucketed
POSTHOOK: query: CREATE TABLE l3_monthly_dw_dimplan_unbucketed(
  idp_warehouse_id bigint,
  idp_audit_id bigint,
  idp_data_date date,
  l3_snapshot_number bigint,
  plan_key bigint,
  project_key bigint,
  charge_code_key bigint,
  transclass_key bigint,
  resource_key bigint,
  finplan_detail_object_id bigint,
  project_object_id bigint,
  txn_class_object_id bigint,
  charge_code_object_id bigint,
  resoruce_object_id bigint,
  plan_name varchar(1500),
  plan_code varchar(500),
  plan_type varchar(50),
  period_type varchar(50),
  plan_description varchar(3000),
  plan_status varchar(50),
  period_start varchar(50),
  period_end varchar(50),
  plan_of_record varchar(1),
  percentage decimal(32,6),
  l3_created_date timestamp,
  bmo_cost_type varchar(30),
  bmo_fiscal_year varchar(50),
  clarity_updated_date timestamp,
  is_latest_snapshot bigint,
  latest_fiscal_budget_plan bigint,
  plan_category varchar(70),
  last_updated_by varchar(250))
ROW FORMAT SERDE
'org.apache.hadoop.hive.ql.io.orc.OrcSerde'
STORED AS INPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@l3_monthly_dw_dimplan_unbucketed
PREHOOK: query: CREATE TABLE l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1(
  project_key bigint,
  l3_snapshot_number bigint,
  l3_created_date timestamp,
  project_object_id bigint,
  idp_data_date date)
ROW FORMAT SERDE
'org.apache.hadoop.hive.ql.io.orc.OrcSerde'
STORED AS INPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
POSTHOOK: query: CREATE TABLE l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1(
  project_key bigint,
  l3_snapshot_number bigint,
  l3_created_date timestamp,
  project_object_id bigint,
  idp_data_date date)
ROW FORMAT SERDE
'org.apache.hadoop.hive.ql.io.orc.OrcSerde'
STORED AS INPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
PREHOOK: query: load data local inpath '../../data/files/bucket_pruning/l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1' into table l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
POSTHOOK: query: load data local inpath '../../data/files/bucket_pruning/l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1' into table l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
PREHOOK: query: load data local inpath '../../data/files/bucket_pruning/l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1' into table l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
POSTHOOK: query: load data local inpath '../../data/files/bucket_pruning/l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1' into table l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
PREHOOK: query: load data local inpath '../../data/files/bucket_pruning/l3_clarity__l3_snap_number_2018022300104' into table l3_clarity__l3_snap_number_2018022300104
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@l3_clarity__l3_snap_number_2018022300104
POSTHOOK: query: load data local inpath '../../data/files/bucket_pruning/l3_clarity__l3_snap_number_2018022300104' into table l3_clarity__l3_snap_number_2018022300104
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@l3_clarity__l3_snap_number_2018022300104
PREHOOK: query: load data local inpath '../../data/files/bucket_pruning/l3_monthly_dw_dimplan' into table l3_monthly_dw_dimplan_unbucketed
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@l3_monthly_dw_dimplan_unbucketed
POSTHOOK: query: load data local inpath '../../data/files/bucket_pruning/l3_monthly_dw_dimplan' into table l3_monthly_dw_dimplan_unbucketed
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@l3_monthly_dw_dimplan_unbucketed
PREHOOK: query: INSERT OVERWRITE TABLE l3_monthly_dw_dimplan select * from l3_monthly_dw_dimplan_unbucketed
PREHOOK: type: QUERY
PREHOOK: Input: default@l3_monthly_dw_dimplan_unbucketed
PREHOOK: Output: default@l3_monthly_dw_dimplan
POSTHOOK: query: INSERT OVERWRITE TABLE l3_monthly_dw_dimplan select * from l3_monthly_dw_dimplan_unbucketed
POSTHOOK: type: QUERY
POSTHOOK: Input: default@l3_monthly_dw_dimplan_unbucketed
POSTHOOK: Output: default@l3_monthly_dw_dimplan
POSTHOOK: Lineage: l3_monthly_dw_dimplan.bmo_cost_type SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:bmo_cost_type, type:varchar(30), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.bmo_fiscal_year SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:bmo_fiscal_year, type:varchar(50), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.charge_code_key SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:charge_code_key, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.charge_code_object_id SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:charge_code_object_id, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.clarity_updated_date SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:clarity_updated_date, type:timestamp, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.finplan_detail_object_id SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:finplan_detail_object_id, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.idp_audit_id SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:idp_audit_id, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.idp_data_date SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:idp_data_date, type:date, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.idp_warehouse_id SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:idp_warehouse_id, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.is_latest_snapshot SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:is_latest_snapshot, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.l3_created_date SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:l3_created_date, type:timestamp, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.l3_snapshot_number SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:l3_snapshot_number, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.last_updated_by SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:last_updated_by, type:varchar(250), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.latest_fiscal_budget_plan SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:latest_fiscal_budget_plan, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.percentage SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:percentage, type:decimal(32,6), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.period_end SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:period_end, type:varchar(50), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.period_start SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:period_start, type:varchar(50), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.period_type SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:period_type, type:varchar(50), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.plan_category SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:plan_category, type:varchar(70), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.plan_code SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:plan_code, type:varchar(500), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.plan_description SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:plan_description, type:varchar(3000), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.plan_key SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:plan_key, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.plan_name SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:plan_name, type:varchar(1500), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.plan_of_record SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:plan_of_record, type:varchar(1), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.plan_status SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:plan_status, type:varchar(50), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.plan_type SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:plan_type, type:varchar(50), comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.project_key SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:project_key, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.project_object_id SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:project_object_id, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.resoruce_object_id SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:resoruce_object_id, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.resource_key SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:resource_key, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.transclass_key SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:transclass_key, type:bigint, comment:null), ]
POSTHOOK: Lineage: l3_monthly_dw_dimplan.txn_class_object_id SIMPLE [(l3_monthly_dw_dimplan_unbucketed)l3_monthly_dw_dimplan_unbucketed.FieldSchema(name:txn_class_object_id, type:bigint, comment:null), ]
PREHOOK: query: analyze table l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1 compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
PREHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
POSTHOOK: query: analyze table l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1 compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
POSTHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
PREHOOK: query: analyze table l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1 compute statistics for columns
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
PREHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
#### A masked pattern was here ####
POSTHOOK: query: analyze table l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1 compute statistics for columns
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
POSTHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
#### A masked pattern was here ####
PREHOOK: query: analyze table l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1 compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
PREHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
POSTHOOK: query: analyze table l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1 compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
POSTHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
PREHOOK: query: analyze table l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1 compute statistics for columns
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
PREHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
#### A masked pattern was here ####
POSTHOOK: query: analyze table l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1 compute statistics for columns
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
POSTHOOK: Output: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
#### A masked pattern was here ####
PREHOOK: query: analyze table l3_clarity__l3_snap_number_2018022300104 compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
PREHOOK: Output: default@l3_clarity__l3_snap_number_2018022300104
POSTHOOK: query: analyze table l3_clarity__l3_snap_number_2018022300104 compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
POSTHOOK: Output: default@l3_clarity__l3_snap_number_2018022300104
PREHOOK: query: analyze table l3_clarity__l3_snap_number_2018022300104 compute statistics for columns
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
PREHOOK: Output: default@l3_clarity__l3_snap_number_2018022300104
#### A masked pattern was here ####
POSTHOOK: query: analyze table l3_clarity__l3_snap_number_2018022300104 compute statistics for columns
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
POSTHOOK: Output: default@l3_clarity__l3_snap_number_2018022300104
#### A masked pattern was here ####
PREHOOK: query: analyze table l3_monthly_dw_dimplan compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@l3_monthly_dw_dimplan
PREHOOK: Output: default@l3_monthly_dw_dimplan
POSTHOOK: query: analyze table l3_monthly_dw_dimplan compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@l3_monthly_dw_dimplan
POSTHOOK: Output: default@l3_monthly_dw_dimplan
PREHOOK: query: analyze table l3_monthly_dw_dimplan compute statistics for columns
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@l3_monthly_dw_dimplan
PREHOOK: Output: default@l3_monthly_dw_dimplan
#### A masked pattern was here ####
POSTHOOK: query: analyze table l3_monthly_dw_dimplan compute statistics for columns
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@l3_monthly_dw_dimplan
POSTHOOK: Output: default@l3_monthly_dw_dimplan
#### A masked pattern was here ####
Warning: Map Join MAPJOIN[54][bigTable=?] in task 'Map 1' is a cross product
PREHOOK: query: EXPLAIN EXTENDED
SELECT DW.PROJECT_OBJECT_ID, S1.PLAN_KEY as PLAN_KEY, S2.PROJECT_KEY AS PROJECT_KEY
FROM l3_clarity__L3_SNAP_NUMBER_2018022300104 snap inner join
l3_clarity__L3_MONTHLY_DW_FACTPLAN_DW_STG_2018022300104_1 DW on 1=1
  LEFT OUTER JOIN L3_MONTHLY_DW_DIMPLAN S1
    ON S1.FINPLAN_DETAIL_OBJECT_ID = DW.PLAN_DETAIL_OBJECT_ID AND S1.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S1.IDP_DATA_DATE = '2017-12-28'
  LEFT OUTER JOIN l3_clarity__L3_MONTHLY_DW_FACTPLAN_DATAJOIN_1_s2_2018022300104_1 S2
    ON S2.PROJECT_OBJECT_ID = DW.PROJECT_OBJECT_ID AND S2.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S2.IDP_DATA_DATE = '2017-12-28'
where DW.PROJECT_OBJECT_ID =7147200
order by DW.PROJECT_OBJECT_ID, PLAN_KEY, PROJECT_KEY
limit 5
PREHOOK: type: QUERY
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
PREHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
PREHOOK: Input: default@l3_monthly_dw_dimplan
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN EXTENDED
SELECT DW.PROJECT_OBJECT_ID, S1.PLAN_KEY as PLAN_KEY, S2.PROJECT_KEY AS PROJECT_KEY
FROM l3_clarity__L3_SNAP_NUMBER_2018022300104 snap inner join
l3_clarity__L3_MONTHLY_DW_FACTPLAN_DW_STG_2018022300104_1 DW on 1=1
  LEFT OUTER JOIN L3_MONTHLY_DW_DIMPLAN S1
    ON S1.FINPLAN_DETAIL_OBJECT_ID = DW.PLAN_DETAIL_OBJECT_ID AND S1.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S1.IDP_DATA_DATE = '2017-12-28'
  LEFT OUTER JOIN l3_clarity__L3_MONTHLY_DW_FACTPLAN_DATAJOIN_1_s2_2018022300104_1 S2
    ON S2.PROJECT_OBJECT_ID = DW.PROJECT_OBJECT_ID AND S2.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S2.IDP_DATA_DATE = '2017-12-28'
where DW.PROJECT_OBJECT_ID =7147200
order by DW.PROJECT_OBJECT_ID, PLAN_KEY, PROJECT_KEY
limit 5
POSTHOOK: type: QUERY
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
POSTHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
POSTHOOK: Input: default@l3_monthly_dw_dimplan
#### A masked pattern was here ####
OPTIMIZED SQL: SELECT CAST(7147200 AS BIGINT) AS `project_object_id`, `t8`.`plan_key`, `t8`.`project_key`
FROM (SELECT `t4`.`plan_key`, `t6`.`project_key`
FROM (SELECT `t3`.`l3_snapshot_number`, `t2`.`plan_detail_object_id`, `t0`.`l3_snapshot_number` AS `l3_snapshot_number0`, `t0`.`plan_key`, `t0`.`finplan_detail_object_id`
FROM (SELECT `l3_snapshot_number`, `plan_key`, `finplan_detail_object_id`
FROM `default`.`l3_monthly_dw_dimplan`
WHERE `idp_data_date` = DATE '2017-12-28' AND (`finplan_detail_object_id` IS NOT NULL AND `l3_snapshot_number` IS NOT NULL)) AS `t0`
RIGHT JOIN ((SELECT `plan_detail_object_id`
FROM `default`.`l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1`
WHERE `project_object_id` = 7147200) AS `t2`, (SELECT `l3_snapshot_number`
FROM `default`.`l3_clarity__l3_snap_number_2018022300104`) AS `t3`) ON `t0`.`finplan_detail_object_id` = `t2`.`plan_detail_object_id` AND `t0`.`l3_snapshot_number` = `t3`.`l3_snapshot_number`) AS `t4`
LEFT JOIN (SELECT `project_key`, `l3_snapshot_number`
FROM `default`.`l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1`
WHERE `idp_data_date` = DATE '2017-12-28' AND (`project_object_id` = 7147200 AND `l3_snapshot_number` IS NOT NULL)) AS `t6` ON `t4`.`l3_snapshot_number` = `t6`.`l3_snapshot_number`
ORDER BY `t4`.`plan_key`, `t6`.`project_key`
LIMIT 5) AS `t8`
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: dw
                  filterExpr: (project_object_id = 7147200L) (type: boolean)
                  Statistics: Num rows: 15 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                  GatherStats: false
                  Filter Operator
                    isSamplingPred: false
                    predicate: (project_object_id = 7147200L) (type: boolean)
                    Statistics: Num rows: 15 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: plan_detail_object_id (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        Estimated key counts: Map 3 => 1
                        keys:
                          0 
                          1 
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 3
                        Position of Big Table: 0
                        Statistics: Num rows: 15 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Left Outer Join 0 to 1
                          Estimated key counts: Map 4 => 90170
                          keys:
                            0 _col1 (type: bigint), _col0 (type: bigint)
                            1 _col0 (type: bigint), _col2 (type: bigint)
                          outputColumnNames: _col1, _col3
                          input vertices:
                            1 Map 4
                          Position of Big Table: 0
                          Statistics: Num rows: 30 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Select Operator
                            expressions: _col1 (type: bigint), _col3 (type: bigint)
                            outputColumnNames: _col0, _col3
                            Statistics: Num rows: 30 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Left Outer Join 0 to 1
                              Estimated key counts: Map 5 => 1
                              keys:
                                0 _col0 (type: bigint)
                                1 _col1 (type: bigint)
                              outputColumnNames: _col3, _col5
                              input vertices:
                                1 Map 5
                              Position of Big Table: 0
                              Statistics: Num rows: 30 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                              Top N Key Operator
                                sort order: ++
                                keys: _col3 (type: bigint), _col5 (type: bigint)
                                null sort order: zz
                                Statistics: Num rows: 30 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                                top n: 5
                                Select Operator
                                  expressions: _col3 (type: bigint), _col5 (type: bigint)
                                  outputColumnNames: _col0, _col1
                                  Statistics: Num rows: 30 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    bucketingVersion: 2
                                    key expressions: _col0 (type: bigint), _col1 (type: bigint)
                                    null sort order: zz
                                    numBuckets: -1
                                    sort order: ++
                                    Statistics: Num rows: 30 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                                    tag: -1
                                    auto parallelism: false
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Path -> Alias:
#### A masked pattern was here ####
            Path -> Partition:
#### A masked pattern was here ####
                Partition
                  base file name: l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
                  input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                  output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                  properties:
                    bucket_count -1
                    bucketing_version 2
                    column.name.delimiter ,
                    columns plan_detail_object_id,project_object_id,charge_code_object_id,transclass_object_id,resource_object_id,slice_date,split_amount,split_units,year_key,quarter_key,month_key,week_key,date_key,fy_year_key,fy_quarter_key,fy_month_key,supplier_object_id,business_dept_object_id,business_partner_percentage
                    columns.types bigint:bigint:bigint:bigint:bigint:varchar(50):varchar(50):varchar(50):varchar(20):varchar(20):varchar(50):varchar(50):varchar(50):varchar(50):string:string:bigint:bigint:decimal(38,8)
#### A masked pattern was here ####
                    name default.l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
                    serialization.format 1
                    serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                  serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                
                    input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                    output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                    properties:
                      bucketing_version 2
                      column.name.delimiter ,
                      columns plan_detail_object_id,project_object_id,charge_code_object_id,transclass_object_id,resource_object_id,slice_date,split_amount,split_units,year_key,quarter_key,month_key,week_key,date_key,fy_year_key,fy_quarter_key,fy_month_key,supplier_object_id,business_dept_object_id,business_partner_percentage
                      columns.comments 
                      columns.types bigint:bigint:bigint:bigint:bigint:varchar(50):varchar(50):varchar(50):varchar(20):varchar(20):varchar(50):varchar(50):varchar(50):varchar(50):string:string:bigint:bigint:decimal(38,8)
#### A masked pattern was here ####
                      name default.l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
                      serialization.format 1
                      serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    name: default.l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
                  name: default.l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
            Truncated Path -> Alias:
              /l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1 [dw]
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: snap
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  GatherStats: false
                  Select Operator
                    expressions: l3_snapshot_number (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      bucketingVersion: 2
                      null sort order: 
                      numBuckets: -1
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                      tag: 1
                      value expressions: _col0 (type: bigint)
                      auto parallelism: false
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Path -> Alias:
#### A masked pattern was here ####
            Path -> Partition:
#### A masked pattern was here ####
                Partition
                  base file name: l3_clarity__l3_snap_number_2018022300104
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  properties:
                    bucket_count -1
                    bucketing_version 2
                    column.name.delimiter ,
                    columns l3_snapshot_number
                    columns.types bigint
#### A masked pattern was here ####
                    name default.l3_clarity__l3_snap_number_2018022300104
                    serialization.format 1
                    serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    properties:
                      bucketing_version 2
                      column.name.delimiter ,
                      columns l3_snapshot_number
                      columns.comments 
                      columns.types bigint
#### A masked pattern was here ####
                      name default.l3_clarity__l3_snap_number_2018022300104
                      serialization.format 1
                      serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: default.l3_clarity__l3_snap_number_2018022300104
                  name: default.l3_clarity__l3_snap_number_2018022300104
            Truncated Path -> Alias:
              /l3_clarity__l3_snap_number_2018022300104 [snap]
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: s1
                  filterExpr: ((idp_data_date = DATE'2017-12-28') and finplan_detail_object_id is not null and l3_snapshot_number is not null) (type: boolean)
                  Statistics: Num rows: 180340 Data size: 14427200 Basic stats: COMPLETE Column stats: COMPLETE
                  GatherStats: false
                  Filter Operator
                    isSamplingPred: false
                    predicate: ((idp_data_date = DATE'2017-12-28') and finplan_detail_object_id is not null and l3_snapshot_number is not null) (type: boolean)
                    Statistics: Num rows: 90170 Data size: 7213600 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: l3_snapshot_number (type: bigint), plan_key (type: bigint), finplan_detail_object_id (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 90170 Data size: 2164080 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        bucketingVersion: 2
                        key expressions: _col0 (type: bigint), _col2 (type: bigint)
                        null sort order: zz
                        numBuckets: -1
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col2 (type: bigint)
                        Statistics: Num rows: 90170 Data size: 2164080 Basic stats: COMPLETE Column stats: COMPLETE
                        tag: 1
                        value expressions: _col1 (type: bigint)
                        auto parallelism: true
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Path -> Alias:
#### A masked pattern was here ####
            Path -> Partition:
#### A masked pattern was here ####
                Partition
                  base file name: l3_monthly_dw_dimplan
                  input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                  output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                  properties:
                    bucket_count 64
                    bucket_field_name idp_data_date
                    bucketing_version 2
                    column.name.delimiter ,
                    columns idp_warehouse_id,idp_audit_id,idp_data_date,l3_snapshot_number,plan_key,project_key,charge_code_key,transclass_key,resource_key,finplan_detail_object_id,project_object_id,txn_class_object_id,charge_code_object_id,resoruce_object_id,plan_name,plan_code,plan_type,period_type,plan_description,plan_status,period_start,period_end,plan_of_record,percentage,l3_created_date,bmo_cost_type,bmo_fiscal_year,clarity_updated_date,is_latest_snapshot,latest_fiscal_budget_plan,plan_category,last_updated_by
                    columns.types bigint:bigint:date:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:varchar(1500):varchar(500):varchar(50):varchar(50):varchar(3000):varchar(50):varchar(50):varchar(50):varchar(1):decimal(32,6):timestamp:varchar(30):varchar(50):timestamp:bigint:bigint:varchar(70):varchar(250)
#### A masked pattern was here ####
                    name default.l3_monthly_dw_dimplan
                    serialization.format 1
                    serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                  serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                
                    input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                    output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                    properties:
                      bucket_count 64
                      bucket_field_name idp_data_date
                      bucketing_version 2
                      column.name.delimiter ,
                      columns idp_warehouse_id,idp_audit_id,idp_data_date,l3_snapshot_number,plan_key,project_key,charge_code_key,transclass_key,resource_key,finplan_detail_object_id,project_object_id,txn_class_object_id,charge_code_object_id,resoruce_object_id,plan_name,plan_code,plan_type,period_type,plan_description,plan_status,period_start,period_end,plan_of_record,percentage,l3_created_date,bmo_cost_type,bmo_fiscal_year,clarity_updated_date,is_latest_snapshot,latest_fiscal_budget_plan,plan_category,last_updated_by
                      columns.comments 
                      columns.types bigint:bigint:date:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:varchar(1500):varchar(500):varchar(50):varchar(50):varchar(3000):varchar(50):varchar(50):varchar(50):varchar(1):decimal(32,6):timestamp:varchar(30):varchar(50):timestamp:bigint:bigint:varchar(70):varchar(250)
#### A masked pattern was here ####
                      name default.l3_monthly_dw_dimplan
                      serialization.format 1
                      serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    name: default.l3_monthly_dw_dimplan
                  name: default.l3_monthly_dw_dimplan
            Truncated Path -> Alias:
              /l3_monthly_dw_dimplan [s1]
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: s2
                  filterExpr: ((idp_data_date = DATE'2017-12-28') and (project_object_id = 7147200L) and l3_snapshot_number is not null) (type: boolean)
                  Statistics: Num rows: 1 Data size: 80 Basic stats: COMPLETE Column stats: COMPLETE
                  GatherStats: false
                  Filter Operator
                    isSamplingPred: false
                    predicate: ((idp_data_date = DATE'2017-12-28') and (project_object_id = 7147200L) and l3_snapshot_number is not null) (type: boolean)
                    Statistics: Num rows: 1 Data size: 80 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: project_key (type: bigint), l3_snapshot_number (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        bucketingVersion: 2
                        key expressions: _col1 (type: bigint)
                        null sort order: z
                        numBuckets: -1
                        sort order: +
                        Map-reduce partition columns: _col1 (type: bigint)
                        Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                        tag: 1
                        value expressions: _col0 (type: bigint)
                        auto parallelism: true
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Path -> Alias:
#### A masked pattern was here ####
            Path -> Partition:
#### A masked pattern was here ####
                Partition
                  base file name: l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
                  input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                  output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                  properties:
                    bucket_count -1
                    bucketing_version 2
                    column.name.delimiter ,
                    columns project_key,l3_snapshot_number,l3_created_date,project_object_id,idp_data_date
                    columns.types bigint:bigint:timestamp:bigint:date
#### A masked pattern was here ####
                    name default.l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
                    serialization.format 1
                    serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                  serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                
                    input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                    output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                    properties:
                      bucketing_version 2
                      column.name.delimiter ,
                      columns project_key,l3_snapshot_number,l3_created_date,project_object_id,idp_data_date
                      columns.comments 
                      columns.types bigint:bigint:timestamp:bigint:date
#### A masked pattern was here ####
                      name default.l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
                      serialization.format 1
                      serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    name: default.l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
                  name: default.l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
            Truncated Path -> Alias:
              /l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1 [s2]
        Reducer 2 
            Execution mode: vectorized, llap
            Needs Tagging: false
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 30 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 5
                  Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: 7147200L (type: bigint), _col0 (type: bigint), _col1 (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 5 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      bucketingVersion: 2
                      compressed: false
                      GlobalTableId: 0
#### A masked pattern was here ####
                      NumFilesPerFileSink: 1
                      Statistics: Num rows: 5 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
#### A masked pattern was here ####
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          properties:
                            bucketing_version -1
                            columns _col0,_col1,_col2
                            columns.types bigint:bigint:bigint
                            escape.delim \
                            hive.serialization.extend.additional.nesting.levels true
                            serialization.escape.crlf true
                            serialization.format 1
                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                      TotalFiles: 1
                      GatherStats: false
                      MultiFileSpray: false

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

Warning: Map Join MAPJOIN[54][bigTable=?] in task 'Map 1' is a cross product
PREHOOK: query: SELECT DW.PROJECT_OBJECT_ID, S1.PLAN_KEY as PLAN_KEY, S2.PROJECT_KEY AS PROJECT_KEY
FROM l3_clarity__L3_SNAP_NUMBER_2018022300104 snap inner join
l3_clarity__L3_MONTHLY_DW_FACTPLAN_DW_STG_2018022300104_1 DW on 1=1
  LEFT OUTER JOIN L3_MONTHLY_DW_DIMPLAN S1
    ON S1.FINPLAN_DETAIL_OBJECT_ID = DW.PLAN_DETAIL_OBJECT_ID AND S1.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S1.IDP_DATA_DATE = '2017-12-28'
  LEFT OUTER JOIN l3_clarity__L3_MONTHLY_DW_FACTPLAN_DATAJOIN_1_s2_2018022300104_1 S2
    ON S2.PROJECT_OBJECT_ID = DW.PROJECT_OBJECT_ID AND S2.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S2.IDP_DATA_DATE = '2017-12-28'
where DW.PROJECT_OBJECT_ID =7147200
order by DW.PROJECT_OBJECT_ID, PLAN_KEY, PROJECT_KEY
limit 5
PREHOOK: type: QUERY
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
PREHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
PREHOOK: Input: default@l3_monthly_dw_dimplan
#### A masked pattern was here ####
POSTHOOK: query: SELECT DW.PROJECT_OBJECT_ID, S1.PLAN_KEY as PLAN_KEY, S2.PROJECT_KEY AS PROJECT_KEY
FROM l3_clarity__L3_SNAP_NUMBER_2018022300104 snap inner join
l3_clarity__L3_MONTHLY_DW_FACTPLAN_DW_STG_2018022300104_1 DW on 1=1
  LEFT OUTER JOIN L3_MONTHLY_DW_DIMPLAN S1
    ON S1.FINPLAN_DETAIL_OBJECT_ID = DW.PLAN_DETAIL_OBJECT_ID AND S1.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S1.IDP_DATA_DATE = '2017-12-28'
  LEFT OUTER JOIN l3_clarity__L3_MONTHLY_DW_FACTPLAN_DATAJOIN_1_s2_2018022300104_1 S2
    ON S2.PROJECT_OBJECT_ID = DW.PROJECT_OBJECT_ID AND S2.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S2.IDP_DATA_DATE = '2017-12-28'
where DW.PROJECT_OBJECT_ID =7147200
order by DW.PROJECT_OBJECT_ID, PLAN_KEY, PROJECT_KEY
limit 5
POSTHOOK: type: QUERY
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
POSTHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
POSTHOOK: Input: default@l3_monthly_dw_dimplan
#### A masked pattern was here ####
7147200	189561	27114
7147200	191205	27114
7147200	195775	27114
7147200	234349	27114
7147200	350519	27114
Warning: Map Join MAPJOIN[54][bigTable=?] in task 'Map 1' is a cross product
PREHOOK: query: EXPLAIN EXTENDED
SELECT DW.PROJECT_OBJECT_ID, S1.PLAN_KEY as PLAN_KEY, S2.PROJECT_KEY AS PROJECT_KEY
FROM l3_clarity__L3_SNAP_NUMBER_2018022300104 snap inner join
l3_clarity__L3_MONTHLY_DW_FACTPLAN_DW_STG_2018022300104_1 DW on 1=1
  LEFT OUTER JOIN L3_MONTHLY_DW_DIMPLAN S1
    ON S1.FINPLAN_DETAIL_OBJECT_ID = DW.PLAN_DETAIL_OBJECT_ID AND S1.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S1.IDP_DATA_DATE = '2017-12-28'
  LEFT OUTER JOIN l3_clarity__L3_MONTHLY_DW_FACTPLAN_DATAJOIN_1_s2_2018022300104_1 S2
    ON S2.PROJECT_OBJECT_ID = DW.PROJECT_OBJECT_ID AND S2.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S2.IDP_DATA_DATE = '2017-12-28'
where DW.PROJECT_OBJECT_ID =7147200
order by DW.PROJECT_OBJECT_ID, PLAN_KEY, PROJECT_KEY
limit 5
PREHOOK: type: QUERY
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
PREHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
PREHOOK: Input: default@l3_monthly_dw_dimplan
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN EXTENDED
SELECT DW.PROJECT_OBJECT_ID, S1.PLAN_KEY as PLAN_KEY, S2.PROJECT_KEY AS PROJECT_KEY
FROM l3_clarity__L3_SNAP_NUMBER_2018022300104 snap inner join
l3_clarity__L3_MONTHLY_DW_FACTPLAN_DW_STG_2018022300104_1 DW on 1=1
  LEFT OUTER JOIN L3_MONTHLY_DW_DIMPLAN S1
    ON S1.FINPLAN_DETAIL_OBJECT_ID = DW.PLAN_DETAIL_OBJECT_ID AND S1.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S1.IDP_DATA_DATE = '2017-12-28'
  LEFT OUTER JOIN l3_clarity__L3_MONTHLY_DW_FACTPLAN_DATAJOIN_1_s2_2018022300104_1 S2
    ON S2.PROJECT_OBJECT_ID = DW.PROJECT_OBJECT_ID AND S2.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S2.IDP_DATA_DATE = '2017-12-28'
where DW.PROJECT_OBJECT_ID =7147200
order by DW.PROJECT_OBJECT_ID, PLAN_KEY, PROJECT_KEY
limit 5
POSTHOOK: type: QUERY
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
POSTHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
POSTHOOK: Input: default@l3_monthly_dw_dimplan
#### A masked pattern was here ####
OPTIMIZED SQL: SELECT CAST(7147200 AS BIGINT) AS `project_object_id`, `t8`.`plan_key`, `t8`.`project_key`
FROM (SELECT `t4`.`plan_key`, `t6`.`project_key`
FROM (SELECT `t3`.`l3_snapshot_number`, `t2`.`plan_detail_object_id`, `t0`.`l3_snapshot_number` AS `l3_snapshot_number0`, `t0`.`plan_key`, `t0`.`finplan_detail_object_id`
FROM (SELECT `l3_snapshot_number`, `plan_key`, `finplan_detail_object_id`
FROM `default`.`l3_monthly_dw_dimplan`
WHERE `idp_data_date` = DATE '2017-12-28' AND (`finplan_detail_object_id` IS NOT NULL AND `l3_snapshot_number` IS NOT NULL)) AS `t0`
RIGHT JOIN ((SELECT `plan_detail_object_id`
FROM `default`.`l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1`
WHERE `project_object_id` = 7147200) AS `t2`, (SELECT `l3_snapshot_number`
FROM `default`.`l3_clarity__l3_snap_number_2018022300104`) AS `t3`) ON `t0`.`finplan_detail_object_id` = `t2`.`plan_detail_object_id` AND `t0`.`l3_snapshot_number` = `t3`.`l3_snapshot_number`) AS `t4`
LEFT JOIN (SELECT `project_key`, `l3_snapshot_number`
FROM `default`.`l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1`
WHERE `idp_data_date` = DATE '2017-12-28' AND (`project_object_id` = 7147200 AND `l3_snapshot_number` IS NOT NULL)) AS `t6` ON `t4`.`l3_snapshot_number` = `t6`.`l3_snapshot_number`
ORDER BY `t4`.`plan_key`, `t6`.`project_key`
LIMIT 5) AS `t8`
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: dw
                  filterExpr: (project_object_id = 7147200L) (type: boolean)
                  Statistics: Num rows: 15 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                  GatherStats: false
                  Filter Operator
                    isSamplingPred: false
                    predicate: (project_object_id = 7147200L) (type: boolean)
                    Statistics: Num rows: 15 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: plan_detail_object_id (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        Estimated key counts: Map 3 => 1
                        keys:
                          0 
                          1 
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 3
                        Position of Big Table: 0
                        Statistics: Num rows: 15 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Left Outer Join 0 to 1
                          Estimated key counts: Map 4 => 90170
                          keys:
                            0 _col1 (type: bigint), _col0 (type: bigint)
                            1 _col0 (type: bigint), _col2 (type: bigint)
                          outputColumnNames: _col1, _col3
                          input vertices:
                            1 Map 4
                          Position of Big Table: 0
                          Statistics: Num rows: 30 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Select Operator
                            expressions: _col1 (type: bigint), _col3 (type: bigint)
                            outputColumnNames: _col0, _col3
                            Statistics: Num rows: 30 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Left Outer Join 0 to 1
                              Estimated key counts: Map 5 => 1
                              keys:
                                0 _col0 (type: bigint)
                                1 _col1 (type: bigint)
                              outputColumnNames: _col3, _col5
                              input vertices:
                                1 Map 5
                              Position of Big Table: 0
                              Statistics: Num rows: 30 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                              Top N Key Operator
                                sort order: ++
                                keys: _col3 (type: bigint), _col5 (type: bigint)
                                null sort order: zz
                                Statistics: Num rows: 30 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                                top n: 5
                                Select Operator
                                  expressions: _col3 (type: bigint), _col5 (type: bigint)
                                  outputColumnNames: _col0, _col1
                                  Statistics: Num rows: 30 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    bucketingVersion: 2
                                    key expressions: _col0 (type: bigint), _col1 (type: bigint)
                                    null sort order: zz
                                    numBuckets: -1
                                    sort order: ++
                                    Statistics: Num rows: 30 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                                    tag: -1
                                    auto parallelism: false
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Path -> Alias:
#### A masked pattern was here ####
            Path -> Partition:
#### A masked pattern was here ####
                Partition
                  base file name: l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
                  input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                  output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                  properties:
                    bucket_count -1
                    bucketing_version 2
                    column.name.delimiter ,
                    columns plan_detail_object_id,project_object_id,charge_code_object_id,transclass_object_id,resource_object_id,slice_date,split_amount,split_units,year_key,quarter_key,month_key,week_key,date_key,fy_year_key,fy_quarter_key,fy_month_key,supplier_object_id,business_dept_object_id,business_partner_percentage
                    columns.types bigint:bigint:bigint:bigint:bigint:varchar(50):varchar(50):varchar(50):varchar(20):varchar(20):varchar(50):varchar(50):varchar(50):varchar(50):string:string:bigint:bigint:decimal(38,8)
#### A masked pattern was here ####
                    name default.l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
                    serialization.format 1
                    serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                  serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                
                    input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                    output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                    properties:
                      bucketing_version 2
                      column.name.delimiter ,
                      columns plan_detail_object_id,project_object_id,charge_code_object_id,transclass_object_id,resource_object_id,slice_date,split_amount,split_units,year_key,quarter_key,month_key,week_key,date_key,fy_year_key,fy_quarter_key,fy_month_key,supplier_object_id,business_dept_object_id,business_partner_percentage
                      columns.comments 
                      columns.types bigint:bigint:bigint:bigint:bigint:varchar(50):varchar(50):varchar(50):varchar(20):varchar(20):varchar(50):varchar(50):varchar(50):varchar(50):string:string:bigint:bigint:decimal(38,8)
#### A masked pattern was here ####
                      name default.l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
                      serialization.format 1
                      serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    name: default.l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
                  name: default.l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
            Truncated Path -> Alias:
              /l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1 [dw]
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: snap
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  GatherStats: false
                  Select Operator
                    expressions: l3_snapshot_number (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      bucketingVersion: 2
                      null sort order: 
                      numBuckets: -1
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                      tag: 1
                      value expressions: _col0 (type: bigint)
                      auto parallelism: false
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Path -> Alias:
#### A masked pattern was here ####
            Path -> Partition:
#### A masked pattern was here ####
                Partition
                  base file name: l3_clarity__l3_snap_number_2018022300104
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  properties:
                    bucket_count -1
                    bucketing_version 2
                    column.name.delimiter ,
                    columns l3_snapshot_number
                    columns.types bigint
#### A masked pattern was here ####
                    name default.l3_clarity__l3_snap_number_2018022300104
                    serialization.format 1
                    serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    properties:
                      bucketing_version 2
                      column.name.delimiter ,
                      columns l3_snapshot_number
                      columns.comments 
                      columns.types bigint
#### A masked pattern was here ####
                      name default.l3_clarity__l3_snap_number_2018022300104
                      serialization.format 1
                      serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: default.l3_clarity__l3_snap_number_2018022300104
                  name: default.l3_clarity__l3_snap_number_2018022300104
            Truncated Path -> Alias:
              /l3_clarity__l3_snap_number_2018022300104 [snap]
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: s1
                  filterExpr: ((idp_data_date = DATE'2017-12-28') and finplan_detail_object_id is not null and l3_snapshot_number is not null) (type: boolean)
                  buckets included: [50,] of 64
                  Statistics: Num rows: 180340 Data size: 14427200 Basic stats: COMPLETE Column stats: COMPLETE
                  GatherStats: false
                  Filter Operator
                    isSamplingPred: false
                    predicate: ((idp_data_date = DATE'2017-12-28') and finplan_detail_object_id is not null and l3_snapshot_number is not null) (type: boolean)
                    Statistics: Num rows: 90170 Data size: 7213600 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: l3_snapshot_number (type: bigint), plan_key (type: bigint), finplan_detail_object_id (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 90170 Data size: 2164080 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        bucketingVersion: 2
                        key expressions: _col0 (type: bigint), _col2 (type: bigint)
                        null sort order: zz
                        numBuckets: -1
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col2 (type: bigint)
                        Statistics: Num rows: 90170 Data size: 2164080 Basic stats: COMPLETE Column stats: COMPLETE
                        tag: 1
                        value expressions: _col1 (type: bigint)
                        auto parallelism: true
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Path -> Alias:
#### A masked pattern was here ####
            Path -> Partition:
#### A masked pattern was here ####
                Partition
                  base file name: l3_monthly_dw_dimplan
                  input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                  output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                  properties:
                    bucket_count 64
                    bucket_field_name idp_data_date
                    bucketing_version 2
                    column.name.delimiter ,
                    columns idp_warehouse_id,idp_audit_id,idp_data_date,l3_snapshot_number,plan_key,project_key,charge_code_key,transclass_key,resource_key,finplan_detail_object_id,project_object_id,txn_class_object_id,charge_code_object_id,resoruce_object_id,plan_name,plan_code,plan_type,period_type,plan_description,plan_status,period_start,period_end,plan_of_record,percentage,l3_created_date,bmo_cost_type,bmo_fiscal_year,clarity_updated_date,is_latest_snapshot,latest_fiscal_budget_plan,plan_category,last_updated_by
                    columns.types bigint:bigint:date:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:varchar(1500):varchar(500):varchar(50):varchar(50):varchar(3000):varchar(50):varchar(50):varchar(50):varchar(1):decimal(32,6):timestamp:varchar(30):varchar(50):timestamp:bigint:bigint:varchar(70):varchar(250)
#### A masked pattern was here ####
                    name default.l3_monthly_dw_dimplan
                    serialization.format 1
                    serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                  serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                
                    input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                    output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                    properties:
                      bucket_count 64
                      bucket_field_name idp_data_date
                      bucketing_version 2
                      column.name.delimiter ,
                      columns idp_warehouse_id,idp_audit_id,idp_data_date,l3_snapshot_number,plan_key,project_key,charge_code_key,transclass_key,resource_key,finplan_detail_object_id,project_object_id,txn_class_object_id,charge_code_object_id,resoruce_object_id,plan_name,plan_code,plan_type,period_type,plan_description,plan_status,period_start,period_end,plan_of_record,percentage,l3_created_date,bmo_cost_type,bmo_fiscal_year,clarity_updated_date,is_latest_snapshot,latest_fiscal_budget_plan,plan_category,last_updated_by
                      columns.comments 
                      columns.types bigint:bigint:date:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:bigint:varchar(1500):varchar(500):varchar(50):varchar(50):varchar(3000):varchar(50):varchar(50):varchar(50):varchar(1):decimal(32,6):timestamp:varchar(30):varchar(50):timestamp:bigint:bigint:varchar(70):varchar(250)
#### A masked pattern was here ####
                      name default.l3_monthly_dw_dimplan
                      serialization.format 1
                      serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    name: default.l3_monthly_dw_dimplan
                  name: default.l3_monthly_dw_dimplan
            Truncated Path -> Alias:
              /l3_monthly_dw_dimplan [s1]
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: s2
                  filterExpr: ((idp_data_date = DATE'2017-12-28') and (project_object_id = 7147200L) and l3_snapshot_number is not null) (type: boolean)
                  Statistics: Num rows: 1 Data size: 80 Basic stats: COMPLETE Column stats: COMPLETE
                  GatherStats: false
                  Filter Operator
                    isSamplingPred: false
                    predicate: ((idp_data_date = DATE'2017-12-28') and (project_object_id = 7147200L) and l3_snapshot_number is not null) (type: boolean)
                    Statistics: Num rows: 1 Data size: 80 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: project_key (type: bigint), l3_snapshot_number (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        bucketingVersion: 2
                        key expressions: _col1 (type: bigint)
                        null sort order: z
                        numBuckets: -1
                        sort order: +
                        Map-reduce partition columns: _col1 (type: bigint)
                        Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                        tag: 1
                        value expressions: _col0 (type: bigint)
                        auto parallelism: true
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Path -> Alias:
#### A masked pattern was here ####
            Path -> Partition:
#### A masked pattern was here ####
                Partition
                  base file name: l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
                  input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                  output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                  properties:
                    bucket_count -1
                    bucketing_version 2
                    column.name.delimiter ,
                    columns project_key,l3_snapshot_number,l3_created_date,project_object_id,idp_data_date
                    columns.types bigint:bigint:timestamp:bigint:date
#### A masked pattern was here ####
                    name default.l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
                    serialization.format 1
                    serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                  serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                
                    input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                    output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                    properties:
                      bucketing_version 2
                      column.name.delimiter ,
                      columns project_key,l3_snapshot_number,l3_created_date,project_object_id,idp_data_date
                      columns.comments 
                      columns.types bigint:bigint:timestamp:bigint:date
#### A masked pattern was here ####
                      name default.l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
                      serialization.format 1
                      serialization.lib org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    name: default.l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
                  name: default.l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
            Truncated Path -> Alias:
              /l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1 [s2]
        Reducer 2 
            Execution mode: vectorized, llap
            Needs Tagging: false
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 30 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 5
                  Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: 7147200L (type: bigint), _col0 (type: bigint), _col1 (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 5 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      bucketingVersion: 2
                      compressed: false
                      GlobalTableId: 0
#### A masked pattern was here ####
                      NumFilesPerFileSink: 1
                      Statistics: Num rows: 5 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
#### A masked pattern was here ####
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          properties:
                            bucketing_version -1
                            columns _col0,_col1,_col2
                            columns.types bigint:bigint:bigint
                            escape.delim \
                            hive.serialization.extend.additional.nesting.levels true
                            serialization.escape.crlf true
                            serialization.format 1
                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                      TotalFiles: 1
                      GatherStats: false
                      MultiFileSpray: false

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

Warning: Map Join MAPJOIN[54][bigTable=?] in task 'Map 1' is a cross product
PREHOOK: query: SELECT DW.PROJECT_OBJECT_ID, S1.PLAN_KEY as PLAN_KEY, S2.PROJECT_KEY AS PROJECT_KEY
FROM l3_clarity__L3_SNAP_NUMBER_2018022300104 snap inner join
l3_clarity__L3_MONTHLY_DW_FACTPLAN_DW_STG_2018022300104_1 DW on 1=1
  LEFT OUTER JOIN L3_MONTHLY_DW_DIMPLAN S1
    ON S1.FINPLAN_DETAIL_OBJECT_ID = DW.PLAN_DETAIL_OBJECT_ID AND S1.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S1.IDP_DATA_DATE = '2017-12-28'
  LEFT OUTER JOIN l3_clarity__L3_MONTHLY_DW_FACTPLAN_DATAJOIN_1_s2_2018022300104_1 S2
    ON S2.PROJECT_OBJECT_ID = DW.PROJECT_OBJECT_ID AND S2.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S2.IDP_DATA_DATE = '2017-12-28'
where DW.PROJECT_OBJECT_ID =7147200
order by DW.PROJECT_OBJECT_ID, PLAN_KEY, PROJECT_KEY
limit 5
PREHOOK: type: QUERY
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
PREHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
PREHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
PREHOOK: Input: default@l3_monthly_dw_dimplan
#### A masked pattern was here ####
POSTHOOK: query: SELECT DW.PROJECT_OBJECT_ID, S1.PLAN_KEY as PLAN_KEY, S2.PROJECT_KEY AS PROJECT_KEY
FROM l3_clarity__L3_SNAP_NUMBER_2018022300104 snap inner join
l3_clarity__L3_MONTHLY_DW_FACTPLAN_DW_STG_2018022300104_1 DW on 1=1
  LEFT OUTER JOIN L3_MONTHLY_DW_DIMPLAN S1
    ON S1.FINPLAN_DETAIL_OBJECT_ID = DW.PLAN_DETAIL_OBJECT_ID AND S1.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S1.IDP_DATA_DATE = '2017-12-28'
  LEFT OUTER JOIN l3_clarity__L3_MONTHLY_DW_FACTPLAN_DATAJOIN_1_s2_2018022300104_1 S2
    ON S2.PROJECT_OBJECT_ID = DW.PROJECT_OBJECT_ID AND S2.L3_SNAPSHOT_NUMBER =snap.L3_snapshot_number
  AND S2.IDP_DATA_DATE = '2017-12-28'
where DW.PROJECT_OBJECT_ID =7147200
order by DW.PROJECT_OBJECT_ID, PLAN_KEY, PROJECT_KEY
limit 5
POSTHOOK: type: QUERY
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_datajoin_1_s2_2018022300104_1
POSTHOOK: Input: default@l3_clarity__l3_monthly_dw_factplan_dw_stg_2018022300104_1
POSTHOOK: Input: default@l3_clarity__l3_snap_number_2018022300104
POSTHOOK: Input: default@l3_monthly_dw_dimplan
#### A masked pattern was here ####
7147200	189561	27114
7147200	191205	27114
7147200	195775	27114
7147200	234349	27114
7147200	350519	27114
PREHOOK: query: CREATE TABLE `test_table`( `col_1` int,`col_2` string,`col_3` string)
        CLUSTERED BY (col_1) INTO 4 BUCKETS
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@test_table
POSTHOOK: query: CREATE TABLE `test_table`( `col_1` int,`col_2` string,`col_3` string)
        CLUSTERED BY (col_1) INTO 4 BUCKETS
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@test_table
PREHOOK: query: insert into test_table values(1, 'one', 'ONE'), (2, 'two', 'TWO'), (3,'three','THREE'),(4,'four','FOUR')
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@test_table
POSTHOOK: query: insert into test_table values(1, 'one', 'ONE'), (2, 'two', 'TWO'), (3,'three','THREE'),(4,'four','FOUR')
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@test_table
POSTHOOK: Lineage: test_table.col_1 SCRIPT []
POSTHOOK: Lineage: test_table.col_2 SCRIPT []
POSTHOOK: Lineage: test_table.col_3 SCRIPT []
PREHOOK: query: select * from test_table
PREHOOK: type: QUERY
PREHOOK: Input: default@test_table
#### A masked pattern was here ####
POSTHOOK: query: select * from test_table
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_table
#### A masked pattern was here ####
2	two	TWO
1	one	ONE
4	four	FOUR
3	three	THREE
PREHOOK: query: explain extended select col_1, col_2, col_3 from test_table where col_1 <> 2 order by col_2
PREHOOK: type: QUERY
PREHOOK: Input: default@test_table
#### A masked pattern was here ####
POSTHOOK: query: explain extended select col_1, col_2, col_3 from test_table where col_1 <> 2 order by col_2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_table
#### A masked pattern was here ####
OPTIMIZED SQL: SELECT `col_1`, `col_2`, `col_3`
FROM `default`.`test_table`
WHERE `col_1` <> 2
ORDER BY `col_2`
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: test_table
                  filterExpr: (col_1 <> 2) (type: boolean)
                  Statistics: Num rows: 4 Data size: 720 Basic stats: COMPLETE Column stats: COMPLETE
                  GatherStats: false
                  Filter Operator
                    isSamplingPred: false
                    predicate: (col_1 <> 2) (type: boolean)
                    Statistics: Num rows: 4 Data size: 720 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: col_1 (type: int), col_2 (type: string), col_3 (type: string)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 4 Data size: 720 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        bucketingVersion: 2
                        key expressions: _col1 (type: string)
                        null sort order: z
                        numBuckets: -1
                        sort order: +
                        Statistics: Num rows: 4 Data size: 720 Basic stats: COMPLETE Column stats: COMPLETE
                        tag: -1
                        value expressions: _col0 (type: int), _col2 (type: string)
                        auto parallelism: false
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Path -> Alias:
#### A masked pattern was here ####
            Path -> Partition:
#### A masked pattern was here ####
                Partition
                  base file name: test_table
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  properties:
                    bucket_count 4
                    bucket_field_name col_1
                    bucketing_version 2
                    column.name.delimiter ,
                    columns col_1,col_2,col_3
                    columns.types int:string:string
#### A masked pattern was here ####
                    name default.test_table
                    serialization.format 1
                    serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    properties:
                      bucket_count 4
                      bucket_field_name col_1
                      bucketing_version 2
                      column.name.delimiter ,
                      columns col_1,col_2,col_3
                      columns.comments 
                      columns.types int:string:string
#### A masked pattern was here ####
                      name default.test_table
                      serialization.format 1
                      serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: default.test_table
                  name: default.test_table
            Truncated Path -> Alias:
              /test_table [test_table]
        Reducer 2 
            Execution mode: vectorized, llap
            Needs Tagging: false
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col1 (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 4 Data size: 720 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  bucketingVersion: 2
                  compressed: false
                  GlobalTableId: 0
#### A masked pattern was here ####
                  NumFilesPerFileSink: 1
                  Statistics: Num rows: 4 Data size: 720 Basic stats: COMPLETE Column stats: COMPLETE
#### A masked pattern was here ####
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      properties:
                        bucketing_version -1
                        columns _col0,_col1,_col2
                        columns.types int:string:string
                        escape.delim \
                        hive.serialization.extend.additional.nesting.levels true
                        serialization.escape.crlf true
                        serialization.format 1
                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  TotalFiles: 1
                  GatherStats: false
                  MultiFileSpray: false

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select col_1, col_2, col_3 from test_table where col_1 <> 2 order by col_2
PREHOOK: type: QUERY
PREHOOK: Input: default@test_table
#### A masked pattern was here ####
POSTHOOK: query: select col_1, col_2, col_3 from test_table where col_1 <> 2 order by col_2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_table
#### A masked pattern was here ####
4	four	FOUR
1	one	ONE
3	three	THREE
PREHOOK: query: explain extended select col_1, col_2, col_3 from test_table where col_1 = 2 order by col_2
PREHOOK: type: QUERY
PREHOOK: Input: default@test_table
#### A masked pattern was here ####
POSTHOOK: query: explain extended select col_1, col_2, col_3 from test_table where col_1 = 2 order by col_2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_table
#### A masked pattern was here ####
OPTIMIZED SQL: SELECT CAST(2 AS INT) AS `col_1`, `col_2`, `col_3`
FROM (SELECT `col_2`, `col_3`
FROM `default`.`test_table`
WHERE `col_1` = 2
ORDER BY `col_2`) AS `t1`
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: test_table
                  filterExpr: (col_1 = 2) (type: boolean)
                  buckets included: [0,] of 4
                  Statistics: Num rows: 4 Data size: 720 Basic stats: COMPLETE Column stats: COMPLETE
                  GatherStats: false
                  Filter Operator
                    isSamplingPred: false
                    predicate: (col_1 = 2) (type: boolean)
                    Statistics: Num rows: 1 Data size: 180 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: col_2 (type: string), col_3 (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1 Data size: 176 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        bucketingVersion: 2
                        key expressions: _col0 (type: string)
                        null sort order: z
                        numBuckets: -1
                        sort order: +
                        Statistics: Num rows: 1 Data size: 176 Basic stats: COMPLETE Column stats: COMPLETE
                        tag: -1
                        value expressions: _col1 (type: string)
                        auto parallelism: false
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Path -> Alias:
#### A masked pattern was here ####
            Path -> Partition:
#### A masked pattern was here ####
                Partition
                  base file name: test_table
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  properties:
                    bucket_count 4
                    bucket_field_name col_1
                    bucketing_version 2
                    column.name.delimiter ,
                    columns col_1,col_2,col_3
                    columns.types int:string:string
#### A masked pattern was here ####
                    name default.test_table
                    serialization.format 1
                    serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    properties:
                      bucket_count 4
                      bucket_field_name col_1
                      bucketing_version 2
                      column.name.delimiter ,
                      columns col_1,col_2,col_3
                      columns.comments 
                      columns.types int:string:string
#### A masked pattern was here ####
                      name default.test_table
                      serialization.format 1
                      serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: default.test_table
                  name: default.test_table
            Truncated Path -> Alias:
              /test_table [test_table]
        Reducer 2 
            Execution mode: vectorized, llap
            Needs Tagging: false
            Reduce Operator Tree:
              Select Operator
                expressions: 2 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 180 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  bucketingVersion: 2
                  compressed: false
                  GlobalTableId: 0
#### A masked pattern was here ####
                  NumFilesPerFileSink: 1
                  Statistics: Num rows: 1 Data size: 180 Basic stats: COMPLETE Column stats: COMPLETE
#### A masked pattern was here ####
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      properties:
                        bucketing_version -1
                        columns _col0,_col1,_col2
                        columns.types int:string:string
                        escape.delim \
                        hive.serialization.extend.additional.nesting.levels true
                        serialization.escape.crlf true
                        serialization.format 1
                        serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  TotalFiles: 1
                  GatherStats: false
                  MultiFileSpray: false

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select col_1, col_2, col_3 from test_table where col_1 = 2 order by col_2
PREHOOK: type: QUERY
PREHOOK: Input: default@test_table
#### A masked pattern was here ####
POSTHOOK: query: select col_1, col_2, col_3 from test_table where col_1 = 2 order by col_2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_table
#### A masked pattern was here ####
2	two	TWO
PREHOOK: query: drop table `test_table`
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@test_table
PREHOOK: Output: database:default
PREHOOK: Output: default@test_table
POSTHOOK: query: drop table `test_table`
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@test_table
POSTHOOK: Output: database:default
POSTHOOK: Output: default@test_table
