PREHOOK: query: create table tmp1 (a int, b string) partitioned by (c int)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tmp1
POSTHOOK: query: create table tmp1 (a int, b string) partitioned by (c int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tmp1
PREHOOK: query: create table tmp2 (a int, b string) partitioned by (c int)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tmp2
POSTHOOK: query: create table tmp2 (a int, b string) partitioned by (c int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tmp2
PREHOOK: query: create table tmp3 (a int, b string) partitioned by (c int)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tmp3
POSTHOOK: query: create table tmp3 (a int, b string) partitioned by (c int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tmp3
PREHOOK: query: insert into table tmp1 partition (c = 30) values (3, "a"), (4, "b"), (5, "c")
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@tmp1@c=30
POSTHOOK: query: insert into table tmp1 partition (c = 30) values (3, "a"), (4, "b"), (5, "c")
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@tmp1@c=30
POSTHOOK: Lineage: tmp1 PARTITION(c=30).a SCRIPT []
POSTHOOK: Lineage: tmp1 PARTITION(c=30).b SCRIPT []
col1	col2
PREHOOK: query: insert into table tmp1 partition (c = 40) values (6, "d")
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@tmp1@c=40
POSTHOOK: query: insert into table tmp1 partition (c = 40) values (6, "d")
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@tmp1@c=40
POSTHOOK: Lineage: tmp1 PARTITION(c=40).a SCRIPT []
POSTHOOK: Lineage: tmp1 PARTITION(c=40).b SCRIPT []
col1	col2
PREHOOK: query: insert into table tmp2 partition (c = 30) values (7, "e")
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@tmp2@c=30
POSTHOOK: query: insert into table tmp2 partition (c = 30) values (7, "e")
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@tmp2@c=30
POSTHOOK: Lineage: tmp2 PARTITION(c=30).a SCRIPT []
POSTHOOK: Lineage: tmp2 PARTITION(c=30).b SCRIPT []
col1	col2
PREHOOK: query: explain cbo
select count(*) from tmp1
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
#### A masked pattern was here ####
Explain
Excluded rules: HivePruneZeroRowsTable

CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])

PREHOOK: query: select count(*) from tmp1
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
#### A masked pattern was here ####
_c0
4
PREHOOK: query: explain cbo
select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
Explain
Excluded rules: HivePruneZeroRowsTable

CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

PREHOOK: query: select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
_c0
1
PREHOOK: query: explain cbo
select count(*) from tmp3
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp3
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp3
#### A masked pattern was here ####
Explain
Excluded rules: HivePruneZeroRowsTable

CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveTableScan(table=[[default, tmp3]], table:alias=[tmp3])

PREHOOK: query: select count(*) from tmp3
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp3
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp3
#### A masked pattern was here ####
_c0
0
PREHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp1@c=30
PREHOOK: Input: default@tmp1@c=40
PREHOOK: Input: default@tmp2
PREHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
POSTHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp1@c=30
POSTHOOK: Input: default@tmp1@c=40
POSTHOOK: Input: default@tmp2
POSTHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
Explain
Excluded rules: HivePruneZeroRowsTable

CBO PLAN:
HiveProject(a=[$0], b=[$1], c=[$2], b1=[$4], c1=[$5])
  HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(a=[$0], b=[$1], c=[$2])
      HiveFilter(condition=[IS NOT NULL($0)])
        HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])
    HiveProject(a=[$0], b=[$1], c=[$2])
      HiveFilter(condition=[IS NOT NULL($0)])
        HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

PREHOOK: query: select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp1@c=30
PREHOOK: Input: default@tmp1@c=40
PREHOOK: Input: default@tmp2
PREHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
POSTHOOK: query: select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp1@c=30
POSTHOOK: Input: default@tmp1@c=40
POSTHOOK: Input: default@tmp2
POSTHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
tmp1.a	tmp1.b	tmp1.c	tmp2.b	tmp2.c
Warning: Shuffle Join MERGEJOIN[13][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
PREHOOK: query: explain cbo
select * from tmp1 join tmp2 using(c) where tmp1.c=30
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp1@c=30
PREHOOK: Input: default@tmp2
PREHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select * from tmp1 join tmp2 using(c) where tmp1.c=30
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp1@c=30
POSTHOOK: Input: default@tmp2
POSTHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
Explain
Excluded rules: HivePruneZeroRowsTable

CBO PLAN:
HiveProject(c=[CAST(30):INTEGER], a=[$0], b=[$1], a1=[$2], b1=[$3])
  HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(a=[$0], b=[$1])
      HiveFilter(condition=[=($2, 30)])
        HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])
    HiveProject(a=[$0], b=[$1])
      HiveFilter(condition=[=(30, $2)])
        HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

Warning: Shuffle Join MERGEJOIN[13][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
PREHOOK: query: select * from tmp1 join tmp2 using(c) where tmp1.c=30
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp1@c=30
PREHOOK: Input: default@tmp2
PREHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
POSTHOOK: query: select * from tmp1 join tmp2 using(c) where tmp1.c=30
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp1@c=30
POSTHOOK: Input: default@tmp2
POSTHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
tmp1.c	tmp1.a	tmp1.b	tmp2.a	tmp2.b
30	5	c	7	e
30	4	b	7	e
30	3	a	7	e
Warning: Shuffle Join MERGEJOIN[13][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
PREHOOK: query: explain cbo
select * from tmp1 join tmp2 using(c) where tmp1.c=40
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp1@c=40
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select * from tmp1 join tmp2 using(c) where tmp1.c=40
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp1@c=40
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
Explain
Excluded rules: HivePruneZeroRowsTable

CBO PLAN:
HiveProject(c=[CAST(40):INTEGER], a=[$0], b=[$1], a1=[$2], b1=[$3])
  HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(a=[$0], b=[$1])
      HiveFilter(condition=[=($2, 40)])
        HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])
    HiveProject(a=[$0], b=[$1])
      HiveFilter(condition=[=(40, $2)])
        HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

Warning: Shuffle Join MERGEJOIN[13][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
PREHOOK: query: select * from tmp1 join tmp2 using(c) where tmp1.c=40
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp1@c=40
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select * from tmp1 join tmp2 using(c) where tmp1.c=40
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp1@c=40
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
tmp1.c	tmp1.a	tmp1.b	tmp2.a	tmp2.b
PREHOOK: query: explain cbo
select count(*) from tmp1
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
#### A masked pattern was here ####
Explain
CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])

PREHOOK: query: select count(*) from tmp1
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
#### A masked pattern was here ####
_c0
4
PREHOOK: query: explain cbo
select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
Explain
CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

PREHOOK: query: select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
_c0
1
PREHOOK: query: explain cbo
select count(*) from tmp3
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Input: default@tmp3
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp3
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Input: default@tmp3
#### A masked pattern was here ####
Explain
CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveValues(tuples=[[]])

PREHOOK: query: select count(*) from tmp3
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Input: default@tmp3
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp3
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Input: default@tmp3
#### A masked pattern was here ####
_c0
0
PREHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp1@c=30
PREHOOK: Input: default@tmp1@c=40
PREHOOK: Input: default@tmp2
PREHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
POSTHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp1@c=30
POSTHOOK: Input: default@tmp1@c=40
POSTHOOK: Input: default@tmp2
POSTHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
Explain
CBO PLAN:
HiveProject(a=[$0], b=[$1], c=[$2], b1=[$4], c1=[$5])
  HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(a=[$0], b=[$1], c=[$2])
      HiveFilter(condition=[IS NOT NULL($0)])
        HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])
    HiveProject(a=[$0], b=[$1], c=[$2])
      HiveFilter(condition=[IS NOT NULL($0)])
        HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

PREHOOK: query: select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp1@c=30
PREHOOK: Input: default@tmp1@c=40
PREHOOK: Input: default@tmp2
PREHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
POSTHOOK: query: select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp1@c=30
POSTHOOK: Input: default@tmp1@c=40
POSTHOOK: Input: default@tmp2
POSTHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
tmp1.a	tmp1.b	tmp1.c	tmp2.b	tmp2.c
Warning: Shuffle Join MERGEJOIN[13][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
PREHOOK: query: explain cbo
select * from tmp1 join tmp2 using(c) where tmp1.c=30
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp1@c=30
PREHOOK: Input: default@tmp2
PREHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select * from tmp1 join tmp2 using(c) where tmp1.c=30
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp1@c=30
POSTHOOK: Input: default@tmp2
POSTHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
Explain
CBO PLAN:
HiveProject(c=[CAST(30):INTEGER], a=[$0], b=[$1], a1=[$2], b1=[$3])
  HiveJoin(condition=[true], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(a=[$0], b=[$1])
      HiveFilter(condition=[=($2, 30)])
        HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])
    HiveProject(a=[$0], b=[$1])
      HiveFilter(condition=[=(30, $2)])
        HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

Warning: Shuffle Join MERGEJOIN[13][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
PREHOOK: query: select * from tmp1 join tmp2 using(c) where tmp1.c=30
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp1@c=30
PREHOOK: Input: default@tmp2
PREHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
POSTHOOK: query: select * from tmp1 join tmp2 using(c) where tmp1.c=30
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp1@c=30
POSTHOOK: Input: default@tmp2
POSTHOOK: Input: default@tmp2@c=30
#### A masked pattern was here ####
tmp1.c	tmp1.a	tmp1.b	tmp2.a	tmp2.b
30	5	c	7	e
30	4	b	7	e
30	3	a	7	e
PREHOOK: query: explain cbo
select * from tmp1 join tmp2 using(c) where tmp1.c=40
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select * from tmp1 join tmp2 using(c) where tmp1.c=40
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
Explain
CBO PLAN:
HiveValues(tuples=[[]])

PREHOOK: query: select * from tmp1 join tmp2 using(c) where tmp1.c=40
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select * from tmp1 join tmp2 using(c) where tmp1.c=40
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
tmp1.c	tmp1.a	tmp1.b	tmp2.a	tmp2.b
