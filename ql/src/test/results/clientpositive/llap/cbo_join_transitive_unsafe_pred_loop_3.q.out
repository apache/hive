PREHOOK: query: CREATE TABLE tableA
(
    `bd_id`            bigint,
    `quota_type`       string
)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tableA
POSTHOOK: query: CREATE TABLE tableA
(
    `bd_id`            bigint,
    `quota_type`       string
)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tableA
PREHOOK: query: explain cbo
select a.bd_id
from (
    select t.bd_id
    from tableA t
    where (t.bd_id = 8 and t.quota_type in('A','C')) or (t.bd_id = 9 and t.quota_type in ('A','B'))
 ) a join (
     select t.bd_id
     from tableA t
     where t.bd_id = 9 and t.quota_type in ('A','B')
     union all
     select t.bd_id
     from tableA t
     where (t.bd_id = 8 and t.quota_type in('A','C')) or (t.bd_id = 9 and t.quota_type in ('A','B'))
) b on a.bd_id = b.bd_id
where a.bd_id = 8 or a.bd_id <>8
PREHOOK: type: QUERY
PREHOOK: Input: default@tablea
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select a.bd_id
from (
    select t.bd_id
    from tableA t
    where (t.bd_id = 8 and t.quota_type in('A','C')) or (t.bd_id = 9 and t.quota_type in ('A','B'))
 ) a join (
     select t.bd_id
     from tableA t
     where t.bd_id = 9 and t.quota_type in ('A','B')
     union all
     select t.bd_id
     from tableA t
     where (t.bd_id = 8 and t.quota_type in('A','C')) or (t.bd_id = 9 and t.quota_type in ('A','B'))
) b on a.bd_id = b.bd_id
where a.bd_id = 8 or a.bd_id <>8
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tablea
#### A masked pattern was here ####
CBO PLAN:
HiveProject(bd_id=[$0])
  HiveJoin(condition=[=($0, $1)], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(bd_id=[$0])
      HiveFilter(condition=[AND(OR(=($0, 8), <>($0, 8)), OR(AND(=($0, 8), IN($1, _UTF-16LE'A':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'C':VARCHAR(2147483647) CHARACTER SET "UTF-16LE")), AND(=($0, 9), IN($1, _UTF-16LE'A':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'B':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"))), IS NOT NULL($0))])
        HiveTableScan(table=[[default, tablea]], table:alias=[t])
    HiveProject($f0=[$0])
      HiveUnion(all=[true])
        HiveProject($f0=[CAST(9:BIGINT):BIGINT])
          HiveFilter(condition=[AND(=($0, 9), IN($1, _UTF-16LE'A':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'B':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"))])
            HiveTableScan(table=[[default, tablea]], table:alias=[t])
        HiveProject(bd_id=[$0])
          HiveFilter(condition=[AND(OR(AND(=($0, 8), IN($1, _UTF-16LE'A':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'C':VARCHAR(2147483647) CHARACTER SET "UTF-16LE")), AND(=($0, 9), IN($1, _UTF-16LE'A':VARCHAR(2147483647) CHARACTER SET "UTF-16LE", _UTF-16LE'B':VARCHAR(2147483647) CHARACTER SET "UTF-16LE"))), IS NOT NULL($0))])
            HiveTableScan(table=[[default, tablea]], table:alias=[t])

