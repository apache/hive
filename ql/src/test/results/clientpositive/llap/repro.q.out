PREHOOK: query: CREATE TABLE customer(orders array<string>)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@customer
POSTHOOK: query: CREATE TABLE customer(orders array<string>)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@customer
PREHOOK: query: EXPLAIN SELECT *
FROM customer
lateral view explode(orders) v as c1
lateral view explode(orders) v as c2
PREHOOK: type: QUERY
PREHOOK: Input: default@customer
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN SELECT *
FROM customer
lateral view explode(orders) v as c1
lateral view explode(orders) v as c2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@customer
#### A masked pattern was here ####
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: customer
          Lateral View Forward
            Select Operator
              expressions: orders (type: array<string>)
              outputColumnNames: orders
              Lateral View Join Operator
                outputColumnNames: _col0, _col5
                Lateral View Forward
                  Select Operator
                    expressions: _col0 (type: array<string>), _col5 (type: string)
                    outputColumnNames: _col0, _col5
                    Lateral View Join Operator
                      outputColumnNames: _col0, _col5, _col6
                      Select Operator
                        expressions: _col0 (type: array<string>), _col5 (type: string), _col6 (type: string)
                        outputColumnNames: _col0, _col1, _col2
                        ListSink
                  Select Operator
                    expressions: _col0 (type: array<string>)
                    outputColumnNames: _col0
                    UDTF Operator
                      function name: explode
                      Lateral View Join Operator
                        outputColumnNames: _col0, _col5, _col6
            Select Operator
              expressions: orders (type: array<string>)
              outputColumnNames: _col0
              UDTF Operator
                function name: explode
                Lateral View Join Operator
                  outputColumnNames: _col0, _col5

PREHOOK: query: EXPLAIN FORMATTED SELECT *
FROM customer
lateral view explode(orders) v as c1
lateral view explode(orders) v as c2
PREHOOK: type: QUERY
PREHOOK: Input: default@customer
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN FORMATTED SELECT *
FROM customer
lateral view explode(orders) v as c1
lateral view explode(orders) v as c2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@customer
#### A masked pattern was here ####
{"cboInfo":"Plan not optimized by CBO because the statement has lateral views","STAGE DEPENDENCIES":{"Stage-0":{"ROOT STAGE":"TRUE"}},"STAGE PLANS":{"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"TableScan":{"alias:":"customer","columns:":["orders"],"database:":"default","table:":"customer","isTempTable:":"false","OperatorId:":"TS_0","children":{"Lateral View Forward":{"columnExprMap:":{"orders":"orders"},"OperatorId:":"LVF_1","children":[{"Select Operator":{"expressions:":"orders (type: array<string>)","columnExprMap:":{"orders":"orders"},"outputColumnNames:":["orders"],"OperatorId:":"SEL_2","children":{"Lateral View Join Operator":{"columnExprMap:":{"_col0":"orders","_col5":"col"},"outputColumnNames:":["_col0","_col5"],"OperatorId:":"LVJ_5","children":{"Lateral View Forward":{"columnExprMap:":{"_col0":"_col0","_col5":"_col5"},"OperatorId:":"LVF_6","children":[{"Select Operator":{"expressions:":"_col0 (type: array<string>), _col5 (type: string)","columnExprMap:":{"_col0":"_col0","_col5":"_col5"},"outputColumnNames:":["_col0","_col5"],"OperatorId:":"SEL_7","children":{"Lateral View Join Operator":{"columnExprMap:":{"_col0":"_col0","_col5":"_col5","_col6":"col"},"outputColumnNames:":["_col0","_col5","_col6"],"OperatorId:":"LVJ_10","children":{"Select Operator":{"expressions:":"_col0 (type: array<string>), _col5 (type: string), _col6 (type: string)","columnExprMap:":{"_col0":"_col0","_col1":"_col5","_col2":"_col6"},"outputColumnNames:":["_col0","_col1","_col2"],"OperatorId:":"SEL_11","children":{"ListSink":{"OperatorId:":"LIST_SINK_13"}}}}}}}},{"Select Operator":{"expressions:":"_col0 (type: array<string>)","columnExprMap:":{"_col0":"_col0"},"outputColumnNames:":["_col0"],"OperatorId:":"SEL_8","children":{"UDTF Operator":{"function name:":"explode","OperatorId:":"UDTF_9","children":{"Lateral View Join Operator":{"columnExprMap:":{"_col0":"_col0","_col5":"_col5","_col6":"col"},"outputColumnNames:":["_col0","_col5","_col6"],"OperatorId:":"LVJ_10"}}}}}}]}}}}}},{"Select Operator":{"expressions:":"orders (type: array<string>)","columnExprMap:":{"_col0":"orders"},"outputColumnNames:":["_col0"],"OperatorId:":"SEL_3","children":{"UDTF Operator":{"function name:":"explode","OperatorId:":"UDTF_4","children":{"Lateral View Join Operator":{"columnExprMap:":{"_col0":"orders","_col5":"col"},"outputColumnNames:":["_col0","_col5"],"OperatorId:":"LVJ_5"}}}}}}]}}}}}}}}
PREHOOK: query: EXPLAIN AST SELECT *
FROM customer
lateral view explode(orders) v as c1
lateral view explode(orders) v as c2
PREHOOK: type: QUERY
PREHOOK: Input: default@customer
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN AST SELECT *
FROM customer
lateral view explode(orders) v as c1
lateral view explode(orders) v as c2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@customer
#### A masked pattern was here ####
ABSTRACT SYNTAX TREE:
  
TOK_QUERY
   TOK_FROM
      TOK_LATERAL_VIEW
         TOK_SELECT
            TOK_SELEXPR
               TOK_FUNCTION
                  explode
                  TOK_TABLE_OR_COL
                     orders
               c2
               TOK_TABALIAS
                  v
         TOK_LATERAL_VIEW
            TOK_SELECT
               TOK_SELEXPR
                  TOK_FUNCTION
                     explode
                     TOK_TABLE_OR_COL
                        orders
                  c1
                  TOK_TABALIAS
                     v
            TOK_TABREF
               TOK_TABNAME
                  customer
   TOK_INSERT
      TOK_DESTINATION
         TOK_DIR
            TOK_TMP_FILE
      TOK_SELECT
         TOK_SELEXPR
            TOK_ALLCOLREF

PREHOOK: query: EXPLAIN SELECT *
FROM customer
lateral view explode(orders) v as c1
lateral view explode(orders) v as c2
PREHOOK: type: QUERY
PREHOOK: Input: default@customer
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN SELECT *
FROM customer
lateral view explode(orders) v as c1
lateral view explode(orders) v as c2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@customer
#### A masked pattern was here ####
Plan not optimized by CBO because the statement has lateral views

Stage-0
  Fetch Operator
    limit:-1
    Select Operator [SEL_11]
      Output:["_col0","_col1","_col2"]
      Lateral View Join Operator [LVJ_10]
        Output:["_col0","_col5","_col6"]
        Select Operator [SEL_7]
          Output:["_col0","_col5"]
          Lateral View Forward [LVF_6]
            Lateral View Join Operator [LVJ_5]
              Output:["_col0","_col5"]
              Select Operator [SEL_2]
                Output:["orders"]
                Lateral View Forward [LVF_1]
                  TableScan [TS_0]
                    Output:["orders"]
    Lateral View Join Operator [LVJ_10]
      Output:["_col0","_col5","_col6"]
      UDTF Operator [UDTF_9]
        function name:explode
        Select Operator [SEL_8]
          Output:["_col0"]
           Please refer to the previous Lateral View Forward [LVF_6]
    Lateral View Join Operator [LVJ_5]
      Output:["_col0","_col5"]
      UDTF Operator [UDTF_4]
        function name:explode
        Select Operator [SEL_3]
          Output:["_col0"]
           Please refer to the previous Lateral View Forward [LVF_1]

PREHOOK: query: EXPLAIN FORMATTED SELECT *
FROM customer
lateral view explode(orders) v as c1
lateral view explode(orders) v as c2
PREHOOK: type: QUERY
PREHOOK: Input: default@customer
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN FORMATTED SELECT *
FROM customer
lateral view explode(orders) v as c1
lateral view explode(orders) v as c2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@customer
#### A masked pattern was here ####
{"cboInfo":"Plan not optimized by CBO because the statement has lateral views","STAGE DEPENDENCIES":{"Stage-0":{"ROOT STAGE":"TRUE"}},"STAGE PLANS":{"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"TableScan":{"alias:":"customer","columns:":["orders"],"database:":"default","table:":"customer","isTempTable:":"false","OperatorId:":"TS_0","children":{"Lateral View Forward":{"columnExprMap:":{"orders":"orders"},"OperatorId:":"LVF_1","children":[{"Select Operator":{"expressions:":"orders (type: array<string>)","columnExprMap:":{"orders":"orders"},"outputColumnNames:":["orders"],"OperatorId:":"SEL_2","children":{"Lateral View Join Operator":{"columnExprMap:":{"_col0":"orders","_col5":"col"},"outputColumnNames:":["_col0","_col5"],"OperatorId:":"LVJ_5","children":{"Lateral View Forward":{"columnExprMap:":{"_col0":"_col0","_col5":"_col5"},"OperatorId:":"LVF_6","children":[{"Select Operator":{"expressions:":"_col0 (type: array<string>), _col5 (type: string)","columnExprMap:":{"_col0":"_col0","_col5":"_col5"},"outputColumnNames:":["_col0","_col5"],"OperatorId:":"SEL_7","children":{"Lateral View Join Operator":{"columnExprMap:":{"_col0":"_col0","_col5":"_col5","_col6":"col"},"outputColumnNames:":["_col0","_col5","_col6"],"OperatorId:":"LVJ_10","children":{"Select Operator":{"expressions:":"_col0 (type: array<string>), _col5 (type: string), _col6 (type: string)","columnExprMap:":{"_col0":"_col0","_col1":"_col5","_col2":"_col6"},"outputColumnNames:":["_col0","_col1","_col2"],"OperatorId:":"SEL_11","children":{"ListSink":{"OperatorId:":"LIST_SINK_13"}}}}}}}},{"Select Operator":{"expressions:":"_col0 (type: array<string>)","columnExprMap:":{"_col0":"_col0"},"outputColumnNames:":["_col0"],"OperatorId:":"SEL_8","children":{"UDTF Operator":{"function name:":"explode","OperatorId:":"UDTF_9","children":{"Lateral View Join Operator":{"columnExprMap:":{"_col0":"_col0","_col5":"_col5","_col6":"col"},"outputColumnNames:":["_col0","_col5","_col6"],"OperatorId:":"LVJ_10"}}}}}}]}}}}}},{"Select Operator":{"expressions:":"orders (type: array<string>)","columnExprMap:":{"_col0":"orders"},"outputColumnNames:":["_col0"],"OperatorId:":"SEL_3","children":{"UDTF Operator":{"function name:":"explode","OperatorId:":"UDTF_4","children":{"Lateral View Join Operator":{"columnExprMap:":{"_col0":"orders","_col5":"col"},"outputColumnNames:":["_col0","_col5"],"OperatorId:":"LVJ_5"}}}}}}]}}}}}}}}
