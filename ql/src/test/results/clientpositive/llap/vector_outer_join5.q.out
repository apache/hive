PREHOOK: query: -- SORT_QUERY_RESULTS

create table sorted_mod_4 stored as orc
as select ctinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
order by ctinyint
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@sorted_mod_4
POSTHOOK: query: -- SORT_QUERY_RESULTS

create table sorted_mod_4 stored as orc
as select ctinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
order by ctinyint
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@sorted_mod_4
PREHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: default@sorted_mod_4
POSTHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: default@sorted_mod_4
PREHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: QUERY
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
PREHOOK: query: create table small_table stored
as orc as select ctinyint, cbigint from alltypesorc limit 100
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@small_table
POSTHOOK: query: create table small_table stored
as orc as select ctinyint, cbigint from alltypesorc limit 100
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@small_table
PREHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Output: default@small_table
POSTHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Output: default@small_table
PREHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
#### A masked pattern was here ####
PREHOOK: query: explain
select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: ctinyint (type: tinyint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Left Outer Join0 to 1
                      keys:
                        0 _col0 (type: tinyint)
                        1 _col0 (type: tinyint)
                      input vertices:
                        1 Map 3
                      Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
                      HybridGraceHashJoin: true
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: st
                  Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: ctinyint (type: tinyint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: tinyint)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: tinyint)
                      Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Reducer 2 
            Execution mode: vectorized, uber
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
6876
PREHOOK: query: explain
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: ctinyint (type: tinyint), cmodint (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Left Outer Join0 to 1
                      filter predicates:
                        0 {(_col1 = 2)}
                        1 
                      keys:
                        0 _col0 (type: tinyint)
                        1 _col0 (type: tinyint)
                      input vertices:
                        1 Map 3
                      Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
                      HybridGraceHashJoin: true
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: sm
                  Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: ctinyint (type: tinyint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: tinyint)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: tinyint)
                      Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Reducer 2 
            Execution mode: vectorized, uber
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
6058
PREHOOK: query: explain
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: ctinyint (type: tinyint), cmodint (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Left Outer Join0 to 1
                      filter predicates:
                        0 {((UDFToInteger(_col0) pmod 4) = _col1)}
                        1 
                      keys:
                        0 _col0 (type: tinyint)
                        1 _col0 (type: tinyint)
                      input vertices:
                        1 Map 3
                      Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
                      HybridGraceHashJoin: true
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: sm
                  Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: ctinyint (type: tinyint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: tinyint)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: tinyint)
                      Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Reducer 2 
            Execution mode: vectorized, uber
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
6248
PREHOOK: query: explain
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: ctinyint (type: tinyint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Left Outer Join0 to 1
                      filter predicates:
                        0 {(_col0 < 100)}
                        1 
                      keys:
                        0 _col0 (type: tinyint)
                        1 _col0 (type: tinyint)
                      input vertices:
                        1 Map 3
                      Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
                      HybridGraceHashJoin: true
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: sm
                  Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: ctinyint (type: tinyint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: tinyint)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: tinyint)
                      Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Reducer 2 
            Execution mode: vectorized, uber
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
6876
PREHOOK: query: explain
select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 4 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: ctinyint (type: tinyint), cmodint (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Left Outer Join0 to 1
                      keys:
                        0 UDFToLong(_col1) (type: bigint)
                        1 (_col0 pmod UDFToLong(8)) (type: bigint)
                      outputColumnNames: _col0
                      input vertices:
                        1 Map 4
                      Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
                      HybridGraceHashJoin: true
                      Reduce Output Operator
                        key expressions: _col0 (type: tinyint)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: tinyint)
                        Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: sm
                  Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cbigint (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: (_col0 pmod UDFToLong(8)) (type: bigint)
                      sort order: +
                      Map-reduce partition columns: (_col0 pmod UDFToLong(8)) (type: bigint)
                      Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: ctinyint (type: tinyint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: tinyint)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: tinyint)
                      Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Left Outer Join0 to 1
                keys:
                  0 _col0 (type: tinyint)
                  1 _col0 (type: tinyint)
                Statistics: Num rows: 7329 Data size: 58641 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count()
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    sort order: 
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col0 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, uber
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
3268334
PREHOOK: query: create table mod_8_mod_4 stored as orc
as select pmod(ctinyint, 8) as cmodtinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@mod_8_mod_4
POSTHOOK: query: create table mod_8_mod_4 stored as orc
as select pmod(ctinyint, 8) as cmodtinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@mod_8_mod_4
PREHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Output: default@mod_8_mod_4
POSTHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Output: default@mod_8_mod_4
PREHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
#### A masked pattern was here ####
PREHOOK: query: create table small_table2 stored
as orc as select pmod(ctinyint, 16) as cmodtinyint, cbigint from alltypesorc limit 100
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@small_table2
POSTHOOK: query: create table small_table2 stored
as orc as select pmod(ctinyint, 16) as cmodtinyint, cbigint from alltypesorc limit 100
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@small_table2
PREHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table2
PREHOOK: Output: default@small_table2
POSTHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: default@small_table2
PREHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
PREHOOK: query: explain
select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cmodtinyint (type: int)
                    outputColumnNames: _col0
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Left Outer Join0 to 1
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      input vertices:
                        1 Map 3
                      Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
                      HybridGraceHashJoin: true
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: st
                  Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cmodtinyint (type: int)
                    outputColumnNames: _col0
                    Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: int)
                      Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Reducer 2 
            Execution mode: vectorized, uber
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
39112
PREHOOK: query: explain
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cmodtinyint (type: int), cmodint (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Left Outer Join0 to 1
                      filter predicates:
                        0 {(_col1 = 2)}
                        1 
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      input vertices:
                        1 Map 3
                      Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
                      HybridGraceHashJoin: true
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: sm
                  Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cmodtinyint (type: int)
                    outputColumnNames: _col0
                    Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: int)
                      Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Reducer 2 
            Execution mode: vectorized, uber
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
11171
PREHOOK: query: explain
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cmodtinyint (type: int), cmodint (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Left Outer Join0 to 1
                      filter predicates:
                        0 {((_col0 pmod 4) = _col1)}
                        1 
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      input vertices:
                        1 Map 3
                      Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
                      HybridGraceHashJoin: true
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: sm
                  Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cmodtinyint (type: int)
                    outputColumnNames: _col0
                    Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: int)
                      Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Reducer 2 
            Execution mode: vectorized, uber
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
14371
PREHOOK: query: explain
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 3 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cmodtinyint (type: int)
                    outputColumnNames: _col0
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Left Outer Join0 to 1
                      filter predicates:
                        0 {(_col0 < 3)}
                        1 
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      input vertices:
                        1 Map 3
                      Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
                      HybridGraceHashJoin: true
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: sm
                  Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cmodtinyint (type: int)
                    outputColumnNames: _col0
                    Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: int)
                      Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Reducer 2 
            Execution mode: vectorized, uber
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
17792
PREHOOK: query: explain
select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      Edges:
        Map 1 <- Map 4 (BROADCAST_EDGE)
        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cmodtinyint (type: int), cmodint (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Left Outer Join0 to 1
                      keys:
                        0 UDFToLong(_col1) (type: bigint)
                        1 (_col0 pmod UDFToLong(8)) (type: bigint)
                      outputColumnNames: _col0
                      input vertices:
                        1 Map 4
                      Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
                      HybridGraceHashJoin: true
                      Reduce Output Operator
                        key expressions: _col0 (type: int)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 6663 Data size: 53310 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: sm
                  Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cbigint (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: (_col0 pmod UDFToLong(8)) (type: bigint)
                      sort order: +
                      Map-reduce partition columns: (_col0 pmod UDFToLong(8)) (type: bigint)
                      Statistics: Num rows: 100 Data size: 392 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: s
                  Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: cmodtinyint (type: int)
                    outputColumnNames: _col0
                    Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: int)
                      Statistics: Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: NONE
            Execution mode: vectorized, llap
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Left Outer Join0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col0 (type: int)
                Statistics: Num rows: 7329 Data size: 58641 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count()
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    sort order: 
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col0 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, uber
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
6524438
