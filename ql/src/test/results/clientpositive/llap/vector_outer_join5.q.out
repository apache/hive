PREHOOK: query: create table sorted_mod_4 stored as orc
as select ctinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
order by ctinyint
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@sorted_mod_4
POSTHOOK: query: create table sorted_mod_4 stored as orc
as select ctinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
order by ctinyint
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@sorted_mod_4
POSTHOOK: Lineage: sorted_mod_4.cmodint EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
POSTHOOK: Lineage: sorted_mod_4.ctinyint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
PREHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: default@sorted_mod_4
POSTHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: default@sorted_mod_4
PREHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@sorted_mod_4
PREHOOK: Output: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE sorted_mod_4 COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@sorted_mod_4
POSTHOOK: Output: default@sorted_mod_4
#### A masked pattern was here ####
PREHOOK: query: create table small_table stored
as orc as select ctinyint, cbigint from alltypesorc limit 100
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@small_table
POSTHOOK: query: create table small_table stored
as orc as select ctinyint, cbigint from alltypesorc limit 100
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@small_table
POSTHOOK: Lineage: small_table.cbigint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cbigint, type:bigint, comment:null), ]
POSTHOOK: Lineage: small_table.ctinyint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
PREHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Output: default@small_table
POSTHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Output: default@small_table
PREHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@small_table
PREHOOK: Output: default@small_table
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE small_table COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@small_table
POSTHOOK: Output: default@small_table
#### A masked pattern was here ####
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
{
  "CBOPlan": {
    "rels": [
      {
        "id": "0",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "sorted_mod_4"
        ],
        "table:alias": "s",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "ctinyint",
            "ndv": 127,
            "minValue": -64,
            "maxValue": 62
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "1",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "ctinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "2",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "small_table"
        ],
        "table:alias": "st",
        "inputs": [],
        "rowCount": 100,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "cbigint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "ctinyint",
            "ndv": 66,
            "minValue": -62,
            "maxValue": 62
          },
          {
            "name": "cbigint",
            "ndv": 1,
            "minValue": null,
            "maxValue": null
          }
        ]
      },
      {
        "id": "3",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "rowCount": 98
      },
      {
        "id": "4",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "ctinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 98
      },
      {
        "id": "5",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "=",
            "kind": "EQUALS",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            },
            {
              "input": 1,
              "name": "$1"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "1",
          "4"
        ],
        "rowCount": 12054.183673469386
      },
      {
        "id": "6",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveAggregate",
        "group": [],
        "aggs": [
          {
            "agg": {
              "name": "count",
              "kind": "COUNT",
              "syntax": "FUNCTION_STAR"
            },
            "type": {
              "type": "BIGINT",
              "nullable": true
            },
            "distinct": false,
            "operands": [],
            "name": null
          }
        ],
        "rowCount": 1
      },
      {
        "id": "7",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "_c0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 1
      }
    ]
  },
  "optimizedSQL": "SELECT COUNT(*) AS `_c0`\nFROM (SELECT `ctinyint`\nFROM `default`.`sorted_mod_4`) AS `t`\nLEFT JOIN (SELECT `ctinyint`\nFROM `default`.`small_table`\nWHERE `ctinyint` IS NOT NULL) AS `t1` ON `t`.`ctinyint` = `t1`.`ctinyint`",
  "PLAN VECTORIZATION": {
    "enabled": true,
    "enabledConditionsMet": [
      "hive.vectorized.execution.enabled IS true"
    ]
  },
  "cboInfo": "Plan optimized by CBO.",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
#### A masked pattern was here ####
        "Edges:": {
          "Map 1": {
            "parent": "Map 3",
            "type": "BROADCAST_EDGE"
          },
          "Reducer 2": {
            "parent": "Map 1",
            "type": "CUSTOM_SIMPLE_EDGE"
          }
        },
#### A masked pattern was here ####
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s",
                  "columns:": [
                    "ctinyint"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "sorted_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "ctinyint (type: tinyint)",
                      "columnExprMap:": {
                        "_col0": "ctinyint"
                      },
                      "outputColumnNames:": [
                        "_col0"
                      ],
                      "Select Vectorization:": {
                        "className:": "VectorSelectOperator",
                        "native:": "true",
                        "projectedOutputColumnNums:": "[0]"
                      },
                      "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "SEL_26",
                      "children": {
                        "Map Join Operator": {
                          "condition map:": [
                            {
                              "": "Left Outer Join 0 to 1"
                            }
                          ],
                          "keys:": {
                            "0": "_col0 (type: tinyint)",
                            "1": "_col0 (type: tinyint)"
                          },
                          "Map Join Vectorization:": {
                            "bigTableKeyColumns:": [
                              "0:tinyint"
                            ],
                            "bigTableRetainColumnNums:": "[]",
                            "className:": "VectorMapJoinOuterLongOperator",
                            "native:": "true",
                            "nativeConditionsMet:": [
                              "hive.mapjoin.optimized.hashtable IS true",
                              "hive.vectorized.execution.mapjoin.native.enabled IS true",
                              "hive.execution.engine tez IN [tez] IS true",
                              "One MapJoin Condition IS true",
                              "No nullsafe IS true",
                              "Small table vectorizes IS true",
                              "Outer Join has keys IS true",
                              "Optimized Table and Supports Key Types IS true"
                            ],
                            "hashTableImplementationType:": "OPTIMIZED"
                          },
                          "input vertices:": {
                            "1": "Map 3"
                          },
                          "Statistics:": "Num rows: 10225 Data size: 81800 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "MAPJOIN_27",
                          "children": {
                            "Group By Operator": {
                              "aggregations:": [
                                "count()"
                              ],
                              "Group By Vectorization:": {
                                "aggregators:": [
                                  "VectorUDAFCountStar(*) -> bigint"
                                ],
                                "className:": "VectorGroupByOperator",
                                "groupByMode:": "HASH",
                                "native:": "false",
                                "vectorProcessingMode:": "HASH",
                                "projectedOutputColumnNums:": "[0]"
                              },
                              "minReductionHashAggr:": "0.99",
                              "mode:": "hash",
                              "outputColumnNames:": [
                                "_col0"
                              ],
                              "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "GBY_28",
                              "children": {
                                "Reduce Output Operator": {
                                  "columnExprMap:": {
                                    "VALUE._col0": "_col0"
                                  },
                                  "null sort order:": "",
                                  "sort order:": "",
                                  "Reduce Sink Vectorization:": {
                                    "className:": "VectorReduceSinkEmptyKeyOperator",
                                    "native:": "true",
                                    "nativeConditionsMet:": [
                                      "hive.vectorized.execution.reducesink.new.enabled IS true",
                                      "hive.execution.engine tez IN [tez] IS true",
                                      "No PTF TopN IS true",
                                      "No DISTINCT columns IS true",
                                      "BinarySortableSerDe for keys IS true",
                                      "LazyBinarySerDe for values IS true"
                                    ],
                                    "valueColumns:": [
                                      "0:bigint"
                                    ]
                                  },
                                  "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                                  "value expressions:": "_col0 (type: bigint)",
                                  "OperatorId:": "RS_29",
                                  "outputname:": "Reducer 2",
                                  "outputOperator:": [
                                    "GBY_30"
                                  ]
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Map 3": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "st",
                  "columns:": [
                    "ctinyint"
                  ],
                  "database:": "default",
                  "filterExpr:": "ctinyint is not null (type: boolean)",
                  "Statistics:": "Num rows: 100 Data size: 396 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "small_table",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cbigint:bigint, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_2",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 0:tinyint)"
                      },
                      "predicate:": "ctinyint is not null (type: boolean)",
                      "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_23",
                      "children": {
                        "Select Operator": {
                          "expressions:": "ctinyint (type: tinyint)",
                          "columnExprMap:": {
                            "_col0": "ctinyint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[0]"
                          },
                          "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_24",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: tinyint)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: tinyint)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:tinyint"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_25",
                              "outputname:": "Map 1",
                              "outputOperator:": [
                                "TS_0"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cbigint:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Reducer 2": {
            "Execution mode:": "vectorized, llap",
            "Reduce Vectorization:": {
              "enabled:": "true",
              "enableConditionsMet:": [
                "hive.vectorized.execution.reduce.enabled IS true",
                "hive.execution.engine tez IN [tez] IS true"
              ],
              "reduceColumnNullOrder:": "",
              "reduceColumnSortOrder:": "",
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "1",
                "dataColumns:": [
                  "VALUE._col0:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            },
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "Group By Vectorization:": {
                  "aggregators:": [
                    "VectorUDAFCountMerge(col 0:bigint) -> bigint"
                  ],
                  "className:": "VectorGroupByOperator",
                  "groupByMode:": "MERGEPARTIAL",
                  "native:": "false",
                  "vectorProcessingMode:": "GLOBAL",
                  "projectedOutputColumnNums:": "[0]"
                },
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0"
                ],
                "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "GBY_30",
                "children": {
                  "File Output Operator": {
                    "compressed:": "false",
                    "File Sink Vectorization:": {
                      "className:": "VectorFileSinkOperator",
                      "native:": "false"
                    },
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "table:": {
                      "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                      "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                      "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                    },
                    "OperatorId:": "FS_31"
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_32"
          }
        }
      }
    }
  }
}
PREHOOK: query: select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.*, st.*
from sorted_mod_4 s
left outer join small_table st
on s.ctinyint = st.ctinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
6876
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
{
  "CBOPlan": {
    "rels": [
      {
        "id": "0",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "sorted_mod_4"
        ],
        "table:alias": "s",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 8,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "ctinyint",
            "ndv": 127,
            "minValue": -64,
            "maxValue": 62
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "1",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "ctinyint",
          "EXPR$0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          },
          {
            "op": {
              "name": "=",
              "kind": "EQUALS",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "input": 1,
                "name": "$1"
              },
              {
                "literal": 2,
                "type": {
                  "type": "INTEGER",
                  "nullable": false
                }
              }
            ]
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "2",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "small_table"
        ],
        "table:alias": "sm",
        "inputs": [],
        "rowCount": 100,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "cbigint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "ctinyint",
            "ndv": 66,
            "minValue": -62,
            "maxValue": 62
          },
          {
            "name": "cbigint",
            "ndv": 1,
            "minValue": null,
            "maxValue": null
          }
        ]
      },
      {
        "id": "3",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "rowCount": 98
      },
      {
        "id": "4",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "ctinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 98
      },
      {
        "id": "5",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "AND",
            "kind": "AND",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "op": {
                "name": "=",
                "kind": "EQUALS",
                "syntax": "BINARY"
              },
              "operands": [
                {
                  "input": 0,
                  "name": "$0"
                },
                {
                  "input": 2,
                  "name": "$2"
                }
              ]
            },
            {
              "input": 1,
              "name": "$1"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "1",
          "4"
        ],
        "rowCount": 12054.183673469386
      },
      {
        "id": "6",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveAggregate",
        "group": [],
        "aggs": [
          {
            "agg": {
              "name": "count",
              "kind": "COUNT",
              "syntax": "FUNCTION_STAR"
            },
            "type": {
              "type": "BIGINT",
              "nullable": true
            },
            "distinct": false,
            "operands": [],
            "name": null
          }
        ],
        "rowCount": 1
      },
      {
        "id": "7",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "_c0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 1
      }
    ]
  },
  "optimizedSQL": "SELECT COUNT(*) AS `_c0`\nFROM (SELECT `ctinyint`, `cmodint` = 2 AS `EXPR$0`\nFROM `default`.`sorted_mod_4`) AS `t`\nLEFT JOIN (SELECT `ctinyint`\nFROM `default`.`small_table`\nWHERE `ctinyint` IS NOT NULL) AS `t1` ON `t`.`ctinyint` = `t1`.`ctinyint` AND `t`.`EXPR$0`",
  "PLAN VECTORIZATION": {
    "enabled": true,
    "enabledConditionsMet": [
      "hive.vectorized.execution.enabled IS true"
    ]
  },
  "cboInfo": "Plan optimized by CBO.",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
#### A masked pattern was here ####
        "Edges:": {
          "Map 1": {
            "parent": "Map 3",
            "type": "BROADCAST_EDGE"
          },
          "Reducer 2": {
            "parent": "Map 1",
            "type": "CUSTOM_SIMPLE_EDGE"
          }
        },
#### A masked pattern was here ####
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s",
                  "columns:": [
                    "ctinyint",
                    "cmodint"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "sorted_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "ctinyint (type: tinyint), (cmodint = 2) (type: boolean)",
                      "columnExprMap:": {
                        "_col0": "ctinyint",
                        "_col1": "(cmodint = 2)"
                      },
                      "outputColumnNames:": [
                        "_col0",
                        "_col1"
                      ],
                      "Select Vectorization:": {
                        "className:": "VectorSelectOperator",
                        "native:": "true",
                        "projectedOutputColumnNums:": "[0, 4]",
                        "selectExpressions:": [
                          "LongColEqualLongScalar(col 1:int, val 2) -> 4:boolean"
                        ]
                      },
                      "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "SEL_26",
                      "children": {
                        "Map Join Operator": {
                          "condition map:": [
                            {
                              "": "Left Outer Join 0 to 1"
                            }
                          ],
                          "filter predicates:": {
                            "0": "{_col1}",
                            "1": ""
                          },
                          "keys:": {
                            "0": "_col0 (type: tinyint)",
                            "1": "_col0 (type: tinyint)"
                          },
                          "Map Join Vectorization:": {
                            "bigTableFilterExpressions:": [
                              "SelectColumnIsTrue(col 4:boolean)"
                            ],
                            "bigTableKeyColumns:": [
                              "0:tinyint"
                            ],
                            "bigTableRetainColumnNums:": "[]",
                            "className:": "VectorMapJoinOuterLongOperator",
                            "native:": "true",
                            "nativeConditionsMet:": [
                              "hive.mapjoin.optimized.hashtable IS true",
                              "hive.vectorized.execution.mapjoin.native.enabled IS true",
                              "hive.execution.engine tez IN [tez] IS true",
                              "One MapJoin Condition IS true",
                              "No nullsafe IS true",
                              "Small table vectorizes IS true",
                              "Outer Join has keys IS true",
                              "Optimized Table and Supports Key Types IS true"
                            ],
                            "hashTableImplementationType:": "OPTIMIZED"
                          },
                          "input vertices:": {
                            "1": "Map 3"
                          },
                          "Statistics:": "Num rows: 10225 Data size: 81800 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "MAPJOIN_27",
                          "children": {
                            "Group By Operator": {
                              "aggregations:": [
                                "count()"
                              ],
                              "Group By Vectorization:": {
                                "aggregators:": [
                                  "VectorUDAFCountStar(*) -> bigint"
                                ],
                                "className:": "VectorGroupByOperator",
                                "groupByMode:": "HASH",
                                "native:": "false",
                                "vectorProcessingMode:": "HASH",
                                "projectedOutputColumnNums:": "[0]"
                              },
                              "minReductionHashAggr:": "0.99",
                              "mode:": "hash",
                              "outputColumnNames:": [
                                "_col0"
                              ],
                              "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "GBY_28",
                              "children": {
                                "Reduce Output Operator": {
                                  "columnExprMap:": {
                                    "VALUE._col0": "_col0"
                                  },
                                  "null sort order:": "",
                                  "sort order:": "",
                                  "Reduce Sink Vectorization:": {
                                    "className:": "VectorReduceSinkEmptyKeyOperator",
                                    "native:": "true",
                                    "nativeConditionsMet:": [
                                      "hive.vectorized.execution.reducesink.new.enabled IS true",
                                      "hive.execution.engine tez IN [tez] IS true",
                                      "No PTF TopN IS true",
                                      "No DISTINCT columns IS true",
                                      "BinarySortableSerDe for keys IS true",
                                      "LazyBinarySerDe for values IS true"
                                    ],
                                    "valueColumns:": [
                                      "0:bigint"
                                    ]
                                  },
                                  "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                                  "value expressions:": "_col0 (type: bigint)",
                                  "OperatorId:": "RS_29",
                                  "outputname:": "Reducer 2",
                                  "outputOperator:": [
                                    "GBY_30"
                                  ]
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0, 1]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[bigint]"
              }
            }
          },
          "Map 3": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "sm",
                  "columns:": [
                    "ctinyint"
                  ],
                  "database:": "default",
                  "filterExpr:": "ctinyint is not null (type: boolean)",
                  "Statistics:": "Num rows: 100 Data size: 396 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "small_table",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cbigint:bigint, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_2",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 0:tinyint)"
                      },
                      "predicate:": "ctinyint is not null (type: boolean)",
                      "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_23",
                      "children": {
                        "Select Operator": {
                          "expressions:": "ctinyint (type: tinyint)",
                          "columnExprMap:": {
                            "_col0": "ctinyint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[0]"
                          },
                          "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_24",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: tinyint)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: tinyint)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:tinyint"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_25",
                              "outputname:": "Map 1",
                              "outputOperator:": [
                                "TS_0"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cbigint:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Reducer 2": {
            "Execution mode:": "vectorized, llap",
            "Reduce Vectorization:": {
              "enabled:": "true",
              "enableConditionsMet:": [
                "hive.vectorized.execution.reduce.enabled IS true",
                "hive.execution.engine tez IN [tez] IS true"
              ],
              "reduceColumnNullOrder:": "",
              "reduceColumnSortOrder:": "",
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "1",
                "dataColumns:": [
                  "VALUE._col0:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            },
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "Group By Vectorization:": {
                  "aggregators:": [
                    "VectorUDAFCountMerge(col 0:bigint) -> bigint"
                  ],
                  "className:": "VectorGroupByOperator",
                  "groupByMode:": "MERGEPARTIAL",
                  "native:": "false",
                  "vectorProcessingMode:": "GLOBAL",
                  "projectedOutputColumnNums:": "[0]"
                },
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0"
                ],
                "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "GBY_30",
                "children": {
                  "File Output Operator": {
                    "compressed:": "false",
                    "File Sink Vectorization:": {
                      "className:": "VectorFileSinkOperator",
                      "native:": "false"
                    },
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "table:": {
                      "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                      "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                      "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                    },
                    "OperatorId:": "FS_31"
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_32"
          }
        }
      }
    }
  }
}
PREHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
6058
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
{
  "CBOPlan": {
    "rels": [
      {
        "id": "0",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "sorted_mod_4"
        ],
        "table:alias": "s",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 8,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "ctinyint",
            "ndv": 127,
            "minValue": -64,
            "maxValue": 62
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "1",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "ctinyint",
          "EXPR$0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          },
          {
            "op": {
              "name": "=",
              "kind": "EQUALS",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "op": {
                  "name": "pmod",
                  "kind": "OTHER_FUNCTION",
                  "syntax": "FUNCTION"
                },
                "operands": [
                  {
                    "op": {
                      "name": "CAST",
                      "kind": "CAST",
                      "syntax": "SPECIAL"
                    },
                    "operands": [
                      {
                        "input": 0,
                        "name": "$0"
                      }
                    ],
                    "type": {
                      "type": "INTEGER",
                      "nullable": true
                    }
                  },
                  {
                    "literal": 4,
                    "type": {
                      "type": "INTEGER",
                      "nullable": false
                    }
                  }
                ],
                "class": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveSqlFunction",
                "type": {
                  "type": "INTEGER",
                  "nullable": true
                },
                "deterministic": true,
                "dynamic": false
              },
              {
                "input": 1,
                "name": "$1"
              }
            ]
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "2",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "small_table"
        ],
        "table:alias": "sm",
        "inputs": [],
        "rowCount": 100,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "cbigint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "ctinyint",
            "ndv": 66,
            "minValue": -62,
            "maxValue": 62
          },
          {
            "name": "cbigint",
            "ndv": 1,
            "minValue": null,
            "maxValue": null
          }
        ]
      },
      {
        "id": "3",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "rowCount": 98
      },
      {
        "id": "4",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "ctinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 98
      },
      {
        "id": "5",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "AND",
            "kind": "AND",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "op": {
                "name": "=",
                "kind": "EQUALS",
                "syntax": "BINARY"
              },
              "operands": [
                {
                  "input": 0,
                  "name": "$0"
                },
                {
                  "input": 2,
                  "name": "$2"
                }
              ]
            },
            {
              "input": 1,
              "name": "$1"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "1",
          "4"
        ],
        "rowCount": 12054.183673469386
      },
      {
        "id": "6",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveAggregate",
        "group": [],
        "aggs": [
          {
            "agg": {
              "name": "count",
              "kind": "COUNT",
              "syntax": "FUNCTION_STAR"
            },
            "type": {
              "type": "BIGINT",
              "nullable": true
            },
            "distinct": false,
            "operands": [],
            "name": null
          }
        ],
        "rowCount": 1
      },
      {
        "id": "7",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "_c0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 1
      }
    ]
  },
  "optimizedSQL": "SELECT COUNT(*) AS `_c0`\nFROM (SELECT `ctinyint`, PMOD(CAST(`ctinyint` AS INT), 4) = `cmodint` AS `EXPR$0`\nFROM `default`.`sorted_mod_4`) AS `t`\nLEFT JOIN (SELECT `ctinyint`\nFROM `default`.`small_table`\nWHERE `ctinyint` IS NOT NULL) AS `t1` ON `t`.`ctinyint` = `t1`.`ctinyint` AND `t`.`EXPR$0`",
  "PLAN VECTORIZATION": {
    "enabled": true,
    "enabledConditionsMet": [
      "hive.vectorized.execution.enabled IS true"
    ]
  },
  "cboInfo": "Plan optimized by CBO.",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
#### A masked pattern was here ####
        "Edges:": {
          "Map 1": {
            "parent": "Map 3",
            "type": "BROADCAST_EDGE"
          },
          "Reducer 2": {
            "parent": "Map 1",
            "type": "CUSTOM_SIMPLE_EDGE"
          }
        },
#### A masked pattern was here ####
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s",
                  "columns:": [
                    "ctinyint",
                    "cmodint"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "sorted_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "ctinyint (type: tinyint), ((UDFToInteger(ctinyint) pmod 4) = cmodint) (type: boolean)",
                      "columnExprMap:": {
                        "_col0": "ctinyint",
                        "_col1": "((UDFToInteger(ctinyint) pmod 4) = cmodint)"
                      },
                      "outputColumnNames:": [
                        "_col0",
                        "_col1"
                      ],
                      "Select Vectorization:": {
                        "className:": "VectorSelectOperator",
                        "native:": "true",
                        "projectedOutputColumnNums:": "[0, 5]",
                        "selectExpressions:": [
                          "LongColEqualLongColumn(col 4:int, col 1:int)(children: PosModLongToLong(col 0, divisor 4)(children: col 0:tinyint) -> 4:int) -> 5:boolean"
                        ]
                      },
                      "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "SEL_26",
                      "children": {
                        "Map Join Operator": {
                          "condition map:": [
                            {
                              "": "Left Outer Join 0 to 1"
                            }
                          ],
                          "filter predicates:": {
                            "0": "{_col1}",
                            "1": ""
                          },
                          "keys:": {
                            "0": "_col0 (type: tinyint)",
                            "1": "_col0 (type: tinyint)"
                          },
                          "Map Join Vectorization:": {
                            "bigTableFilterExpressions:": [
                              "SelectColumnIsTrue(col 5:boolean)"
                            ],
                            "bigTableKeyColumns:": [
                              "0:tinyint"
                            ],
                            "bigTableRetainColumnNums:": "[]",
                            "className:": "VectorMapJoinOuterLongOperator",
                            "native:": "true",
                            "nativeConditionsMet:": [
                              "hive.mapjoin.optimized.hashtable IS true",
                              "hive.vectorized.execution.mapjoin.native.enabled IS true",
                              "hive.execution.engine tez IN [tez] IS true",
                              "One MapJoin Condition IS true",
                              "No nullsafe IS true",
                              "Small table vectorizes IS true",
                              "Outer Join has keys IS true",
                              "Optimized Table and Supports Key Types IS true"
                            ],
                            "hashTableImplementationType:": "OPTIMIZED"
                          },
                          "input vertices:": {
                            "1": "Map 3"
                          },
                          "Statistics:": "Num rows: 10225 Data size: 81800 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "MAPJOIN_27",
                          "children": {
                            "Group By Operator": {
                              "aggregations:": [
                                "count()"
                              ],
                              "Group By Vectorization:": {
                                "aggregators:": [
                                  "VectorUDAFCountStar(*) -> bigint"
                                ],
                                "className:": "VectorGroupByOperator",
                                "groupByMode:": "HASH",
                                "native:": "false",
                                "vectorProcessingMode:": "HASH",
                                "projectedOutputColumnNums:": "[0]"
                              },
                              "minReductionHashAggr:": "0.99",
                              "mode:": "hash",
                              "outputColumnNames:": [
                                "_col0"
                              ],
                              "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "GBY_28",
                              "children": {
                                "Reduce Output Operator": {
                                  "columnExprMap:": {
                                    "VALUE._col0": "_col0"
                                  },
                                  "null sort order:": "",
                                  "sort order:": "",
                                  "Reduce Sink Vectorization:": {
                                    "className:": "VectorReduceSinkEmptyKeyOperator",
                                    "native:": "true",
                                    "nativeConditionsMet:": [
                                      "hive.vectorized.execution.reducesink.new.enabled IS true",
                                      "hive.execution.engine tez IN [tez] IS true",
                                      "No PTF TopN IS true",
                                      "No DISTINCT columns IS true",
                                      "BinarySortableSerDe for keys IS true",
                                      "LazyBinarySerDe for values IS true"
                                    ],
                                    "valueColumns:": [
                                      "0:bigint"
                                    ]
                                  },
                                  "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                                  "value expressions:": "_col0 (type: bigint)",
                                  "OperatorId:": "RS_29",
                                  "outputname:": "Reducer 2",
                                  "outputOperator:": [
                                    "GBY_30"
                                  ]
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0, 1]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[bigint, bigint]"
              }
            }
          },
          "Map 3": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "sm",
                  "columns:": [
                    "ctinyint"
                  ],
                  "database:": "default",
                  "filterExpr:": "ctinyint is not null (type: boolean)",
                  "Statistics:": "Num rows: 100 Data size: 396 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "small_table",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cbigint:bigint, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_2",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 0:tinyint)"
                      },
                      "predicate:": "ctinyint is not null (type: boolean)",
                      "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_23",
                      "children": {
                        "Select Operator": {
                          "expressions:": "ctinyint (type: tinyint)",
                          "columnExprMap:": {
                            "_col0": "ctinyint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[0]"
                          },
                          "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_24",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: tinyint)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: tinyint)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:tinyint"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_25",
                              "outputname:": "Map 1",
                              "outputOperator:": [
                                "TS_0"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cbigint:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Reducer 2": {
            "Execution mode:": "vectorized, llap",
            "Reduce Vectorization:": {
              "enabled:": "true",
              "enableConditionsMet:": [
                "hive.vectorized.execution.reduce.enabled IS true",
                "hive.execution.engine tez IN [tez] IS true"
              ],
              "reduceColumnNullOrder:": "",
              "reduceColumnSortOrder:": "",
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "1",
                "dataColumns:": [
                  "VALUE._col0:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            },
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "Group By Vectorization:": {
                  "aggregators:": [
                    "VectorUDAFCountMerge(col 0:bigint) -> bigint"
                  ],
                  "className:": "VectorGroupByOperator",
                  "groupByMode:": "MERGEPARTIAL",
                  "native:": "false",
                  "vectorProcessingMode:": "GLOBAL",
                  "projectedOutputColumnNums:": "[0]"
                },
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0"
                ],
                "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "GBY_30",
                "children": {
                  "File Output Operator": {
                    "compressed:": "false",
                    "File Sink Vectorization:": {
                      "className:": "VectorFileSinkOperator",
                      "native:": "false"
                    },
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "table:": {
                      "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                      "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                      "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                    },
                    "OperatorId:": "FS_31"
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_32"
          }
        }
      }
    }
  }
}
PREHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and pmod(s.ctinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
6248
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
{
  "CBOPlan": {
    "rels": [
      {
        "id": "0",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "sorted_mod_4"
        ],
        "table:alias": "s",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "ctinyint",
            "ndv": 127,
            "minValue": -64,
            "maxValue": 62
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "1",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "ctinyint",
          "EXPR$0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          },
          {
            "op": {
              "name": "<",
              "kind": "LESS_THAN",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "input": 0,
                "name": "$0"
              },
              {
                "literal": 100,
                "type": {
                  "type": "TINYINT",
                  "nullable": false
                }
              }
            ]
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "2",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "small_table"
        ],
        "table:alias": "sm",
        "inputs": [],
        "rowCount": 100,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "cbigint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "ctinyint",
            "ndv": 66,
            "minValue": -62,
            "maxValue": 62
          },
          {
            "name": "cbigint",
            "ndv": 1,
            "minValue": null,
            "maxValue": null
          }
        ]
      },
      {
        "id": "3",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "rowCount": 98
      },
      {
        "id": "4",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "ctinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 98
      },
      {
        "id": "5",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "AND",
            "kind": "AND",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "op": {
                "name": "=",
                "kind": "EQUALS",
                "syntax": "BINARY"
              },
              "operands": [
                {
                  "input": 0,
                  "name": "$0"
                },
                {
                  "input": 2,
                  "name": "$2"
                }
              ]
            },
            {
              "input": 1,
              "name": "$1"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "1",
          "4"
        ],
        "rowCount": 12054.183673469386
      },
      {
        "id": "6",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveAggregate",
        "group": [],
        "aggs": [
          {
            "agg": {
              "name": "count",
              "kind": "COUNT",
              "syntax": "FUNCTION_STAR"
            },
            "type": {
              "type": "BIGINT",
              "nullable": true
            },
            "distinct": false,
            "operands": [],
            "name": null
          }
        ],
        "rowCount": 1
      },
      {
        "id": "7",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "_c0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 1
      }
    ]
  },
  "optimizedSQL": "SELECT COUNT(*) AS `_c0`\nFROM (SELECT `ctinyint`, `ctinyint` < 100 AS `EXPR$0`\nFROM `default`.`sorted_mod_4`) AS `t`\nLEFT JOIN (SELECT `ctinyint`\nFROM `default`.`small_table`\nWHERE `ctinyint` IS NOT NULL) AS `t1` ON `t`.`ctinyint` = `t1`.`ctinyint` AND `t`.`EXPR$0`",
  "PLAN VECTORIZATION": {
    "enabled": true,
    "enabledConditionsMet": [
      "hive.vectorized.execution.enabled IS true"
    ]
  },
  "cboInfo": "Plan optimized by CBO.",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
#### A masked pattern was here ####
        "Edges:": {
          "Map 1": {
            "parent": "Map 3",
            "type": "BROADCAST_EDGE"
          },
          "Reducer 2": {
            "parent": "Map 1",
            "type": "CUSTOM_SIMPLE_EDGE"
          }
        },
#### A masked pattern was here ####
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s",
                  "columns:": [
                    "ctinyint"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "sorted_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "ctinyint (type: tinyint), (ctinyint < 100Y) (type: boolean)",
                      "columnExprMap:": {
                        "_col0": "ctinyint",
                        "_col1": "(ctinyint < 100Y)"
                      },
                      "outputColumnNames:": [
                        "_col0",
                        "_col1"
                      ],
                      "Select Vectorization:": {
                        "className:": "VectorSelectOperator",
                        "native:": "true",
                        "projectedOutputColumnNums:": "[0, 4]",
                        "selectExpressions:": [
                          "LongColLessLongScalar(col 0:tinyint, val 100) -> 4:boolean"
                        ]
                      },
                      "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "SEL_26",
                      "children": {
                        "Map Join Operator": {
                          "condition map:": [
                            {
                              "": "Left Outer Join 0 to 1"
                            }
                          ],
                          "filter predicates:": {
                            "0": "{_col1}",
                            "1": ""
                          },
                          "keys:": {
                            "0": "_col0 (type: tinyint)",
                            "1": "_col0 (type: tinyint)"
                          },
                          "Map Join Vectorization:": {
                            "bigTableFilterExpressions:": [
                              "SelectColumnIsTrue(col 4:boolean)"
                            ],
                            "bigTableKeyColumns:": [
                              "0:tinyint"
                            ],
                            "bigTableRetainColumnNums:": "[]",
                            "className:": "VectorMapJoinOuterLongOperator",
                            "native:": "true",
                            "nativeConditionsMet:": [
                              "hive.mapjoin.optimized.hashtable IS true",
                              "hive.vectorized.execution.mapjoin.native.enabled IS true",
                              "hive.execution.engine tez IN [tez] IS true",
                              "One MapJoin Condition IS true",
                              "No nullsafe IS true",
                              "Small table vectorizes IS true",
                              "Outer Join has keys IS true",
                              "Optimized Table and Supports Key Types IS true"
                            ],
                            "hashTableImplementationType:": "OPTIMIZED"
                          },
                          "input vertices:": {
                            "1": "Map 3"
                          },
                          "Statistics:": "Num rows: 10225 Data size: 81800 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "MAPJOIN_27",
                          "children": {
                            "Group By Operator": {
                              "aggregations:": [
                                "count()"
                              ],
                              "Group By Vectorization:": {
                                "aggregators:": [
                                  "VectorUDAFCountStar(*) -> bigint"
                                ],
                                "className:": "VectorGroupByOperator",
                                "groupByMode:": "HASH",
                                "native:": "false",
                                "vectorProcessingMode:": "HASH",
                                "projectedOutputColumnNums:": "[0]"
                              },
                              "minReductionHashAggr:": "0.99",
                              "mode:": "hash",
                              "outputColumnNames:": [
                                "_col0"
                              ],
                              "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "GBY_28",
                              "children": {
                                "Reduce Output Operator": {
                                  "columnExprMap:": {
                                    "VALUE._col0": "_col0"
                                  },
                                  "null sort order:": "",
                                  "sort order:": "",
                                  "Reduce Sink Vectorization:": {
                                    "className:": "VectorReduceSinkEmptyKeyOperator",
                                    "native:": "true",
                                    "nativeConditionsMet:": [
                                      "hive.vectorized.execution.reducesink.new.enabled IS true",
                                      "hive.execution.engine tez IN [tez] IS true",
                                      "No PTF TopN IS true",
                                      "No DISTINCT columns IS true",
                                      "BinarySortableSerDe for keys IS true",
                                      "LazyBinarySerDe for values IS true"
                                    ],
                                    "valueColumns:": [
                                      "0:bigint"
                                    ]
                                  },
                                  "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                                  "value expressions:": "_col0 (type: bigint)",
                                  "OperatorId:": "RS_29",
                                  "outputname:": "Reducer 2",
                                  "outputOperator:": [
                                    "GBY_30"
                                  ]
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[bigint]"
              }
            }
          },
          "Map 3": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "sm",
                  "columns:": [
                    "ctinyint"
                  ],
                  "database:": "default",
                  "filterExpr:": "ctinyint is not null (type: boolean)",
                  "Statistics:": "Num rows: 100 Data size: 396 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "small_table",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cbigint:bigint, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_2",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 0:tinyint)"
                      },
                      "predicate:": "ctinyint is not null (type: boolean)",
                      "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_23",
                      "children": {
                        "Select Operator": {
                          "expressions:": "ctinyint (type: tinyint)",
                          "columnExprMap:": {
                            "_col0": "ctinyint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[0]"
                          },
                          "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_24",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: tinyint)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: tinyint)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:tinyint"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_25",
                              "outputname:": "Map 1",
                              "outputOperator:": [
                                "TS_0"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cbigint:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Reducer 2": {
            "Execution mode:": "vectorized, llap",
            "Reduce Vectorization:": {
              "enabled:": "true",
              "enableConditionsMet:": [
                "hive.vectorized.execution.reduce.enabled IS true",
                "hive.execution.engine tez IN [tez] IS true"
              ],
              "reduceColumnNullOrder:": "",
              "reduceColumnSortOrder:": "",
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "1",
                "dataColumns:": [
                  "VALUE._col0:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            },
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "Group By Vectorization:": {
                  "aggregators:": [
                    "VectorUDAFCountMerge(col 0:bigint) -> bigint"
                  ],
                  "className:": "VectorGroupByOperator",
                  "groupByMode:": "MERGEPARTIAL",
                  "native:": "false",
                  "vectorProcessingMode:": "GLOBAL",
                  "projectedOutputColumnNums:": "[0]"
                },
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0"
                ],
                "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "GBY_30",
                "children": {
                  "File Output Operator": {
                    "compressed:": "false",
                    "File Sink Vectorization:": {
                      "className:": "VectorFileSinkOperator",
                      "native:": "false"
                    },
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "table:": {
                      "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                      "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                      "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                    },
                    "OperatorId:": "FS_31"
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_32"
          }
        }
      }
    }
  }
}
PREHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.ctinyint, s.cmodint, sm.cbigint 
from sorted_mod_4 s
left outer join small_table sm
on s.ctinyint = sm.ctinyint and s.ctinyint < 100
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
6876
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
{
  "CBOPlan": {
    "rels": [
      {
        "id": "0",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "sorted_mod_4"
        ],
        "table:alias": "s",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 8,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "ctinyint",
            "ndv": 127,
            "minValue": -64,
            "maxValue": 62
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "1",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "ctinyint",
          "EXPR$0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          },
          {
            "op": {
              "name": "CAST",
              "kind": "CAST",
              "syntax": "SPECIAL"
            },
            "operands": [
              {
                "input": 1,
                "name": "$1"
              }
            ],
            "type": {
              "type": "BIGINT",
              "nullable": true
            }
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "2",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "small_table"
        ],
        "table:alias": "sm",
        "inputs": [],
        "rowCount": 100,
        "avgRowSize": 8,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "cbigint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cbigint",
            "ndv": 1,
            "minValue": null,
            "maxValue": null
          },
          {
            "name": "ctinyint",
            "ndv": 66,
            "minValue": -62,
            "maxValue": 62
          }
        ]
      },
      {
        "id": "3",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "op": {
                "name": "pmod",
                "kind": "OTHER_FUNCTION",
                "syntax": "FUNCTION"
              },
              "operands": [
                {
                  "input": 1,
                  "name": "$1"
                },
                {
                  "literal": 8,
                  "type": {
                    "type": "BIGINT",
                    "nullable": false
                  }
                }
              ],
              "class": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveSqlFunction",
              "type": {
                "type": "BIGINT",
                "nullable": true
              },
              "deterministic": true,
              "dynamic": false
            }
          ]
        },
        "rowCount": 1
      },
      {
        "id": "4",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cbigint"
        ],
        "exprs": [
          {
            "input": 1,
            "name": "$1"
          }
        ],
        "rowCount": 1
      },
      {
        "id": "5",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "=",
            "kind": "EQUALS",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "op": {
                "name": "pmod",
                "kind": "OTHER_FUNCTION",
                "syntax": "FUNCTION"
              },
              "operands": [
                {
                  "input": 2,
                  "name": "$2"
                },
                {
                  "literal": 8,
                  "type": {
                    "type": "BIGINT",
                    "nullable": false
                  }
                }
              ],
              "class": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveSqlFunction",
              "type": {
                "type": "BIGINT",
                "nullable": true
              },
              "deterministic": true,
              "dynamic": false
            },
            {
              "input": 1,
              "name": "$1"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "1",
          "4"
        ],
        "rowCount": 6058
      },
      {
        "id": "6",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "sorted_mod_4"
        ],
        "table:alias": "s2",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "TINYINT",
              "nullable": true,
              "name": "ctinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "ctinyint",
            "ndv": 127,
            "minValue": -64,
            "maxValue": 62
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "7",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "rowCount": 6058
      },
      {
        "id": "8",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "ctinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "9",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "=",
            "kind": "EQUALS",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "input": 3,
              "name": "$3"
            },
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "5",
          "8"
        ],
        "rowCount": 294981.6692913386
      },
      {
        "id": "10",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveAggregate",
        "group": [],
        "aggs": [
          {
            "agg": {
              "name": "count",
              "kind": "COUNT",
              "syntax": "FUNCTION_STAR"
            },
            "type": {
              "type": "BIGINT",
              "nullable": true
            },
            "distinct": false,
            "operands": [],
            "name": null
          }
        ],
        "rowCount": 1
      },
      {
        "id": "11",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "_c0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 1
      }
    ]
  },
  "optimizedSQL": "SELECT COUNT(*) AS `_c0`\nFROM (SELECT `ctinyint`, CAST(`cmodint` AS BIGINT) AS `EXPR$0`\nFROM `default`.`sorted_mod_4`) AS `t`\nLEFT JOIN (SELECT `cbigint`\nFROM `default`.`small_table`\nWHERE PMOD(`cbigint`, 8) IS NOT NULL) AS `t1` ON PMOD(`t1`.`cbigint`, 8) = `t`.`EXPR$0`\nLEFT JOIN (SELECT `ctinyint`\nFROM `default`.`sorted_mod_4`\nWHERE `ctinyint` IS NOT NULL) AS `t3` ON `t`.`ctinyint` = `t3`.`ctinyint`",
  "PLAN VECTORIZATION": {
    "enabled": true,
    "enabledConditionsMet": [
      "hive.vectorized.execution.enabled IS true"
    ]
  },
  "cboInfo": "Plan optimized by CBO.",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
#### A masked pattern was here ####
        "Edges:": {
          "Map 1": {
            "parent": "Map 4",
            "type": "BROADCAST_EDGE"
          },
          "Reducer 2": [
            {
              "parent": "Map 1",
              "type": "SIMPLE_EDGE"
            },
            {
              "parent": "Map 5",
              "type": "SIMPLE_EDGE"
            }
          ],
          "Reducer 3": {
            "parent": "Reducer 2",
            "type": "CUSTOM_SIMPLE_EDGE"
          }
        },
#### A masked pattern was here ####
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s",
                  "columns:": [
                    "ctinyint",
                    "cmodint"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "sorted_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "ctinyint (type: tinyint), UDFToLong(cmodint) (type: bigint)",
                      "columnExprMap:": {
                        "_col0": "ctinyint",
                        "_col1": "UDFToLong(cmodint)"
                      },
                      "outputColumnNames:": [
                        "_col0",
                        "_col1"
                      ],
                      "Select Vectorization:": {
                        "className:": "VectorSelectOperator",
                        "native:": "true",
                        "projectedOutputColumnNums:": "[0, 1]"
                      },
                      "Statistics:": "Num rows: 6058 Data size: 72696 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "SEL_40",
                      "children": {
                        "Map Join Operator": {
                          "columnExprMap:": {
                            "_col0": "0:_col0"
                          },
                          "condition map:": [
                            {
                              "": "Left Outer Join 0 to 1"
                            }
                          ],
                          "keys:": {
                            "0": "_col1 (type: bigint)",
                            "1": "(_col0 pmod 8L) (type: bigint)"
                          },
                          "Map Join Vectorization:": {
                            "bigTableKeyColumns:": [
                              "1:bigint"
                            ],
                            "bigTableRetainColumnNums:": "[0]",
                            "bigTableValueColumns:": [
                              "0:tinyint"
                            ],
                            "className:": "VectorMapJoinOuterLongOperator",
                            "native:": "true",
                            "nativeConditionsMet:": [
                              "hive.mapjoin.optimized.hashtable IS true",
                              "hive.vectorized.execution.mapjoin.native.enabled IS true",
                              "hive.execution.engine tez IN [tez] IS true",
                              "One MapJoin Condition IS true",
                              "No nullsafe IS true",
                              "Small table vectorizes IS true",
                              "Outer Join has keys IS true",
                              "Optimized Table and Supports Key Types IS true"
                            ],
                            "projectedOutput:": [
                              "0:tinyint"
                            ],
                            "hashTableImplementationType:": "OPTIMIZED"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "input vertices:": {
                            "1": "Map 4"
                          },
                          "Statistics:": "Num rows: 157508 Data size: 630032 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "MAPJOIN_41",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: tinyint)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: tinyint)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:tinyint"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 157508 Data size: 630032 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_42",
                              "outputname:": "Reducer 2",
                              "outputOperator:": [
                                "MERGEJOIN_35"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0, 1]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Map 4": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "sm",
                  "columns:": [
                    "cbigint"
                  ],
                  "database:": "default",
                  "filterExpr:": "(cbigint pmod 8L) is not null (type: boolean)",
                  "Statistics:": "Num rows: 100 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "small_table",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cbigint:bigint, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_2",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 4:bigint)(children: PosModLongToLong(col 1, divisor 8) -> 4:bigint)"
                      },
                      "predicate:": "(cbigint pmod 8L) is not null (type: boolean)",
                      "Statistics:": "Num rows: 100 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_37",
                      "children": {
                        "Select Operator": {
                          "expressions:": "cbigint (type: bigint)",
                          "columnExprMap:": {
                            "_col0": "cbigint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[1]"
                          },
                          "Statistics:": "Num rows: 100 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_38",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "(_col0 pmod 8L)"
                              },
                              "key expressions:": "(_col0 pmod 8L) (type: bigint)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "(_col0 pmod 8L) (type: bigint)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "4:bigint"
                                ],
                                "keyExpressions:": [
                                  "PosModLongToLong(col 1, divisor 8) -> 4:bigint"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 100 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_39",
                              "outputname:": "Map 1",
                              "outputOperator:": [
                                "TS_0"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[1]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cbigint:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[bigint]"
              }
            }
          },
          "Map 5": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s2",
                  "columns:": [
                    "ctinyint"
                  ],
                  "database:": "default",
                  "filterExpr:": "ctinyint is not null (type: boolean)",
                  "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "sorted_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:ctinyint:tinyint, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_5",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 0:tinyint)"
                      },
                      "predicate:": "ctinyint is not null (type: boolean)",
                      "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_43",
                      "children": {
                        "Select Operator": {
                          "expressions:": "ctinyint (type: tinyint)",
                          "columnExprMap:": {
                            "_col0": "ctinyint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[0]"
                          },
                          "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_44",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: tinyint)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: tinyint)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:tinyint"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_45",
                              "outputname:": "Reducer 2",
                              "outputOperator:": [
                                "MERGEJOIN_35"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "ctinyint:tinyint",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Reducer 2": {
            "Execution mode:": "llap",
            "Reduce Operator Tree:": {
              "Merge Join Operator": {
                "condition map:": [
                  {
                    "": "Left Outer Join 0 to 1"
                  }
                ],
                "keys:": {
                  "0": "_col0 (type: tinyint)",
                  "1": "_col0 (type: tinyint)"
                },
                "Statistics:": "Num rows: 7513255 Data size: 60106040 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "MERGEJOIN_35",
                "children": {
                  "Group By Operator": {
                    "aggregations:": [
                      "count()"
                    ],
                    "minReductionHashAggr:": "0.99",
                    "mode:": "hash",
                    "outputColumnNames:": [
                      "_col0"
                    ],
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "OperatorId:": "GBY_15",
                    "children": {
                      "Reduce Output Operator": {
                        "columnExprMap:": {
                          "VALUE._col0": "_col0"
                        },
                        "null sort order:": "",
                        "sort order:": "",
                        "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                        "value expressions:": "_col0 (type: bigint)",
                        "OperatorId:": "RS_16",
                        "outputname:": "Reducer 3",
                        "outputOperator:": [
                          "GBY_46"
                        ]
                      }
                    }
                  }
                }
              }
            },
            "MergeJoin Vectorization:": {
              "enabled:": "false",
              "enableConditionsNotMet:": [
                "Vectorizing MergeJoin Supported IS false"
              ]
            }
          },
          "Reducer 3": {
            "Execution mode:": "vectorized, llap",
            "Reduce Vectorization:": {
              "enabled:": "true",
              "enableConditionsMet:": [
                "hive.vectorized.execution.reduce.enabled IS true",
                "hive.execution.engine tez IN [tez] IS true"
              ],
              "reduceColumnNullOrder:": "",
              "reduceColumnSortOrder:": "",
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "1",
                "dataColumns:": [
                  "VALUE._col0:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            },
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "Group By Vectorization:": {
                  "aggregators:": [
                    "VectorUDAFCountMerge(col 0:bigint) -> bigint"
                  ],
                  "className:": "VectorGroupByOperator",
                  "groupByMode:": "MERGEPARTIAL",
                  "native:": "false",
                  "vectorProcessingMode:": "GLOBAL",
                  "projectedOutputColumnNums:": "[0]"
                },
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0"
                ],
                "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "GBY_46",
                "children": {
                  "File Output Operator": {
                    "compressed:": "false",
                    "File Sink Vectorization:": {
                      "className:": "VectorFileSinkOperator",
                      "native:": "false"
                    },
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "table:": {
                      "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                      "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                      "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                    },
                    "OperatorId:": "FS_47"
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_48"
          }
        }
      }
    }
  }
}
PREHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table
PREHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from sorted_mod_4 s
left outer join small_table sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join sorted_mod_4 s2
  on s2.ctinyint = s.ctinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table
POSTHOOK: Input: default@sorted_mod_4
#### A masked pattern was here ####
3268334
PREHOOK: query: create table mod_8_mod_4 stored as orc
as select pmod(ctinyint, 8) as cmodtinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@mod_8_mod_4
POSTHOOK: query: create table mod_8_mod_4 stored as orc
as select pmod(ctinyint, 8) as cmodtinyint, pmod(cint, 4) as cmodint from alltypesorc
where cint is not null and ctinyint is not null
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@mod_8_mod_4
POSTHOOK: Lineage: mod_8_mod_4.cmodint EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
POSTHOOK: Lineage: mod_8_mod_4.cmodtinyint EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
PREHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Output: default@mod_8_mod_4
POSTHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Output: default@mod_8_mod_4
PREHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Output: default@mod_8_mod_4
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE mod_8_mod_4 COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Output: default@mod_8_mod_4
#### A masked pattern was here ####
PREHOOK: query: create table small_table2 stored
as orc as select pmod(ctinyint, 16) as cmodtinyint, cbigint from alltypesorc limit 100
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@alltypesorc
PREHOOK: Output: database:default
PREHOOK: Output: default@small_table2
POSTHOOK: query: create table small_table2 stored
as orc as select pmod(ctinyint, 16) as cmodtinyint, cbigint from alltypesorc limit 100
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@alltypesorc
POSTHOOK: Output: database:default
POSTHOOK: Output: default@small_table2
POSTHOOK: Lineage: small_table2.cbigint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cbigint, type:bigint, comment:null), ]
POSTHOOK: Lineage: small_table2.cmodtinyint EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
PREHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@small_table2
PREHOOK: Output: default@small_table2
POSTHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: default@small_table2
PREHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS FOR COLUMNS
PREHOOK: type: ANALYZE_TABLE
PREHOOK: Input: default@small_table2
PREHOOK: Output: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE small_table2 COMPUTE STATISTICS FOR COLUMNS
POSTHOOK: type: ANALYZE_TABLE
POSTHOOK: Input: default@small_table2
POSTHOOK: Output: default@small_table2
#### A masked pattern was here ####
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
{
  "CBOPlan": {
    "rels": [
      {
        "id": "0",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "mod_8_mod_4"
        ],
        "table:alias": "s",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cmodtinyint",
            "ndv": 8,
            "minValue": 0,
            "maxValue": 7
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "1",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cmodtinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "2",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "small_table2"
        ],
        "table:alias": "st",
        "inputs": [],
        "rowCount": 100,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "cbigint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cmodtinyint",
            "ndv": 16,
            "minValue": 0,
            "maxValue": 15
          },
          {
            "name": "cbigint",
            "ndv": 1,
            "minValue": null,
            "maxValue": null
          }
        ]
      },
      {
        "id": "3",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "rowCount": 98
      },
      {
        "id": "4",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cmodtinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 98
      },
      {
        "id": "5",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "=",
            "kind": "EQUALS",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            },
            {
              "input": 1,
              "name": "$1"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "1",
          "4"
        ],
        "rowCount": 42784.625
      },
      {
        "id": "6",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveAggregate",
        "group": [],
        "aggs": [
          {
            "agg": {
              "name": "count",
              "kind": "COUNT",
              "syntax": "FUNCTION_STAR"
            },
            "type": {
              "type": "BIGINT",
              "nullable": true
            },
            "distinct": false,
            "operands": [],
            "name": null
          }
        ],
        "rowCount": 1
      },
      {
        "id": "7",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "_c0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 1
      }
    ]
  },
  "optimizedSQL": "SELECT COUNT(*) AS `_c0`\nFROM (SELECT `cmodtinyint`\nFROM `default`.`mod_8_mod_4`) AS `t`\nLEFT JOIN (SELECT `cmodtinyint`\nFROM `default`.`small_table2`\nWHERE `cmodtinyint` IS NOT NULL) AS `t1` ON `t`.`cmodtinyint` = `t1`.`cmodtinyint`",
  "PLAN VECTORIZATION": {
    "enabled": true,
    "enabledConditionsMet": [
      "hive.vectorized.execution.enabled IS true"
    ]
  },
  "cboInfo": "Plan optimized by CBO.",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
#### A masked pattern was here ####
        "Edges:": {
          "Map 1": {
            "parent": "Map 3",
            "type": "BROADCAST_EDGE"
          },
          "Reducer 2": {
            "parent": "Map 1",
            "type": "CUSTOM_SIMPLE_EDGE"
          }
        },
#### A masked pattern was here ####
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s",
                  "columns:": [
                    "cmodtinyint"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "mod_8_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "cmodtinyint (type: int)",
                      "columnExprMap:": {
                        "_col0": "cmodtinyint"
                      },
                      "outputColumnNames:": [
                        "_col0"
                      ],
                      "Select Vectorization:": {
                        "className:": "VectorSelectOperator",
                        "native:": "true",
                        "projectedOutputColumnNums:": "[0]"
                      },
                      "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "SEL_26",
                      "children": {
                        "Map Join Operator": {
                          "condition map:": [
                            {
                              "": "Left Outer Join 0 to 1"
                            }
                          ],
                          "keys:": {
                            "0": "_col0 (type: int)",
                            "1": "_col0 (type: int)"
                          },
                          "Map Join Vectorization:": {
                            "bigTableKeyColumns:": [
                              "0:int"
                            ],
                            "bigTableRetainColumnNums:": "[]",
                            "className:": "VectorMapJoinOuterLongOperator",
                            "native:": "true",
                            "nativeConditionsMet:": [
                              "hive.mapjoin.optimized.hashtable IS true",
                              "hive.vectorized.execution.mapjoin.native.enabled IS true",
                              "hive.execution.engine tez IN [tez] IS true",
                              "One MapJoin Condition IS true",
                              "No nullsafe IS true",
                              "Small table vectorizes IS true",
                              "Outer Join has keys IS true",
                              "Optimized Table and Supports Key Types IS true"
                            ],
                            "hashTableImplementationType:": "OPTIMIZED"
                          },
                          "input vertices:": {
                            "1": "Map 3"
                          },
                          "Statistics:": "Num rows: 43163 Data size: 345304 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "MAPJOIN_27",
                          "children": {
                            "Group By Operator": {
                              "aggregations:": [
                                "count()"
                              ],
                              "Group By Vectorization:": {
                                "aggregators:": [
                                  "VectorUDAFCountStar(*) -> bigint"
                                ],
                                "className:": "VectorGroupByOperator",
                                "groupByMode:": "HASH",
                                "native:": "false",
                                "vectorProcessingMode:": "HASH",
                                "projectedOutputColumnNums:": "[0]"
                              },
                              "minReductionHashAggr:": "0.99",
                              "mode:": "hash",
                              "outputColumnNames:": [
                                "_col0"
                              ],
                              "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "GBY_28",
                              "children": {
                                "Reduce Output Operator": {
                                  "columnExprMap:": {
                                    "VALUE._col0": "_col0"
                                  },
                                  "null sort order:": "",
                                  "sort order:": "",
                                  "Reduce Sink Vectorization:": {
                                    "className:": "VectorReduceSinkEmptyKeyOperator",
                                    "native:": "true",
                                    "nativeConditionsMet:": [
                                      "hive.vectorized.execution.reducesink.new.enabled IS true",
                                      "hive.execution.engine tez IN [tez] IS true",
                                      "No PTF TopN IS true",
                                      "No DISTINCT columns IS true",
                                      "BinarySortableSerDe for keys IS true",
                                      "LazyBinarySerDe for values IS true"
                                    ],
                                    "valueColumns:": [
                                      "0:bigint"
                                    ]
                                  },
                                  "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                                  "value expressions:": "_col0 (type: bigint)",
                                  "OperatorId:": "RS_29",
                                  "outputname:": "Reducer 2",
                                  "outputOperator:": [
                                    "GBY_30"
                                  ]
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Map 3": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "st",
                  "columns:": [
                    "cmodtinyint"
                  ],
                  "database:": "default",
                  "filterExpr:": "cmodtinyint is not null (type: boolean)",
                  "Statistics:": "Num rows: 100 Data size: 396 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "small_table2",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cbigint:bigint, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_2",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 0:int)"
                      },
                      "predicate:": "cmodtinyint is not null (type: boolean)",
                      "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_23",
                      "children": {
                        "Select Operator": {
                          "expressions:": "cmodtinyint (type: int)",
                          "columnExprMap:": {
                            "_col0": "cmodtinyint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[0]"
                          },
                          "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_24",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: int)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: int)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:int"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_25",
                              "outputname:": "Map 1",
                              "outputOperator:": [
                                "TS_0"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cbigint:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Reducer 2": {
            "Execution mode:": "vectorized, llap",
            "Reduce Vectorization:": {
              "enabled:": "true",
              "enableConditionsMet:": [
                "hive.vectorized.execution.reduce.enabled IS true",
                "hive.execution.engine tez IN [tez] IS true"
              ],
              "reduceColumnNullOrder:": "",
              "reduceColumnSortOrder:": "",
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "1",
                "dataColumns:": [
                  "VALUE._col0:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            },
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "Group By Vectorization:": {
                  "aggregators:": [
                    "VectorUDAFCountMerge(col 0:bigint) -> bigint"
                  ],
                  "className:": "VectorGroupByOperator",
                  "groupByMode:": "MERGEPARTIAL",
                  "native:": "false",
                  "vectorProcessingMode:": "GLOBAL",
                  "projectedOutputColumnNums:": "[0]"
                },
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0"
                ],
                "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "GBY_30",
                "children": {
                  "File Output Operator": {
                    "compressed:": "false",
                    "File Sink Vectorization:": {
                      "className:": "VectorFileSinkOperator",
                      "native:": "false"
                    },
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "table:": {
                      "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                      "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                      "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                    },
                    "OperatorId:": "FS_31"
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_32"
          }
        }
      }
    }
  }
}
PREHOOK: query: select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.*, st.*
from mod_8_mod_4 s
left outer join small_table2 st
on s.cmodtinyint = st.cmodtinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
39112
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
{
  "CBOPlan": {
    "rels": [
      {
        "id": "0",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "mod_8_mod_4"
        ],
        "table:alias": "s",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 8,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cmodtinyint",
            "ndv": 8,
            "minValue": 0,
            "maxValue": 7
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "1",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cmodtinyint",
          "EXPR$0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          },
          {
            "op": {
              "name": "=",
              "kind": "EQUALS",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "input": 1,
                "name": "$1"
              },
              {
                "literal": 2,
                "type": {
                  "type": "INTEGER",
                  "nullable": false
                }
              }
            ]
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "2",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "small_table2"
        ],
        "table:alias": "sm",
        "inputs": [],
        "rowCount": 100,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "cbigint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cmodtinyint",
            "ndv": 16,
            "minValue": 0,
            "maxValue": 15
          },
          {
            "name": "cbigint",
            "ndv": 1,
            "minValue": null,
            "maxValue": null
          }
        ]
      },
      {
        "id": "3",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "rowCount": 98
      },
      {
        "id": "4",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cmodtinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 98
      },
      {
        "id": "5",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "AND",
            "kind": "AND",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "op": {
                "name": "=",
                "kind": "EQUALS",
                "syntax": "BINARY"
              },
              "operands": [
                {
                  "input": 0,
                  "name": "$0"
                },
                {
                  "input": 2,
                  "name": "$2"
                }
              ]
            },
            {
              "input": 1,
              "name": "$1"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "1",
          "4"
        ],
        "rowCount": 42784.625
      },
      {
        "id": "6",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveAggregate",
        "group": [],
        "aggs": [
          {
            "agg": {
              "name": "count",
              "kind": "COUNT",
              "syntax": "FUNCTION_STAR"
            },
            "type": {
              "type": "BIGINT",
              "nullable": true
            },
            "distinct": false,
            "operands": [],
            "name": null
          }
        ],
        "rowCount": 1
      },
      {
        "id": "7",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "_c0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 1
      }
    ]
  },
  "optimizedSQL": "SELECT COUNT(*) AS `_c0`\nFROM (SELECT `cmodtinyint`, `cmodint` = 2 AS `EXPR$0`\nFROM `default`.`mod_8_mod_4`) AS `t`\nLEFT JOIN (SELECT `cmodtinyint`\nFROM `default`.`small_table2`\nWHERE `cmodtinyint` IS NOT NULL) AS `t1` ON `t`.`cmodtinyint` = `t1`.`cmodtinyint` AND `t`.`EXPR$0`",
  "PLAN VECTORIZATION": {
    "enabled": true,
    "enabledConditionsMet": [
      "hive.vectorized.execution.enabled IS true"
    ]
  },
  "cboInfo": "Plan optimized by CBO.",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
#### A masked pattern was here ####
        "Edges:": {
          "Map 1": {
            "parent": "Map 3",
            "type": "BROADCAST_EDGE"
          },
          "Reducer 2": {
            "parent": "Map 1",
            "type": "CUSTOM_SIMPLE_EDGE"
          }
        },
#### A masked pattern was here ####
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s",
                  "columns:": [
                    "cmodtinyint",
                    "cmodint"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "mod_8_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "cmodtinyint (type: int), (cmodint = 2) (type: boolean)",
                      "columnExprMap:": {
                        "_col0": "cmodtinyint",
                        "_col1": "(cmodint = 2)"
                      },
                      "outputColumnNames:": [
                        "_col0",
                        "_col1"
                      ],
                      "Select Vectorization:": {
                        "className:": "VectorSelectOperator",
                        "native:": "true",
                        "projectedOutputColumnNums:": "[0, 4]",
                        "selectExpressions:": [
                          "LongColEqualLongScalar(col 1:int, val 2) -> 4:boolean"
                        ]
                      },
                      "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "SEL_26",
                      "children": {
                        "Map Join Operator": {
                          "condition map:": [
                            {
                              "": "Left Outer Join 0 to 1"
                            }
                          ],
                          "filter predicates:": {
                            "0": "{_col1}",
                            "1": ""
                          },
                          "keys:": {
                            "0": "_col0 (type: int)",
                            "1": "_col0 (type: int)"
                          },
                          "Map Join Vectorization:": {
                            "bigTableFilterExpressions:": [
                              "SelectColumnIsTrue(col 4:boolean)"
                            ],
                            "bigTableKeyColumns:": [
                              "0:int"
                            ],
                            "bigTableRetainColumnNums:": "[]",
                            "className:": "VectorMapJoinOuterLongOperator",
                            "native:": "true",
                            "nativeConditionsMet:": [
                              "hive.mapjoin.optimized.hashtable IS true",
                              "hive.vectorized.execution.mapjoin.native.enabled IS true",
                              "hive.execution.engine tez IN [tez] IS true",
                              "One MapJoin Condition IS true",
                              "No nullsafe IS true",
                              "Small table vectorizes IS true",
                              "Outer Join has keys IS true",
                              "Optimized Table and Supports Key Types IS true"
                            ],
                            "hashTableImplementationType:": "OPTIMIZED"
                          },
                          "input vertices:": {
                            "1": "Map 3"
                          },
                          "Statistics:": "Num rows: 43163 Data size: 345304 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "MAPJOIN_27",
                          "children": {
                            "Group By Operator": {
                              "aggregations:": [
                                "count()"
                              ],
                              "Group By Vectorization:": {
                                "aggregators:": [
                                  "VectorUDAFCountStar(*) -> bigint"
                                ],
                                "className:": "VectorGroupByOperator",
                                "groupByMode:": "HASH",
                                "native:": "false",
                                "vectorProcessingMode:": "HASH",
                                "projectedOutputColumnNums:": "[0]"
                              },
                              "minReductionHashAggr:": "0.99",
                              "mode:": "hash",
                              "outputColumnNames:": [
                                "_col0"
                              ],
                              "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "GBY_28",
                              "children": {
                                "Reduce Output Operator": {
                                  "columnExprMap:": {
                                    "VALUE._col0": "_col0"
                                  },
                                  "null sort order:": "",
                                  "sort order:": "",
                                  "Reduce Sink Vectorization:": {
                                    "className:": "VectorReduceSinkEmptyKeyOperator",
                                    "native:": "true",
                                    "nativeConditionsMet:": [
                                      "hive.vectorized.execution.reducesink.new.enabled IS true",
                                      "hive.execution.engine tez IN [tez] IS true",
                                      "No PTF TopN IS true",
                                      "No DISTINCT columns IS true",
                                      "BinarySortableSerDe for keys IS true",
                                      "LazyBinarySerDe for values IS true"
                                    ],
                                    "valueColumns:": [
                                      "0:bigint"
                                    ]
                                  },
                                  "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                                  "value expressions:": "_col0 (type: bigint)",
                                  "OperatorId:": "RS_29",
                                  "outputname:": "Reducer 2",
                                  "outputOperator:": [
                                    "GBY_30"
                                  ]
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0, 1]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[bigint]"
              }
            }
          },
          "Map 3": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "sm",
                  "columns:": [
                    "cmodtinyint"
                  ],
                  "database:": "default",
                  "filterExpr:": "cmodtinyint is not null (type: boolean)",
                  "Statistics:": "Num rows: 100 Data size: 396 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "small_table2",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cbigint:bigint, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_2",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 0:int)"
                      },
                      "predicate:": "cmodtinyint is not null (type: boolean)",
                      "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_23",
                      "children": {
                        "Select Operator": {
                          "expressions:": "cmodtinyint (type: int)",
                          "columnExprMap:": {
                            "_col0": "cmodtinyint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[0]"
                          },
                          "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_24",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: int)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: int)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:int"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_25",
                              "outputname:": "Map 1",
                              "outputOperator:": [
                                "TS_0"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cbigint:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Reducer 2": {
            "Execution mode:": "vectorized, llap",
            "Reduce Vectorization:": {
              "enabled:": "true",
              "enableConditionsMet:": [
                "hive.vectorized.execution.reduce.enabled IS true",
                "hive.execution.engine tez IN [tez] IS true"
              ],
              "reduceColumnNullOrder:": "",
              "reduceColumnSortOrder:": "",
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "1",
                "dataColumns:": [
                  "VALUE._col0:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            },
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "Group By Vectorization:": {
                  "aggregators:": [
                    "VectorUDAFCountMerge(col 0:bigint) -> bigint"
                  ],
                  "className:": "VectorGroupByOperator",
                  "groupByMode:": "MERGEPARTIAL",
                  "native:": "false",
                  "vectorProcessingMode:": "GLOBAL",
                  "projectedOutputColumnNums:": "[0]"
                },
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0"
                ],
                "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "GBY_30",
                "children": {
                  "File Output Operator": {
                    "compressed:": "false",
                    "File Sink Vectorization:": {
                      "className:": "VectorFileSinkOperator",
                      "native:": "false"
                    },
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "table:": {
                      "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                      "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                      "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                    },
                    "OperatorId:": "FS_31"
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_32"
          }
        }
      }
    }
  }
}
PREHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodint = 2
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
11171
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
{
  "CBOPlan": {
    "rels": [
      {
        "id": "0",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "mod_8_mod_4"
        ],
        "table:alias": "s",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 8,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cmodtinyint",
            "ndv": 8,
            "minValue": 0,
            "maxValue": 7
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "1",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cmodtinyint",
          "EXPR$0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          },
          {
            "op": {
              "name": "=",
              "kind": "EQUALS",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "op": {
                  "name": "pmod",
                  "kind": "OTHER_FUNCTION",
                  "syntax": "FUNCTION"
                },
                "operands": [
                  {
                    "input": 0,
                    "name": "$0"
                  },
                  {
                    "literal": 4,
                    "type": {
                      "type": "INTEGER",
                      "nullable": false
                    }
                  }
                ],
                "class": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveSqlFunction",
                "type": {
                  "type": "INTEGER",
                  "nullable": true
                },
                "deterministic": true,
                "dynamic": false
              },
              {
                "input": 1,
                "name": "$1"
              }
            ]
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "2",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "small_table2"
        ],
        "table:alias": "sm",
        "inputs": [],
        "rowCount": 100,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "cbigint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cmodtinyint",
            "ndv": 16,
            "minValue": 0,
            "maxValue": 15
          },
          {
            "name": "cbigint",
            "ndv": 1,
            "minValue": null,
            "maxValue": null
          }
        ]
      },
      {
        "id": "3",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "rowCount": 98
      },
      {
        "id": "4",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cmodtinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 98
      },
      {
        "id": "5",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "AND",
            "kind": "AND",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "op": {
                "name": "=",
                "kind": "EQUALS",
                "syntax": "BINARY"
              },
              "operands": [
                {
                  "input": 0,
                  "name": "$0"
                },
                {
                  "input": 2,
                  "name": "$2"
                }
              ]
            },
            {
              "input": 1,
              "name": "$1"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "1",
          "4"
        ],
        "rowCount": 42784.625
      },
      {
        "id": "6",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveAggregate",
        "group": [],
        "aggs": [
          {
            "agg": {
              "name": "count",
              "kind": "COUNT",
              "syntax": "FUNCTION_STAR"
            },
            "type": {
              "type": "BIGINT",
              "nullable": true
            },
            "distinct": false,
            "operands": [],
            "name": null
          }
        ],
        "rowCount": 1
      },
      {
        "id": "7",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "_c0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 1
      }
    ]
  },
  "optimizedSQL": "SELECT COUNT(*) AS `_c0`\nFROM (SELECT `cmodtinyint`, PMOD(`cmodtinyint`, 4) = `cmodint` AS `EXPR$0`\nFROM `default`.`mod_8_mod_4`) AS `t`\nLEFT JOIN (SELECT `cmodtinyint`\nFROM `default`.`small_table2`\nWHERE `cmodtinyint` IS NOT NULL) AS `t1` ON `t`.`cmodtinyint` = `t1`.`cmodtinyint` AND `t`.`EXPR$0`",
  "PLAN VECTORIZATION": {
    "enabled": true,
    "enabledConditionsMet": [
      "hive.vectorized.execution.enabled IS true"
    ]
  },
  "cboInfo": "Plan optimized by CBO.",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
#### A masked pattern was here ####
        "Edges:": {
          "Map 1": {
            "parent": "Map 3",
            "type": "BROADCAST_EDGE"
          },
          "Reducer 2": {
            "parent": "Map 1",
            "type": "CUSTOM_SIMPLE_EDGE"
          }
        },
#### A masked pattern was here ####
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s",
                  "columns:": [
                    "cmodtinyint",
                    "cmodint"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "mod_8_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "cmodtinyint (type: int), ((cmodtinyint pmod 4) = cmodint) (type: boolean)",
                      "columnExprMap:": {
                        "_col0": "cmodtinyint",
                        "_col1": "((cmodtinyint pmod 4) = cmodint)"
                      },
                      "outputColumnNames:": [
                        "_col0",
                        "_col1"
                      ],
                      "Select Vectorization:": {
                        "className:": "VectorSelectOperator",
                        "native:": "true",
                        "projectedOutputColumnNums:": "[0, 5]",
                        "selectExpressions:": [
                          "LongColEqualLongColumn(col 4:int, col 1:int)(children: PosModLongToLong(col 0, divisor 4) -> 4:int) -> 5:boolean"
                        ]
                      },
                      "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "SEL_26",
                      "children": {
                        "Map Join Operator": {
                          "condition map:": [
                            {
                              "": "Left Outer Join 0 to 1"
                            }
                          ],
                          "filter predicates:": {
                            "0": "{_col1}",
                            "1": ""
                          },
                          "keys:": {
                            "0": "_col0 (type: int)",
                            "1": "_col0 (type: int)"
                          },
                          "Map Join Vectorization:": {
                            "bigTableFilterExpressions:": [
                              "SelectColumnIsTrue(col 5:boolean)"
                            ],
                            "bigTableKeyColumns:": [
                              "0:int"
                            ],
                            "bigTableRetainColumnNums:": "[]",
                            "className:": "VectorMapJoinOuterLongOperator",
                            "native:": "true",
                            "nativeConditionsMet:": [
                              "hive.mapjoin.optimized.hashtable IS true",
                              "hive.vectorized.execution.mapjoin.native.enabled IS true",
                              "hive.execution.engine tez IN [tez] IS true",
                              "One MapJoin Condition IS true",
                              "No nullsafe IS true",
                              "Small table vectorizes IS true",
                              "Outer Join has keys IS true",
                              "Optimized Table and Supports Key Types IS true"
                            ],
                            "hashTableImplementationType:": "OPTIMIZED"
                          },
                          "input vertices:": {
                            "1": "Map 3"
                          },
                          "Statistics:": "Num rows: 43163 Data size: 345304 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "MAPJOIN_27",
                          "children": {
                            "Group By Operator": {
                              "aggregations:": [
                                "count()"
                              ],
                              "Group By Vectorization:": {
                                "aggregators:": [
                                  "VectorUDAFCountStar(*) -> bigint"
                                ],
                                "className:": "VectorGroupByOperator",
                                "groupByMode:": "HASH",
                                "native:": "false",
                                "vectorProcessingMode:": "HASH",
                                "projectedOutputColumnNums:": "[0]"
                              },
                              "minReductionHashAggr:": "0.99",
                              "mode:": "hash",
                              "outputColumnNames:": [
                                "_col0"
                              ],
                              "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "GBY_28",
                              "children": {
                                "Reduce Output Operator": {
                                  "columnExprMap:": {
                                    "VALUE._col0": "_col0"
                                  },
                                  "null sort order:": "",
                                  "sort order:": "",
                                  "Reduce Sink Vectorization:": {
                                    "className:": "VectorReduceSinkEmptyKeyOperator",
                                    "native:": "true",
                                    "nativeConditionsMet:": [
                                      "hive.vectorized.execution.reducesink.new.enabled IS true",
                                      "hive.execution.engine tez IN [tez] IS true",
                                      "No PTF TopN IS true",
                                      "No DISTINCT columns IS true",
                                      "BinarySortableSerDe for keys IS true",
                                      "LazyBinarySerDe for values IS true"
                                    ],
                                    "valueColumns:": [
                                      "0:bigint"
                                    ]
                                  },
                                  "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                                  "value expressions:": "_col0 (type: bigint)",
                                  "OperatorId:": "RS_29",
                                  "outputname:": "Reducer 2",
                                  "outputOperator:": [
                                    "GBY_30"
                                  ]
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0, 1]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[bigint, bigint]"
              }
            }
          },
          "Map 3": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "sm",
                  "columns:": [
                    "cmodtinyint"
                  ],
                  "database:": "default",
                  "filterExpr:": "cmodtinyint is not null (type: boolean)",
                  "Statistics:": "Num rows: 100 Data size: 396 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "small_table2",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cbigint:bigint, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_2",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 0:int)"
                      },
                      "predicate:": "cmodtinyint is not null (type: boolean)",
                      "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_23",
                      "children": {
                        "Select Operator": {
                          "expressions:": "cmodtinyint (type: int)",
                          "columnExprMap:": {
                            "_col0": "cmodtinyint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[0]"
                          },
                          "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_24",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: int)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: int)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:int"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_25",
                              "outputname:": "Map 1",
                              "outputOperator:": [
                                "TS_0"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cbigint:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Reducer 2": {
            "Execution mode:": "vectorized, llap",
            "Reduce Vectorization:": {
              "enabled:": "true",
              "enableConditionsMet:": [
                "hive.vectorized.execution.reduce.enabled IS true",
                "hive.execution.engine tez IN [tez] IS true"
              ],
              "reduceColumnNullOrder:": "",
              "reduceColumnSortOrder:": "",
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "1",
                "dataColumns:": [
                  "VALUE._col0:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            },
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "Group By Vectorization:": {
                  "aggregators:": [
                    "VectorUDAFCountMerge(col 0:bigint) -> bigint"
                  ],
                  "className:": "VectorGroupByOperator",
                  "groupByMode:": "MERGEPARTIAL",
                  "native:": "false",
                  "vectorProcessingMode:": "GLOBAL",
                  "projectedOutputColumnNums:": "[0]"
                },
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0"
                ],
                "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "GBY_30",
                "children": {
                  "File Output Operator": {
                    "compressed:": "false",
                    "File Sink Vectorization:": {
                      "className:": "VectorFileSinkOperator",
                      "native:": "false"
                    },
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "table:": {
                      "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                      "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                      "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                    },
                    "OperatorId:": "FS_31"
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_32"
          }
        }
      }
    }
  }
}
PREHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and pmod(s.cmodtinyint, 4) = s.cmodint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
14371
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
{
  "CBOPlan": {
    "rels": [
      {
        "id": "0",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "mod_8_mod_4"
        ],
        "table:alias": "s",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cmodtinyint",
            "ndv": 8,
            "minValue": 0,
            "maxValue": 7
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "1",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cmodtinyint",
          "EXPR$0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          },
          {
            "op": {
              "name": "<",
              "kind": "LESS_THAN",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "input": 0,
                "name": "$0"
              },
              {
                "literal": 3,
                "type": {
                  "type": "INTEGER",
                  "nullable": false
                }
              }
            ]
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "2",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "small_table2"
        ],
        "table:alias": "sm",
        "inputs": [],
        "rowCount": 100,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "cbigint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cmodtinyint",
            "ndv": 16,
            "minValue": 0,
            "maxValue": 15
          },
          {
            "name": "cbigint",
            "ndv": 1,
            "minValue": null,
            "maxValue": null
          }
        ]
      },
      {
        "id": "3",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "rowCount": 98
      },
      {
        "id": "4",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cmodtinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 98
      },
      {
        "id": "5",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "AND",
            "kind": "AND",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "op": {
                "name": "=",
                "kind": "EQUALS",
                "syntax": "BINARY"
              },
              "operands": [
                {
                  "input": 0,
                  "name": "$0"
                },
                {
                  "input": 2,
                  "name": "$2"
                }
              ]
            },
            {
              "input": 1,
              "name": "$1"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "1",
          "4"
        ],
        "rowCount": 42784.625
      },
      {
        "id": "6",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveAggregate",
        "group": [],
        "aggs": [
          {
            "agg": {
              "name": "count",
              "kind": "COUNT",
              "syntax": "FUNCTION_STAR"
            },
            "type": {
              "type": "BIGINT",
              "nullable": true
            },
            "distinct": false,
            "operands": [],
            "name": null
          }
        ],
        "rowCount": 1
      },
      {
        "id": "7",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "_c0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 1
      }
    ]
  },
  "optimizedSQL": "SELECT COUNT(*) AS `_c0`\nFROM (SELECT `cmodtinyint`, `cmodtinyint` < 3 AS `EXPR$0`\nFROM `default`.`mod_8_mod_4`) AS `t`\nLEFT JOIN (SELECT `cmodtinyint`\nFROM `default`.`small_table2`\nWHERE `cmodtinyint` IS NOT NULL) AS `t1` ON `t`.`cmodtinyint` = `t1`.`cmodtinyint` AND `t`.`EXPR$0`",
  "PLAN VECTORIZATION": {
    "enabled": true,
    "enabledConditionsMet": [
      "hive.vectorized.execution.enabled IS true"
    ]
  },
  "cboInfo": "Plan optimized by CBO.",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
#### A masked pattern was here ####
        "Edges:": {
          "Map 1": {
            "parent": "Map 3",
            "type": "BROADCAST_EDGE"
          },
          "Reducer 2": {
            "parent": "Map 1",
            "type": "CUSTOM_SIMPLE_EDGE"
          }
        },
#### A masked pattern was here ####
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s",
                  "columns:": [
                    "cmodtinyint"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "mod_8_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "cmodtinyint (type: int), (cmodtinyint < 3) (type: boolean)",
                      "columnExprMap:": {
                        "_col0": "cmodtinyint",
                        "_col1": "(cmodtinyint < 3)"
                      },
                      "outputColumnNames:": [
                        "_col0",
                        "_col1"
                      ],
                      "Select Vectorization:": {
                        "className:": "VectorSelectOperator",
                        "native:": "true",
                        "projectedOutputColumnNums:": "[0, 4]",
                        "selectExpressions:": [
                          "LongColLessLongScalar(col 0:int, val 3) -> 4:boolean"
                        ]
                      },
                      "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "SEL_26",
                      "children": {
                        "Map Join Operator": {
                          "condition map:": [
                            {
                              "": "Left Outer Join 0 to 1"
                            }
                          ],
                          "filter predicates:": {
                            "0": "{_col1}",
                            "1": ""
                          },
                          "keys:": {
                            "0": "_col0 (type: int)",
                            "1": "_col0 (type: int)"
                          },
                          "Map Join Vectorization:": {
                            "bigTableFilterExpressions:": [
                              "SelectColumnIsTrue(col 4:boolean)"
                            ],
                            "bigTableKeyColumns:": [
                              "0:int"
                            ],
                            "bigTableRetainColumnNums:": "[]",
                            "className:": "VectorMapJoinOuterLongOperator",
                            "native:": "true",
                            "nativeConditionsMet:": [
                              "hive.mapjoin.optimized.hashtable IS true",
                              "hive.vectorized.execution.mapjoin.native.enabled IS true",
                              "hive.execution.engine tez IN [tez] IS true",
                              "One MapJoin Condition IS true",
                              "No nullsafe IS true",
                              "Small table vectorizes IS true",
                              "Outer Join has keys IS true",
                              "Optimized Table and Supports Key Types IS true"
                            ],
                            "hashTableImplementationType:": "OPTIMIZED"
                          },
                          "input vertices:": {
                            "1": "Map 3"
                          },
                          "Statistics:": "Num rows: 43163 Data size: 345304 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "MAPJOIN_27",
                          "children": {
                            "Group By Operator": {
                              "aggregations:": [
                                "count()"
                              ],
                              "Group By Vectorization:": {
                                "aggregators:": [
                                  "VectorUDAFCountStar(*) -> bigint"
                                ],
                                "className:": "VectorGroupByOperator",
                                "groupByMode:": "HASH",
                                "native:": "false",
                                "vectorProcessingMode:": "HASH",
                                "projectedOutputColumnNums:": "[0]"
                              },
                              "minReductionHashAggr:": "0.99",
                              "mode:": "hash",
                              "outputColumnNames:": [
                                "_col0"
                              ],
                              "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "GBY_28",
                              "children": {
                                "Reduce Output Operator": {
                                  "columnExprMap:": {
                                    "VALUE._col0": "_col0"
                                  },
                                  "null sort order:": "",
                                  "sort order:": "",
                                  "Reduce Sink Vectorization:": {
                                    "className:": "VectorReduceSinkEmptyKeyOperator",
                                    "native:": "true",
                                    "nativeConditionsMet:": [
                                      "hive.vectorized.execution.reducesink.new.enabled IS true",
                                      "hive.execution.engine tez IN [tez] IS true",
                                      "No PTF TopN IS true",
                                      "No DISTINCT columns IS true",
                                      "BinarySortableSerDe for keys IS true",
                                      "LazyBinarySerDe for values IS true"
                                    ],
                                    "valueColumns:": [
                                      "0:bigint"
                                    ]
                                  },
                                  "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                                  "value expressions:": "_col0 (type: bigint)",
                                  "OperatorId:": "RS_29",
                                  "outputname:": "Reducer 2",
                                  "outputOperator:": [
                                    "GBY_30"
                                  ]
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[bigint]"
              }
            }
          },
          "Map 3": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "sm",
                  "columns:": [
                    "cmodtinyint"
                  ],
                  "database:": "default",
                  "filterExpr:": "cmodtinyint is not null (type: boolean)",
                  "Statistics:": "Num rows: 100 Data size: 396 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "small_table2",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cbigint:bigint, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_2",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 0:int)"
                      },
                      "predicate:": "cmodtinyint is not null (type: boolean)",
                      "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_23",
                      "children": {
                        "Select Operator": {
                          "expressions:": "cmodtinyint (type: int)",
                          "columnExprMap:": {
                            "_col0": "cmodtinyint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[0]"
                          },
                          "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_24",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: int)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: int)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:int"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 98 Data size: 388 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_25",
                              "outputname:": "Map 1",
                              "outputOperator:": [
                                "TS_0"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cbigint:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Reducer 2": {
            "Execution mode:": "vectorized, llap",
            "Reduce Vectorization:": {
              "enabled:": "true",
              "enableConditionsMet:": [
                "hive.vectorized.execution.reduce.enabled IS true",
                "hive.execution.engine tez IN [tez] IS true"
              ],
              "reduceColumnNullOrder:": "",
              "reduceColumnSortOrder:": "",
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "1",
                "dataColumns:": [
                  "VALUE._col0:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            },
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "Group By Vectorization:": {
                  "aggregators:": [
                    "VectorUDAFCountMerge(col 0:bigint) -> bigint"
                  ],
                  "className:": "VectorGroupByOperator",
                  "groupByMode:": "MERGEPARTIAL",
                  "native:": "false",
                  "vectorProcessingMode:": "GLOBAL",
                  "projectedOutputColumnNums:": "[0]"
                },
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0"
                ],
                "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "GBY_30",
                "children": {
                  "File Output Operator": {
                    "compressed:": "false",
                    "File Sink Vectorization:": {
                      "className:": "VectorFileSinkOperator",
                      "native:": "false"
                    },
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "table:": {
                      "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                      "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                      "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                    },
                    "OperatorId:": "FS_31"
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_32"
          }
        }
      }
    }
  }
}
PREHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.cmodtinyint, s.cmodint, sm.cbigint 
from mod_8_mod_4 s
left outer join small_table2 sm
on s.cmodtinyint = sm.cmodtinyint and s.cmodtinyint < 3
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
17792
PREHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: explain vectorization detail formatted
select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
{
  "CBOPlan": {
    "rels": [
      {
        "id": "0",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "mod_8_mod_4"
        ],
        "table:alias": "s",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 8,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cmodtinyint",
            "ndv": 8,
            "minValue": 0,
            "maxValue": 7
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "1",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cmodtinyint",
          "EXPR$0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          },
          {
            "op": {
              "name": "CAST",
              "kind": "CAST",
              "syntax": "SPECIAL"
            },
            "operands": [
              {
                "input": 1,
                "name": "$1"
              }
            ],
            "type": {
              "type": "BIGINT",
              "nullable": true
            }
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "2",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "small_table2"
        ],
        "table:alias": "sm",
        "inputs": [],
        "rowCount": 100,
        "avgRowSize": 8,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "cbigint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cbigint",
            "ndv": 1,
            "minValue": null,
            "maxValue": null
          },
          {
            "name": "cmodtinyint",
            "ndv": 16,
            "minValue": 0,
            "maxValue": 15
          }
        ]
      },
      {
        "id": "3",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "op": {
                "name": "pmod",
                "kind": "OTHER_FUNCTION",
                "syntax": "FUNCTION"
              },
              "operands": [
                {
                  "input": 1,
                  "name": "$1"
                },
                {
                  "literal": 8,
                  "type": {
                    "type": "BIGINT",
                    "nullable": false
                  }
                }
              ],
              "class": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveSqlFunction",
              "type": {
                "type": "BIGINT",
                "nullable": true
              },
              "deterministic": true,
              "dynamic": false
            }
          ]
        },
        "rowCount": 1
      },
      {
        "id": "4",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cbigint"
        ],
        "exprs": [
          {
            "input": 1,
            "name": "$1"
          }
        ],
        "rowCount": 1
      },
      {
        "id": "5",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "=",
            "kind": "EQUALS",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "op": {
                "name": "pmod",
                "kind": "OTHER_FUNCTION",
                "syntax": "FUNCTION"
              },
              "operands": [
                {
                  "input": 2,
                  "name": "$2"
                },
                {
                  "literal": 8,
                  "type": {
                    "type": "BIGINT",
                    "nullable": false
                  }
                }
              ],
              "class": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveSqlFunction",
              "type": {
                "type": "BIGINT",
                "nullable": true
              },
              "deterministic": true,
              "dynamic": false
            },
            {
              "input": 1,
              "name": "$1"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "1",
          "4"
        ],
        "rowCount": 6058
      },
      {
        "id": "6",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveTableScan",
        "table": [
          "default",
          "mod_8_mod_4"
        ],
        "table:alias": "s2",
        "inputs": [],
        "rowCount": 6058,
        "avgRowSize": 4,
        "rowType": {
          "fields": [
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodtinyint"
            },
            {
              "type": "INTEGER",
              "nullable": true,
              "name": "cmodint"
            },
            {
              "type": "BIGINT",
              "nullable": true,
              "name": "BLOCK__OFFSET__INSIDE__FILE"
            },
            {
              "type": "VARCHAR",
              "nullable": true,
              "precision": 2147483647,
              "name": "INPUT__FILE__NAME"
            },
            {
              "fields": [
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "writeid"
                },
                {
                  "type": "INTEGER",
                  "nullable": true,
                  "name": "bucketid"
                },
                {
                  "type": "BIGINT",
                  "nullable": true,
                  "name": "rowid"
                }
              ],
              "nullable": true,
              "name": "ROW__ID"
            },
            {
              "type": "BOOLEAN",
              "nullable": true,
              "name": "ROW__IS__DELETED"
            }
          ],
          "nullable": false
        },
        "colStats": [
          {
            "name": "cmodtinyint",
            "ndv": 8,
            "minValue": 0,
            "maxValue": 7
          },
          {
            "name": "cmodint",
            "ndv": 4,
            "minValue": 0,
            "maxValue": 3
          }
        ]
      },
      {
        "id": "7",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveFilter",
        "condition": {
          "op": {
            "name": "IS NOT NULL",
            "kind": "IS_NOT_NULL",
            "syntax": "POSTFIX"
          },
          "operands": [
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "rowCount": 6058
      },
      {
        "id": "8",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "cmodtinyint"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 6058
      },
      {
        "id": "9",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveJoin",
        "condition": {
          "op": {
            "name": "=",
            "kind": "EQUALS",
            "syntax": "BINARY"
          },
          "operands": [
            {
              "input": 3,
              "name": "$3"
            },
            {
              "input": 0,
              "name": "$0"
            }
          ]
        },
        "joinType": "left",
        "algorithm": "none",
        "cost": "not available",
        "inputs": [
          "5",
          "8"
        ],
        "rowCount": 4592721.25
      },
      {
        "id": "10",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveAggregate",
        "group": [],
        "aggs": [
          {
            "agg": {
              "name": "count",
              "kind": "COUNT",
              "syntax": "FUNCTION_STAR"
            },
            "type": {
              "type": "BIGINT",
              "nullable": true
            },
            "distinct": false,
            "operands": [],
            "name": null
          }
        ],
        "rowCount": 1
      },
      {
        "id": "11",
        "relOp": "org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveProject",
        "fields": [
          "_c0"
        ],
        "exprs": [
          {
            "input": 0,
            "name": "$0"
          }
        ],
        "rowCount": 1
      }
    ]
  },
  "optimizedSQL": "SELECT COUNT(*) AS `_c0`\nFROM (SELECT `cmodtinyint`, CAST(`cmodint` AS BIGINT) AS `EXPR$0`\nFROM `default`.`mod_8_mod_4`) AS `t`\nLEFT JOIN (SELECT `cbigint`\nFROM `default`.`small_table2`\nWHERE PMOD(`cbigint`, 8) IS NOT NULL) AS `t1` ON PMOD(`t1`.`cbigint`, 8) = `t`.`EXPR$0`\nLEFT JOIN (SELECT `cmodtinyint`\nFROM `default`.`mod_8_mod_4`\nWHERE `cmodtinyint` IS NOT NULL) AS `t3` ON `t`.`cmodtinyint` = `t3`.`cmodtinyint`",
  "PLAN VECTORIZATION": {
    "enabled": true,
    "enabledConditionsMet": [
      "hive.vectorized.execution.enabled IS true"
    ]
  },
  "cboInfo": "Plan optimized by CBO.",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
#### A masked pattern was here ####
        "Edges:": {
          "Map 1": {
            "parent": "Map 4",
            "type": "BROADCAST_EDGE"
          },
          "Reducer 2": [
            {
              "parent": "Map 1",
              "type": "SIMPLE_EDGE"
            },
            {
              "parent": "Map 5",
              "type": "SIMPLE_EDGE"
            }
          ],
          "Reducer 3": {
            "parent": "Reducer 2",
            "type": "CUSTOM_SIMPLE_EDGE"
          }
        },
#### A masked pattern was here ####
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s",
                  "columns:": [
                    "cmodtinyint",
                    "cmodint"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 6058 Data size: 48464 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "mod_8_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "cmodtinyint (type: int), UDFToLong(cmodint) (type: bigint)",
                      "columnExprMap:": {
                        "_col0": "cmodtinyint",
                        "_col1": "UDFToLong(cmodint)"
                      },
                      "outputColumnNames:": [
                        "_col0",
                        "_col1"
                      ],
                      "Select Vectorization:": {
                        "className:": "VectorSelectOperator",
                        "native:": "true",
                        "projectedOutputColumnNums:": "[0, 1]"
                      },
                      "Statistics:": "Num rows: 6058 Data size: 72696 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "SEL_40",
                      "children": {
                        "Map Join Operator": {
                          "columnExprMap:": {
                            "_col0": "0:_col0"
                          },
                          "condition map:": [
                            {
                              "": "Left Outer Join 0 to 1"
                            }
                          ],
                          "keys:": {
                            "0": "_col1 (type: bigint)",
                            "1": "(_col0 pmod 8L) (type: bigint)"
                          },
                          "Map Join Vectorization:": {
                            "bigTableKeyColumns:": [
                              "1:bigint"
                            ],
                            "bigTableRetainColumnNums:": "[0]",
                            "bigTableValueColumns:": [
                              "0:int"
                            ],
                            "className:": "VectorMapJoinOuterLongOperator",
                            "native:": "true",
                            "nativeConditionsMet:": [
                              "hive.mapjoin.optimized.hashtable IS true",
                              "hive.vectorized.execution.mapjoin.native.enabled IS true",
                              "hive.execution.engine tez IN [tez] IS true",
                              "One MapJoin Condition IS true",
                              "No nullsafe IS true",
                              "Small table vectorizes IS true",
                              "Outer Join has keys IS true",
                              "Optimized Table and Supports Key Types IS true"
                            ],
                            "projectedOutput:": [
                              "0:int"
                            ],
                            "hashTableImplementationType:": "OPTIMIZED"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "input vertices:": {
                            "1": "Map 4"
                          },
                          "Statistics:": "Num rows: 157508 Data size: 630032 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "MAPJOIN_41",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: int)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: int)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:int"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 157508 Data size: 630032 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_42",
                              "outputname:": "Reducer 2",
                              "outputOperator:": [
                                "MERGEJOIN_35"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0, 1]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Map 4": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "sm",
                  "columns:": [
                    "cbigint"
                  ],
                  "database:": "default",
                  "filterExpr:": "(cbigint pmod 8L) is not null (type: boolean)",
                  "Statistics:": "Num rows: 100 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "small_table2",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cbigint:bigint, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_2",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 4:bigint)(children: PosModLongToLong(col 1, divisor 8) -> 4:bigint)"
                      },
                      "predicate:": "(cbigint pmod 8L) is not null (type: boolean)",
                      "Statistics:": "Num rows: 100 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_37",
                      "children": {
                        "Select Operator": {
                          "expressions:": "cbigint (type: bigint)",
                          "columnExprMap:": {
                            "_col0": "cbigint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[1]"
                          },
                          "Statistics:": "Num rows: 100 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_38",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "(_col0 pmod 8L)"
                              },
                              "key expressions:": "(_col0 pmod 8L) (type: bigint)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "(_col0 pmod 8L) (type: bigint)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "4:bigint"
                                ],
                                "keyExpressions:": [
                                  "PosModLongToLong(col 1, divisor 8) -> 4:bigint"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 100 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_39",
                              "outputname:": "Map 1",
                              "outputOperator:": [
                                "TS_0"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[1]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cbigint:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[bigint]"
              }
            }
          },
          "Map 5": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "s2",
                  "columns:": [
                    "cmodtinyint"
                  ],
                  "database:": "default",
                  "filterExpr:": "cmodtinyint is not null (type: boolean)",
                  "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                  "table:": "mod_8_mod_4",
                  "TableScan Vectorization:": {
                    "native:": "true",
                    "vectorizationSchemaColumns:": "[0:cmodtinyint:int, 1:cmodint:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]"
                  },
                  "isTempTable:": "false",
                  "OperatorId:": "TS_5",
                  "children": {
                    "Filter Operator": {
                      "Filter Vectorization:": {
                        "className:": "VectorFilterOperator",
                        "native:": "true",
                        "predicateExpression:": "SelectColumnIsNotNull(col 0:int)"
                      },
                      "predicate:": "cmodtinyint is not null (type: boolean)",
                      "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                      "OperatorId:": "FIL_43",
                      "children": {
                        "Select Operator": {
                          "expressions:": "cmodtinyint (type: int)",
                          "columnExprMap:": {
                            "_col0": "cmodtinyint"
                          },
                          "outputColumnNames:": [
                            "_col0"
                          ],
                          "Select Vectorization:": {
                            "className:": "VectorSelectOperator",
                            "native:": "true",
                            "projectedOutputColumnNums:": "[0]"
                          },
                          "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                          "OperatorId:": "SEL_44",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY.reducesinkkey0": "_col0"
                              },
                              "key expressions:": "_col0 (type: int)",
                              "null sort order:": "z",
                              "sort order:": "+",
                              "Map-reduce partition columns:": "_col0 (type: int)",
                              "Reduce Sink Vectorization:": {
                                "className:": "VectorReduceSinkLongOperator",
                                "keyColumns:": [
                                  "0:int"
                                ],
                                "native:": "true",
                                "nativeConditionsMet:": [
                                  "hive.vectorized.execution.reducesink.new.enabled IS true",
                                  "hive.execution.engine tez IN [tez] IS true",
                                  "No PTF TopN IS true",
                                  "No DISTINCT columns IS true",
                                  "BinarySortableSerDe for keys IS true",
                                  "LazyBinarySerDe for values IS true"
                                ]
                              },
                              "Statistics:": "Num rows: 6058 Data size: 24232 Basic stats: COMPLETE Column stats: COMPLETE",
                              "OperatorId:": "RS_45",
                              "outputname:": "Reducer 2",
                              "outputOperator:": [
                                "MERGEJOIN_35"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized, llap",
            "LLAP IO:": "all inputs",
            "Map Vectorization:": {
              "enabled:": "true",
              "enabledConditionsMet:": [
                "hive.vectorized.use.vectorized.input.format IS true"
              ],
              "inputFormatFeatureSupport:": "[DECIMAL_64]",
              "featureSupportInUse:": "[DECIMAL_64]",
              "inputFileFormats:": [
                "org.apache.hadoop.hive.ql.io.orc.OrcInputFormat"
              ],
              "allNative:": "true",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "2",
                "includeColumns:": "[0]",
                "dataColumns:": [
                  "cmodtinyint:int",
                  "cmodint:int"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            }
          },
          "Reducer 2": {
            "Execution mode:": "llap",
            "Reduce Operator Tree:": {
              "Merge Join Operator": {
                "condition map:": [
                  {
                    "": "Left Outer Join 0 to 1"
                  }
                ],
                "keys:": {
                  "0": "_col0 (type: int)",
                  "1": "_col0 (type: int)"
                },
                "Statistics:": "Num rows: 119272933 Data size: 954183464 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "MERGEJOIN_35",
                "children": {
                  "Group By Operator": {
                    "aggregations:": [
                      "count()"
                    ],
                    "minReductionHashAggr:": "0.99",
                    "mode:": "hash",
                    "outputColumnNames:": [
                      "_col0"
                    ],
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "OperatorId:": "GBY_15",
                    "children": {
                      "Reduce Output Operator": {
                        "columnExprMap:": {
                          "VALUE._col0": "_col0"
                        },
                        "null sort order:": "",
                        "sort order:": "",
                        "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                        "value expressions:": "_col0 (type: bigint)",
                        "OperatorId:": "RS_16",
                        "outputname:": "Reducer 3",
                        "outputOperator:": [
                          "GBY_46"
                        ]
                      }
                    }
                  }
                }
              }
            },
            "MergeJoin Vectorization:": {
              "enabled:": "false",
              "enableConditionsNotMet:": [
                "Vectorizing MergeJoin Supported IS false"
              ]
            }
          },
          "Reducer 3": {
            "Execution mode:": "vectorized, llap",
            "Reduce Vectorization:": {
              "enabled:": "true",
              "enableConditionsMet:": [
                "hive.vectorized.execution.reduce.enabled IS true",
                "hive.execution.engine tez IN [tez] IS true"
              ],
              "reduceColumnNullOrder:": "",
              "reduceColumnSortOrder:": "",
              "allNative:": "false",
              "usesVectorUDFAdaptor:": "false",
              "vectorized:": "true",
              "rowBatchContext:": {
                "dataColumnCount:": "1",
                "dataColumns:": [
                  "VALUE._col0:bigint"
                ],
                "partitionColumnCount:": "0",
                "scratchColumnTypeNames:": "[]"
              }
            },
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "Group By Vectorization:": {
                  "aggregators:": [
                    "VectorUDAFCountMerge(col 0:bigint) -> bigint"
                  ],
                  "className:": "VectorGroupByOperator",
                  "groupByMode:": "MERGEPARTIAL",
                  "native:": "false",
                  "vectorProcessingMode:": "GLOBAL",
                  "projectedOutputColumnNums:": "[0]"
                },
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0"
                ],
                "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                "OperatorId:": "GBY_46",
                "children": {
                  "File Output Operator": {
                    "compressed:": "false",
                    "File Sink Vectorization:": {
                      "className:": "VectorFileSinkOperator",
                      "native:": "false"
                    },
                    "Statistics:": "Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE",
                    "table:": {
                      "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                      "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                      "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                    },
                    "OperatorId:": "FS_47"
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_48"
          }
        }
      }
    }
  }
}
PREHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
PREHOOK: type: QUERY
PREHOOK: Input: default@mod_8_mod_4
PREHOOK: Input: default@small_table2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from (select s.*, sm.*, s2.* 
from mod_8_mod_4 s
left outer join small_table2 sm
  on pmod(sm.cbigint, 8) = s.cmodint 
left outer join mod_8_mod_4 s2
  on s2.cmodtinyint = s.cmodtinyint
) t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@mod_8_mod_4
POSTHOOK: Input: default@small_table2
#### A masked pattern was here ####
6524438
