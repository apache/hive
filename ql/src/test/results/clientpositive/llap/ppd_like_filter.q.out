PREHOOK: query: CREATE TABLE test_tbl (a int) PARTITIONED BY (b string)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@test_tbl
POSTHOOK: query: CREATE TABLE test_tbl (a int) PARTITIONED BY (b string)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@test_tbl
PREHOOK: query: INSERT INTO test_tbl PARTITION(b="abc") VALUES (1)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@test_tbl@b=abc
POSTHOOK: query: INSERT INTO test_tbl PARTITION(b="abc") VALUES (1)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@test_tbl@b=abc
POSTHOOK: Lineage: test_tbl PARTITION(b=abc).a SCRIPT []
PREHOOK: query: INSERT INTO test_tbl PARTITION(b="d_\\%ae") VALUES (1)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@test_tbl@b=d_%5C%25ae
POSTHOOK: query: INSERT INTO test_tbl PARTITION(b="d_\\%ae") VALUES (1)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@test_tbl@b=d_%5C%25ae
POSTHOOK: Lineage: test_tbl PARTITION(b=d_\%ae).a SCRIPT []
PREHOOK: query: INSERT INTO test_tbl PARTITION(b="af%") VALUES (1)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@test_tbl@b=af%25
POSTHOOK: query: INSERT INTO test_tbl PARTITION(b="af%") VALUES (1)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@test_tbl@b=af%25
POSTHOOK: Lineage: test_tbl PARTITION(b=af%).a SCRIPT []
PREHOOK: query: select * from test_tbl where b like 'a%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
PREHOOK: Input: default@test_tbl@b=af%25
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like 'a%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
POSTHOOK: Input: default@test_tbl@b=af%25
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1,3) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1,3) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1,3) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12,14) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12,14) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12,14) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12,14) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12,14) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?,?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?,?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
1	af%
PREHOOK: query: select * from test_tbl where b like '%a%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
PREHOOK: Input: default@test_tbl@b=af%25
PREHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%a%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
POSTHOOK: Input: default@test_tbl@b=af%25
POSTHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1,2,3) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1,2,3) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12,14,13) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12,14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12,14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12,14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12,14,13) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?,?,?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?,?,?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
1	af%
1	d_\%ae
PREHOOK: query: select * from test_tbl where b like '%a'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%a'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
PREHOOK: query: select * from test_tbl where b like '%a'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%a'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
PREHOOK: query: select * from test_tbl where b like 'a%c'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like 'a%c'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
PREHOOK: query: select * from test_tbl where b like '%a%c%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%a%c%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
PREHOOK: query: select * from test_tbl where b like '%_b%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%_b%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
PREHOOK: query: select * from test_tbl where b like '%b_'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%b_'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
PREHOOK: query: select * from test_tbl where b like '%c'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%c'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
PREHOOK: query: select * from test_tbl where b like '%c%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%c%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
PREHOOK: query: select * from test_tbl where b like 'c%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like 'c%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
PREHOOK: query: select * from test_tbl where b like '%\_%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%\_%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (13) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (13) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	d_\%ae
PREHOOK: query: select * from test_tbl where b like '%\\%%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=af%25
PREHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%\\%%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=af%25
POSTHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (14,13) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (14,13) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?,?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?,?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	af%
1	d_\%ae
PREHOOK: query: select * from test_tbl where b like 'abc'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like 'abc'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
PREHOOK: query: select * from test_tbl where b like '%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
PREHOOK: Input: default@test_tbl@b=af%25
PREHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
POSTHOOK: Input: default@test_tbl@b=af%25
POSTHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1,2,3) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1,2,3) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12,14,13) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12,14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12,14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12,14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12,14,13) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?,?,?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?,?,?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
1	af%
1	d_\%ae
PREHOOK: query: select * from test_tbl where b like '_'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '_'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
PREHOOK: query: select * from test_tbl where b like '___'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
PREHOOK: Input: default@test_tbl@b=af%25
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '___'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
POSTHOOK: Input: default@test_tbl@b=af%25
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1,3) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1,3) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1,3) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12,14) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12,14) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12,14) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12,14) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12,14) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?,?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?,?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
1	af%
PREHOOK: query: select * from test_tbl where b like '%%%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=abc
PREHOOK: Input: default@test_tbl@b=af%25
PREHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%%%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=abc
POSTHOOK: Input: default@test_tbl@b=af%25
POSTHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1,2,3) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1,2,3) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (12,14,13) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (12,14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (12,14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (12,14,13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (12,14,13) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?,?,?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?,?,?)  and "ENGINE" = ?  order by "PARTITION_NAME""
1	abc
1	af%
1	d_\%ae
PREHOOK: query: select * from test_tbl where b like '%\\\\%'
PREHOOK: type: QUERY
PREHOOK: Input: default@test_tbl
PREHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
POSTHOOK: query: select * from test_tbl where b like '%\\\\%'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@test_tbl
POSTHOOK: Input: default@test_tbl@b=d_%5C%25ae
#### A masked pattern was here ####
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "DBS"."CTLG_NAME" from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT  "D2"."NAME", "T2"."TBL_NAME", CASE WHEN "C2"."COLUMN_NAME" IS NOT NULL THEN "C2"."COLUMN_NAME" ELSE "P2"."PKEY_NAME" END, "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."UPDATE_RULE", "KEY_CONSTRAINTS"."DELETE_RULE", "KEY_CONSTRAINTS"."CONSTRAINT_NAME" , "KEY_CONSTRAINTS2"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."CHILD_TBL_ID"  INNER JOIN "KEY_CONSTRAINTS" "KEY_CONSTRAINTS2" ON "KEY_CONSTRAINTS2"."PARENT_TBL_ID"  = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  AND "KEY_CONSTRAINTS2"."PARENT_CD_ID"  = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "KEY_CONSTRAINTS2"."PARENT_INTEGER_IDX"  = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  INNER JOIN "TBLS" "T2" ON  "KEY_CONSTRAINTS"."PARENT_TBL_ID" = "T2"."TBL_ID"  INNER JOIN "DBS" "D2" ON "T2"."DB_ID" = "D2"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2"  ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."CHILD_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."CHILD_INTEGER_IDX"  LEFT OUTER JOIN "COLUMNS_V2" "C2" ON "C2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "C2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" "P2" ON "P2"."TBL_ID" = "TBLS"."TBL_ID" AND  "P2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 1 AND "KEY_CONSTRAINTS2"."CONSTRAINT_TYPE" = 0 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME", CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."POSITION", "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 2 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 4 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY", "KEY_CONSTRAINTS"."DEFAULT_VALUE"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 5 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "SELECT "DBS"."NAME", "TBLS"."TBL_NAME",CASE WHEN "COLUMNS_V2"."COLUMN_NAME" IS NOT NULL THEN "COLUMNS_V2"."COLUMN_NAME" ELSE "PARTITION_KEYS"."PKEY_NAME" END, "KEY_CONSTRAINTS"."CONSTRAINT_NAME", "KEY_CONSTRAINTS"."ENABLE_VALIDATE_RELY"  from "TBLS"  INNER JOIN "KEY_CONSTRAINTS" ON "TBLS"."TBL_ID" = "KEY_CONSTRAINTS"."PARENT_TBL_ID"  INNER JOIN "DBS" ON "TBLS"."DB_ID" = "DBS"."DB_ID"  LEFT OUTER JOIN "COLUMNS_V2" ON "COLUMNS_V2"."CD_ID" = "KEY_CONSTRAINTS"."PARENT_CD_ID" AND  "COLUMNS_V2"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  LEFT OUTER JOIN "PARTITION_KEYS" ON "TBLS"."TBL_ID" = "PARTITION_KEYS"."TBL_ID" AND  "PARTITION_KEYS"."INTEGER_IDX" = "KEY_CONSTRAINTS"."PARENT_INTEGER_IDX"  WHERE "KEY_CONSTRAINTS"."CONSTRAINT_TYPE" = 3 AND "DBS"."CTLG_NAME" = ? AND "DBS"."NAME" = ? AND "TBLS"."TBL_NAME" = ?"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 where "DBS"."CTLG_NAME" = ?  and (("FILTER0"."PART_KEY_VAL" like ? ESCAPE '\' ))"
SQL Query : "select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2) order by "PART_NAME" asc"
SQL Query : "select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2) and "PARAM_KEY" is not null order by "PART_ID" asc"
SQL Query : "select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2) order by "PART_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (13) and "PARAM_KEY" is not null order by "SD_ID" asc"
SQL Query : "select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (13) order by "SD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (11) order by "CD_ID" asc, "INTEGER_IDX" asc"
SQL Query : "select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (13) and "PARAM_KEY" is not null order by "SERDE_ID" asc"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select "DB_ID", "NAME", "DB_LOCATION_URI", "DESC", "OWNER_NAME", "OWNER_TYPE", "CTLG_NAME" , "CREATE_TIME", "DB_MANAGED_LOCATION_URI", "TYPE", "DATACONNECTOR_NAME", "REMOTE_DBNAME"FROM "DBS" where "NAME" = ? and "CTLG_NAME" = ?"
SQL Query : "select "PARAM_KEY", "PARAM_VALUE"  from "DATABASE_PARAMS"  WHERE "DB_ID" = ?  AND "PARAM_KEY" IS NOT NULL"
SQL Query : "select count("COLUMN_NAME") from "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ?  and "COLUMN_NAME" in (?) and "PARTITION_NAME" in (?) and "ENGINE" = ?  group by "PARTITION_NAME""
SQL Query : "select "PARTITION_NAME", "COLUMN_NAME", "COLUMN_TYPE", "LONG_LOW_VALUE", "LONG_HIGH_VALUE", "DOUBLE_LOW_VALUE", "DOUBLE_HIGH_VALUE", "BIG_DECIMAL_LOW_VALUE", "BIG_DECIMAL_HIGH_VALUE", "NUM_NULLS", "NUM_DISTINCTS", "BIT_VECTOR", "AVG_COL_LEN", "MAX_COL_LEN", "NUM_TRUES", "NUM_FALSES", "LAST_ANALYZED"  from  "PART_COL_STATS" where "CAT_NAME" = ? and "DB_NAME" = ? and "TABLE_NAME" = ? and "COLUMN_NAME"  in (?) AND "PARTITION_NAME" in (?)  and "ENGINE" = ?  order by "PARTITION_NAME""
