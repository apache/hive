PREHOOK: query: CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@dest_j1
POSTHOOK: query: CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@dest_j1
PREHOOK: query: CREATE TABLE ss(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@ss
POSTHOOK: query: CREATE TABLE ss(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@ss
PREHOOK: query: CREATE TABLE sr(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@sr
POSTHOOK: query: CREATE TABLE sr(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@sr
PREHOOK: query: CREATE TABLE cs(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@cs
POSTHOOK: query: CREATE TABLE cs(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@cs
PREHOOK: query: INSERT OVERWRITE TABLE ss
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Input: default@src1
PREHOOK: Input: default@srcpart
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
PREHOOK: Output: default@ss
POSTHOOK: query: INSERT OVERWRITE TABLE ss
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Input: default@src1
POSTHOOK: Input: default@srcpart
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
POSTHOOK: Output: default@ss
POSTHOOK: Lineage: ss.k1 SIMPLE [(src1)x.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: ss.k2 SIMPLE [(src)y.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: ss.k3 SIMPLE [(srcpart)z.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: ss.v1 SIMPLE [(src1)x.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: ss.v2 SIMPLE [(src)y.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: ss.v3 SIMPLE [(srcpart)z.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: INSERT OVERWRITE TABLE sr
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=12)
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Input: default@src1
PREHOOK: Input: default@srcpart
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
PREHOOK: Output: default@sr
POSTHOOK: query: INSERT OVERWRITE TABLE sr
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=12)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Input: default@src1
POSTHOOK: Input: default@srcpart
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
POSTHOOK: Output: default@sr
POSTHOOK: Lineage: sr.k1 SIMPLE [(src1)x.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: sr.k2 SIMPLE [(src)y.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: sr.k3 SIMPLE [(srcpart)z.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: sr.v1 SIMPLE [(src1)x.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: sr.v2 SIMPLE [(src)y.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: sr.v3 SIMPLE [(srcpart)z.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: INSERT OVERWRITE TABLE cs
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08')
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Input: default@src1
PREHOOK: Input: default@srcpart
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
PREHOOK: Output: default@cs
POSTHOOK: query: INSERT OVERWRITE TABLE cs
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08')
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Input: default@src1
POSTHOOK: Input: default@srcpart
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
POSTHOOK: Output: default@cs
POSTHOOK: Lineage: cs.k1 SIMPLE [(src1)x.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: cs.k2 SIMPLE [(src)y.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: cs.k3 SIMPLE [(srcpart)z.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: cs.v1 SIMPLE [(src1)x.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: cs.v2 SIMPLE [(src)y.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: cs.v3 SIMPLE [(srcpart)z.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: ANALYZE TABLE ss COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@ss
PREHOOK: Output: default@ss
POSTHOOK: query: ANALYZE TABLE ss COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@ss
POSTHOOK: Output: default@ss
PREHOOK: query: ANALYZE TABLE ss COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
PREHOOK: type: QUERY
PREHOOK: Input: default@ss
PREHOOK: Output: default@ss
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE ss COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@ss
POSTHOOK: Output: default@ss
#### A masked pattern was here ####
PREHOOK: query: ANALYZE TABLE sr COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@sr
PREHOOK: Output: default@sr
POSTHOOK: query: ANALYZE TABLE sr COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@sr
POSTHOOK: Output: default@sr
PREHOOK: query: ANALYZE TABLE sr COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
PREHOOK: type: QUERY
PREHOOK: Input: default@sr
PREHOOK: Output: default@sr
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE sr COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@sr
POSTHOOK: Output: default@sr
#### A masked pattern was here ####
PREHOOK: query: ANALYZE TABLE cs COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@cs
PREHOOK: Output: default@cs
POSTHOOK: query: ANALYZE TABLE cs COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cs
POSTHOOK: Output: default@cs
PREHOOK: query: ANALYZE TABLE cs COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
PREHOOK: type: QUERY
PREHOOK: Input: default@cs
PREHOOK: Output: default@cs
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE cs COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cs
POSTHOOK: Output: default@cs
#### A masked pattern was here ####
PREHOOK: query: EXPLAIN
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
Reducer 3 <- Map 5 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 3 llap
      File Output Operator [FS_16]
        Select Operator [SEL_15] (rows=141 width=268)
          Output:["_col0","_col1","_col2"]
          Merge Join Operator [MERGEJOIN_26] (rows=141 width=268)
            Conds:RS_12._col3=RS_13._col0(Inner),Output:["_col0","_col3","_col6"]
          <-Map 5 [SIMPLE_EDGE] llap
            SHUFFLE [RS_13]
              PartitionCols:_col0
              Select Operator [SEL_8] (rows=500 width=178)
                Output:["_col0","_col1"]
                Filter Operator [FIL_24] (rows=500 width=178)
                  predicate:key is not null
                  TableScan [TS_6] (rows=500 width=178)
                    default@src,y,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
          <-Reducer 2 [SIMPLE_EDGE] llap
            SHUFFLE [RS_12]
              PartitionCols:_col3
              Merge Join Operator [MERGEJOIN_25] (rows=58 width=177)
                Conds:RS_9._col0=RS_10._col1(Inner),Output:["_col0","_col3"]
              <-Map 1 [SIMPLE_EDGE] llap
                SHUFFLE [RS_9]
                  PartitionCols:_col0
                  Select Operator [SEL_2] (rows=500 width=369)
                    Output:["_col0"]
                    Filter Operator [FIL_22] (rows=500 width=91)
                      predicate:value is not null
                      TableScan [TS_0] (rows=500 width=91)
                        default@srcpart,z,Tbl:COMPLETE,Col:COMPLETE,Output:["value"]
              <-Map 4 [SIMPLE_EDGE] llap
                SHUFFLE [RS_10]
                  PartitionCols:_col1
                  Select Operator [SEL_5] (rows=25 width=175)
                    Output:["_col0","_col1"]
                    Filter Operator [FIL_23] (rows=25 width=175)
                      predicate:(key is not null and value is not null)
                      TableScan [TS_3] (rows=25 width=175)
                        default@src1,x,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]

PREHOOK: query: EXPLAIN
select 
ss.k1,sr.k2,cs.k3,count(ss.v1),count(sr.v2),count(cs.v3)
FROM 
ss,sr,cs,src d1,src d2,src d3,src1,srcpart
where
    ss.k1 = d1.key 
and sr.k1 = d2.key 
and cs.k1 = d3.key 
and ss.k2 = sr.k2
and ss.k3 = sr.k3
and ss.v1 = src1.value
and ss.v2 = srcpart.value
and sr.v2 = cs.v2
and sr.v3 = cs.v3
and ss.v3='ssv3'
and sr.v1='srv1'
and src1.key = 'src1key'
and srcpart.key = 'srcpartkey'
and d1.value = 'd1value'
and d2.value in ('2000Q1','2000Q2','2000Q3')
and d3.value in ('2000Q1','2000Q2','2000Q3')
group by 
ss.k1,sr.k2,cs.k3
order by 
ss.k1,sr.k2,cs.k3
limit 100
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
select 
ss.k1,sr.k2,cs.k3,count(ss.v1),count(sr.v2),count(cs.v3)
FROM 
ss,sr,cs,src d1,src d2,src d3,src1,srcpart
where
    ss.k1 = d1.key 
and sr.k1 = d2.key 
and cs.k1 = d3.key 
and ss.k2 = sr.k2
and ss.k3 = sr.k3
and ss.v1 = src1.value
and ss.v2 = srcpart.value
and sr.v2 = cs.v2
and sr.v3 = cs.v3
and ss.v3='ssv3'
and sr.v1='srv1'
and src1.key = 'src1key'
and srcpart.key = 'srcpartkey'
and d1.value = 'd1value'
and d2.value in ('2000Q1','2000Q2','2000Q3')
and d3.value in ('2000Q1','2000Q2','2000Q3')
group by 
ss.k1,sr.k2,cs.k3
order by 
ss.k1,sr.k2,cs.k3
limit 100
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 10 <- Map 14 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
Reducer 11 <- Reducer 10 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE)
Reducer 16 <- Map 15 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE)
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 6 (SIMPLE_EDGE)
Reducer 3 <- Reducer 11 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 8 <- Map 12 (SIMPLE_EDGE), Map 7 (SIMPLE_EDGE)
Reducer 9 <- Map 13 (SIMPLE_EDGE), Reducer 8 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:100
    Stage-1
      Reducer 5 llap
      File Output Operator [FS_55]
        Limit [LIM_54] (rows=14 width=285)
          Number of rows:100
          Select Operator [SEL_53] (rows=14 width=285)
            Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
          <-Reducer 4 [SIMPLE_EDGE] llap
            SHUFFLE [RS_52]
              Group By Operator [GBY_50] (rows=14 width=285)
                Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["count(VALUE._col0)","count(VALUE._col1)","count(VALUE._col2)"],keys:KEY._col0, KEY._col1, KEY._col2
              <-Reducer 3 [SIMPLE_EDGE] llap
                SHUFFLE [RS_49]
                  PartitionCols:_col0, _col1, _col2
                  Group By Operator [GBY_48] (rows=14 width=285)
                    Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["count(_col13)","count(_col21)","count(_col3)"],keys:_col12, _col20, _col2
                    Select Operator [SEL_47] (rows=363 width=534)
                      Output:["_col12","_col20","_col2","_col13","_col21","_col3"]
                      Merge Join Operator [MERGEJOIN_97] (rows=363 width=534)
                        Conds:RS_44._col1, _col3=RS_45._col15, _col17(Inner),Output:["_col2","_col3","_col12","_col13","_col20","_col21"]
                      <-Reducer 11 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_45]
                          PartitionCols:_col15, _col17
                          Select Operator [SEL_40] (rows=180 width=447)
                            Output:["_col14","_col15","_col17","_col6","_col7"]
                            Merge Join Operator [MERGEJOIN_96] (rows=180 width=447)
                              Conds:RS_37._col6, _col4=RS_38._col4, _col2(Inner),Output:["_col2","_col3","_col14","_col15","_col17"]
                            <-Reducer 10 [SIMPLE_EDGE] llap
                              SHUFFLE [RS_37]
                                PartitionCols:_col6, _col4
                                Merge Join Operator [MERGEJOIN_94] (rows=40 width=352)
                                  Conds:RS_34._col3=RS_35._col1(Inner),Output:["_col2","_col3","_col4","_col6"]
                                <-Map 14 [SIMPLE_EDGE] llap
                                  SHUFFLE [RS_35]
                                    PartitionCols:_col1
                                    Select Operator [SEL_17] (rows=2 width=180)
                                      Output:["_col1"]
                                      Filter Operator [FIL_88] (rows=2 width=175)
                                        predicate:((key = 'src1key') and value is not null)
                                        TableScan [TS_15] (rows=25 width=175)
                                          default@src1,src1,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                                <-Reducer 9 [SIMPLE_EDGE] llap
                                  SHUFFLE [RS_34]
                                    PartitionCols:_col3
                                    Merge Join Operator [MERGEJOIN_93] (rows=40 width=352)
                                      Conds:RS_31._col2=RS_32._col0(Inner),Output:["_col2","_col3","_col4","_col6"]
                                    <-Map 13 [SIMPLE_EDGE] llap
                                      SHUFFLE [RS_32]
                                        PartitionCols:_col0
                                        Select Operator [SEL_14] (rows=2 width=178)
                                          Output:["_col0"]
                                          Filter Operator [FIL_87] (rows=2 width=178)
                                            predicate:((value = 'd1value') and key is not null)
                                            TableScan [TS_12] (rows=500 width=178)
                                              default@src,d1,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                                    <-Reducer 8 [SIMPLE_EDGE] llap
                                      SHUFFLE [RS_31]
                                        PartitionCols:_col2
                                        Merge Join Operator [MERGEJOIN_92] (rows=40 width=352)
                                          Conds:RS_28._col1=RS_29._col3(Inner),Output:["_col2","_col3","_col4","_col6"]
                                        <-Map 12 [SIMPLE_EDGE] llap
                                          SHUFFLE [RS_29]
                                            PartitionCols:_col3
                                            Select Operator [SEL_11] (rows=8 width=531)
                                              Output:["_col0","_col1","_col2","_col3","_col4"]
                                              Filter Operator [FIL_86] (rows=8 width=534)
                                                predicate:((v3 = 'ssv3') and k2 is not null and k3 is not null and k1 is not null and v1 is not null and v2 is not null)
                                                TableScan [TS_9] (rows=85 width=534)
                                                  default@ss,ss,Tbl:COMPLETE,Col:COMPLETE,Output:["k1","v1","k2","v2","k3","v3"]
                                        <-Map 7 [SIMPLE_EDGE] llap
                                          SHUFFLE [RS_28]
                                            PartitionCols:_col1
                                            Select Operator [SEL_8] (rows=10 width=185)
                                              Output:["_col1"]
                                              Filter Operator [FIL_85] (rows=10 width=178)
                                                predicate:((key = 'srcpartkey') and value is not null)
                                                TableScan [TS_6] (rows=2000 width=178)
                                                  default@srcpart,srcpart,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                            <-Reducer 16 [SIMPLE_EDGE] llap
                              SHUFFLE [RS_38]
                                PartitionCols:_col4, _col2
                                Merge Join Operator [MERGEJOIN_95] (rows=18 width=356)
                                  Conds:RS_24._col0=RS_25._col0(Inner),Output:["_col2","_col3","_col4","_col5"]
                                <-Map 15 [SIMPLE_EDGE] llap
                                  SHUFFLE [RS_24]
                                    PartitionCols:_col0
                                    Select Operator [SEL_20] (rows=8 width=531)
                                      Output:["_col0","_col2","_col3","_col4","_col5"]
                                      Filter Operator [FIL_89] (rows=8 width=534)
                                        predicate:((v1 = 'srv1') and k2 is not null and k3 is not null and v2 is not null and v3 is not null and k1 is not null)
                                        TableScan [TS_18] (rows=85 width=534)
                                          default@sr,sr,Tbl:COMPLETE,Col:COMPLETE,Output:["k1","v1","k2","v2","k3","v3"]
                                <-Map 17 [SIMPLE_EDGE] llap
                                  SHUFFLE [RS_25]
                                    PartitionCols:_col0
                                    Select Operator [SEL_23] (rows=7 width=178)
                                      Output:["_col0"]
                                      Filter Operator [FIL_90] (rows=7 width=178)
                                        predicate:((value) IN ('2000Q1', '2000Q2', '2000Q3') and key is not null)
                                        TableScan [TS_21] (rows=500 width=178)
                                          default@src,d2,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                      <-Reducer 2 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_44]
                          PartitionCols:_col1, _col3
                          Merge Join Operator [MERGEJOIN_91] (rows=99 width=269)
                            Conds:RS_41._col0=RS_42._col0(Inner),Output:["_col1","_col2","_col3"]
                          <-Map 1 [SIMPLE_EDGE] llap
                            SHUFFLE [RS_41]
                              PartitionCols:_col0
                              Select Operator [SEL_2] (rows=170 width=356)
                                Output:["_col0","_col1","_col2","_col3"]
                                Filter Operator [FIL_83] (rows=170 width=356)
                                  predicate:(v2 is not null and v3 is not null and k1 is not null)
                                  TableScan [TS_0] (rows=170 width=356)
                                    default@cs,cs,Tbl:COMPLETE,Col:COMPLETE,Output:["k1","v2","k3","v3"]
                          <-Map 6 [SIMPLE_EDGE] llap
                            SHUFFLE [RS_42]
                              PartitionCols:_col0
                              Select Operator [SEL_5] (rows=7 width=178)
                                Output:["_col0"]
                                Filter Operator [FIL_84] (rows=7 width=178)
                                  predicate:((value) IN ('2000Q1', '2000Q2', '2000Q3') and key is not null)
                                  TableScan [TS_3] (rows=500 width=178)
                                    default@src,d3,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]

PREHOOK: query: explain
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Union 2 (CONTAINS)
Map 11 <- Union 12 (CONTAINS)
Map 16 <- Union 12 (CONTAINS)
Map 8 <- Union 2 (CONTAINS)
Reducer 13 <- Union 12 (SIMPLE_EDGE)
Reducer 14 <- Map 17 (SIMPLE_EDGE), Reducer 13 (SIMPLE_EDGE)
Reducer 15 <- Map 18 (SIMPLE_EDGE), Reducer 14 (SIMPLE_EDGE), Union 6 (CONTAINS)
Reducer 3 <- Union 2 (SIMPLE_EDGE)
Reducer 4 <- Map 9 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
Reducer 5 <- Map 10 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE), Union 6 (CONTAINS)
Reducer 7 <- Union 6 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 7 llap
      File Output Operator [FS_59]
        Group By Operator [GBY_57] (rows=28 width=177)
          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
        <-Union 6 [SIMPLE_EDGE]
          <-Reducer 15 [CONTAINS] llap
            Reduce Output Operator [RS_56]
              PartitionCols:_col0, _col1
              Group By Operator [GBY_55] (rows=28 width=177)
                Output:["_col0","_col1"],keys:_col0, _col1
                Select Operator [SEL_51] (rows=73 width=177)
                  Output:["_col0","_col1"]
                  Merge Join Operator [MERGEJOIN_85] (rows=73 width=177)
                    Conds:RS_48._col2=RS_49._col0(Inner),Output:["_col1","_col2"]
                  <-Map 18 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_49]
                      PartitionCols:_col0
                      Select Operator [SEL_44] (rows=500 width=87)
                        Output:["_col0"]
                        Filter Operator [FIL_81] (rows=500 width=87)
                          predicate:key is not null
                          TableScan [TS_42] (rows=500 width=87)
                            default@src,y,Tbl:COMPLETE,Col:COMPLETE,Output:["key"]
                  <-Reducer 14 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_48]
                      PartitionCols:_col2
                      Merge Join Operator [MERGEJOIN_84] (rows=30 width=177)
                        Conds:RS_45._col1=RS_46._col1(Inner),Output:["_col1","_col2"]
                      <-Map 17 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_46]
                          PartitionCols:_col1
                          Select Operator [SEL_41] (rows=25 width=175)
                            Output:["_col0","_col1"]
                            Filter Operator [FIL_80] (rows=25 width=175)
                              predicate:(key is not null and value is not null)
                              TableScan [TS_39] (rows=25 width=175)
                                default@src1,x,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                      <-Reducer 13 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_45]
                          PartitionCols:_col1
                          Select Operator [SEL_38] (rows=262 width=178)
                            Output:["_col1"]
                            Group By Operator [GBY_37] (rows=262 width=178)
                              Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                            <-Union 12 [SIMPLE_EDGE]
                              <-Map 11 [CONTAINS] llap
                                Reduce Output Operator [RS_36]
                                  PartitionCols:_col0, _col1
                                  Group By Operator [GBY_35] (rows=262 width=178)
                                    Output:["_col0","_col1"],keys:_col1, _col0
                                    Select Operator [SEL_28] (rows=25 width=175)
                                      Output:["_col0","_col1"]
                                      Filter Operator [FIL_78] (rows=25 width=175)
                                        predicate:value is not null
                                        TableScan [TS_26] (rows=25 width=175)
                                          Output:["key","value"]
                              <-Map 16 [CONTAINS] llap
                                Reduce Output Operator [RS_36]
                                  PartitionCols:_col0, _col1
                                  Group By Operator [GBY_35] (rows=262 width=178)
                                    Output:["_col0","_col1"],keys:_col1, _col0
                                    Select Operator [SEL_31] (rows=500 width=178)
                                      Output:["_col0","_col1"]
                                      Filter Operator [FIL_79] (rows=500 width=178)
                                        predicate:value is not null
                                        TableScan [TS_29] (rows=500 width=178)
                                          Output:["key","value"]
          <-Reducer 5 [CONTAINS] llap
            Reduce Output Operator [RS_56]
              PartitionCols:_col0, _col1
              Group By Operator [GBY_55] (rows=28 width=177)
                Output:["_col0","_col1"],keys:_col0, _col1
                Select Operator [SEL_25] (rows=73 width=177)
                  Output:["_col0","_col1"]
                  Merge Join Operator [MERGEJOIN_83] (rows=73 width=177)
                    Conds:RS_22._col2=RS_23._col0(Inner),Output:["_col1","_col2"]
                  <-Map 10 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_23]
                      PartitionCols:_col0
                      Select Operator [SEL_18] (rows=500 width=87)
                        Output:["_col0"]
                        Filter Operator [FIL_77] (rows=500 width=87)
                          predicate:key is not null
                          TableScan [TS_16] (rows=500 width=87)
                            default@src,y,Tbl:COMPLETE,Col:COMPLETE,Output:["key"]
                  <-Reducer 4 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_22]
                      PartitionCols:_col2
                      Merge Join Operator [MERGEJOIN_82] (rows=30 width=177)
                        Conds:RS_19._col1=RS_20._col1(Inner),Output:["_col1","_col2"]
                      <-Map 9 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_20]
                          PartitionCols:_col1
                          Select Operator [SEL_15] (rows=25 width=175)
                            Output:["_col0","_col1"]
                            Filter Operator [FIL_76] (rows=25 width=175)
                              predicate:(key is not null and value is not null)
                              TableScan [TS_13] (rows=25 width=175)
                                default@src1,x,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                      <-Reducer 3 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_19]
                          PartitionCols:_col1
                          Select Operator [SEL_12] (rows=262 width=178)
                            Output:["_col1"]
                            Group By Operator [GBY_11] (rows=262 width=178)
                              Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                            <-Union 2 [SIMPLE_EDGE]
                              <-Map 1 [CONTAINS] llap
                                Reduce Output Operator [RS_10]
                                  PartitionCols:_col0, _col1
                                  Group By Operator [GBY_9] (rows=262 width=178)
                                    Output:["_col0","_col1"],keys:_col1, _col0
                                    Select Operator [SEL_2] (rows=25 width=175)
                                      Output:["_col0","_col1"]
                                      Filter Operator [FIL_74] (rows=25 width=175)
                                        predicate:value is not null
                                        TableScan [TS_0] (rows=25 width=175)
                                          Output:["key","value"]
                              <-Map 8 [CONTAINS] llap
                                Reduce Output Operator [RS_10]
                                  PartitionCols:_col0, _col1
                                  Group By Operator [GBY_9] (rows=262 width=178)
                                    Output:["_col0","_col1"],keys:_col1, _col0
                                    Select Operator [SEL_5] (rows=500 width=178)
                                      Output:["_col0","_col1"]
                                      Filter Operator [FIL_75] (rows=500 width=178)
                                        predicate:value is not null
                                        TableScan [TS_3] (rows=500 width=178)
                                          Output:["key","value"]

PREHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Union 2 (CONTAINS)
Map 10 <- Union 2 (CONTAINS)
Map 13 <- Union 14 (CONTAINS)
Map 20 <- Union 14 (CONTAINS)
Map 21 <- Union 16 (CONTAINS)
Map 24 <- Union 25 (CONTAINS)
Map 33 <- Union 25 (CONTAINS)
Map 34 <- Union 27 (CONTAINS)
Map 35 <- Union 29 (CONTAINS)
Reducer 15 <- Union 14 (SIMPLE_EDGE), Union 16 (CONTAINS)
Reducer 17 <- Union 16 (SIMPLE_EDGE)
Reducer 18 <- Map 22 (SIMPLE_EDGE), Reducer 17 (SIMPLE_EDGE)
Reducer 19 <- Map 23 (SIMPLE_EDGE), Reducer 18 (SIMPLE_EDGE), Union 6 (CONTAINS)
Reducer 26 <- Union 25 (SIMPLE_EDGE), Union 27 (CONTAINS)
Reducer 28 <- Union 27 (SIMPLE_EDGE), Union 29 (CONTAINS)
Reducer 3 <- Union 2 (SIMPLE_EDGE)
Reducer 30 <- Union 29 (SIMPLE_EDGE)
Reducer 31 <- Map 36 (SIMPLE_EDGE), Reducer 30 (SIMPLE_EDGE)
Reducer 32 <- Map 37 (SIMPLE_EDGE), Reducer 31 (SIMPLE_EDGE), Union 8 (CONTAINS)
Reducer 4 <- Map 11 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
Reducer 5 <- Map 12 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE), Union 6 (CONTAINS)
Reducer 7 <- Union 6 (SIMPLE_EDGE), Union 8 (CONTAINS)
Reducer 9 <- Union 8 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 9 llap
      File Output Operator [FS_122]
        Group By Operator [GBY_120] (rows=107 width=177)
          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
        <-Union 8 [SIMPLE_EDGE]
          <-Reducer 32 [CONTAINS] llap
            Reduce Output Operator [RS_119]
              PartitionCols:_col0, _col1
              Group By Operator [GBY_118] (rows=107 width=177)
                Output:["_col0","_col1"],keys:_col0, _col1
                Select Operator [SEL_114] (rows=124 width=177)
                  Output:["_col0","_col1"]
                  Merge Join Operator [MERGEJOIN_170] (rows=124 width=177)
                    Conds:RS_111._col2=RS_112._col0(Inner),Output:["_col2","_col5"]
                  <-Map 37 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_112]
                      PartitionCols:_col0
                      Select Operator [SEL_107] (rows=500 width=178)
                        Output:["_col0","_col1"]
                        Filter Operator [FIL_164] (rows=500 width=178)
                          predicate:key is not null
                          TableScan [TS_105] (rows=500 width=178)
                            default@src,y,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                  <-Reducer 31 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_111]
                      PartitionCols:_col2
                      Merge Join Operator [MERGEJOIN_169] (rows=51 width=86)
                        Conds:RS_108._col1=RS_109._col1(Inner),Output:["_col2"]
                      <-Map 36 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_109]
                          PartitionCols:_col1
                          Select Operator [SEL_104] (rows=25 width=175)
                            Output:["_col0","_col1"]
                            Filter Operator [FIL_163] (rows=25 width=175)
                              predicate:(key is not null and value is not null)
                              TableScan [TS_102] (rows=25 width=175)
                                default@src1,x,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                      <-Reducer 30 [SIMPLE_EDGE] llap
                        SHUFFLE [RS_108]
                          PartitionCols:_col1
                          Select Operator [SEL_101] (rows=440 width=178)
                            Output:["_col1"]
                            Group By Operator [GBY_100] (rows=440 width=178)
                              Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                            <-Union 29 [SIMPLE_EDGE]
                              <-Map 35 [CONTAINS] llap
                                Reduce Output Operator [RS_99]
                                  PartitionCols:_col0, _col1
                                  Group By Operator [GBY_98] (rows=440 width=178)
                                    Output:["_col0","_col1"],keys:_col1, _col0
                                    Select Operator [SEL_94] (rows=500 width=178)
                                      Output:["_col0","_col1"]
                                      Filter Operator [FIL_162] (rows=500 width=178)
                                        predicate:value is not null
                                        TableScan [TS_92] (rows=500 width=178)
                                          Output:["key","value"]
                              <-Reducer 28 [CONTAINS] llap
                                Reduce Output Operator [RS_99]
                                  PartitionCols:_col0, _col1
                                  Group By Operator [GBY_98] (rows=440 width=178)
                                    Output:["_col0","_col1"],keys:_col1, _col0
                                    Select Operator [SEL_91] (rows=381 width=178)
                                      Output:["_col0","_col1"]
                                      Group By Operator [GBY_90] (rows=381 width=178)
                                        Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                      <-Union 27 [SIMPLE_EDGE]
                                        <-Map 34 [CONTAINS] llap
                                          Reduce Output Operator [RS_89]
                                            PartitionCols:_col0, _col1
                                            Group By Operator [GBY_88] (rows=381 width=178)
                                              Output:["_col0","_col1"],keys:_col1, _col0
                                              Select Operator [SEL_84] (rows=500 width=178)
                                                Output:["_col0","_col1"]
                                                Filter Operator [FIL_161] (rows=500 width=178)
                                                  predicate:value is not null
                                                  TableScan [TS_82] (rows=500 width=178)
                                                    Output:["key","value"]
                                        <-Reducer 26 [CONTAINS] llap
                                          Reduce Output Operator [RS_89]
                                            PartitionCols:_col0, _col1
                                            Group By Operator [GBY_88] (rows=381 width=178)
                                              Output:["_col0","_col1"],keys:_col1, _col0
                                              Select Operator [SEL_81] (rows=262 width=178)
                                                Output:["_col0","_col1"]
                                                Group By Operator [GBY_80] (rows=262 width=178)
                                                  Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                                <-Union 25 [SIMPLE_EDGE]
                                                  <-Map 24 [CONTAINS] llap
                                                    Reduce Output Operator [RS_79]
                                                      PartitionCols:_col0, _col1
                                                      Group By Operator [GBY_78] (rows=262 width=178)
                                                        Output:["_col0","_col1"],keys:_col1, _col0
                                                        Select Operator [SEL_71] (rows=25 width=175)
                                                          Output:["_col0","_col1"]
                                                          Filter Operator [FIL_159] (rows=25 width=175)
                                                            predicate:value is not null
                                                            TableScan [TS_69] (rows=25 width=175)
                                                              Output:["key","value"]
                                                  <-Map 33 [CONTAINS] llap
                                                    Reduce Output Operator [RS_79]
                                                      PartitionCols:_col0, _col1
                                                      Group By Operator [GBY_78] (rows=262 width=178)
                                                        Output:["_col0","_col1"],keys:_col1, _col0
                                                        Select Operator [SEL_74] (rows=500 width=178)
                                                          Output:["_col0","_col1"]
                                                          Filter Operator [FIL_160] (rows=500 width=178)
                                                            predicate:value is not null
                                                            TableScan [TS_72] (rows=500 width=178)
                                                              Output:["key","value"]
          <-Reducer 7 [CONTAINS] llap
            Reduce Output Operator [RS_119]
              PartitionCols:_col0, _col1
              Group By Operator [GBY_118] (rows=107 width=177)
                Output:["_col0","_col1"],keys:_col0, _col1
                Group By Operator [GBY_67] (rows=90 width=177)
                  Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                <-Union 6 [SIMPLE_EDGE]
                  <-Reducer 19 [CONTAINS] llap
                    Reduce Output Operator [RS_66]
                      PartitionCols:_col0, _col1
                      Group By Operator [GBY_65] (rows=90 width=177)
                        Output:["_col0","_col1"],keys:_col0, _col1
                        Select Operator [SEL_61] (rows=107 width=177)
                          Output:["_col0","_col1"]
                          Merge Join Operator [MERGEJOIN_168] (rows=107 width=177)
                            Conds:RS_58._col2=RS_59._col0(Inner),Output:["_col2","_col5"]
                          <-Map 23 [SIMPLE_EDGE] llap
                            SHUFFLE [RS_59]
                              PartitionCols:_col0
                              Select Operator [SEL_54] (rows=500 width=178)
                                Output:["_col0","_col1"]
                                Filter Operator [FIL_158] (rows=500 width=178)
                                  predicate:key is not null
                                  TableScan [TS_52] (rows=500 width=178)
                                    default@src,y,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                          <-Reducer 18 [SIMPLE_EDGE] llap
                            SHUFFLE [RS_58]
                              PartitionCols:_col2
                              Merge Join Operator [MERGEJOIN_167] (rows=44 width=86)
                                Conds:RS_55._col1=RS_56._col1(Inner),Output:["_col2"]
                              <-Map 22 [SIMPLE_EDGE] llap
                                SHUFFLE [RS_56]
                                  PartitionCols:_col1
                                  Select Operator [SEL_51] (rows=25 width=175)
                                    Output:["_col0","_col1"]
                                    Filter Operator [FIL_157] (rows=25 width=175)
                                      predicate:(key is not null and value is not null)
                                      TableScan [TS_49] (rows=25 width=175)
                                        default@src1,x,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                              <-Reducer 17 [SIMPLE_EDGE] llap
                                SHUFFLE [RS_55]
                                  PartitionCols:_col1
                                  Select Operator [SEL_48] (rows=381 width=178)
                                    Output:["_col1"]
                                    Group By Operator [GBY_47] (rows=381 width=178)
                                      Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                    <-Union 16 [SIMPLE_EDGE]
                                      <-Map 21 [CONTAINS] llap
                                        Reduce Output Operator [RS_46]
                                          PartitionCols:_col0, _col1
                                          Group By Operator [GBY_45] (rows=381 width=178)
                                            Output:["_col0","_col1"],keys:_col1, _col0
                                            Select Operator [SEL_41] (rows=500 width=178)
                                              Output:["_col0","_col1"]
                                              Filter Operator [FIL_156] (rows=500 width=178)
                                                predicate:value is not null
                                                TableScan [TS_39] (rows=500 width=178)
                                                  Output:["key","value"]
                                      <-Reducer 15 [CONTAINS] llap
                                        Reduce Output Operator [RS_46]
                                          PartitionCols:_col0, _col1
                                          Group By Operator [GBY_45] (rows=381 width=178)
                                            Output:["_col0","_col1"],keys:_col1, _col0
                                            Select Operator [SEL_38] (rows=262 width=178)
                                              Output:["_col0","_col1"]
                                              Group By Operator [GBY_37] (rows=262 width=178)
                                                Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                              <-Union 14 [SIMPLE_EDGE]
                                                <-Map 13 [CONTAINS] llap
                                                  Reduce Output Operator [RS_36]
                                                    PartitionCols:_col0, _col1
                                                    Group By Operator [GBY_35] (rows=262 width=178)
                                                      Output:["_col0","_col1"],keys:_col1, _col0
                                                      Select Operator [SEL_28] (rows=25 width=175)
                                                        Output:["_col0","_col1"]
                                                        Filter Operator [FIL_154] (rows=25 width=175)
                                                          predicate:value is not null
                                                          TableScan [TS_26] (rows=25 width=175)
                                                            Output:["key","value"]
                                                <-Map 20 [CONTAINS] llap
                                                  Reduce Output Operator [RS_36]
                                                    PartitionCols:_col0, _col1
                                                    Group By Operator [GBY_35] (rows=262 width=178)
                                                      Output:["_col0","_col1"],keys:_col1, _col0
                                                      Select Operator [SEL_31] (rows=500 width=178)
                                                        Output:["_col0","_col1"]
                                                        Filter Operator [FIL_155] (rows=500 width=178)
                                                          predicate:value is not null
                                                          TableScan [TS_29] (rows=500 width=178)
                                                            Output:["key","value"]
                  <-Reducer 5 [CONTAINS] llap
                    Reduce Output Operator [RS_66]
                      PartitionCols:_col0, _col1
                      Group By Operator [GBY_65] (rows=90 width=177)
                        Output:["_col0","_col1"],keys:_col0, _col1
                        Select Operator [SEL_25] (rows=73 width=177)
                          Output:["_col0","_col1"]
                          Merge Join Operator [MERGEJOIN_166] (rows=73 width=177)
                            Conds:RS_22._col2=RS_23._col0(Inner),Output:["_col2","_col5"]
                          <-Map 12 [SIMPLE_EDGE] llap
                            SHUFFLE [RS_23]
                              PartitionCols:_col0
                              Select Operator [SEL_18] (rows=500 width=178)
                                Output:["_col0","_col1"]
                                Filter Operator [FIL_153] (rows=500 width=178)
                                  predicate:key is not null
                                  TableScan [TS_16] (rows=500 width=178)
                                    default@src,y,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                          <-Reducer 4 [SIMPLE_EDGE] llap
                            SHUFFLE [RS_22]
                              PartitionCols:_col2
                              Merge Join Operator [MERGEJOIN_165] (rows=30 width=86)
                                Conds:RS_19._col1=RS_20._col1(Inner),Output:["_col2"]
                              <-Map 11 [SIMPLE_EDGE] llap
                                SHUFFLE [RS_20]
                                  PartitionCols:_col1
                                  Select Operator [SEL_15] (rows=25 width=175)
                                    Output:["_col0","_col1"]
                                    Filter Operator [FIL_152] (rows=25 width=175)
                                      predicate:(key is not null and value is not null)
                                      TableScan [TS_13] (rows=25 width=175)
                                        default@src1,x,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                              <-Reducer 3 [SIMPLE_EDGE] llap
                                SHUFFLE [RS_19]
                                  PartitionCols:_col1
                                  Select Operator [SEL_12] (rows=262 width=178)
                                    Output:["_col1"]
                                    Group By Operator [GBY_11] (rows=262 width=178)
                                      Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                    <-Union 2 [SIMPLE_EDGE]
                                      <-Map 1 [CONTAINS] llap
                                        Reduce Output Operator [RS_10]
                                          PartitionCols:_col0, _col1
                                          Group By Operator [GBY_9] (rows=262 width=178)
                                            Output:["_col0","_col1"],keys:_col1, _col0
                                            Select Operator [SEL_2] (rows=25 width=175)
                                              Output:["_col0","_col1"]
                                              Filter Operator [FIL_150] (rows=25 width=175)
                                                predicate:value is not null
                                                TableScan [TS_0] (rows=25 width=175)
                                                  Output:["key","value"]
                                      <-Map 10 [CONTAINS] llap
                                        Reduce Output Operator [RS_10]
                                          PartitionCols:_col0, _col1
                                          Group By Operator [GBY_9] (rows=262 width=178)
                                            Output:["_col0","_col1"],keys:_col1, _col0
                                            Select Operator [SEL_5] (rows=500 width=178)
                                              Output:["_col0","_col1"]
                                              Filter Operator [FIL_151] (rows=500 width=178)
                                                predicate:value is not null
                                                TableScan [TS_3] (rows=500 width=178)
                                                  Output:["key","value"]

PREHOOK: query: EXPLAIN
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Map 2 (BROADCAST_EDGE), Map 3 (BROADCAST_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Map 1 llap
      File Output Operator [FS_16]
        Select Operator [SEL_15] (rows=605 width=10)
          Output:["_col0","_col1","_col2"]
          Map Join Operator [MAPJOIN_26] (rows=605 width=10)
            Conds:MAPJOIN_25._col3=RS_13._col0(Inner),Output:["_col0","_col3","_col6"]
          <-Map 3 [BROADCAST_EDGE] llap
            BROADCAST [RS_13]
              PartitionCols:_col0
              Select Operator [SEL_8] (rows=500 width=10)
                Output:["_col0","_col1"]
                Filter Operator [FIL_24] (rows=500 width=10)
                  predicate:key is not null
                  TableScan [TS_6] (rows=500 width=10)
                    default@src,y,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
          <-Map Join Operator [MAPJOIN_25] (rows=550 width=10)
              Conds:SEL_2._col0=RS_10._col1(Inner),Output:["_col0","_col3"]
            <-Map 2 [BROADCAST_EDGE] llap
              BROADCAST [RS_10]
                PartitionCols:_col1
                Select Operator [SEL_5] (rows=25 width=7)
                  Output:["_col0","_col1"]
                  Filter Operator [FIL_23] (rows=25 width=7)
                    predicate:(key is not null and value is not null)
                    TableScan [TS_3] (rows=25 width=7)
                      default@src1,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
            <-Select Operator [SEL_2] (rows=500 width=10)
                Output:["_col0"]
                Filter Operator [FIL_22] (rows=500 width=10)
                  predicate:value is not null
                  TableScan [TS_0] (rows=500 width=10)
                    default@srcpart,z,Tbl:COMPLETE,Col:NONE,Output:["value"]

PREHOOK: query: EXPLAIN
select 
ss.k1,sr.k2,cs.k3,count(ss.v1),count(sr.v2),count(cs.v3)
FROM 
ss,sr,cs,src d1,src d2,src d3,src1,srcpart
where
    ss.k1 = d1.key 
and sr.k1 = d2.key 
and cs.k1 = d3.key 
and ss.k2 = sr.k2
and ss.k3 = sr.k3
and ss.v1 = src1.value
and ss.v2 = srcpart.value
and sr.v2 = cs.v2
and sr.v3 = cs.v3
and ss.v3='ssv3'
and sr.v1='srv1'
and src1.key = 'src1key'
and srcpart.key = 'srcpartkey'
and d1.value = 'd1value'
and d2.value in ('2000Q1','2000Q2','2000Q3')
and d3.value in ('2000Q1','2000Q2','2000Q3')
group by 
ss.k1,sr.k2,cs.k3
order by 
ss.k1,sr.k2,cs.k3
limit 100
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
select 
ss.k1,sr.k2,cs.k3,count(ss.v1),count(sr.v2),count(cs.v3)
FROM 
ss,sr,cs,src d1,src d2,src d3,src1,srcpart
where
    ss.k1 = d1.key 
and sr.k1 = d2.key 
and cs.k1 = d3.key 
and ss.k2 = sr.k2
and ss.k3 = sr.k3
and ss.v1 = src1.value
and ss.v2 = srcpart.value
and sr.v2 = cs.v2
and sr.v3 = cs.v3
and ss.v3='ssv3'
and sr.v1='srv1'
and src1.key = 'src1key'
and srcpart.key = 'srcpartkey'
and d1.value = 'd1value'
and d2.value in ('2000Q1','2000Q2','2000Q3')
and d3.value in ('2000Q1','2000Q2','2000Q3')
group by 
ss.k1,sr.k2,cs.k3
order by 
ss.k1,sr.k2,cs.k3
limit 100
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 10 <- Map 9 (BROADCAST_EDGE)
Map 2 <- Map 1 (BROADCAST_EDGE)
Map 3 <- Map 10 (BROADCAST_EDGE), Map 2 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
Reducer 4 <- Map 3 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:100
    Stage-1
      Reducer 5 llap
      File Output Operator [FS_55]
        Limit [LIM_54] (rows=100 width=10)
          Number of rows:100
          Select Operator [SEL_53] (rows=805 width=10)
            Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
          <-Reducer 4 [SIMPLE_EDGE] llap
            SHUFFLE [RS_52]
              Group By Operator [GBY_50] (rows=805 width=10)
                Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["count(VALUE._col0)","count(VALUE._col1)","count(VALUE._col2)"],keys:KEY._col0, KEY._col1, KEY._col2
              <-Map 3 [SIMPLE_EDGE] llap
                SHUFFLE [RS_49]
                  PartitionCols:_col0, _col1, _col2
                  Group By Operator [GBY_48] (rows=1610 width=10)
                    Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["count(_col13)","count(_col21)","count(_col3)"],keys:_col12, _col20, _col2
                    Select Operator [SEL_47] (rows=1610 width=10)
                      Output:["_col12","_col20","_col2","_col13","_col21","_col3"]
                      Map Join Operator [MAPJOIN_97] (rows=1610 width=10)
                        Conds:RS_44._col1, _col3=SEL_40._col15, _col17(Inner),Output:["_col2","_col3","_col12","_col13","_col20","_col21"]
                      <-Map 2 [BROADCAST_EDGE] llap
                        BROADCAST [RS_44]
                          PartitionCols:_col1, _col3
                          Map Join Operator [MAPJOIN_91] (rows=275 width=10)
                            Conds:RS_41._col0=SEL_5._col0(Inner),Output:["_col1","_col2","_col3"]
                          <-Map 1 [BROADCAST_EDGE] llap
                            BROADCAST [RS_41]
                              PartitionCols:_col0
                              Select Operator [SEL_2] (rows=170 width=34)
                                Output:["_col0","_col1","_col2","_col3"]
                                Filter Operator [FIL_83] (rows=170 width=34)
                                  predicate:(v2 is not null and v3 is not null and k1 is not null)
                                  TableScan [TS_0] (rows=170 width=34)
                                    default@cs,cs,Tbl:COMPLETE,Col:NONE,Output:["k1","v2","k3","v3"]
                          <-Select Operator [SEL_5] (rows=250 width=10)
                              Output:["_col0"]
                              Filter Operator [FIL_84] (rows=250 width=10)
                                predicate:((value) IN ('2000Q1', '2000Q2', '2000Q3') and key is not null)
                                TableScan [TS_3] (rows=500 width=10)
                                  default@src,d3,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                      <-Select Operator [SEL_40] (rows=1464 width=10)
                          Output:["_col14","_col15","_col17","_col6","_col7"]
                          Map Join Operator [MAPJOIN_96] (rows=1464 width=10)
                            Conds:MAPJOIN_94._col6, _col4=RS_38._col4, _col2(Inner),Output:["_col2","_col3","_col14","_col15","_col17"]
                          <-Map 10 [BROADCAST_EDGE] llap
                            BROADCAST [RS_38]
                              PartitionCols:_col4, _col2
                              Map Join Operator [MAPJOIN_95] (rows=275 width=10)
                                Conds:RS_24._col0=SEL_23._col0(Inner),Output:["_col2","_col3","_col4","_col5"]
                              <-Map 9 [BROADCAST_EDGE] llap
                                BROADCAST [RS_24]
                                  PartitionCols:_col0
                                  Select Operator [SEL_20] (rows=42 width=34)
                                    Output:["_col0","_col2","_col3","_col4","_col5"]
                                    Filter Operator [FIL_89] (rows=42 width=34)
                                      predicate:((v1 = 'srv1') and k2 is not null and k3 is not null and v2 is not null and v3 is not null and k1 is not null)
                                      TableScan [TS_18] (rows=85 width=34)
                                        default@sr,sr,Tbl:COMPLETE,Col:NONE,Output:["k1","v1","k2","v2","k3","v3"]
                              <-Select Operator [SEL_23] (rows=250 width=10)
                                  Output:["_col0"]
                                  Filter Operator [FIL_90] (rows=250 width=10)
                                    predicate:((value) IN ('2000Q1', '2000Q2', '2000Q3') and key is not null)
                                    TableScan [TS_21] (rows=500 width=10)
                                      default@src,d2,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                          <-Map Join Operator [MAPJOIN_94] (rows=1331 width=10)
                              Conds:MAPJOIN_93._col3=RS_35._col1(Inner),Output:["_col2","_col3","_col4","_col6"]
                            <-Map 8 [BROADCAST_EDGE] llap
                              BROADCAST [RS_35]
                                PartitionCols:_col1
                                Select Operator [SEL_17] (rows=12 width=7)
                                  Output:["_col1"]
                                  Filter Operator [FIL_88] (rows=12 width=7)
                                    predicate:((key = 'src1key') and value is not null)
                                    TableScan [TS_15] (rows=25 width=7)
                                      default@src1,src1,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                            <-Map Join Operator [MAPJOIN_93] (rows=1210 width=10)
                                Conds:MAPJOIN_92._col2=RS_32._col0(Inner),Output:["_col2","_col3","_col4","_col6"]
                              <-Map 7 [BROADCAST_EDGE] llap
                                BROADCAST [RS_32]
                                  PartitionCols:_col0
                                  Select Operator [SEL_14] (rows=250 width=10)
                                    Output:["_col0"]
                                    Filter Operator [FIL_87] (rows=250 width=10)
                                      predicate:((value = 'd1value') and key is not null)
                                      TableScan [TS_12] (rows=500 width=10)
                                        default@src,d1,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                              <-Map Join Operator [MAPJOIN_92] (rows=1100 width=10)
                                  Conds:SEL_8._col1=RS_29._col3(Inner),Output:["_col2","_col3","_col4","_col6"]
                                <-Map 6 [BROADCAST_EDGE] llap
                                  BROADCAST [RS_29]
                                    PartitionCols:_col3
                                    Select Operator [SEL_11] (rows=42 width=34)
                                      Output:["_col0","_col1","_col2","_col3","_col4"]
                                      Filter Operator [FIL_86] (rows=42 width=34)
                                        predicate:((v3 = 'ssv3') and k2 is not null and k3 is not null and k1 is not null and v1 is not null and v2 is not null)
                                        TableScan [TS_9] (rows=85 width=34)
                                          default@ss,ss,Tbl:COMPLETE,Col:NONE,Output:["k1","v1","k2","v2","k3","v3"]
                                <-Select Operator [SEL_8] (rows=1000 width=10)
                                    Output:["_col1"]
                                    Filter Operator [FIL_85] (rows=1000 width=10)
                                      predicate:((key = 'srcpartkey') and value is not null)
                                      TableScan [TS_6] (rows=2000 width=10)
                                        default@srcpart,srcpart,Tbl:COMPLETE,Col:NONE,Output:["key","value"]

PREHOOK: query: explain
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Union 2 (CONTAINS)
Map 12 <- Union 10 (CONTAINS)
Map 6 <- Union 2 (CONTAINS)
Map 9 <- Union 10 (CONTAINS)
Reducer 11 <- Map 13 (BROADCAST_EDGE), Map 14 (BROADCAST_EDGE), Union 10 (SIMPLE_EDGE), Union 4 (CONTAINS)
Reducer 3 <- Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Union 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
Reducer 5 <- Union 4 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 5 llap
      File Output Operator [FS_59]
        Group By Operator [GBY_57] (rows=550 width=10)
          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
        <-Union 4 [SIMPLE_EDGE]
          <-Reducer 11 [CONTAINS] llap
            Reduce Output Operator [RS_56]
              PartitionCols:_col0, _col1
              Group By Operator [GBY_55] (rows=1100 width=10)
                Output:["_col0","_col1"],keys:_col0, _col1
                Select Operator [SEL_51] (rows=550 width=10)
                  Output:["_col0","_col1"]
                  Map Join Operator [MAPJOIN_85] (rows=550 width=10)
                    Conds:MAPJOIN_84._col2=RS_49._col0(Inner),Output:["_col1","_col2"]
                  <-Map 14 [BROADCAST_EDGE] llap
                    BROADCAST [RS_49]
                      PartitionCols:_col0
                      Select Operator [SEL_44] (rows=500 width=10)
                        Output:["_col0"]
                        Filter Operator [FIL_81] (rows=500 width=10)
                          predicate:key is not null
                          TableScan [TS_42] (rows=500 width=10)
                            default@src,y,Tbl:COMPLETE,Col:NONE,Output:["key"]
                  <-Map Join Operator [MAPJOIN_84] (rows=288 width=10)
                      Conds:SEL_38._col1=RS_46._col1(Inner),Output:["_col1","_col2"]
                    <-Map 13 [BROADCAST_EDGE] llap
                      BROADCAST [RS_46]
                        PartitionCols:_col1
                        Select Operator [SEL_41] (rows=25 width=7)
                          Output:["_col0","_col1"]
                          Filter Operator [FIL_80] (rows=25 width=7)
                            predicate:(key is not null and value is not null)
                            TableScan [TS_39] (rows=25 width=7)
                              default@src1,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                    <-Select Operator [SEL_38] (rows=262 width=10)
                        Output:["_col1"]
                        Group By Operator [GBY_37] (rows=262 width=10)
                          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                        <-Union 10 [SIMPLE_EDGE]
                          <-Map 12 [CONTAINS] llap
                            Reduce Output Operator [RS_36]
                              PartitionCols:_col0, _col1
                              Group By Operator [GBY_35] (rows=525 width=10)
                                Output:["_col0","_col1"],keys:_col1, _col0
                                Select Operator [SEL_31] (rows=500 width=10)
                                  Output:["_col0","_col1"]
                                  Filter Operator [FIL_79] (rows=500 width=10)
                                    predicate:value is not null
                                    TableScan [TS_29] (rows=500 width=10)
                                      Output:["key","value"]
                          <-Map 9 [CONTAINS] llap
                            Reduce Output Operator [RS_36]
                              PartitionCols:_col0, _col1
                              Group By Operator [GBY_35] (rows=525 width=10)
                                Output:["_col0","_col1"],keys:_col1, _col0
                                Select Operator [SEL_28] (rows=25 width=7)
                                  Output:["_col0","_col1"]
                                  Filter Operator [FIL_78] (rows=25 width=7)
                                    predicate:value is not null
                                    TableScan [TS_26] (rows=25 width=7)
                                      Output:["key","value"]
          <-Reducer 3 [CONTAINS] llap
            Reduce Output Operator [RS_56]
              PartitionCols:_col0, _col1
              Group By Operator [GBY_55] (rows=1100 width=10)
                Output:["_col0","_col1"],keys:_col0, _col1
                Select Operator [SEL_25] (rows=550 width=10)
                  Output:["_col0","_col1"]
                  Map Join Operator [MAPJOIN_83] (rows=550 width=10)
                    Conds:MAPJOIN_82._col2=RS_23._col0(Inner),Output:["_col1","_col2"]
                  <-Map 8 [BROADCAST_EDGE] llap
                    BROADCAST [RS_23]
                      PartitionCols:_col0
                      Select Operator [SEL_18] (rows=500 width=10)
                        Output:["_col0"]
                        Filter Operator [FIL_77] (rows=500 width=10)
                          predicate:key is not null
                          TableScan [TS_16] (rows=500 width=10)
                            default@src,y,Tbl:COMPLETE,Col:NONE,Output:["key"]
                  <-Map Join Operator [MAPJOIN_82] (rows=288 width=10)
                      Conds:SEL_12._col1=RS_20._col1(Inner),Output:["_col1","_col2"]
                    <-Map 7 [BROADCAST_EDGE] llap
                      BROADCAST [RS_20]
                        PartitionCols:_col1
                        Select Operator [SEL_15] (rows=25 width=7)
                          Output:["_col0","_col1"]
                          Filter Operator [FIL_76] (rows=25 width=7)
                            predicate:(key is not null and value is not null)
                            TableScan [TS_13] (rows=25 width=7)
                              default@src1,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                    <-Select Operator [SEL_12] (rows=262 width=10)
                        Output:["_col1"]
                        Group By Operator [GBY_11] (rows=262 width=10)
                          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                        <-Union 2 [SIMPLE_EDGE]
                          <-Map 1 [CONTAINS] llap
                            Reduce Output Operator [RS_10]
                              PartitionCols:_col0, _col1
                              Group By Operator [GBY_9] (rows=525 width=10)
                                Output:["_col0","_col1"],keys:_col1, _col0
                                Select Operator [SEL_2] (rows=25 width=7)
                                  Output:["_col0","_col1"]
                                  Filter Operator [FIL_74] (rows=25 width=7)
                                    predicate:value is not null
                                    TableScan [TS_0] (rows=25 width=7)
                                      Output:["key","value"]
                          <-Map 6 [CONTAINS] llap
                            Reduce Output Operator [RS_10]
                              PartitionCols:_col0, _col1
                              Group By Operator [GBY_9] (rows=525 width=10)
                                Output:["_col0","_col1"],keys:_col1, _col0
                                Select Operator [SEL_5] (rows=500 width=10)
                                  Output:["_col0","_col1"]
                                  Filter Operator [FIL_75] (rows=500 width=10)
                                    predicate:value is not null
                                    TableScan [TS_3] (rows=500 width=10)
                                      Output:["key","value"]

PREHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Union 2 (CONTAINS)
Map 11 <- Union 12 (CONTAINS)
Map 16 <- Union 12 (CONTAINS)
Map 17 <- Union 14 (CONTAINS)
Map 20 <- Union 21 (CONTAINS)
Map 27 <- Union 21 (CONTAINS)
Map 28 <- Union 23 (CONTAINS)
Map 29 <- Union 25 (CONTAINS)
Map 8 <- Union 2 (CONTAINS)
Reducer 13 <- Union 12 (SIMPLE_EDGE), Union 14 (CONTAINS)
Reducer 15 <- Map 18 (BROADCAST_EDGE), Map 19 (BROADCAST_EDGE), Union 14 (SIMPLE_EDGE), Union 4 (CONTAINS)
Reducer 22 <- Union 21 (SIMPLE_EDGE), Union 23 (CONTAINS)
Reducer 24 <- Union 23 (SIMPLE_EDGE), Union 25 (CONTAINS)
Reducer 26 <- Map 30 (BROADCAST_EDGE), Map 31 (BROADCAST_EDGE), Union 25 (SIMPLE_EDGE), Union 6 (CONTAINS)
Reducer 3 <- Map 10 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE), Union 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
Reducer 5 <- Union 4 (SIMPLE_EDGE), Union 6 (CONTAINS)
Reducer 7 <- Union 6 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 7 llap
      File Output Operator [FS_122]
        Group By Operator [GBY_120] (rows=550 width=10)
          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
        <-Union 6 [SIMPLE_EDGE]
          <-Reducer 26 [CONTAINS] llap
            Reduce Output Operator [RS_119]
              PartitionCols:_col0, _col1
              Group By Operator [GBY_118] (rows=1100 width=10)
                Output:["_col0","_col1"],keys:_col0, _col1
                Select Operator [SEL_114] (rows=550 width=10)
                  Output:["_col0","_col1"]
                  Map Join Operator [MAPJOIN_170] (rows=550 width=10)
                    Conds:MAPJOIN_169._col2=RS_112._col0(Inner),Output:["_col2","_col5"]
                  <-Map 31 [BROADCAST_EDGE] llap
                    BROADCAST [RS_112]
                      PartitionCols:_col0
                      Select Operator [SEL_107] (rows=500 width=10)
                        Output:["_col0","_col1"]
                        Filter Operator [FIL_164] (rows=500 width=10)
                          predicate:key is not null
                          TableScan [TS_105] (rows=500 width=10)
                            default@src,y,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                  <-Map Join Operator [MAPJOIN_169] (rows=484 width=10)
                      Conds:SEL_101._col1=RS_109._col1(Inner),Output:["_col2"]
                    <-Map 30 [BROADCAST_EDGE] llap
                      BROADCAST [RS_109]
                        PartitionCols:_col1
                        Select Operator [SEL_104] (rows=25 width=7)
                          Output:["_col0","_col1"]
                          Filter Operator [FIL_163] (rows=25 width=7)
                            predicate:(key is not null and value is not null)
                            TableScan [TS_102] (rows=25 width=7)
                              default@src1,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                    <-Select Operator [SEL_101] (rows=440 width=10)
                        Output:["_col1"]
                        Group By Operator [GBY_100] (rows=440 width=10)
                          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                        <-Union 25 [SIMPLE_EDGE]
                          <-Map 29 [CONTAINS] llap
                            Reduce Output Operator [RS_99]
                              PartitionCols:_col0, _col1
                              Group By Operator [GBY_98] (rows=881 width=10)
                                Output:["_col0","_col1"],keys:_col1, _col0
                                Select Operator [SEL_94] (rows=500 width=10)
                                  Output:["_col0","_col1"]
                                  Filter Operator [FIL_162] (rows=500 width=10)
                                    predicate:value is not null
                                    TableScan [TS_92] (rows=500 width=10)
                                      Output:["key","value"]
                          <-Reducer 24 [CONTAINS] llap
                            Reduce Output Operator [RS_99]
                              PartitionCols:_col0, _col1
                              Group By Operator [GBY_98] (rows=881 width=10)
                                Output:["_col0","_col1"],keys:_col1, _col0
                                Select Operator [SEL_91] (rows=381 width=10)
                                  Output:["_col0","_col1"]
                                  Group By Operator [GBY_90] (rows=381 width=10)
                                    Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                  <-Union 23 [SIMPLE_EDGE]
                                    <-Map 28 [CONTAINS] llap
                                      Reduce Output Operator [RS_89]
                                        PartitionCols:_col0, _col1
                                        Group By Operator [GBY_88] (rows=762 width=10)
                                          Output:["_col0","_col1"],keys:_col1, _col0
                                          Select Operator [SEL_84] (rows=500 width=10)
                                            Output:["_col0","_col1"]
                                            Filter Operator [FIL_161] (rows=500 width=10)
                                              predicate:value is not null
                                              TableScan [TS_82] (rows=500 width=10)
                                                Output:["key","value"]
                                    <-Reducer 22 [CONTAINS] llap
                                      Reduce Output Operator [RS_89]
                                        PartitionCols:_col0, _col1
                                        Group By Operator [GBY_88] (rows=762 width=10)
                                          Output:["_col0","_col1"],keys:_col1, _col0
                                          Select Operator [SEL_81] (rows=262 width=10)
                                            Output:["_col0","_col1"]
                                            Group By Operator [GBY_80] (rows=262 width=10)
                                              Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                            <-Union 21 [SIMPLE_EDGE]
                                              <-Map 20 [CONTAINS] llap
                                                Reduce Output Operator [RS_79]
                                                  PartitionCols:_col0, _col1
                                                  Group By Operator [GBY_78] (rows=525 width=10)
                                                    Output:["_col0","_col1"],keys:_col1, _col0
                                                    Select Operator [SEL_71] (rows=25 width=7)
                                                      Output:["_col0","_col1"]
                                                      Filter Operator [FIL_159] (rows=25 width=7)
                                                        predicate:value is not null
                                                        TableScan [TS_69] (rows=25 width=7)
                                                          Output:["key","value"]
                                              <-Map 27 [CONTAINS] llap
                                                Reduce Output Operator [RS_79]
                                                  PartitionCols:_col0, _col1
                                                  Group By Operator [GBY_78] (rows=525 width=10)
                                                    Output:["_col0","_col1"],keys:_col1, _col0
                                                    Select Operator [SEL_74] (rows=500 width=10)
                                                      Output:["_col0","_col1"]
                                                      Filter Operator [FIL_160] (rows=500 width=10)
                                                        predicate:value is not null
                                                        TableScan [TS_72] (rows=500 width=10)
                                                          Output:["key","value"]
          <-Reducer 5 [CONTAINS] llap
            Reduce Output Operator [RS_119]
              PartitionCols:_col0, _col1
              Group By Operator [GBY_118] (rows=1100 width=10)
                Output:["_col0","_col1"],keys:_col0, _col1
                Group By Operator [GBY_67] (rows=550 width=10)
                  Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                <-Union 4 [SIMPLE_EDGE]
                  <-Reducer 15 [CONTAINS] llap
                    Reduce Output Operator [RS_66]
                      PartitionCols:_col0, _col1
                      Group By Operator [GBY_65] (rows=1100 width=10)
                        Output:["_col0","_col1"],keys:_col0, _col1
                        Select Operator [SEL_61] (rows=550 width=10)
                          Output:["_col0","_col1"]
                          Map Join Operator [MAPJOIN_168] (rows=550 width=10)
                            Conds:MAPJOIN_167._col2=RS_59._col0(Inner),Output:["_col2","_col5"]
                          <-Map 19 [BROADCAST_EDGE] llap
                            BROADCAST [RS_59]
                              PartitionCols:_col0
                              Select Operator [SEL_54] (rows=500 width=10)
                                Output:["_col0","_col1"]
                                Filter Operator [FIL_158] (rows=500 width=10)
                                  predicate:key is not null
                                  TableScan [TS_52] (rows=500 width=10)
                                    default@src,y,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                          <-Map Join Operator [MAPJOIN_167] (rows=419 width=10)
                              Conds:SEL_48._col1=RS_56._col1(Inner),Output:["_col2"]
                            <-Map 18 [BROADCAST_EDGE] llap
                              BROADCAST [RS_56]
                                PartitionCols:_col1
                                Select Operator [SEL_51] (rows=25 width=7)
                                  Output:["_col0","_col1"]
                                  Filter Operator [FIL_157] (rows=25 width=7)
                                    predicate:(key is not null and value is not null)
                                    TableScan [TS_49] (rows=25 width=7)
                                      default@src1,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                            <-Select Operator [SEL_48] (rows=381 width=10)
                                Output:["_col1"]
                                Group By Operator [GBY_47] (rows=381 width=10)
                                  Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                <-Union 14 [SIMPLE_EDGE]
                                  <-Map 17 [CONTAINS] llap
                                    Reduce Output Operator [RS_46]
                                      PartitionCols:_col0, _col1
                                      Group By Operator [GBY_45] (rows=762 width=10)
                                        Output:["_col0","_col1"],keys:_col1, _col0
                                        Select Operator [SEL_41] (rows=500 width=10)
                                          Output:["_col0","_col1"]
                                          Filter Operator [FIL_156] (rows=500 width=10)
                                            predicate:value is not null
                                            TableScan [TS_39] (rows=500 width=10)
                                              Output:["key","value"]
                                  <-Reducer 13 [CONTAINS] llap
                                    Reduce Output Operator [RS_46]
                                      PartitionCols:_col0, _col1
                                      Group By Operator [GBY_45] (rows=762 width=10)
                                        Output:["_col0","_col1"],keys:_col1, _col0
                                        Select Operator [SEL_38] (rows=262 width=10)
                                          Output:["_col0","_col1"]
                                          Group By Operator [GBY_37] (rows=262 width=10)
                                            Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                          <-Union 12 [SIMPLE_EDGE]
                                            <-Map 11 [CONTAINS] llap
                                              Reduce Output Operator [RS_36]
                                                PartitionCols:_col0, _col1
                                                Group By Operator [GBY_35] (rows=525 width=10)
                                                  Output:["_col0","_col1"],keys:_col1, _col0
                                                  Select Operator [SEL_28] (rows=25 width=7)
                                                    Output:["_col0","_col1"]
                                                    Filter Operator [FIL_154] (rows=25 width=7)
                                                      predicate:value is not null
                                                      TableScan [TS_26] (rows=25 width=7)
                                                        Output:["key","value"]
                                            <-Map 16 [CONTAINS] llap
                                              Reduce Output Operator [RS_36]
                                                PartitionCols:_col0, _col1
                                                Group By Operator [GBY_35] (rows=525 width=10)
                                                  Output:["_col0","_col1"],keys:_col1, _col0
                                                  Select Operator [SEL_31] (rows=500 width=10)
                                                    Output:["_col0","_col1"]
                                                    Filter Operator [FIL_155] (rows=500 width=10)
                                                      predicate:value is not null
                                                      TableScan [TS_29] (rows=500 width=10)
                                                        Output:["key","value"]
                  <-Reducer 3 [CONTAINS] llap
                    Reduce Output Operator [RS_66]
                      PartitionCols:_col0, _col1
                      Group By Operator [GBY_65] (rows=1100 width=10)
                        Output:["_col0","_col1"],keys:_col0, _col1
                        Select Operator [SEL_25] (rows=550 width=10)
                          Output:["_col0","_col1"]
                          Map Join Operator [MAPJOIN_166] (rows=550 width=10)
                            Conds:MAPJOIN_165._col2=RS_23._col0(Inner),Output:["_col2","_col5"]
                          <-Map 10 [BROADCAST_EDGE] llap
                            BROADCAST [RS_23]
                              PartitionCols:_col0
                              Select Operator [SEL_18] (rows=500 width=10)
                                Output:["_col0","_col1"]
                                Filter Operator [FIL_153] (rows=500 width=10)
                                  predicate:key is not null
                                  TableScan [TS_16] (rows=500 width=10)
                                    default@src,y,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                          <-Map Join Operator [MAPJOIN_165] (rows=288 width=10)
                              Conds:SEL_12._col1=RS_20._col1(Inner),Output:["_col2"]
                            <-Map 9 [BROADCAST_EDGE] llap
                              BROADCAST [RS_20]
                                PartitionCols:_col1
                                Select Operator [SEL_15] (rows=25 width=7)
                                  Output:["_col0","_col1"]
                                  Filter Operator [FIL_152] (rows=25 width=7)
                                    predicate:(key is not null and value is not null)
                                    TableScan [TS_13] (rows=25 width=7)
                                      default@src1,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                            <-Select Operator [SEL_12] (rows=262 width=10)
                                Output:["_col1"]
                                Group By Operator [GBY_11] (rows=262 width=10)
                                  Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                <-Union 2 [SIMPLE_EDGE]
                                  <-Map 1 [CONTAINS] llap
                                    Reduce Output Operator [RS_10]
                                      PartitionCols:_col0, _col1
                                      Group By Operator [GBY_9] (rows=525 width=10)
                                        Output:["_col0","_col1"],keys:_col1, _col0
                                        Select Operator [SEL_2] (rows=25 width=7)
                                          Output:["_col0","_col1"]
                                          Filter Operator [FIL_150] (rows=25 width=7)
                                            predicate:value is not null
                                            TableScan [TS_0] (rows=25 width=7)
                                              Output:["key","value"]
                                  <-Map 8 [CONTAINS] llap
                                    Reduce Output Operator [RS_10]
                                      PartitionCols:_col0, _col1
                                      Group By Operator [GBY_9] (rows=525 width=10)
                                        Output:["_col0","_col1"],keys:_col1, _col0
                                        Select Operator [SEL_5] (rows=500 width=10)
                                          Output:["_col0","_col1"]
                                          Filter Operator [FIL_151] (rows=500 width=10)
                                            predicate:value is not null
                                            TableScan [TS_3] (rows=500 width=10)
                                              Output:["key","value"]

PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@srcbucket_mapjoin
POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@srcbucket_mapjoin
PREHOOK: query: CREATE TABLE tab_part (key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tab_part
POSTHOOK: query: CREATE TABLE tab_part (key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tab_part
PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@srcbucket_mapjoin_part
POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@srcbucket_mapjoin_part
PREHOOK: query: load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE srcbucket_mapjoin partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin
POSTHOOK: query: load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE srcbucket_mapjoin partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin
POSTHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
PREHOOK: query: load data local inpath '../../data/files/srcbucket22.txt' INTO TABLE srcbucket_mapjoin partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
POSTHOOK: query: load data local inpath '../../data/files/srcbucket22.txt' INTO TABLE srcbucket_mapjoin partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
PREHOOK: query: load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin_part
POSTHOOK: query: load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin_part
POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
PREHOOK: query: load data local inpath '../../data/files/srcbucket21.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
POSTHOOK: query: load data local inpath '../../data/files/srcbucket21.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
PREHOOK: query: load data local inpath '../../data/files/srcbucket22.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
POSTHOOK: query: load data local inpath '../../data/files/srcbucket22.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
PREHOOK: query: load data local inpath '../../data/files/srcbucket23.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
POSTHOOK: query: load data local inpath '../../data/files/srcbucket23.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
PREHOOK: query: insert overwrite table tab_part partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin_part
PREHOOK: type: QUERY
PREHOOK: Input: default@srcbucket_mapjoin_part
PREHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
PREHOOK: Output: default@tab_part@ds=2008-04-08
POSTHOOK: query: insert overwrite table tab_part partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin_part
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcbucket_mapjoin_part
POSTHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
POSTHOOK: Output: default@tab_part@ds=2008-04-08
POSTHOOK: Lineage: tab_part PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin_part)srcbucket_mapjoin_part.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: tab_part PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin_part)srcbucket_mapjoin_part.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: CREATE TABLE tab(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tab
POSTHOOK: query: CREATE TABLE tab(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tab
PREHOOK: query: insert overwrite table tab partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin
PREHOOK: type: QUERY
PREHOOK: Input: default@srcbucket_mapjoin
PREHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
PREHOOK: Output: default@tab@ds=2008-04-08
POSTHOOK: query: insert overwrite table tab partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcbucket_mapjoin
POSTHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
POSTHOOK: Output: default@tab@ds=2008-04-08
POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: CREATE TABLE tab2(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tab2
POSTHOOK: query: CREATE TABLE tab2(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tab2
PREHOOK: query: insert overwrite table tab2 partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin
PREHOOK: type: QUERY
PREHOOK: Input: default@srcbucket_mapjoin
PREHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
PREHOOK: Output: default@tab2@ds=2008-04-08
POSTHOOK: query: insert overwrite table tab2 partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcbucket_mapjoin
POSTHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
POSTHOOK: Output: default@tab2@ds=2008-04-08
POSTHOOK: Lineage: tab2 PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: tab2 PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key
PREHOOK: type: QUERY
POSTHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key
POSTHOOK: type: QUERY
Plan optimized by CBO.

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Map 1 llap
      File Output Operator [FS_10]
        Merge Join Operator [MERGEJOIN_15] (rows=266 width=10)
          Conds:SEL_2._col0=SEL_5._col0(Inner),Output:["_col0","_col1"]
        <-Select Operator [SEL_5] (rows=242 width=10)
            Output:["_col0"]
            Filter Operator [FIL_14] (rows=242 width=10)
              predicate:key is not null
              TableScan [TS_3] (rows=242 width=10)
                default@tab,s3,Tbl:COMPLETE,Col:NONE,Output:["key"]
        <-Select Operator [SEL_2] (rows=242 width=10)
            Output:["_col0","_col1"]
            Filter Operator [FIL_13] (rows=242 width=10)
              predicate:key is not null
              TableScan [TS_0] (rows=242 width=10)
                default@tab,s1,Tbl:COMPLETE,Col:NONE,Output:["key","value"]

PREHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key join tab s2 on s1.value=s2.value
PREHOOK: type: QUERY
POSTHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key join tab s2 on s1.value=s2.value
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 2 llap
      File Output Operator [FS_16]
        Merge Join Operator [MERGEJOIN_27] (rows=292 width=10)
          Conds:RS_12._col1=RS_13._col1(Inner),Output:["_col0","_col1"]
        <-Map 1 [SIMPLE_EDGE] llap
          SHUFFLE [RS_12]
            PartitionCols:_col1
            Merge Join Operator [MERGEJOIN_25] (rows=266 width=10)
              Conds:SEL_2._col0=SEL_5._col0(Inner),Output:["_col0","_col1"]
            <-Select Operator [SEL_5] (rows=242 width=10)
                Output:["_col0"]
                Filter Operator [FIL_23] (rows=242 width=10)
                  predicate:key is not null
                  TableScan [TS_3] (rows=242 width=10)
                    default@tab,s3,Tbl:COMPLETE,Col:NONE,Output:["key"]
            <-Select Operator [SEL_2] (rows=242 width=10)
                Output:["_col0","_col1"]
                Filter Operator [FIL_22] (rows=242 width=10)
                  predicate:(key is not null and value is not null)
                  TableScan [TS_0] (rows=242 width=10)
                    default@tab,s1,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
        <-Map 4 [SIMPLE_EDGE] llap
          SHUFFLE [RS_13]
            PartitionCols:_col1
            Select Operator [SEL_8] (rows=242 width=10)
              Output:["_col1"]
              Filter Operator [FIL_24] (rows=242 width=10)
                predicate:value is not null
                TableScan [TS_6] (rows=242 width=10)
                  default@tab,s2,Tbl:COMPLETE,Col:NONE,Output:["value"]

PREHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab2 s3 on s1.key=s3.key
PREHOOK: type: QUERY
POSTHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab2 s3 on s1.key=s3.key
POSTHOOK: type: QUERY
Plan optimized by CBO.

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Map 1 llap
      File Output Operator [FS_10]
        Merge Join Operator [MERGEJOIN_15] (rows=266 width=10)
          Conds:SEL_2._col0=SEL_5._col0(Inner),Output:["_col0","_col1"]
        <-Select Operator [SEL_5] (rows=242 width=10)
            Output:["_col0"]
            Filter Operator [FIL_14] (rows=242 width=10)
              predicate:key is not null
              TableScan [TS_3] (rows=242 width=10)
                default@tab2,s3,Tbl:COMPLETE,Col:NONE,Output:["key"]
        <-Select Operator [SEL_2] (rows=242 width=10)
            Output:["_col0","_col1"]
            Filter Operator [FIL_13] (rows=242 width=10)
              predicate:key is not null
              TableScan [TS_0] (rows=242 width=10)
                default@tab,s1,Tbl:COMPLETE,Col:NONE,Output:["key","value"]

PREHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab2 s3 on s1.key=s3.key join tab2 s2 on s1.value=s2.value
PREHOOK: type: QUERY
POSTHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab2 s3 on s1.key=s3.key join tab2 s2 on s1.value=s2.value
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 2 llap
      File Output Operator [FS_16]
        Merge Join Operator [MERGEJOIN_27] (rows=292 width=10)
          Conds:RS_12._col1=RS_13._col1(Inner),Output:["_col0","_col1"]
        <-Map 1 [SIMPLE_EDGE] llap
          SHUFFLE [RS_12]
            PartitionCols:_col1
            Merge Join Operator [MERGEJOIN_25] (rows=266 width=10)
              Conds:SEL_2._col0=SEL_5._col0(Inner),Output:["_col0","_col1"]
            <-Select Operator [SEL_5] (rows=242 width=10)
                Output:["_col0"]
                Filter Operator [FIL_23] (rows=242 width=10)
                  predicate:key is not null
                  TableScan [TS_3] (rows=242 width=10)
                    default@tab2,s3,Tbl:COMPLETE,Col:NONE,Output:["key"]
            <-Select Operator [SEL_2] (rows=242 width=10)
                Output:["_col0","_col1"]
                Filter Operator [FIL_22] (rows=242 width=10)
                  predicate:(key is not null and value is not null)
                  TableScan [TS_0] (rows=242 width=10)
                    default@tab,s1,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
        <-Map 4 [SIMPLE_EDGE] llap
          SHUFFLE [RS_13]
            PartitionCols:_col1
            Select Operator [SEL_8] (rows=242 width=10)
              Output:["_col1"]
              Filter Operator [FIL_24] (rows=242 width=10)
                predicate:value is not null
                TableScan [TS_6] (rows=242 width=10)
                  default@tab2,s2,Tbl:COMPLETE,Col:NONE,Output:["value"]

PREHOOK: query: explain
select count(*) from (select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key
UNION  ALL
select s2.key as key, s2.value as value from tab s2
) a join tab_part b on (a.key = b.key)
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key
UNION  ALL
select s2.key as key, s2.value as value from tab s2
) a join tab_part b on (a.key = b.key)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Union 2 (CONTAINS)
Map 6 <- Union 2 (CONTAINS)
Reducer 3 <- Map 7 (SIMPLE_EDGE), Union 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (CUSTOM_SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 4 llap
      File Output Operator [FS_26]
        Group By Operator [GBY_24] (rows=1 width=8)
          Output:["_col0"],aggregations:["count(VALUE._col0)"]
        <-Reducer 3 [CUSTOM_SIMPLE_EDGE] llap
          PARTITION_ONLY_SHUFFLE [RS_23]
            Group By Operator [GBY_22] (rows=1 width=8)
              Output:["_col0"],aggregations:["count()"]
              Merge Join Operator [MERGEJOIN_39] (rows=558 width=10)
                Conds:Union 2._col0=RS_19._col0(Inner)
              <-Map 7 [SIMPLE_EDGE] llap
                SHUFFLE [RS_19]
                  PartitionCols:_col0
                  Select Operator [SEL_17] (rows=500 width=10)
                    Output:["_col0"]
                    Filter Operator [FIL_36] (rows=500 width=10)
                      predicate:key is not null
                      TableScan [TS_15] (rows=500 width=10)
                        default@tab_part,b,Tbl:COMPLETE,Col:NONE,Output:["key"]
              <-Union 2 [SIMPLE_EDGE]
                <-Map 1 [CONTAINS] llap
                  Reduce Output Operator [RS_18]
                    PartitionCols:_col0
                    Merge Join Operator [MERGEJOIN_37] (rows=266 width=10)
                      Conds:SEL_2._col0=SEL_5._col0(Inner),Output:["_col0"]
                    <-Select Operator [SEL_5] (rows=242 width=10)
                        Output:["_col0"]
                        Filter Operator [FIL_34] (rows=242 width=10)
                          predicate:key is not null
                          TableScan [TS_3] (rows=242 width=10)
                            default@tab,s3,Tbl:COMPLETE,Col:NONE,Output:["key"]
                    <-Select Operator [SEL_2] (rows=242 width=10)
                        Output:["_col0"]
                        Filter Operator [FIL_33] (rows=242 width=10)
                          predicate:key is not null
                          TableScan [TS_0] (rows=242 width=10)
                            Output:["key"]
                <-Map 6 [CONTAINS] llap
                  Reduce Output Operator [RS_18]
                    PartitionCols:_col0
                    Select Operator [SEL_12] (rows=242 width=10)
                      Output:["_col0"]
                      Filter Operator [FIL_35] (rows=242 width=10)
                        predicate:key is not null
                        TableScan [TS_10] (rows=242 width=10)
                          Output:["key"]

PREHOOK: query: explain
select count(*) from (select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key join tab s2 on s1.value=s2.value
UNION  ALL
select s2.key as key, s2.value as value from tab s2
) a join tab_part b on (a.key = b.key)
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key join tab s2 on s1.value=s2.value
UNION  ALL
select s2.key as key, s2.value as value from tab s2
) a join tab_part b on (a.key = b.key)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 8 <- Union 3 (CONTAINS)
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 7 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 4 <- Map 9 (SIMPLE_EDGE), Union 3 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (CUSTOM_SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 5 llap
      File Output Operator [FS_32]
        Group By Operator [GBY_30] (rows=1 width=8)
          Output:["_col0"],aggregations:["count(VALUE._col0)"]
        <-Reducer 4 [CUSTOM_SIMPLE_EDGE] llap
          PARTITION_ONLY_SHUFFLE [RS_29]
            Group By Operator [GBY_28] (rows=1 width=8)
              Output:["_col0"],aggregations:["count()"]
              Merge Join Operator [MERGEJOIN_51] (rows=587 width=10)
                Conds:Union 3._col0=RS_25._col0(Inner)
              <-Map 9 [SIMPLE_EDGE] llap
                SHUFFLE [RS_25]
                  PartitionCols:_col0
                  Select Operator [SEL_23] (rows=500 width=10)
                    Output:["_col0"]
                    Filter Operator [FIL_47] (rows=500 width=10)
                      predicate:key is not null
                      TableScan [TS_21] (rows=500 width=10)
                        default@tab_part,b,Tbl:COMPLETE,Col:NONE,Output:["key"]
              <-Union 3 [SIMPLE_EDGE]
                <-Map 8 [CONTAINS] llap
                  Reduce Output Operator [RS_24]
                    PartitionCols:_col0
                    Select Operator [SEL_18] (rows=242 width=10)
                      Output:["_col0"]
                      Filter Operator [FIL_46] (rows=242 width=10)
                        predicate:key is not null
                        TableScan [TS_16] (rows=242 width=10)
                          Output:["key"]
                <-Reducer 2 [CONTAINS] llap
                  Reduce Output Operator [RS_24]
                    PartitionCols:_col0
                    Merge Join Operator [MERGEJOIN_50] (rows=292 width=10)
                      Conds:RS_12._col1=RS_13._col1(Inner),Output:["_col0"]
                    <-Map 1 [SIMPLE_EDGE] llap
                      SHUFFLE [RS_12]
                        PartitionCols:_col1
                        Merge Join Operator [MERGEJOIN_48] (rows=266 width=10)
                          Conds:SEL_2._col0=SEL_5._col0(Inner),Output:["_col0","_col1"]
                        <-Select Operator [SEL_5] (rows=242 width=10)
                            Output:["_col0"]
                            Filter Operator [FIL_44] (rows=242 width=10)
                              predicate:key is not null
                              TableScan [TS_3] (rows=242 width=10)
                                default@tab,s3,Tbl:COMPLETE,Col:NONE,Output:["key"]
                        <-Select Operator [SEL_2] (rows=242 width=10)
                            Output:["_col0","_col1"]
                            Filter Operator [FIL_43] (rows=242 width=10)
                              predicate:(key is not null and value is not null)
                              TableScan [TS_0] (rows=242 width=10)
                                default@tab,s1,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                    <-Map 7 [SIMPLE_EDGE] llap
                      SHUFFLE [RS_13]
                        PartitionCols:_col1
                        Select Operator [SEL_8] (rows=242 width=10)
                          Output:["_col1"]
                          Filter Operator [FIL_45] (rows=242 width=10)
                            predicate:value is not null
                            TableScan [TS_6] (rows=242 width=10)
                              default@tab,s2,Tbl:COMPLETE,Col:NONE,Output:["value"]

PREHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union all select * from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union all select * from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Map 1 <- Map 6 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 12 <- Union 9 (CONTAINS)
        Map 13 <- Union 9 (CONTAINS)
        Map 16 <- Map 17 (BROADCAST_EDGE)
        Map 18 <- Map 16 (BROADCAST_EDGE), Union 4 (CONTAINS)
        Map 19 <- Map 16 (BROADCAST_EDGE), Union 4 (CONTAINS)
        Map 20 <- Map 16 (BROADCAST_EDGE), Union 4 (CONTAINS)
        Map 21 <- Map 16 (BROADCAST_EDGE), Union 4 (CONTAINS)
        Map 5 <- Map 6 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 8 <- Union 9 (CONTAINS)
        Reducer 10 <- Map 14 (SIMPLE_EDGE), Union 9 (SIMPLE_EDGE)
        Reducer 11 <- Map 15 (SIMPLE_EDGE), Reducer 10 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 3 <- Map 7 (SIMPLE_EDGE), Union 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: src1
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: string)
                          1 _col1 (type: string)
                        outputColumnNames: _col1
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 577 Data size: 6053 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 577 Data size: 6053 Basic stats: COMPLETE Column stats: NONE
            Execution mode: llap
            LLAP IO: no inputs
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 1025 Data size: 10815 Basic stats: COMPLETE Column stats: NONE
            Execution mode: llap
            LLAP IO: no inputs
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 1025 Data size: 10815 Basic stats: COMPLETE Column stats: NONE
            Execution mode: llap
            LLAP IO: no inputs
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: x
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (key is not null and value is not null) (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col1 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col1 (type: string)
                        Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: y
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: key is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: x
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (key is not null and value is not null) (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col1, _col3
                        input vertices:
                          1 Map 17
                        Statistics: Num rows: 27 Data size: 210 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 27 Data size: 210 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: string), _col3 (type: string)
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 27 Data size: 210 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: string), _col3 (type: string)
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 27 Data size: 210 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: string), _col3 (type: string)
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 27 Data size: 210 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: string), _col3 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 17 
            Map Operator Tree:
                TableScan
                  alias: y
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: key is not null (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 18 
            Map Operator Tree:
                TableScan
                  alias: src1
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          0 Map 16
                        Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col0 (type: string), _col3 (type: string)
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Execution mode: llap
            LLAP IO: no inputs
        Map 19 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          0 Map 16
                        Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col0 (type: string), _col3 (type: string)
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Execution mode: llap
            LLAP IO: no inputs
        Map 20 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          0 Map 16
                        Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col0 (type: string), _col3 (type: string)
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Execution mode: llap
            LLAP IO: no inputs
        Map 21 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          0 Map 16
                        Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col0 (type: string), _col3 (type: string)
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Execution mode: llap
            LLAP IO: no inputs
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: string)
                          1 _col1 (type: string)
                        outputColumnNames: _col1
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 577 Data size: 6053 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 577 Data size: 6053 Basic stats: COMPLETE Column stats: NONE
            Execution mode: llap
            LLAP IO: no inputs
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: x
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (key is not null and value is not null) (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col1 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col1 (type: string)
                        Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: string)
                      Reduce Output Operator
                        key expressions: _col1 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col1 (type: string)
                        Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: y
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: key is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: src1
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 1025 Data size: 10815 Basic stats: COMPLETE Column stats: NONE
            Execution mode: llap
            LLAP IO: no inputs
        Reducer 10 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: string)
                  1 _col1 (type: string)
                outputColumnNames: _col1
                Statistics: Num rows: 1127 Data size: 11896 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: string)
                  Statistics: Num rows: 1127 Data size: 11896 Basic stats: COMPLETE Column stats: NONE
        Reducer 11 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col1 (type: string)
                  1 _col0 (type: string)
                outputColumnNames: _col1, _col4
                Statistics: Num rows: 1239 Data size: 13085 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: string), _col4 (type: string)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1239 Data size: 13085 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 3 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col1 (type: string)
                  1 _col0 (type: string)
                outputColumnNames: _col1, _col4
                Statistics: Num rows: 634 Data size: 6658 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: string), _col4 (type: string)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 634 Data size: 6658 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Union 2 
            Vertex: Union 2
        Union 4 
            Vertex: Union 4
        Union 9 
            Vertex: Union 9

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Union 2 (CONTAINS)
Map 12 <- Union 13 (CONTAINS)
Map 19 <- Union 13 (CONTAINS)
Map 20 <- Union 15 (CONTAINS)
Map 23 <- Map 24 (BROADCAST_EDGE)
Map 25 <- Union 26 (CONTAINS)
Map 32 <- Union 26 (CONTAINS)
Map 33 <- Union 28 (CONTAINS)
Map 34 <- Union 30 (CONTAINS)
Map 9 <- Union 2 (CONTAINS)
Reducer 14 <- Union 13 (SIMPLE_EDGE), Union 15 (CONTAINS)
Reducer 16 <- Union 15 (SIMPLE_EDGE)
Reducer 17 <- Map 21 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE)
Reducer 18 <- Map 22 (SIMPLE_EDGE), Reducer 17 (SIMPLE_EDGE), Union 5 (CONTAINS)
Reducer 27 <- Union 26 (SIMPLE_EDGE), Union 28 (CONTAINS)
Reducer 29 <- Union 28 (SIMPLE_EDGE), Union 30 (CONTAINS)
Reducer 3 <- Map 10 (BROADCAST_EDGE), Union 2 (SIMPLE_EDGE)
Reducer 31 <- Map 23 (BROADCAST_EDGE), Union 30 (SIMPLE_EDGE), Union 7 (CONTAINS)
Reducer 4 <- Map 11 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE), Union 5 (CONTAINS)
Reducer 6 <- Union 5 (SIMPLE_EDGE), Union 7 (CONTAINS)
Reducer 8 <- Union 7 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 8 llap
      File Output Operator [FS_122]
        Group By Operator [GBY_120] (rows=530 width=10)
          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
        <-Union 7 [SIMPLE_EDGE]
          <-Reducer 31 [CONTAINS] llap
            Reduce Output Operator [RS_119]
              PartitionCols:_col0, _col1
              Group By Operator [GBY_118] (rows=1061 width=10)
                Output:["_col0","_col1"],keys:_col0, _col1
                Select Operator [SEL_114] (rows=484 width=10)
                  Output:["_col0","_col1"]
                  Map Join Operator [MAPJOIN_167] (rows=484 width=10)
                    Conds:RS_111._col1=SEL_107._col1(Inner),Output:["_col0","_col3"]
                  <-Map 23 [BROADCAST_EDGE] llap
                    BROADCAST [RS_111]
                      PartitionCols:_col1
                      Map Join Operator [MAPJOIN_166] (rows=27 width=7)
                        Conds:SEL_71._col0=RS_109._col0(Inner),Output:["_col0","_col1","_col3"]
                      <-Map 24 [BROADCAST_EDGE] llap
                        BROADCAST [RS_109]
                          PartitionCols:_col0
                          Select Operator [SEL_74] (rows=25 width=7)
                            Output:["_col0","_col1"]
                            Filter Operator [FIL_157] (rows=25 width=7)
                              predicate:key is not null
                              TableScan [TS_72] (rows=25 width=7)
                                default@src1,y,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                      <-Select Operator [SEL_71] (rows=25 width=7)
                          Output:["_col0","_col1"]
                          Filter Operator [FIL_156] (rows=25 width=7)
                            predicate:(key is not null and value is not null)
                            TableScan [TS_69] (rows=25 width=7)
                              default@src1,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                  <-Select Operator [SEL_107] (rows=440 width=10)
                      Output:["_col1"]
                      Group By Operator [GBY_106] (rows=440 width=10)
                        Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                      <-Union 30 [SIMPLE_EDGE]
                        <-Map 34 [CONTAINS] llap
                          Reduce Output Operator [RS_105]
                            PartitionCols:_col0, _col1
                            Group By Operator [GBY_104] (rows=881 width=10)
                              Output:["_col0","_col1"],keys:_col1, _col0
                              Select Operator [SEL_100] (rows=500 width=10)
                                Output:["_col0","_col1"]
                                Filter Operator [FIL_161] (rows=500 width=10)
                                  predicate:value is not null
                                  TableScan [TS_98] (rows=500 width=10)
                                    Output:["key","value"]
                        <-Reducer 29 [CONTAINS] llap
                          Reduce Output Operator [RS_105]
                            PartitionCols:_col0, _col1
                            Group By Operator [GBY_104] (rows=881 width=10)
                              Output:["_col0","_col1"],keys:_col1, _col0
                              Select Operator [SEL_97] (rows=381 width=10)
                                Output:["_col0","_col1"]
                                Group By Operator [GBY_96] (rows=381 width=10)
                                  Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                <-Union 28 [SIMPLE_EDGE]
                                  <-Map 33 [CONTAINS] llap
                                    Reduce Output Operator [RS_95]
                                      PartitionCols:_col0, _col1
                                      Group By Operator [GBY_94] (rows=762 width=10)
                                        Output:["_col0","_col1"],keys:_col1, _col0
                                        Select Operator [SEL_90] (rows=500 width=10)
                                          Output:["_col0","_col1"]
                                          Filter Operator [FIL_160] (rows=500 width=10)
                                            predicate:value is not null
                                            TableScan [TS_88] (rows=500 width=10)
                                              Output:["key","value"]
                                  <-Reducer 27 [CONTAINS] llap
                                    Reduce Output Operator [RS_95]
                                      PartitionCols:_col0, _col1
                                      Group By Operator [GBY_94] (rows=762 width=10)
                                        Output:["_col0","_col1"],keys:_col1, _col0
                                        Select Operator [SEL_87] (rows=262 width=10)
                                          Output:["_col0","_col1"]
                                          Group By Operator [GBY_86] (rows=262 width=10)
                                            Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                          <-Union 26 [SIMPLE_EDGE]
                                            <-Map 25 [CONTAINS] llap
                                              Reduce Output Operator [RS_85]
                                                PartitionCols:_col0, _col1
                                                Group By Operator [GBY_84] (rows=525 width=10)
                                                  Output:["_col0","_col1"],keys:_col1, _col0
                                                  Select Operator [SEL_77] (rows=25 width=7)
                                                    Output:["_col0","_col1"]
                                                    Filter Operator [FIL_158] (rows=25 width=7)
                                                      predicate:value is not null
                                                      TableScan [TS_75] (rows=25 width=7)
                                                        Output:["key","value"]
                                            <-Map 32 [CONTAINS] llap
                                              Reduce Output Operator [RS_85]
                                                PartitionCols:_col0, _col1
                                                Group By Operator [GBY_84] (rows=525 width=10)
                                                  Output:["_col0","_col1"],keys:_col1, _col0
                                                  Select Operator [SEL_80] (rows=500 width=10)
                                                    Output:["_col0","_col1"]
                                                    Filter Operator [FIL_159] (rows=500 width=10)
                                                      predicate:value is not null
                                                      TableScan [TS_78] (rows=500 width=10)
                                                        Output:["key","value"]
          <-Reducer 6 [CONTAINS] llap
            Reduce Output Operator [RS_119]
              PartitionCols:_col0, _col1
              Group By Operator [GBY_118] (rows=1061 width=10)
                Output:["_col0","_col1"],keys:_col0, _col1
                Group By Operator [GBY_67] (rows=577 width=10)
                  Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                <-Union 5 [SIMPLE_EDGE]
                  <-Reducer 18 [CONTAINS] llap
                    Reduce Output Operator [RS_66]
                      PartitionCols:_col0, _col1
                      Group By Operator [GBY_65] (rows=1155 width=10)
                        Output:["_col0","_col1"],keys:_col0, _col1
                        Select Operator [SEL_61] (rows=605 width=10)
                          Output:["_col0","_col1"]
                          Merge Join Operator [MERGEJOIN_165] (rows=605 width=10)
                            Conds:RS_58._col2=RS_59._col0(Inner),Output:["_col2","_col5"]
                          <-Map 22 [SIMPLE_EDGE] llap
                            SHUFFLE [RS_59]
                              PartitionCols:_col0
                              Select Operator [SEL_54] (rows=500 width=10)
                                Output:["_col0","_col1"]
                                Filter Operator [FIL_155] (rows=500 width=10)
                                  predicate:key is not null
                                  TableScan [TS_52] (rows=500 width=10)
                                    default@src,y,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                          <-Reducer 17 [SIMPLE_EDGE] llap
                            SHUFFLE [RS_58]
                              PartitionCols:_col2
                              Merge Join Operator [MERGEJOIN_164] (rows=550 width=10)
                                Conds:RS_55._col1=RS_56._col1(Inner),Output:["_col2"]
                              <-Map 21 [SIMPLE_EDGE] llap
                                SHUFFLE [RS_56]
                                  PartitionCols:_col1
                                  Select Operator [SEL_51] (rows=500 width=10)
                                    Output:["_col0","_col1"]
                                    Filter Operator [FIL_154] (rows=500 width=10)
                                      predicate:(key is not null and value is not null)
                                      TableScan [TS_49] (rows=500 width=10)
                                        default@src,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                              <-Reducer 16 [SIMPLE_EDGE] llap
                                SHUFFLE [RS_55]
                                  PartitionCols:_col1
                                  Select Operator [SEL_48] (rows=381 width=10)
                                    Output:["_col1"]
                                    Group By Operator [GBY_47] (rows=381 width=10)
                                      Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                    <-Union 15 [SIMPLE_EDGE]
                                      <-Map 20 [CONTAINS] llap
                                        Reduce Output Operator [RS_46]
                                          PartitionCols:_col0, _col1
                                          Group By Operator [GBY_45] (rows=762 width=10)
                                            Output:["_col0","_col1"],keys:_col1, _col0
                                            Select Operator [SEL_41] (rows=500 width=10)
                                              Output:["_col0","_col1"]
                                              Filter Operator [FIL_153] (rows=500 width=10)
                                                predicate:value is not null
                                                TableScan [TS_39] (rows=500 width=10)
                                                  Output:["key","value"]
                                      <-Reducer 14 [CONTAINS] llap
                                        Reduce Output Operator [RS_46]
                                          PartitionCols:_col0, _col1
                                          Group By Operator [GBY_45] (rows=762 width=10)
                                            Output:["_col0","_col1"],keys:_col1, _col0
                                            Select Operator [SEL_38] (rows=262 width=10)
                                              Output:["_col0","_col1"]
                                              Group By Operator [GBY_37] (rows=262 width=10)
                                                Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                              <-Union 13 [SIMPLE_EDGE]
                                                <-Map 12 [CONTAINS] llap
                                                  Reduce Output Operator [RS_36]
                                                    PartitionCols:_col0, _col1
                                                    Group By Operator [GBY_35] (rows=525 width=10)
                                                      Output:["_col0","_col1"],keys:_col1, _col0
                                                      Select Operator [SEL_28] (rows=25 width=7)
                                                        Output:["_col0","_col1"]
                                                        Filter Operator [FIL_151] (rows=25 width=7)
                                                          predicate:value is not null
                                                          TableScan [TS_26] (rows=25 width=7)
                                                            Output:["key","value"]
                                                <-Map 19 [CONTAINS] llap
                                                  Reduce Output Operator [RS_36]
                                                    PartitionCols:_col0, _col1
                                                    Group By Operator [GBY_35] (rows=525 width=10)
                                                      Output:["_col0","_col1"],keys:_col1, _col0
                                                      Select Operator [SEL_31] (rows=500 width=10)
                                                        Output:["_col0","_col1"]
                                                        Filter Operator [FIL_152] (rows=500 width=10)
                                                          predicate:value is not null
                                                          TableScan [TS_29] (rows=500 width=10)
                                                            Output:["key","value"]
                  <-Reducer 4 [CONTAINS] llap
                    Reduce Output Operator [RS_66]
                      PartitionCols:_col0, _col1
                      Group By Operator [GBY_65] (rows=1155 width=10)
                        Output:["_col0","_col1"],keys:_col0, _col1
                        Select Operator [SEL_25] (rows=550 width=10)
                          Output:["_col0","_col1"]
                          Merge Join Operator [MERGEJOIN_163] (rows=550 width=10)
                            Conds:RS_22._col2=RS_23._col0(Inner),Output:["_col2","_col5"]
                          <-Map 11 [SIMPLE_EDGE] llap
                            SHUFFLE [RS_23]
                              PartitionCols:_col0
                              Select Operator [SEL_18] (rows=500 width=10)
                                Output:["_col0","_col1"]
                                Filter Operator [FIL_150] (rows=500 width=10)
                                  predicate:key is not null
                                  TableScan [TS_16] (rows=500 width=10)
                                    default@src,y,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                          <-Reducer 3 [SIMPLE_EDGE] llap
                            SHUFFLE [RS_22]
                              PartitionCols:_col2
                              Map Join Operator [MAPJOIN_162] (rows=288 width=10)
                                Conds:SEL_12._col1=RS_20._col1(Inner),Output:["_col2"]
                              <-Map 10 [BROADCAST_EDGE] llap
                                BROADCAST [RS_20]
                                  PartitionCols:_col1
                                  Select Operator [SEL_15] (rows=25 width=7)
                                    Output:["_col0","_col1"]
                                    Filter Operator [FIL_149] (rows=25 width=7)
                                      predicate:(key is not null and value is not null)
                                      TableScan [TS_13] (rows=25 width=7)
                                        default@src1,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                              <-Select Operator [SEL_12] (rows=262 width=10)
                                  Output:["_col1"]
                                  Group By Operator [GBY_11] (rows=262 width=10)
                                    Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                  <-Union 2 [SIMPLE_EDGE]
                                    <-Map 1 [CONTAINS] llap
                                      Reduce Output Operator [RS_10]
                                        PartitionCols:_col0, _col1
                                        Group By Operator [GBY_9] (rows=525 width=10)
                                          Output:["_col0","_col1"],keys:_col1, _col0
                                          Select Operator [SEL_2] (rows=25 width=7)
                                            Output:["_col0","_col1"]
                                            Filter Operator [FIL_147] (rows=25 width=7)
                                              predicate:value is not null
                                              TableScan [TS_0] (rows=25 width=7)
                                                Output:["key","value"]
                                    <-Map 9 [CONTAINS] llap
                                      Reduce Output Operator [RS_10]
                                        PartitionCols:_col0, _col1
                                        Group By Operator [GBY_9] (rows=525 width=10)
                                          Output:["_col0","_col1"],keys:_col1, _col0
                                          Select Operator [SEL_5] (rows=500 width=10)
                                            Output:["_col0","_col1"]
                                            Filter Operator [FIL_148] (rows=500 width=10)
                                              predicate:value is not null
                                              TableScan [TS_3] (rows=500 width=10)
                                                Output:["key","value"]

PREHOOK: query: CREATE TABLE a(key STRING, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@a
POSTHOOK: query: CREATE TABLE a(key STRING, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@a
PREHOOK: query: CREATE TABLE b(key STRING, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@b
POSTHOOK: query: CREATE TABLE b(key STRING, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@b
PREHOOK: query: CREATE TABLE c(key STRING, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@c
POSTHOOK: query: CREATE TABLE c(key STRING, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@c
PREHOOK: query: explain
from
(
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union all select * from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
) tmp
INSERT OVERWRITE TABLE a SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE b SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE c SELECT tmp.key, tmp.value
PREHOOK: type: QUERY
POSTHOOK: query: explain
from
(
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union all select * from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
) tmp
INSERT OVERWRITE TABLE a SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE b SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE c SELECT tmp.key, tmp.value
POSTHOOK: type: QUERY
STAGE DEPENDENCIES:
  Stage-3 is a root stage
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4
  Stage-5 depends on stages: Stage-0
  Stage-1 depends on stages: Stage-4
  Stage-6 depends on stages: Stage-1
  Stage-2 depends on stages: Stage-4
  Stage-7 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-3
    Tez
#### A masked pattern was here ####
      Edges:
        Map 1 <- Map 6 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 12 <- Union 9 (CONTAINS)
        Map 13 <- Union 9 (CONTAINS)
        Map 16 <- Map 17 (BROADCAST_EDGE)
        Map 18 <- Map 16 (BROADCAST_EDGE), Union 4 (CONTAINS)
        Map 19 <- Map 16 (BROADCAST_EDGE), Union 4 (CONTAINS)
        Map 20 <- Map 16 (BROADCAST_EDGE), Union 4 (CONTAINS)
        Map 21 <- Map 16 (BROADCAST_EDGE), Union 4 (CONTAINS)
        Map 5 <- Map 6 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 8 <- Union 9 (CONTAINS)
        Reducer 10 <- Map 14 (SIMPLE_EDGE), Union 9 (SIMPLE_EDGE)
        Reducer 11 <- Map 15 (SIMPLE_EDGE), Reducer 10 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 3 <- Map 7 (SIMPLE_EDGE), Union 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: src1
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: string)
                          1 _col1 (type: string)
                        outputColumnNames: _col1
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 577 Data size: 6053 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 577 Data size: 6053 Basic stats: COMPLETE Column stats: NONE
            Execution mode: llap
            LLAP IO: no inputs
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 1025 Data size: 10815 Basic stats: COMPLETE Column stats: NONE
            Execution mode: llap
            LLAP IO: no inputs
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 1025 Data size: 10815 Basic stats: COMPLETE Column stats: NONE
            Execution mode: llap
            LLAP IO: no inputs
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: x
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (key is not null and value is not null) (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col1 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col1 (type: string)
                        Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: y
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: key is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: x
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (key is not null and value is not null) (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col1, _col3
                        input vertices:
                          1 Map 17
                        Statistics: Num rows: 27 Data size: 210 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 27 Data size: 210 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: string), _col3 (type: string)
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 27 Data size: 210 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: string), _col3 (type: string)
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 27 Data size: 210 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: string), _col3 (type: string)
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 27 Data size: 210 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: string), _col3 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 17 
            Map Operator Tree:
                TableScan
                  alias: y
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: key is not null (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 18 
            Map Operator Tree:
                TableScan
                  alias: src1
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          0 Map 16
                        Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col0 (type: string), _col3 (type: string)
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.a
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.b
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.c
            Execution mode: llap
            LLAP IO: no inputs
        Map 19 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          0 Map 16
                        Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col0 (type: string), _col3 (type: string)
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.a
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.b
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.c
            Execution mode: llap
            LLAP IO: no inputs
        Map 20 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          0 Map 16
                        Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col0 (type: string), _col3 (type: string)
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.a
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.b
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.c
            Execution mode: llap
            LLAP IO: no inputs
        Map 21 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          0 Map 16
                        Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col0 (type: string), _col3 (type: string)
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1677 Data size: 17739 Basic stats: COMPLETE Column stats: NONE
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.a
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.b
                          File Output Operator
                            compressed: false
                            Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                            table:
                                input format: org.apache.hadoop.mapred.TextInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                name: default.c
            Execution mode: llap
            LLAP IO: no inputs
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: src
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: string)
                          1 _col1 (type: string)
                        outputColumnNames: _col1
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 577 Data size: 6053 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col1 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col1 (type: string)
                          Statistics: Num rows: 577 Data size: 6053 Basic stats: COMPLETE Column stats: NONE
            Execution mode: llap
            LLAP IO: no inputs
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: x
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (key is not null and value is not null) (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col1 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col1 (type: string)
                        Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: string)
                      Reduce Output Operator
                        key expressions: _col1 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col1 (type: string)
                        Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: y
                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: key is not null (type: boolean)
                    Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: key (type: string), value (type: string)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: string)
            Execution mode: llap
            LLAP IO: no inputs
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: src1
                  Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: value is not null (type: boolean)
                    Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: value (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 1025 Data size: 10815 Basic stats: COMPLETE Column stats: NONE
            Execution mode: llap
            LLAP IO: no inputs
        Reducer 10 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: string)
                  1 _col1 (type: string)
                outputColumnNames: _col1
                Statistics: Num rows: 1127 Data size: 11896 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: string)
                  Statistics: Num rows: 1127 Data size: 11896 Basic stats: COMPLETE Column stats: NONE
        Reducer 11 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col1 (type: string)
                  1 _col0 (type: string)
                outputColumnNames: _col1, _col4
                Statistics: Num rows: 1239 Data size: 13085 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: string), _col4 (type: string)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1239 Data size: 13085 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                        name: default.a
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                        name: default.b
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                        name: default.c
        Reducer 3 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col1 (type: string)
                  1 _col0 (type: string)
                outputColumnNames: _col1, _col4
                Statistics: Num rows: 634 Data size: 6658 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: string), _col4 (type: string)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 634 Data size: 6658 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                        name: default.a
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                        name: default.b
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 3550 Data size: 37482 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                        name: default.c
        Union 2 
            Vertex: Union 2
        Union 4 
            Vertex: Union 4
        Union 9 
            Vertex: Union 9

  Stage: Stage-4
    Dependency Collection

  Stage: Stage-0
    Move Operator
      tables:
          replace: true
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: default.a

  Stage: Stage-5
    Stats-Aggr Operator

  Stage: Stage-1
    Move Operator
      tables:
          replace: true
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: default.b

  Stage: Stage-6
    Stats-Aggr Operator

  Stage: Stage-2
    Move Operator
      tables:
          replace: true
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: default.c

  Stage: Stage-7
    Stats-Aggr Operator

PREHOOK: query: explain
FROM
( 
SELECT x.key as key, y.value as value from src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value) 
union
SELECT x.key as key, y.value as value from src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key as key, y.value as value from src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
) tmp
INSERT OVERWRITE TABLE a SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE b SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE c SELECT tmp.key, tmp.value
PREHOOK: type: QUERY
POSTHOOK: query: explain
FROM
( 
SELECT x.key as key, y.value as value from src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value) 
union
SELECT x.key as key, y.value as value from src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key as key, y.value as value from src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
) tmp
INSERT OVERWRITE TABLE a SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE b SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE c SELECT tmp.key, tmp.value
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 1 <- Union 2 (CONTAINS)
Map 12 <- Union 13 (CONTAINS)
Map 19 <- Union 13 (CONTAINS)
Map 20 <- Union 15 (CONTAINS)
Map 23 <- Map 24 (BROADCAST_EDGE)
Map 25 <- Union 26 (CONTAINS)
Map 32 <- Union 26 (CONTAINS)
Map 33 <- Union 28 (CONTAINS)
Map 34 <- Union 30 (CONTAINS)
Map 9 <- Union 2 (CONTAINS)
Reducer 14 <- Union 13 (SIMPLE_EDGE), Union 15 (CONTAINS)
Reducer 16 <- Union 15 (SIMPLE_EDGE)
Reducer 17 <- Map 21 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE)
Reducer 18 <- Map 22 (SIMPLE_EDGE), Reducer 17 (SIMPLE_EDGE), Union 5 (CONTAINS)
Reducer 27 <- Union 26 (SIMPLE_EDGE), Union 28 (CONTAINS)
Reducer 29 <- Union 28 (SIMPLE_EDGE), Union 30 (CONTAINS)
Reducer 3 <- Map 10 (BROADCAST_EDGE), Union 2 (SIMPLE_EDGE)
Reducer 31 <- Map 23 (BROADCAST_EDGE), Union 30 (SIMPLE_EDGE), Union 7 (CONTAINS)
Reducer 4 <- Map 11 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE), Union 5 (CONTAINS)
Reducer 6 <- Union 5 (SIMPLE_EDGE), Union 7 (CONTAINS)
Reducer 8 <- Union 7 (SIMPLE_EDGE)

Stage-5
  Stats-Aggr Operator
    Stage-0
      Move Operator
        table:{"name:":"default.a"}
        Stage-4
          Dependency Collection{}
            Stage-3
              Reducer 8 llap
              File Output Operator [FS_123]
                table:{"name:":"default.a"}
                Group By Operator [GBY_120] (rows=530 width=10)
                  Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                <-Union 7 [SIMPLE_EDGE]
                  <-Reducer 31 [CONTAINS] llap
                    Reduce Output Operator [RS_119]
                      PartitionCols:_col0, _col1
                      Group By Operator [GBY_118] (rows=1061 width=10)
                        Output:["_col0","_col1"],keys:_col0, _col1
                        Select Operator [SEL_114] (rows=484 width=10)
                          Output:["_col0","_col1"]
                          Map Join Operator [MAPJOIN_172] (rows=484 width=10)
                            Conds:RS_111._col1=SEL_107._col1(Inner),Output:["_col0","_col3"]
                          <-Map 23 [BROADCAST_EDGE] llap
                            BROADCAST [RS_111]
                              PartitionCols:_col1
                              Map Join Operator [MAPJOIN_171] (rows=27 width=7)
                                Conds:SEL_71._col0=RS_109._col0(Inner),Output:["_col0","_col1","_col3"]
                              <-Map 24 [BROADCAST_EDGE] llap
                                BROADCAST [RS_109]
                                  PartitionCols:_col0
                                  Select Operator [SEL_74] (rows=25 width=7)
                                    Output:["_col0","_col1"]
                                    Filter Operator [FIL_162] (rows=25 width=7)
                                      predicate:key is not null
                                      TableScan [TS_72] (rows=25 width=7)
                                        default@src1,y,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                              <-Select Operator [SEL_71] (rows=25 width=7)
                                  Output:["_col0","_col1"]
                                  Filter Operator [FIL_161] (rows=25 width=7)
                                    predicate:(key is not null and value is not null)
                                    TableScan [TS_69] (rows=25 width=7)
                                      default@src1,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                          <-Select Operator [SEL_107] (rows=440 width=10)
                              Output:["_col1"]
                              Group By Operator [GBY_106] (rows=440 width=10)
                                Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                              <-Union 30 [SIMPLE_EDGE]
                                <-Map 34 [CONTAINS] llap
                                  Reduce Output Operator [RS_105]
                                    PartitionCols:_col0, _col1
                                    Group By Operator [GBY_104] (rows=881 width=10)
                                      Output:["_col0","_col1"],keys:_col1, _col0
                                      Select Operator [SEL_100] (rows=500 width=10)
                                        Output:["_col0","_col1"]
                                        Filter Operator [FIL_166] (rows=500 width=10)
                                          predicate:value is not null
                                          TableScan [TS_98] (rows=500 width=10)
                                            Output:["key","value"]
                                <-Reducer 29 [CONTAINS] llap
                                  Reduce Output Operator [RS_105]
                                    PartitionCols:_col0, _col1
                                    Group By Operator [GBY_104] (rows=881 width=10)
                                      Output:["_col0","_col1"],keys:_col1, _col0
                                      Select Operator [SEL_97] (rows=381 width=10)
                                        Output:["_col0","_col1"]
                                        Group By Operator [GBY_96] (rows=381 width=10)
                                          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                        <-Union 28 [SIMPLE_EDGE]
                                          <-Map 33 [CONTAINS] llap
                                            Reduce Output Operator [RS_95]
                                              PartitionCols:_col0, _col1
                                              Group By Operator [GBY_94] (rows=762 width=10)
                                                Output:["_col0","_col1"],keys:_col1, _col0
                                                Select Operator [SEL_90] (rows=500 width=10)
                                                  Output:["_col0","_col1"]
                                                  Filter Operator [FIL_165] (rows=500 width=10)
                                                    predicate:value is not null
                                                    TableScan [TS_88] (rows=500 width=10)
                                                      Output:["key","value"]
                                          <-Reducer 27 [CONTAINS] llap
                                            Reduce Output Operator [RS_95]
                                              PartitionCols:_col0, _col1
                                              Group By Operator [GBY_94] (rows=762 width=10)
                                                Output:["_col0","_col1"],keys:_col1, _col0
                                                Select Operator [SEL_87] (rows=262 width=10)
                                                  Output:["_col0","_col1"]
                                                  Group By Operator [GBY_86] (rows=262 width=10)
                                                    Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                                  <-Union 26 [SIMPLE_EDGE]
                                                    <-Map 25 [CONTAINS] llap
                                                      Reduce Output Operator [RS_85]
                                                        PartitionCols:_col0, _col1
                                                        Group By Operator [GBY_84] (rows=525 width=10)
                                                          Output:["_col0","_col1"],keys:_col1, _col0
                                                          Select Operator [SEL_77] (rows=25 width=7)
                                                            Output:["_col0","_col1"]
                                                            Filter Operator [FIL_163] (rows=25 width=7)
                                                              predicate:value is not null
                                                              TableScan [TS_75] (rows=25 width=7)
                                                                Output:["key","value"]
                                                    <-Map 32 [CONTAINS] llap
                                                      Reduce Output Operator [RS_85]
                                                        PartitionCols:_col0, _col1
                                                        Group By Operator [GBY_84] (rows=525 width=10)
                                                          Output:["_col0","_col1"],keys:_col1, _col0
                                                          Select Operator [SEL_80] (rows=500 width=10)
                                                            Output:["_col0","_col1"]
                                                            Filter Operator [FIL_164] (rows=500 width=10)
                                                              predicate:value is not null
                                                              TableScan [TS_78] (rows=500 width=10)
                                                                Output:["key","value"]
                  <-Reducer 6 [CONTAINS] llap
                    Reduce Output Operator [RS_119]
                      PartitionCols:_col0, _col1
                      Group By Operator [GBY_118] (rows=1061 width=10)
                        Output:["_col0","_col1"],keys:_col0, _col1
                        Group By Operator [GBY_67] (rows=577 width=10)
                          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                        <-Union 5 [SIMPLE_EDGE]
                          <-Reducer 18 [CONTAINS] llap
                            Reduce Output Operator [RS_66]
                              PartitionCols:_col0, _col1
                              Group By Operator [GBY_65] (rows=1155 width=10)
                                Output:["_col0","_col1"],keys:_col0, _col1
                                Select Operator [SEL_61] (rows=605 width=10)
                                  Output:["_col0","_col1"]
                                  Merge Join Operator [MERGEJOIN_170] (rows=605 width=10)
                                    Conds:RS_58._col2=RS_59._col0(Inner),Output:["_col2","_col5"]
                                  <-Map 22 [SIMPLE_EDGE] llap
                                    SHUFFLE [RS_59]
                                      PartitionCols:_col0
                                      Select Operator [SEL_54] (rows=500 width=10)
                                        Output:["_col0","_col1"]
                                        Filter Operator [FIL_160] (rows=500 width=10)
                                          predicate:key is not null
                                          TableScan [TS_52] (rows=500 width=10)
                                            default@src,y,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                                  <-Reducer 17 [SIMPLE_EDGE] llap
                                    SHUFFLE [RS_58]
                                      PartitionCols:_col2
                                      Merge Join Operator [MERGEJOIN_169] (rows=550 width=10)
                                        Conds:RS_55._col1=RS_56._col1(Inner),Output:["_col2"]
                                      <-Map 21 [SIMPLE_EDGE] llap
                                        SHUFFLE [RS_56]
                                          PartitionCols:_col1
                                          Select Operator [SEL_51] (rows=500 width=10)
                                            Output:["_col0","_col1"]
                                            Filter Operator [FIL_159] (rows=500 width=10)
                                              predicate:(key is not null and value is not null)
                                              TableScan [TS_49] (rows=500 width=10)
                                                default@src,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                                      <-Reducer 16 [SIMPLE_EDGE] llap
                                        SHUFFLE [RS_55]
                                          PartitionCols:_col1
                                          Select Operator [SEL_48] (rows=381 width=10)
                                            Output:["_col1"]
                                            Group By Operator [GBY_47] (rows=381 width=10)
                                              Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                            <-Union 15 [SIMPLE_EDGE]
                                              <-Map 20 [CONTAINS] llap
                                                Reduce Output Operator [RS_46]
                                                  PartitionCols:_col0, _col1
                                                  Group By Operator [GBY_45] (rows=762 width=10)
                                                    Output:["_col0","_col1"],keys:_col1, _col0
                                                    Select Operator [SEL_41] (rows=500 width=10)
                                                      Output:["_col0","_col1"]
                                                      Filter Operator [FIL_158] (rows=500 width=10)
                                                        predicate:value is not null
                                                        TableScan [TS_39] (rows=500 width=10)
                                                          Output:["key","value"]
                                              <-Reducer 14 [CONTAINS] llap
                                                Reduce Output Operator [RS_46]
                                                  PartitionCols:_col0, _col1
                                                  Group By Operator [GBY_45] (rows=762 width=10)
                                                    Output:["_col0","_col1"],keys:_col1, _col0
                                                    Select Operator [SEL_38] (rows=262 width=10)
                                                      Output:["_col0","_col1"]
                                                      Group By Operator [GBY_37] (rows=262 width=10)
                                                        Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                                      <-Union 13 [SIMPLE_EDGE]
                                                        <-Map 12 [CONTAINS] llap
                                                          Reduce Output Operator [RS_36]
                                                            PartitionCols:_col0, _col1
                                                            Group By Operator [GBY_35] (rows=525 width=10)
                                                              Output:["_col0","_col1"],keys:_col1, _col0
                                                              Select Operator [SEL_28] (rows=25 width=7)
                                                                Output:["_col0","_col1"]
                                                                Filter Operator [FIL_156] (rows=25 width=7)
                                                                  predicate:value is not null
                                                                  TableScan [TS_26] (rows=25 width=7)
                                                                    Output:["key","value"]
                                                        <-Map 19 [CONTAINS] llap
                                                          Reduce Output Operator [RS_36]
                                                            PartitionCols:_col0, _col1
                                                            Group By Operator [GBY_35] (rows=525 width=10)
                                                              Output:["_col0","_col1"],keys:_col1, _col0
                                                              Select Operator [SEL_31] (rows=500 width=10)
                                                                Output:["_col0","_col1"]
                                                                Filter Operator [FIL_157] (rows=500 width=10)
                                                                  predicate:value is not null
                                                                  TableScan [TS_29] (rows=500 width=10)
                                                                    Output:["key","value"]
                          <-Reducer 4 [CONTAINS] llap
                            Reduce Output Operator [RS_66]
                              PartitionCols:_col0, _col1
                              Group By Operator [GBY_65] (rows=1155 width=10)
                                Output:["_col0","_col1"],keys:_col0, _col1
                                Select Operator [SEL_25] (rows=550 width=10)
                                  Output:["_col0","_col1"]
                                  Merge Join Operator [MERGEJOIN_168] (rows=550 width=10)
                                    Conds:RS_22._col2=RS_23._col0(Inner),Output:["_col2","_col5"]
                                  <-Map 11 [SIMPLE_EDGE] llap
                                    SHUFFLE [RS_23]
                                      PartitionCols:_col0
                                      Select Operator [SEL_18] (rows=500 width=10)
                                        Output:["_col0","_col1"]
                                        Filter Operator [FIL_155] (rows=500 width=10)
                                          predicate:key is not null
                                          TableScan [TS_16] (rows=500 width=10)
                                            default@src,y,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                                  <-Reducer 3 [SIMPLE_EDGE] llap
                                    SHUFFLE [RS_22]
                                      PartitionCols:_col2
                                      Map Join Operator [MAPJOIN_167] (rows=288 width=10)
                                        Conds:SEL_12._col1=RS_20._col1(Inner),Output:["_col2"]
                                      <-Map 10 [BROADCAST_EDGE] llap
                                        BROADCAST [RS_20]
                                          PartitionCols:_col1
                                          Select Operator [SEL_15] (rows=25 width=7)
                                            Output:["_col0","_col1"]
                                            Filter Operator [FIL_154] (rows=25 width=7)
                                              predicate:(key is not null and value is not null)
                                              TableScan [TS_13] (rows=25 width=7)
                                                default@src1,x,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
                                      <-Select Operator [SEL_12] (rows=262 width=10)
                                          Output:["_col1"]
                                          Group By Operator [GBY_11] (rows=262 width=10)
                                            Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                                          <-Union 2 [SIMPLE_EDGE]
                                            <-Map 1 [CONTAINS] llap
                                              Reduce Output Operator [RS_10]
                                                PartitionCols:_col0, _col1
                                                Group By Operator [GBY_9] (rows=525 width=10)
                                                  Output:["_col0","_col1"],keys:_col1, _col0
                                                  Select Operator [SEL_2] (rows=25 width=7)
                                                    Output:["_col0","_col1"]
                                                    Filter Operator [FIL_152] (rows=25 width=7)
                                                      predicate:value is not null
                                                      TableScan [TS_0] (rows=25 width=7)
                                                        Output:["key","value"]
                                            <-Map 9 [CONTAINS] llap
                                              Reduce Output Operator [RS_10]
                                                PartitionCols:_col0, _col1
                                                Group By Operator [GBY_9] (rows=525 width=10)
                                                  Output:["_col0","_col1"],keys:_col1, _col0
                                                  Select Operator [SEL_5] (rows=500 width=10)
                                                    Output:["_col0","_col1"]
                                                    Filter Operator [FIL_153] (rows=500 width=10)
                                                      predicate:value is not null
                                                      TableScan [TS_3] (rows=500 width=10)
                                                        Output:["key","value"]
              File Output Operator [FS_125]
                table:{"name:":"default.b"}
                 Please refer to the previous Group By Operator [GBY_120]
              File Output Operator [FS_127]
                table:{"name:":"default.c"}
                 Please refer to the previous Group By Operator [GBY_120]
Stage-6
  Stats-Aggr Operator
    Stage-1
      Move Operator
        table:{"name:":"default.b"}
         Please refer to the previous Stage-4
Stage-7
  Stats-Aggr Operator
    Stage-2
      Move Operator
        table:{"name:":"default.c"}
         Please refer to the previous Stage-4

PREHOOK: query: CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@DEST1
POSTHOOK: query: CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@DEST1
PREHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@DEST2
POSTHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@DEST2
PREHOOK: query: explain 
FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
                         UNION DISTINCT  
      select s2.key as key, s2.value as value from src s2) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key, unionsrc.value
PREHOOK: type: QUERY
POSTHOOK: query: explain 
FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
                         UNION DISTINCT  
      select s2.key as key, s2.value as value from src s2) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key, unionsrc.value
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 6 <- Union 3 (CONTAINS)
Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)

Stage-4
  Stats-Aggr Operator
    Stage-0
      Move Operator
        table:{"name:":"default.dest1"}
        Stage-3
          Dependency Collection{}
            Stage-2
              Reducer 5 llap
              File Output Operator [FS_22]
                table:{"name:":"default.dest1"}
                Select Operator [SEL_20] (rows=1 width=272)
                  Output:["_col0","_col1"]
                  Group By Operator [GBY_19] (rows=1 width=96)
                    Output:["_col0","_col1"],aggregations:["count(DISTINCT KEY._col1:0._col0)"],keys:KEY._col0
                  <-Reducer 4 [SIMPLE_EDGE] llap
                    SHUFFLE [RS_18]
                      PartitionCols:_col0
                      Group By Operator [GBY_17] (rows=1 width=280)
                        Output:["_col0","_col1","_col2"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, substr(_col1, 5)
                        Group By Operator [GBY_14] (rows=1 width=272)
                          Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
                        <-Union 3 [SIMPLE_EDGE]
                          <-Map 6 [CONTAINS] llap
                            Reduce Output Operator [RS_13]
                              PartitionCols:_col0, _col1
                              Group By Operator [GBY_12] (rows=1 width=272)
                                Output:["_col0","_col1"],keys:_col0, _col1
                                Select Operator [SEL_8] (rows=500 width=10)
                                  Output:["_col0","_col1"]
                                  TableScan [TS_7] (rows=500 width=10)
                                    Output:["key","value"]
                          <-Reducer 2 [CONTAINS] llap
                            Reduce Output Operator [RS_13]
                              PartitionCols:_col0, _col1
                              Group By Operator [GBY_12] (rows=1 width=272)
                                Output:["_col0","_col1"],keys:_col0, _col1
                                Select Operator [SEL_6] (rows=1 width=272)
                                  Output:["_col0","_col1"]
                                  Group By Operator [GBY_5] (rows=1 width=8)
                                    Output:["_col0"],aggregations:["count(VALUE._col0)"]
                                  <-Map 1 [CUSTOM_SIMPLE_EDGE] llap
                                    PARTITION_ONLY_SHUFFLE [RS_4]
                                      Group By Operator [GBY_3] (rows=1 width=8)
                                        Output:["_col0"],aggregations:["count(1)"]
                                        Select Operator [SEL_1] (rows=500 width=10)
                                          TableScan [TS_0] (rows=500 width=10)
                                            default@src,s1,Tbl:COMPLETE,Col:COMPLETE
                    File Output Operator [FS_29]
                      table:{"name:":"default.dest2"}
                      Select Operator [SEL_27] (rows=1 width=456)
                        Output:["_col0","_col1","_col2"]
                        Group By Operator [GBY_26] (rows=1 width=464)
                          Output:["_col0","_col1","_col2"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, _col1
                           Please refer to the previous Group By Operator [GBY_14]
Stage-5
  Stats-Aggr Operator
    Stage-1
      Move Operator
        table:{"name:":"default.dest2"}
         Please refer to the previous Stage-3

PREHOOK: query: EXPLAIN FROM UNIQUEJOIN PRESERVE src a (a.key), PRESERVE src1 b (b.key), PRESERVE srcpart c (c.key) SELECT a.key, b.key, c.key
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN FROM UNIQUEJOIN PRESERVE src a (a.key), PRESERVE src1 b (b.key), PRESERVE srcpart c (c.key) SELECT a.key, b.key, c.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Unique_join].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 2 llap
      File Output Operator [FS_8]
        Select Operator [SEL_7] (rows=4400 width=10)
          Output:["_col0","_col1","_col2"]
          Merge Join Operator [MERGEJOIN_9] (rows=4400 width=10)
            Conds:RS_3.key=RS_3.key(Unique),RS_3.key=RS_3.key(Unique),RS_3.key=RS_3.key(Unique),Output:["_col0","_col5","_col10"]
          <-Map 1 [SIMPLE_EDGE] llap
            SHUFFLE [RS_3]
              PartitionCols:key
              TableScan [TS_0] (rows=500 width=10)
                default@src,a,Tbl:COMPLETE,Col:NONE,Output:["key"]
          <-Map 3 [SIMPLE_EDGE] llap
            SHUFFLE [RS_4]
              PartitionCols:key
              TableScan [TS_1] (rows=25 width=7)
                default@src1,b,Tbl:COMPLETE,Col:NONE,Output:["key"]
          <-Map 4 [SIMPLE_EDGE] llap
            SHUFFLE [RS_5]
              PartitionCols:key
              TableScan [TS_2] (rows=2000 width=10)
                default@srcpart,c,Tbl:COMPLETE,Col:NONE,Output:["key"]

PREHOOK: query: EXPLAIN
SELECT 
TRANSFORM(a.key, a.value) USING 'cat' AS (tkey, tvalue)
FROM src a join src b
on a.key = b.key
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT 
TRANSFORM(a.key, a.value) USING 'cat' AS (tkey, tvalue)
FROM src a join src b
on a.key = b.key
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 2
      File Output Operator [FS_9]
        Transform Operator [SCR_8] (rows=550 width=10)
          command:cat
          Merge Join Operator [MERGEJOIN_14] (rows=550 width=10)
            Conds:RS_3.key=RS_5.key(Inner),Output:["_col0","_col1"]
          <-Map 1 [SIMPLE_EDGE] llap
            SHUFFLE [RS_3]
              PartitionCols:key
              Filter Operator [FIL_12] (rows=500 width=10)
                predicate:key is not null
                TableScan [TS_0] (rows=500 width=10)
                  default@src,a,Tbl:COMPLETE,Col:NONE,Output:["key","value"]
          <-Map 3 [SIMPLE_EDGE] llap
            SHUFFLE [RS_5]
              PartitionCols:key
              Filter Operator [FIL_13] (rows=500 width=10)
                predicate:key is not null
                TableScan [TS_1] (rows=500 width=10)
                  default@src,b,Tbl:COMPLETE,Col:NONE,Output:["key"]

PREHOOK: query: explain
FROM (
      select key, value from (
      select 'tst1' as key, cast(count(1) as string) as value, 'tst1' as value2 from src s1
                         UNION all 
      select s2.key as key, s2.value as value, 'tst1' as value2 from src s2) unionsub
                         UNION all
      select key, value from src s0
                             ) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) 
GROUP BY unionsrc.key, unionsrc.value
PREHOOK: type: QUERY
POSTHOOK: query: explain
FROM (
      select key, value from (
      select 'tst1' as key, cast(count(1) as string) as value, 'tst1' as value2 from src s1
                         UNION all 
      select s2.key as key, s2.value as value, 'tst1' as value2 from src s2) unionsub
                         UNION all
      select key, value from src s0
                             ) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) 
GROUP BY unionsrc.key, unionsrc.value
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 6 <- Union 3 (CONTAINS)
Map 7 <- Union 3 (CONTAINS)
Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Reducer 5 <- Union 3 (SIMPLE_EDGE)

Stage-4
  Stats-Aggr Operator
    Stage-0
      Move Operator
        table:{"name:":"default.dest1"}
        Stage-3
          Dependency Collection{}
            Stage-2
              Reducer 4 llap
              File Output Operator [FS_20]
                table:{"name:":"default.dest1"}
                Select Operator [SEL_18] (rows=1 width=272)
                  Output:["_col0","_col1"]
                  Group By Operator [GBY_17] (rows=1 width=96)
                    Output:["_col0","_col1"],aggregations:["count(DISTINCT KEY._col1:0._col0)"],keys:KEY._col0
                  <-Union 3 [SIMPLE_EDGE]
                    <-Map 6 [CONTAINS] llap
                      Reduce Output Operator [RS_16]
                        PartitionCols:_col0
                        Group By Operator [GBY_15] (rows=1 width=280)
                          Output:["_col0","_col1","_col2"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, substr(_col1, 5)
                          Select Operator [SEL_8] (rows=500 width=10)
                            Output:["_col0","_col1"]
                            TableScan [TS_7] (rows=500 width=10)
                              Output:["key","value"]
                      Reduce Output Operator [RS_23]
                        PartitionCols:_col0, _col1
                        Group By Operator [GBY_22] (rows=1 width=464)
                          Output:["_col0","_col1","_col2","_col3"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, _col1, substr(_col1, 5)
                           Please refer to the previous Select Operator [SEL_8]
                    <-Map 7 [CONTAINS] llap
                      Reduce Output Operator [RS_16]
                        PartitionCols:_col0
                        Group By Operator [GBY_15] (rows=1 width=280)
                          Output:["_col0","_col1","_col2"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, substr(_col1, 5)
                          Select Operator [SEL_12] (rows=500 width=10)
                            Output:["_col0","_col1"]
                            TableScan [TS_11] (rows=500 width=10)
                              Output:["key","value"]
                      Reduce Output Operator [RS_23]
                        PartitionCols:_col0, _col1
                        Group By Operator [GBY_22] (rows=1 width=464)
                          Output:["_col0","_col1","_col2","_col3"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, _col1, substr(_col1, 5)
                           Please refer to the previous Select Operator [SEL_12]
                    <-Reducer 2 [CONTAINS] llap
                      Reduce Output Operator [RS_16]
                        PartitionCols:_col0
                        Group By Operator [GBY_15] (rows=1 width=280)
                          Output:["_col0","_col1","_col2"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, substr(_col1, 5)
                          Select Operator [SEL_6] (rows=1 width=272)
                            Output:["_col0","_col1"]
                            Group By Operator [GBY_5] (rows=1 width=8)
                              Output:["_col0"],aggregations:["count(VALUE._col0)"]
                            <-Map 1 [CUSTOM_SIMPLE_EDGE] llap
                              PARTITION_ONLY_SHUFFLE [RS_4]
                                Group By Operator [GBY_3] (rows=1 width=8)
                                  Output:["_col0"],aggregations:["count(1)"]
                                  Select Operator [SEL_1] (rows=500 width=10)
                                    TableScan [TS_0] (rows=500 width=10)
                                      default@src,s1,Tbl:COMPLETE,Col:COMPLETE
                      Reduce Output Operator [RS_23]
                        PartitionCols:_col0, _col1
                        Group By Operator [GBY_22] (rows=1 width=464)
                          Output:["_col0","_col1","_col2","_col3"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, _col1, substr(_col1, 5)
                           Please refer to the previous Select Operator [SEL_6]
              Reducer 5 llap
              File Output Operator [FS_27]
                table:{"name:":"default.dest2"}
                Select Operator [SEL_25] (rows=1 width=456)
                  Output:["_col0","_col1","_col2"]
                  Group By Operator [GBY_24] (rows=1 width=280)
                    Output:["_col0","_col1","_col2"],aggregations:["count(DISTINCT KEY._col2:0._col0)"],keys:KEY._col0, KEY._col1
                  <- Please refer to the previous Union 3 [SIMPLE_EDGE]
Stage-5
  Stats-Aggr Operator
    Stage-1
      Move Operator
        table:{"name:":"default.dest2"}
         Please refer to the previous Stage-3

PREHOOK: query: explain
FROM (
      select 'tst1' as key, cast(count(1) as string) as value, 'tst1' as value2 from src s1
                         UNION all 
      select s2.key as key, s2.value as value, 'tst1' as value2 from src s2
                             ) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) 
GROUP BY unionsrc.key, unionsrc.value
PREHOOK: type: QUERY
POSTHOOK: query: explain
FROM (
      select 'tst1' as key, cast(count(1) as string) as value, 'tst1' as value2 from src s1
                         UNION all 
      select s2.key as key, s2.value as value, 'tst1' as value2 from src s2
                             ) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) 
GROUP BY unionsrc.key, unionsrc.value
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 6 <- Union 3 (CONTAINS)
Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Reducer 5 <- Union 3 (SIMPLE_EDGE)

Stage-4
  Stats-Aggr Operator
    Stage-0
      Move Operator
        table:{"name:":"default.dest1"}
        Stage-3
          Dependency Collection{}
            Stage-2
              Reducer 4 llap
              File Output Operator [FS_17]
                table:{"name:":"default.dest1"}
                Select Operator [SEL_15] (rows=1 width=272)
                  Output:["_col0","_col1"]
                  Group By Operator [GBY_14] (rows=1 width=96)
                    Output:["_col0","_col1"],aggregations:["count(DISTINCT KEY._col1:0._col0)"],keys:KEY._col0
                  <-Union 3 [SIMPLE_EDGE]
                    <-Map 6 [CONTAINS] llap
                      Reduce Output Operator [RS_13]
                        PartitionCols:_col0
                        Group By Operator [GBY_12] (rows=1 width=280)
                          Output:["_col0","_col1","_col2"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, substr(_col1, 5)
                          Select Operator [SEL_8] (rows=500 width=10)
                            Output:["_col0","_col1"]
                            TableScan [TS_7] (rows=500 width=10)
                              Output:["key","value"]
                      Reduce Output Operator [RS_20]
                        PartitionCols:_col0, _col1
                        Group By Operator [GBY_19] (rows=1 width=464)
                          Output:["_col0","_col1","_col2","_col3"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, _col1, substr(_col1, 5)
                           Please refer to the previous Select Operator [SEL_8]
                    <-Reducer 2 [CONTAINS] llap
                      Reduce Output Operator [RS_13]
                        PartitionCols:_col0
                        Group By Operator [GBY_12] (rows=1 width=280)
                          Output:["_col0","_col1","_col2"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, substr(_col1, 5)
                          Select Operator [SEL_6] (rows=1 width=272)
                            Output:["_col0","_col1"]
                            Group By Operator [GBY_5] (rows=1 width=8)
                              Output:["_col0"],aggregations:["count(VALUE._col0)"]
                            <-Map 1 [CUSTOM_SIMPLE_EDGE] llap
                              PARTITION_ONLY_SHUFFLE [RS_4]
                                Group By Operator [GBY_3] (rows=1 width=8)
                                  Output:["_col0"],aggregations:["count(1)"]
                                  Select Operator [SEL_1] (rows=500 width=10)
                                    TableScan [TS_0] (rows=500 width=10)
                                      default@src,s1,Tbl:COMPLETE,Col:COMPLETE
                      Reduce Output Operator [RS_20]
                        PartitionCols:_col0, _col1
                        Group By Operator [GBY_19] (rows=1 width=464)
                          Output:["_col0","_col1","_col2","_col3"],aggregations:["count(DISTINCT substr(_col1, 5))"],keys:_col0, _col1, substr(_col1, 5)
                           Please refer to the previous Select Operator [SEL_6]
              Reducer 5 llap
              File Output Operator [FS_24]
                table:{"name:":"default.dest2"}
                Select Operator [SEL_22] (rows=1 width=456)
                  Output:["_col0","_col1","_col2"]
                  Group By Operator [GBY_21] (rows=1 width=280)
                    Output:["_col0","_col1","_col2"],aggregations:["count(DISTINCT KEY._col2:0._col0)"],keys:KEY._col0, KEY._col1
                  <- Please refer to the previous Union 3 [SIMPLE_EDGE]
Stage-5
  Stats-Aggr Operator
    Stage-1
      Move Operator
        table:{"name:":"default.dest2"}
         Please refer to the previous Stage-3

