PREHOOK: query: drop table intermediate
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table intermediate
POSTHOOK: type: DROPTABLE
PREHOOK: query: create table intermediate(key int) partitioned by (p int) stored as orc
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@intermediate
POSTHOOK: query: create table intermediate(key int) partitioned by (p int) stored as orc
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@intermediate
PREHOOK: query: insert into table intermediate partition(p='455') select distinct key from src where key >= 0 order by key desc limit 2
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@intermediate@p=455
POSTHOOK: query: insert into table intermediate partition(p='455') select distinct key from src where key >= 0 order by key desc limit 2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@intermediate@p=455
POSTHOOK: Lineage: intermediate PARTITION(p=455).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
PREHOOK: query: insert into table intermediate partition(p='456') select distinct key from src where key is not null order by key asc limit 2
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@intermediate@p=456
POSTHOOK: query: insert into table intermediate partition(p='456') select distinct key from src where key is not null order by key asc limit 2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@intermediate@p=456
POSTHOOK: Lineage: intermediate PARTITION(p=456).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
PREHOOK: query: drop table multi0_1_mm
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table multi0_1_mm
POSTHOOK: type: DROPTABLE
PREHOOK: query: drop table multi0_2_mm
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table multi0_2_mm
POSTHOOK: type: DROPTABLE
PREHOOK: query: create table multi0_1_mm (key int, key2 int)  tblproperties("transactional"="true", "transactional_properties"="insert_only")
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@multi0_1_mm
POSTHOOK: query: create table multi0_1_mm (key int, key2 int)  tblproperties("transactional"="true", "transactional_properties"="insert_only")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@multi0_1_mm
PREHOOK: query: create table multi0_2_mm (key int, key2 int)  tblproperties("transactional"="true", "transactional_properties"="insert_only")
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@multi0_2_mm
POSTHOOK: query: create table multi0_2_mm (key int, key2 int)  tblproperties("transactional"="true", "transactional_properties"="insert_only")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@multi0_2_mm
PREHOOK: query: from intermediate
insert overwrite table multi0_1_mm select key, p
insert overwrite table multi0_2_mm select p, key
PREHOOK: type: QUERY
PREHOOK: Input: default@intermediate
PREHOOK: Input: default@intermediate@p=455
PREHOOK: Input: default@intermediate@p=456
PREHOOK: Output: default@multi0_1_mm
PREHOOK: Output: default@multi0_2_mm
POSTHOOK: query: from intermediate
insert overwrite table multi0_1_mm select key, p
insert overwrite table multi0_2_mm select p, key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@intermediate
POSTHOOK: Input: default@intermediate@p=455
POSTHOOK: Input: default@intermediate@p=456
POSTHOOK: Output: default@multi0_1_mm
POSTHOOK: Output: default@multi0_2_mm
POSTHOOK: Lineage: multi0_1_mm.key SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: multi0_1_mm.key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
POSTHOOK: Lineage: multi0_2_mm.key SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
POSTHOOK: Lineage: multi0_2_mm.key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
PREHOOK: query: select * from multi0_1_mm order by key, key2
PREHOOK: type: QUERY
PREHOOK: Input: default@multi0_1_mm
#### A masked pattern was here ####
POSTHOOK: query: select * from multi0_1_mm order by key, key2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@multi0_1_mm
#### A masked pattern was here ####
0	456
10	456
97	455
98	455
PREHOOK: query: select * from multi0_2_mm order by key, key2
PREHOOK: type: QUERY
PREHOOK: Input: default@multi0_2_mm
#### A masked pattern was here ####
POSTHOOK: query: select * from multi0_2_mm order by key, key2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@multi0_2_mm
#### A masked pattern was here ####
455	97
455	98
456	0
456	10
PREHOOK: query: from intermediate
insert into table multi0_1_mm select p, key
insert overwrite table multi0_2_mm select key, p
PREHOOK: type: QUERY
PREHOOK: Input: default@intermediate
PREHOOK: Input: default@intermediate@p=455
PREHOOK: Input: default@intermediate@p=456
PREHOOK: Output: default@multi0_1_mm
PREHOOK: Output: default@multi0_2_mm
POSTHOOK: query: from intermediate
insert into table multi0_1_mm select p, key
insert overwrite table multi0_2_mm select key, p
POSTHOOK: type: QUERY
POSTHOOK: Input: default@intermediate
POSTHOOK: Input: default@intermediate@p=455
POSTHOOK: Input: default@intermediate@p=456
POSTHOOK: Output: default@multi0_1_mm
POSTHOOK: Output: default@multi0_2_mm
POSTHOOK: Lineage: multi0_1_mm.key SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
POSTHOOK: Lineage: multi0_1_mm.key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: multi0_2_mm.key SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: multi0_2_mm.key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
PREHOOK: query: select * from multi0_1_mm order by key, key2
PREHOOK: type: QUERY
PREHOOK: Input: default@multi0_1_mm
#### A masked pattern was here ####
POSTHOOK: query: select * from multi0_1_mm order by key, key2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@multi0_1_mm
#### A masked pattern was here ####
0	456
10	456
97	455
98	455
455	97
455	98
456	0
456	10
PREHOOK: query: select * from multi0_2_mm order by key, key2
PREHOOK: type: QUERY
PREHOOK: Input: default@multi0_2_mm
#### A masked pattern was here ####
POSTHOOK: query: select * from multi0_2_mm order by key, key2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@multi0_2_mm
#### A masked pattern was here ####
0	456
10	456
97	455
98	455
PREHOOK: query: drop table multi0_1_mm
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@multi0_1_mm
PREHOOK: Output: default@multi0_1_mm
POSTHOOK: query: drop table multi0_1_mm
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@multi0_1_mm
POSTHOOK: Output: default@multi0_1_mm
PREHOOK: query: drop table multi0_2_mm
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@multi0_2_mm
PREHOOK: Output: default@multi0_2_mm
POSTHOOK: query: drop table multi0_2_mm
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@multi0_2_mm
POSTHOOK: Output: default@multi0_2_mm
PREHOOK: query: drop table multi1_mm
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table multi1_mm
POSTHOOK: type: DROPTABLE
PREHOOK: query: create table multi1_mm (key int, key2 int) partitioned by (p int) tblproperties("transactional"="true", "transactional_properties"="insert_only")
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@multi1_mm
POSTHOOK: query: create table multi1_mm (key int, key2 int) partitioned by (p int) tblproperties("transactional"="true", "transactional_properties"="insert_only")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@multi1_mm
PREHOOK: query: from intermediate
insert into table multi1_mm partition(p=1) select p, key
insert into table multi1_mm partition(p=2) select key, p
PREHOOK: type: QUERY
PREHOOK: Input: default@intermediate
PREHOOK: Input: default@intermediate@p=455
PREHOOK: Input: default@intermediate@p=456
PREHOOK: Output: default@multi1_mm@p=1
PREHOOK: Output: default@multi1_mm@p=2
POSTHOOK: query: from intermediate
insert into table multi1_mm partition(p=1) select p, key
insert into table multi1_mm partition(p=2) select key, p
POSTHOOK: type: QUERY
POSTHOOK: Input: default@intermediate
POSTHOOK: Input: default@intermediate@p=455
POSTHOOK: Input: default@intermediate@p=456
POSTHOOK: Output: default@multi1_mm@p=1
POSTHOOK: Output: default@multi1_mm@p=2
POSTHOOK: Lineage: multi1_mm PARTITION(p=1).key SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=1).key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=2).key SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=2).key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
PREHOOK: query: select * from multi1_mm order by key, key2, p
PREHOOK: type: QUERY
PREHOOK: Input: default@multi1_mm
PREHOOK: Input: default@multi1_mm@p=1
PREHOOK: Input: default@multi1_mm@p=2
#### A masked pattern was here ####
POSTHOOK: query: select * from multi1_mm order by key, key2, p
POSTHOOK: type: QUERY
POSTHOOK: Input: default@multi1_mm
POSTHOOK: Input: default@multi1_mm@p=1
POSTHOOK: Input: default@multi1_mm@p=2
#### A masked pattern was here ####
0	456	2
10	456	2
97	455	2
98	455	2
455	97	1
455	98	1
456	0	1
456	10	1
PREHOOK: query: from intermediate
insert into table multi1_mm partition(p=2) select p, key
insert overwrite table multi1_mm partition(p=1) select key, p
PREHOOK: type: QUERY
PREHOOK: Input: default@intermediate
PREHOOK: Input: default@intermediate@p=455
PREHOOK: Input: default@intermediate@p=456
PREHOOK: Output: default@multi1_mm@p=1
PREHOOK: Output: default@multi1_mm@p=2
POSTHOOK: query: from intermediate
insert into table multi1_mm partition(p=2) select p, key
insert overwrite table multi1_mm partition(p=1) select key, p
POSTHOOK: type: QUERY
POSTHOOK: Input: default@intermediate
POSTHOOK: Input: default@intermediate@p=455
POSTHOOK: Input: default@intermediate@p=456
POSTHOOK: Output: default@multi1_mm@p=1
POSTHOOK: Output: default@multi1_mm@p=2
POSTHOOK: Lineage: multi1_mm PARTITION(p=1).key SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=1).key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=2).key SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=2).key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
PREHOOK: query: select * from multi1_mm order by key, key2, p
PREHOOK: type: QUERY
PREHOOK: Input: default@multi1_mm
PREHOOK: Input: default@multi1_mm@p=1
PREHOOK: Input: default@multi1_mm@p=2
#### A masked pattern was here ####
POSTHOOK: query: select * from multi1_mm order by key, key2, p
POSTHOOK: type: QUERY
POSTHOOK: Input: default@multi1_mm
POSTHOOK: Input: default@multi1_mm@p=1
POSTHOOK: Input: default@multi1_mm@p=2
#### A masked pattern was here ####
0	456	1
0	456	2
10	456	1
10	456	2
97	455	1
97	455	2
98	455	1
98	455	2
455	97	1
455	97	2
455	98	1
455	98	2
456	0	1
456	0	2
456	10	1
456	10	2
PREHOOK: query: from intermediate
insert into table multi1_mm partition(p) select p, key, p
insert into table multi1_mm partition(p=1) select key, p
PREHOOK: type: QUERY
PREHOOK: Input: default@intermediate
PREHOOK: Input: default@intermediate@p=455
PREHOOK: Input: default@intermediate@p=456
PREHOOK: Output: default@multi1_mm
PREHOOK: Output: default@multi1_mm@p=1
POSTHOOK: query: from intermediate
insert into table multi1_mm partition(p) select p, key, p
insert into table multi1_mm partition(p=1) select key, p
POSTHOOK: type: QUERY
POSTHOOK: Input: default@intermediate
POSTHOOK: Input: default@intermediate@p=455
POSTHOOK: Input: default@intermediate@p=456
POSTHOOK: Output: default@multi1_mm@p=1
POSTHOOK: Output: default@multi1_mm@p=455
POSTHOOK: Output: default@multi1_mm@p=456
POSTHOOK: Lineage: multi1_mm PARTITION(p=1).key SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=1).key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=455).key SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=455).key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=456).key SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=456).key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
PREHOOK: query: select key, key2, p from multi1_mm order by key, key2, p
PREHOOK: type: QUERY
PREHOOK: Input: default@multi1_mm
PREHOOK: Input: default@multi1_mm@p=1
PREHOOK: Input: default@multi1_mm@p=2
PREHOOK: Input: default@multi1_mm@p=455
PREHOOK: Input: default@multi1_mm@p=456
#### A masked pattern was here ####
POSTHOOK: query: select key, key2, p from multi1_mm order by key, key2, p
POSTHOOK: type: QUERY
POSTHOOK: Input: default@multi1_mm
POSTHOOK: Input: default@multi1_mm@p=1
POSTHOOK: Input: default@multi1_mm@p=2
POSTHOOK: Input: default@multi1_mm@p=455
POSTHOOK: Input: default@multi1_mm@p=456
#### A masked pattern was here ####
0	456	1
0	456	1
0	456	2
10	456	1
10	456	1
10	456	2
97	455	1
97	455	1
97	455	2
98	455	1
98	455	1
98	455	2
455	97	1
455	97	2
455	97	455
455	98	1
455	98	2
455	98	455
456	0	1
456	0	2
456	0	456
456	10	1
456	10	2
456	10	456
PREHOOK: query: from intermediate
insert into table multi1_mm partition(p) select p, key, 1
insert into table multi1_mm partition(p=1) select key, p
PREHOOK: type: QUERY
PREHOOK: Input: default@intermediate
PREHOOK: Input: default@intermediate@p=455
PREHOOK: Input: default@intermediate@p=456
PREHOOK: Output: default@multi1_mm
PREHOOK: Output: default@multi1_mm@p=1
POSTHOOK: query: from intermediate
insert into table multi1_mm partition(p) select p, key, 1
insert into table multi1_mm partition(p=1) select key, p
POSTHOOK: type: QUERY
POSTHOOK: Input: default@intermediate
POSTHOOK: Input: default@intermediate@p=455
POSTHOOK: Input: default@intermediate@p=456
POSTHOOK: Output: default@multi1_mm@p=1
POSTHOOK: Lineage: multi1_mm PARTITION(p=1).key SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=1).key SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=1).key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: multi1_mm PARTITION(p=1).key2 SIMPLE [(intermediate)intermediate.FieldSchema(name:p, type:int, comment:null), ]
PREHOOK: query: select key, key2, p from multi1_mm order by key, key2, p
PREHOOK: type: QUERY
PREHOOK: Input: default@multi1_mm
PREHOOK: Input: default@multi1_mm@p=1
PREHOOK: Input: default@multi1_mm@p=2
PREHOOK: Input: default@multi1_mm@p=455
PREHOOK: Input: default@multi1_mm@p=456
#### A masked pattern was here ####
POSTHOOK: query: select key, key2, p from multi1_mm order by key, key2, p
POSTHOOK: type: QUERY
POSTHOOK: Input: default@multi1_mm
POSTHOOK: Input: default@multi1_mm@p=1
POSTHOOK: Input: default@multi1_mm@p=2
POSTHOOK: Input: default@multi1_mm@p=455
POSTHOOK: Input: default@multi1_mm@p=456
#### A masked pattern was here ####
0	456	1
0	456	1
0	456	1
0	456	2
10	456	1
10	456	1
10	456	1
10	456	2
97	455	1
97	455	1
97	455	1
97	455	2
98	455	1
98	455	1
98	455	1
98	455	2
455	97	1
455	97	1
455	97	2
455	97	455
455	98	1
455	98	1
455	98	2
455	98	455
456	0	1
456	0	1
456	0	2
456	0	456
456	10	1
456	10	1
456	10	2
456	10	456
PREHOOK: query: drop table multi1_mm
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@multi1_mm
PREHOOK: Output: default@multi1_mm
POSTHOOK: query: drop table multi1_mm
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@multi1_mm
POSTHOOK: Output: default@multi1_mm
PREHOOK: query: drop table intermediate
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@intermediate
PREHOOK: Output: default@intermediate
POSTHOOK: query: drop table intermediate
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@intermediate
POSTHOOK: Output: default@intermediate
