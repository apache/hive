PREHOOK: query: create table tmp1 (a int, b string) stored as orc TBLPROPERTIES ('transactional'='true')
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tmp1
POSTHOOK: query: create table tmp1 (a int, b string) stored as orc TBLPROPERTIES ('transactional'='true')
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tmp1
PREHOOK: query: create table tmp2 (a int, b string) stored as orc TBLPROPERTIES ('transactional'='true')
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tmp2
POSTHOOK: query: create table tmp2 (a int, b string) stored as orc TBLPROPERTIES ('transactional'='true')
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tmp2
PREHOOK: query: insert into table tmp1 values (3, "a")
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@tmp1
POSTHOOK: query: insert into table tmp1 values (3, "a")
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@tmp1
POSTHOOK: Lineage: tmp1.a SCRIPT []
POSTHOOK: Lineage: tmp1.b SCRIPT []
col1	col2
PREHOOK: query: explain cbo
select count(*) from tmp1
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
#### A masked pattern was here ####
Explain
Excluded rules: HivePruneZeroRowsTable

CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])

PREHOOK: query: select count(*) from tmp1
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
#### A masked pattern was here ####
_c0
1
PREHOOK: query: explain cbo
select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
Explain
Excluded rules: HivePruneZeroRowsTable

CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

PREHOOK: query: select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
_c0
0
PREHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
Explain
Excluded rules: HivePruneZeroRowsTable

CBO PLAN:
HiveProject(a=[$0], b=[$1], b1=[$3])
  HiveJoin(condition=[=($0, $2)], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(a=[$0], b=[$1])
      HiveFilter(condition=[IS NOT NULL($0)])
        HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])
    HiveProject(a=[$0], b=[$1])
      HiveFilter(condition=[IS NOT NULL($0)])
        HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

PREHOOK: query: select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
tmp1.a	tmp1.b	tmp2.b
PREHOOK: query: explain cbo
select count(*) from tmp1
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
#### A masked pattern was here ####
Explain
CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])

PREHOOK: query: select count(*) from tmp1
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
#### A masked pattern was here ####
_c0
1
PREHOOK: query: explain cbo
select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
Explain
CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveValues(tuples=[[]])

PREHOOK: query: select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
_c0
0
PREHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
Explain
CBO PLAN:
HiveValues(tuples=[[]])

PREHOOK: query: select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
tmp1.a	tmp1.b	tmp2.b
