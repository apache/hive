PREHOOK: query: create table tmp1 (a int) stored as orc
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tmp1
POSTHOOK: query: create table tmp1 (a int) stored as orc
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tmp1
PREHOOK: query: create table tmp2 (a int) stored as orc
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tmp2
POSTHOOK: query: create table tmp2 (a int) stored as orc
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tmp2
PREHOOK: query: insert into table tmp1 values (3)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@tmp1
POSTHOOK: query: insert into table tmp1 values (3)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@tmp1
POSTHOOK: Lineage: tmp1.a SCRIPT []
PREHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
CBO PLAN:
HiveProject(a=[$0])
  HiveJoin(condition=[=($0, $1)], joinType=[inner], algorithm=[none], cost=[not available])
    HiveProject(a=[$0])
      HiveFilter(condition=[IS NOT NULL($0)])
        HiveTableScan(table=[[default, tmp1]], table:alias=[tmp1])
    HiveProject(a=[$0])
      HiveFilter(condition=[IS NOT NULL($0)])
        HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

PREHOOK: query: select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
PREHOOK: query: explain cbo
select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveTableScan(table=[[default, tmp2]], table:alias=[tmp2])

PREHOOK: query: select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
0
PREHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo 
select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
CBO PLAN:
HiveValues(tuples=[[]])

PREHOOK: query: select * from tmp1 join tmp2 using(a)
PREHOOK: type: QUERY
PREHOOK: Input: default@tmp1
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select * from tmp1 join tmp2 using(a)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@tmp1
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
PREHOOK: query: explain cbo
select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: explain cbo
select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
CBO PLAN:
HiveAggregate(group=[{}], agg#0=[count()])
  HiveValues(tuples=[[]])

PREHOOK: query: select count(*) from tmp2
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Input: default@tmp2
#### A masked pattern was here ####
POSTHOOK: query: select count(*) from tmp2
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Input: default@tmp2
#### A masked pattern was here ####
0
