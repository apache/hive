PREHOOK: query: CREATE TABLE vector_ptf_part_simple_text(p_mfgr string, p_name string, p_date date, p_retailprice double,
  p_char char(1), p_varchar varchar(5), p_boolean boolean, rowindex int)
        ROW FORMAT DELIMITED
        FIELDS TERMINATED BY ','
        STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@vector_ptf_part_simple_text
POSTHOOK: query: CREATE TABLE vector_ptf_part_simple_text(p_mfgr string, p_name string, p_date date, p_retailprice double,
  p_char char(1), p_varchar varchar(5), p_boolean boolean, rowindex int)
        ROW FORMAT DELIMITED
        FIELDS TERMINATED BY ','
        STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@vector_ptf_part_simple_text
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/vector_ptf_part_simple_all_datatypes.txt' OVERWRITE INTO TABLE vector_ptf_part_simple_text
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@vector_ptf_part_simple_text
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/vector_ptf_part_simple_all_datatypes.txt' OVERWRITE INTO TABLE vector_ptf_part_simple_text
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@vector_ptf_part_simple_text
PREHOOK: query: CREATE TABLE vector_ptf_part_simple_orc (p_mfgr string, p_name string, p_date date, p_timestamp timestamp,
  p_int int, p_retailprice double, p_decimal decimal(10,4), p_char char(1), p_varchar varchar(5),
  p_boolean boolean, rowindex int) stored as orc
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@vector_ptf_part_simple_orc
POSTHOOK: query: CREATE TABLE vector_ptf_part_simple_orc (p_mfgr string, p_name string, p_date date, p_timestamp timestamp,
  p_int int, p_retailprice double, p_decimal decimal(10,4), p_char char(1), p_varchar varchar(5),
  p_boolean boolean, rowindex int) stored as orc
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@vector_ptf_part_simple_orc
PREHOOK: query: SELECT * FROM vector_ptf_part_simple_text
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_text
#### A masked pattern was here ####
POSTHOOK: query: SELECT * FROM vector_ptf_part_simple_text
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_text
#### A masked pattern was here ####
vector_ptf_part_simple_text.p_mfgr	vector_ptf_part_simple_text.p_name	vector_ptf_part_simple_text.p_date	vector_ptf_part_simple_text.p_retailprice	vector_ptf_part_simple_text.p_char	vector_ptf_part_simple_text.p_varchar	vector_ptf_part_simple_text.p_boolean	vector_ptf_part_simple_text.rowindex
Manufacturer#2	almond aquamarine rose maroon antique	NULL	900.66	A	DA	true	1
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02	1414.42	B	AB	true	2
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03	1698.66	C	CA	true	3
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	NULL	A	DE	true	4
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1753.76	B	AC	false	5
Manufacturer#5	almond antique medium spring khaki	1970-01-01	1611.66	C	AA	false	6
Manufacturer#5	almond antique blue firebrick mint	NULL	1789.69	D	FD	true	7
Manufacturer#1	almond antique burnished rose metallic	1970-01-03	1173.15	A	SM	false	8
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	1632.66	B	AK	false	9
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05	1190.27	C	AY	true	10
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01	1844.92	D	FD	false	11
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02	1753.76	D	DA	true	12
Manufacturer#2	almond antique violet turquoise frosted	NULL	1800.7	B	AC	false	13
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04	NULL	C	BB	false	14
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05	1690.68	D	LM	NULL	15
Manufacturer#4	almond antique violet mint lemon	1970-01-01	1375.42	B	OP	true	16
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02	1632.66	D	RS	true	17
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03	1464.48	C	AB	true	18
Manufacturer#3	almond antique forest lavender goldenrod	NULL	590.27	D	CD	true	19
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1753.76	A	EF	false	20
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01	1800.7	B	AA	false	21
Manufacturer#5	almond antique sky peru orange	1970-01-02	1788.73	A	BB	false	22
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03	1632.66	D	CC	true	23
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04	99.68	C	DD	false	24
Manufacturer#4	almond antique gainsboro frosted violet	NULL	NULL	A	EE	false	25
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	1753.76	C	AD	true	26
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02	1800.7	D	AB	true	27
Manufacturer#3	almond antique olive coral navajo	1970-01-03	1337.29	A	AC	false	28
Manufacturer#5	almond antique medium spring khaki	1970-01-04	1611.66	B	AA	false	29
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05	1602.59	C	BB	true	30
Manufacturer#3	almond antique misty red olive	1970-01-01	1922.98	D	BC	false	31
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	1000.6	A	BD	NULL	32
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03	1190.27	B	CA	false	33
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04	2031.98	C	CB	true	34
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	NULL	A	CC	false	35
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01	1018.1	B	CD	true	36
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02	1290.35	C	DA	NULL	37
Manufacturer#3	almond antique metallic orange dim	NULL	55.39	D	DB	true	38
Manufacturer#1	almond antique burnished rose metallic	1970-01-04	1173.15	D	DC	false	39
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	1206.26	C	DD	true	40
PREHOOK: query: INSERT INTO TABLE vector_ptf_part_simple_orc 
SELECT 
p_mfgr, p_name, p_date, 
CAST(FROM_UNIXTIME(UNIX_TIMESTAMP(p_date)) as TIMESTAMP), 
CAST(UNIX_TIMESTAMP(p_date) as int), p_retailprice, 
CAST(p_retailprice as DECIMAL(10,4)),
p_char,
p_varchar,
p_boolean,
rowindex 
FROM vector_ptf_part_simple_text
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_text
PREHOOK: Output: default@vector_ptf_part_simple_orc
POSTHOOK: query: INSERT INTO TABLE vector_ptf_part_simple_orc 
SELECT 
p_mfgr, p_name, p_date, 
CAST(FROM_UNIXTIME(UNIX_TIMESTAMP(p_date)) as TIMESTAMP), 
CAST(UNIX_TIMESTAMP(p_date) as int), p_retailprice, 
CAST(p_retailprice as DECIMAL(10,4)),
p_char,
p_varchar,
p_boolean,
rowindex 
FROM vector_ptf_part_simple_text
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_text
POSTHOOK: Output: default@vector_ptf_part_simple_orc
POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_boolean SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_boolean, type:boolean, comment:null), ]
POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_char SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_char, type:char(1), comment:null), ]
POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_date SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_date, type:date, comment:null), ]
POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_decimal EXPRESSION [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_retailprice, type:double, comment:null), ]
POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_int EXPRESSION [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_date, type:date, comment:null), ]
POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_mfgr SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_mfgr, type:string, comment:null), ]
POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_name SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_name, type:string, comment:null), ]
POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_retailprice SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_retailprice, type:double, comment:null), ]
POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_timestamp EXPRESSION [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_date, type:date, comment:null), ]
POSTHOOK: Lineage: vector_ptf_part_simple_orc.p_varchar SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:p_varchar, type:varchar(5), comment:null), ]
POSTHOOK: Lineage: vector_ptf_part_simple_orc.rowindex SIMPLE [(vector_ptf_part_simple_text)vector_ptf_part_simple_text.FieldSchema(name:rowindex, type:int, comment:null), ]
p_mfgr	p_name	p_date	_c3	_c4	p_retailprice	_c6	p_char	p_varchar	p_boolean	rowindex
PREHOOK: query: SELECT * FROM vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: SELECT * FROM vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
vector_ptf_part_simple_orc.p_mfgr	vector_ptf_part_simple_orc.p_name	vector_ptf_part_simple_orc.p_date	vector_ptf_part_simple_orc.p_timestamp	vector_ptf_part_simple_orc.p_int	vector_ptf_part_simple_orc.p_retailprice	vector_ptf_part_simple_orc.p_decimal	vector_ptf_part_simple_orc.p_char	vector_ptf_part_simple_orc.p_varchar	vector_ptf_part_simple_orc.p_boolean	vector_ptf_part_simple_orc.rowindex
Manufacturer#2	almond aquamarine rose maroon antique	NULL	NULL	NULL	900.66	900.6600	A	DA	true	1
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02	1970-01-02 00:00:00	115200	1414.42	1414.4200	B	AB	true	2
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03	1970-01-03 00:00:00	201600	1698.66	1698.6600	C	CA	true	3
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	1970-01-04 00:00:00	288000	NULL	NULL	A	DE	true	4
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1970-01-05 00:00:00	374400	1753.76	1753.7600	B	AC	false	5
Manufacturer#5	almond antique medium spring khaki	1970-01-01	1970-01-01 00:00:00	28800	1611.66	1611.6600	C	AA	false	6
Manufacturer#5	almond antique blue firebrick mint	NULL	NULL	NULL	1789.69	1789.6900	D	FD	true	7
Manufacturer#1	almond antique burnished rose metallic	1970-01-03	1970-01-03 00:00:00	201600	1173.15	1173.1500	A	SM	false	8
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04	1970-01-04 00:00:00	288000	1632.66	1632.6600	B	AK	false	9
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05	1970-01-05 00:00:00	374400	1190.27	1190.2700	C	AY	true	10
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01	1970-01-01 00:00:00	28800	1844.92	1844.9200	D	FD	false	11
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02	1970-01-02 00:00:00	115200	1753.76	1753.7600	D	DA	true	12
Manufacturer#2	almond antique violet turquoise frosted	NULL	NULL	NULL	1800.7	1800.7000	B	AC	false	13
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04	1970-01-04 00:00:00	288000	NULL	NULL	C	BB	false	14
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05	1970-01-05 00:00:00	374400	1690.68	1690.6800	D	LM	NULL	15
Manufacturer#4	almond antique violet mint lemon	1970-01-01	1970-01-01 00:00:00	28800	1375.42	1375.4200	B	OP	true	16
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02	1970-01-02 00:00:00	115200	1632.66	1632.6600	D	RS	true	17
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03	1970-01-03 00:00:00	201600	1464.48	1464.4800	C	AB	true	18
Manufacturer#3	almond antique forest lavender goldenrod	NULL	NULL	NULL	590.27	590.2700	D	CD	true	19
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05	1970-01-05 00:00:00	374400	1753.76	1753.7600	A	EF	false	20
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01	1970-01-01 00:00:00	28800	1800.7	1800.7000	B	AA	false	21
Manufacturer#5	almond antique sky peru orange	1970-01-02	1970-01-02 00:00:00	115200	1788.73	1788.7300	A	BB	false	22
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03	1970-01-03 00:00:00	201600	1632.66	1632.6600	D	CC	true	23
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04	1970-01-04 00:00:00	288000	99.68	99.6800	C	DD	false	24
Manufacturer#4	almond antique gainsboro frosted violet	NULL	NULL	NULL	NULL	NULL	A	EE	false	25
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	NULL	NULL	1753.76	1753.7600	C	AD	true	26
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02	1970-01-02 00:00:00	115200	1800.7	1800.7000	D	AB	true	27
Manufacturer#3	almond antique olive coral navajo	1970-01-03	1970-01-03 00:00:00	201600	1337.29	1337.2900	A	AC	false	28
Manufacturer#5	almond antique medium spring khaki	1970-01-04	1970-01-04 00:00:00	288000	1611.66	1611.6600	B	AA	false	29
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05	1970-01-05 00:00:00	374400	1602.59	1602.5900	C	BB	true	30
Manufacturer#3	almond antique misty red olive	1970-01-01	1970-01-01 00:00:00	28800	1922.98	1922.9800	D	BC	false	31
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	NULL	NULL	1000.6	1000.6000	A	BD	NULL	32
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03	1970-01-03 00:00:00	201600	1190.27	1190.2700	B	CA	false	33
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04	1970-01-04 00:00:00	288000	2031.98	2031.9800	C	CB	true	34
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	1970-01-05 00:00:00	374400	NULL	NULL	A	CC	false	35
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01	1970-01-01 00:00:00	28800	1018.1	1018.1000	B	CD	true	36
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02	1970-01-02 00:00:00	115200	1290.35	1290.3500	C	DA	NULL	37
Manufacturer#3	almond antique metallic orange dim	NULL	NULL	NULL	55.39	55.3900	D	DB	true	38
Manufacturer#1	almond antique burnished rose metallic	1970-01-04	1970-01-04 00:00:00	288000	1173.15	1173.1500	D	DC	false	39
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05	1970-01-05 00:00:00	374400	1206.26	1206.2600	C	DD	true	40
PREHOOK: query: select "************ NON_VECTORIZED REFERENCE ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ NON_VECTORIZED REFERENCE ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ NON_VECTORIZED REFERENCE ************
PREHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	rowindex	p_date	p_retailprice	cs1	cs2	c1	c2	c_order	s1	s2	min1	min2	max1	max2	avg1	avg2	rn	r	dr	r_date	dr_date	fv	lv	lead1	lag1
Manufacturer#3	almond antique forest lavender goldenrod	33	1970-01-03	1190.27	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	1	1	1	2	2	1190.27	1190.27	55.39	NULL
Manufacturer#3	almond antique olive coral navajo	28	1970-01-03	1337.29	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	8	1	1	2	2	1190.27	1190.27	NULL	1922.98
Manufacturer#3	almond antique misty red olive	31	1970-01-01	1922.98	1	1	1	1	1	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	7	1	1	1	1	1190.27	1190.27	1337.29	99.68
Manufacturer#3	almond antique chartreuse khaki white	24	1970-01-04	99.68	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	6	1	1	4	3	1190.27	1190.27	1922.98	NULL
Manufacturer#3	almond antique forest lavender goldenrod	14	1970-01-04	NULL	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	5	1	1	4	3	1190.27	1190.27	99.68	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	10	1970-01-05	1190.27	3	5	3	5	5	1289.95	3817.51	99.68	99.68	1190.27	1337.29	644.975	954.3775	4	1	1	6	4	1190.27	1190.27	NULL	590.27
Manufacturer#3	almond antique forest lavender goldenrod	19	NULL	590.27	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	3	1	1	7	5	1190.27	1190.27	1190.27	55.39
Manufacturer#3	almond antique metallic orange dim	38	NULL	55.39	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	2	1	1	7	5	1190.27	1190.27	590.27	1190.27
Manufacturer#1	almond aquamarine pink moccasin thistle	4	1970-01-04	NULL	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	1	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	9	1970-01-04	1632.66	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	2	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	23	1970-01-03	1632.66	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	3	1	1	4	2	NULL	NULL	1173.15	1632.66
Manufacturer#1	almond antique burnished rose metallic	8	1970-01-03	1173.15	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	4	1	1	4	2	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	12	1970-01-02	1753.76	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	5	1	1	1	1	NULL	NULL	1632.66	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	17	1970-01-02	1632.66	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	6	1	1	1	1	NULL	NULL	1414.42	1753.76
Manufacturer#1	almond aquamarine burnished black steel	2	1970-01-02	1414.42	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	7	1	1	1	1	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	26	NULL	1753.76	1	1	1	1	0	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	8	1	1	12	5	NULL	NULL	1753.76	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	20	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	9	1	1	9	4	NULL	NULL	1753.76	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	5	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	10	1	1	9	4	NULL	NULL	1602.59	1753.76
Manufacturer#1	almond antique salmon chartreuse burlywood	30	1970-01-05	1602.59	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	11	1	1	9	4	NULL	NULL	1173.15	1753.76
Manufacturer#1	almond antique burnished rose metallic	39	1970-01-04	1173.15	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	12	1	1	6	3	NULL	NULL	NULL	1602.59
Manufacturer#5	almond antique medium spring khaki	29	1970-01-04	1611.66	2	5	2	5	5	3076.1400000000003	7494.629999999999	1464.48	1018.1	1611.66	1788.73	1538.0700000000002	1498.926	6	1	1	5	4	1789.69	1611.66	NULL	1464.48
Manufacturer#5	almond antique blue firebrick mint	7	NULL	1789.69	1	1	1	1	0	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1	1	1	6	5	1789.69	1611.66	1018.1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	36	1970-01-01	1018.1	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	2	1	1	1	1	1789.69	1611.66	1611.66	1789.69
Manufacturer#5	almond antique medium spring khaki	6	1970-01-01	1611.66	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	3	1	1	1	1	1789.69	1611.66	1788.73	1018.1
Manufacturer#5	almond antique sky peru orange	22	1970-01-02	1788.73	3	3	3	3	3	4418.49	4418.49	1018.1	1018.1	1788.73	1788.73	1472.83	1472.83	4	1	1	3	2	1789.69	1611.66	1464.48	1611.66
Manufacturer#5	almond azure blanched chiffon midnight	18	1970-01-03	1464.48	2	4	2	4	4	3253.21	5882.969999999999	1464.48	1018.1	1788.73	1788.73	1626.605	1470.7424999999998	5	1	1	4	3	1789.69	1611.66	1611.66	1788.73
Manufacturer#4	almond antique violet mint lemon	16	1970-01-01	1375.42	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	5	1	1	1	1	1290.35	1375.42	1844.92	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	11	1970-01-01	1844.92	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	6	1	1	1	1	1290.35	1375.42	NULL	1375.42
Manufacturer#4	almond azure aquamarine papaya violet	37	1970-01-02	1290.35	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	1	1	1	3	2	1290.35	1375.42	1206.26	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	40	1970-01-05	1206.26	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	2	1	1	4	3	1290.35	1375.42	NULL	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	35	1970-01-05	NULL	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	3	1	1	4	3	1290.35	1375.42	NULL	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	25	NULL	NULL	1	1	1	1	0	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4	1	1	6	4	1290.35	1375.42	1375.42	NULL
Manufacturer#2	almond antique violet chocolate turquoise	15	1970-01-05	1690.68	2	4	2	4	4	3722.66	7222.020000000001	1690.68	1690.68	2031.98	2031.98	1861.33	1805.5050000000003	3	1	1	5	5	1800.7	1690.68	2031.98	900.66
Manufacturer#2	almond aquamarine rose maroon antique	1	NULL	900.66	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	2	1	1	6	6	1800.7	1690.68	1690.68	1800.7
Manufacturer#2	almond antique violet turquoise frosted	13	NULL	1800.7	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	1	1	1	6	6	1800.7	1690.68	900.66	NULL
Manufacturer#2	almond aquamarine sandy cyan gainsboro	32	NULL	1000.6	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	8	1	1	6	6	1800.7	1690.68	NULL	1698.66
Manufacturer#2	almond aquamarine rose maroon antique	3	1970-01-03	1698.66	2	3	2	3	3	3499.36	5300.06	1698.66	1698.66	1800.7	1800.7	1749.68	1766.6866666666667	7	1	1	3	3	1800.7	1690.68	1000.6	1800.7
Manufacturer#2	almond antique violet turquoise frosted	27	1970-01-02	1800.7	2	2	2	2	2	3601.4	3601.4	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	6	1	1	2	2	1800.7	1690.68	1698.66	1800.7
Manufacturer#2	almond antique violet turquoise frosted	21	1970-01-01	1800.7	1	1	1	1	1	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	5	1	1	1	1	1800.7	1690.68	1800.7	2031.98
Manufacturer#2	almond aquamarine midnight light salmon	34	1970-01-04	2031.98	2	4	2	4	4	3730.6400000000003	7332.040000000001	1698.66	1698.66	2031.98	2031.98	1865.3200000000002	1833.0100000000002	4	1	1	4	4	1800.7	1690.68	1800.7	1690.68
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL
select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL
select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_mfgr (type: string), p_date (type: date)
                    null sort order: az
                    sort order: ++
                    Map-reduce partition columns: p_mfgr (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkObjectHashOperator
                        keyColumns: 0:string, 2:date
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        partitionColumns: 0:string
                        valueColumns: 1:string, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_name (type: string), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: az
                reduceColumnSortOrder: ++
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 5
                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:date, VALUE._col0:string, VALUE._col3:double, VALUE._col8:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, bigint, bigint, bigint, bigint, double, double, double, double, double, double, double, double, bigint, bigint]
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: date), VALUE._col3 (type: double), VALUE._col8 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [0, 2, 1, 3, 4]
                Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col2 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(1)~CURRENT
                              isStar: true
                            window function definition
                              alias: count_window_1
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                              isStar: true
                            window function definition
                              alias: count_window_2
                              arguments: _col10
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(1)~CURRENT
                            window function definition
                              alias: count_window_3
                              arguments: _col10
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                            window function definition
                              alias: count_window_4
                              arguments: _col2
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                            window function definition
                              alias: sum_window_5
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(1)~CURRENT
                            window function definition
                              alias: sum_window_6
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(3)~CURRENT
                            window function definition
                              alias: min_window_7
                              arguments: _col5
                              name: min
                              window function: GenericUDAFMinEvaluator
                              window frame: RANGE PRECEDING(1)~CURRENT
                            window function definition
                              alias: min_window_8
                              arguments: _col5
                              name: min
                              window function: GenericUDAFMinEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                            window function definition
                              alias: max_window_9
                              arguments: _col5
                              name: max
                              window function: GenericUDAFMaxEvaluator
                              window frame: RANGE PRECEDING(1)~CURRENT
                            window function definition
                              alias: max_window_10
                              arguments: _col5
                              name: max
                              window function: GenericUDAFMaxEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                            window function definition
                              alias: avg_window_11
                              arguments: _col5
                              name: avg
                              window function: GenericUDAFAverageEvaluatorDouble
                              window frame: RANGE PRECEDING(1)~CURRENT
                            window function definition
                              alias: avg_window_12
                              arguments: _col5
                              name: avg
                              window function: GenericUDAFAverageEvaluatorDouble
                              window frame: RANGE PRECEDING(3)~CURRENT
                            window function definition
                              alias: rank_window_16
                              arguments: _col2
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                            window function definition
                              alias: dense_rank_window_17
                              arguments: _col2
                              name: dense_rank
                              window function: GenericUDAFDenseRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorCountStar, VectorPTFEvaluatorCount, VectorPTFEvaluatorCount, VectorPTFEvaluatorCount, VectorPTFEvaluatorDoubleSum, VectorPTFEvaluatorDoubleSum, VectorPTFEvaluatorDoubleMin, VectorPTFEvaluatorDoubleMin, VectorPTFEvaluatorDoubleMax, VectorPTFEvaluatorDoubleMax, VectorPTFEvaluatorDoubleAvg, VectorPTFEvaluatorDoubleAvg, VectorPTFEvaluatorRank, VectorPTFEvaluatorDenseRank]
                      functionInputExpressions: [null, null, col 4:int, col 4:int, col 1:date, col 3:double, col 3:double, col 3:double, col 3:double, col 3:double, col 3:double, col 3:double, col 3:double, col 1:date, col 1:date]
                      functionNames: [count, count, count, count, count, sum, sum, min, min, max, max, avg, avg, rank, dense_rank]
                      keyInputColumns: [0, 1]
                      native: true
                      nonKeyInputColumns: [2, 3, 4]
                      orderExpressions: [col 1:date]
                      outputColumns: [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 2, 1, 3, 4]
                      outputTypes: [bigint, bigint, bigint, bigint, bigint, double, double, double, double, double, double, double, double, int, int, string, string, date, double, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: [18, 19]
                  Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col0 (type: string), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col10 (type: int)
                    outputColumnNames: count_window_0, count_window_1, count_window_2, count_window_3, count_window_4, sum_window_5, sum_window_6, min_window_7, min_window_8, max_window_9, max_window_10, avg_window_11, avg_window_12, rank_window_16, dense_rank_window_17, _col0, _col1, _col2, _col5, _col10
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 2, 1, 3, 4]
                    Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: string)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: string)
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkStringOperator
                          keyColumns: 0:string
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 5:bigint, 6:bigint, 7:bigint, 8:bigint, 9:bigint, 10:double, 11:double, 12:double, 13:double, 14:double, 15:double, 16:double, 17:double, 18:int, 19:int, 2:string, 1:date, 3:double, 4:int
                      Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col10 (type: int)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 20
                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:bigint, VALUE._col3:bigint, VALUE._col4:bigint, VALUE._col5:double, VALUE._col6:double, VALUE._col7:double, VALUE._col8:double, VALUE._col9:double, VALUE._col10:double, VALUE._col11:double, VALUE._col12:double, VALUE._col13:int, VALUE._col14:int, VALUE._col15:string, VALUE._col16:date, VALUE._col19:double, VALUE._col24:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, bigint, bigint, double, double, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: double), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: int), VALUE._col14 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col15 (type: string), VALUE._col16 (type: date), VALUE._col19 (type: double), VALUE._col24 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col25
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 16, 17, 18, 19]
                Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: bigint, _col1: bigint, _col2: bigint, _col3: bigint, _col4: bigint, _col5: double, _col6: double, _col7: double, _col8: double, _col9: double, _col10: double, _col11: double, _col12: double, _col13: int, _col14: int, _col15: string, _col16: string, _col17: date, _col20: double, _col25: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col15 ASC NULLS FIRST
                        partition by: _col15
                        raw input shape:
                        window functions:
                            window function definition
                              alias: row_number_window_13
                              name: row_number
                              window function: GenericUDAFRowNumberEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                            window function definition
                              alias: rank_window_14
                              arguments: _col15
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                            window function definition
                              alias: dense_rank_window_15
                              arguments: _col15
                              name: dense_rank
                              window function: GenericUDAFDenseRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                            window function definition
                              alias: first_value_window_18
                              arguments: _col20
                              name: first_value
                              window function: GenericUDAFFirstValueEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                            window function definition
                              alias: lead_window_20
                              arguments: _col20
                              name: lead
                              window function: GenericUDAFLeadEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                            window function definition
                              alias: lag_window_21
                              arguments: _col20
                              name: lag
                              window function: GenericUDAFLagEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorRowNumber, VectorPTFEvaluatorRank, VectorPTFEvaluatorDenseRank, VectorPTFEvaluatorDoubleFirstValue, VectorPTFEvaluatorLead, VectorPTFEvaluatorLag]
                      functionInputExpressions: [null, col 0:string, col 0:string, col 18:double, col 18:double, col 18:double]
                      functionNames: [row_number, rank, dense_rank, first_value, lead, lag]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
                      orderExpressions: [col 0:string]
                      outputColumns: [20, 21, 22, 23, 24, 25, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 16, 17, 18, 19]
                      outputTypes: [int, int, int, double, double, double, bigint, bigint, bigint, bigint, bigint, double, double, double, double, double, double, double, double, int, int, string, string, date, double, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: [20, 21, 22, 23]
                  Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col15 (type: string), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col25 (type: int)
                    outputColumnNames: row_number_window_13, rank_window_14, dense_rank_window_15, first_value_window_18, lead_window_20, lag_window_21, _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col25
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [20, 21, 22, 23, 24, 25, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 16, 17, 18, 19]
                    Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col15 (type: string)
                      null sort order: z
                      sort order: -
                      Map-reduce partition columns: _col15 (type: string)
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkStringOperator
                          keyColumns: 0:string
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 20:int, 21:int, 22:int, 23:double, 24:double, 25:double, 1:bigint, 2:bigint, 3:bigint, 4:bigint, 5:bigint, 6:double, 7:double, 8:double, 9:double, 10:double, 11:double, 12:double, 13:double, 14:int, 15:int, 16:string, 17:date, 18:double, 19:int
                      Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col25 (type: int)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: z
                reduceColumnSortOrder: -
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 26
                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:int, VALUE._col1:int, VALUE._col2:int, VALUE._col3:double, VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:bigint, VALUE._col8:bigint, VALUE._col9:bigint, VALUE._col10:bigint, VALUE._col11:double, VALUE._col12:double, VALUE._col13:double, VALUE._col14:double, VALUE._col15:double, VALUE._col16:double, VALUE._col17:double, VALUE._col18:double, VALUE._col19:int, VALUE._col20:int, VALUE._col21:string, VALUE._col22:date, VALUE._col25:double, VALUE._col30:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double), VALUE._col6 (type: bigint), VALUE._col7 (type: bigint), VALUE._col8 (type: bigint), VALUE._col9 (type: bigint), VALUE._col10 (type: bigint), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: double), VALUE._col14 (type: double), VALUE._col15 (type: double), VALUE._col16 (type: double), VALUE._col17 (type: double), VALUE._col18 (type: double), VALUE._col19 (type: int), VALUE._col20 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col21 (type: string), VALUE._col22 (type: date), VALUE._col25 (type: double), VALUE._col30 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col26, _col31
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 0, 22, 23, 24, 25]
                Statistics: Num rows: 40 Data size: 15584 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: int, _col1: int, _col2: int, _col3: double, _col4: double, _col5: double, _col6: bigint, _col7: bigint, _col8: bigint, _col9: bigint, _col10: bigint, _col11: double, _col12: double, _col13: double, _col14: double, _col15: double, _col16: double, _col17: double, _col18: double, _col19: int, _col20: int, _col21: string, _col22: string, _col23: date, _col26: double, _col31: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col21 DESC NULLS LAST
                        partition by: _col21
                        raw input shape:
                        window functions:
                            window function definition
                              alias: first_value_window_19
                              arguments: _col26
                              name: first_value
                              window function: GenericUDAFFirstValueEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: true
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorDoubleFirstValue]
                      functionInputExpressions: [col 24:double]
                      functionNames: [first_value]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25]
                      orderExpressions: [col 0:string]
                      outputColumns: [26, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 0, 22, 23, 24, 25]
                      outputTypes: [double, int, int, int, double, double, double, bigint, bigint, bigint, bigint, bigint, double, double, double, double, double, double, double, double, int, int, string, string, date, double, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: [26]
                  Statistics: Num rows: 40 Data size: 15584 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col21 (type: string), _col22 (type: string), _col31 (type: int), _col23 (type: date), _col26 (type: double), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col0 (type: int), _col1 (type: int), _col2 (type: int), _col19 (type: int), _col20 (type: int), _col3 (type: double), first_value_window_19 (type: double), _col4 (type: double), _col5 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [0, 22, 25, 23, 24, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 1, 2, 3, 20, 21, 4, 26, 5, 6]
                    Statistics: Num rows: 40 Data size: 13984 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 13984 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 2 ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 2 ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BATCH SIZE=2, BUFFERED BATCHES: 2 ************
PREHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	rowindex	p_date	p_retailprice	cs1	cs2	c1	c2	c_order	s1	s2	min1	min2	max1	max2	avg1	avg2	rn	r	dr	r_date	dr_date	fv	lv	lead1	lag1
Manufacturer#3	almond antique forest lavender goldenrod	33	1970-01-03	1190.27	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	1	1	1	2	2	1190.27	1190.27	55.39	NULL
Manufacturer#3	almond antique olive coral navajo	28	1970-01-03	1337.29	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	8	1	1	2	2	1190.27	1190.27	NULL	1922.98
Manufacturer#3	almond antique misty red olive	31	1970-01-01	1922.98	1	1	1	1	1	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	7	1	1	1	1	1190.27	1190.27	1337.29	99.68
Manufacturer#3	almond antique chartreuse khaki white	24	1970-01-04	99.68	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	6	1	1	4	3	1190.27	1190.27	1922.98	NULL
Manufacturer#3	almond antique forest lavender goldenrod	14	1970-01-04	NULL	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	5	1	1	4	3	1190.27	1190.27	99.68	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	10	1970-01-05	1190.27	3	5	3	5	5	1289.95	3817.51	99.68	99.68	1190.27	1337.29	644.975	954.3775	4	1	1	6	4	1190.27	1190.27	NULL	590.27
Manufacturer#3	almond antique forest lavender goldenrod	19	NULL	590.27	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	3	1	1	7	5	1190.27	1190.27	1190.27	55.39
Manufacturer#3	almond antique metallic orange dim	38	NULL	55.39	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	2	1	1	7	5	1190.27	1190.27	590.27	1190.27
Manufacturer#1	almond aquamarine pink moccasin thistle	4	1970-01-04	NULL	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	1	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	9	1970-01-04	1632.66	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	2	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	23	1970-01-03	1632.66	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	3	1	1	4	2	NULL	NULL	1173.15	1632.66
Manufacturer#1	almond antique burnished rose metallic	8	1970-01-03	1173.15	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	4	1	1	4	2	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	12	1970-01-02	1753.76	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	5	1	1	1	1	NULL	NULL	1632.66	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	17	1970-01-02	1632.66	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	6	1	1	1	1	NULL	NULL	1414.42	1753.76
Manufacturer#1	almond aquamarine burnished black steel	2	1970-01-02	1414.42	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	7	1	1	1	1	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	26	NULL	1753.76	1	1	1	1	0	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	8	1	1	12	5	NULL	NULL	1753.76	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	20	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	9	1	1	9	4	NULL	NULL	1753.76	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	5	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	10	1	1	9	4	NULL	NULL	1602.59	1753.76
Manufacturer#1	almond antique salmon chartreuse burlywood	30	1970-01-05	1602.59	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	11	1	1	9	4	NULL	NULL	1173.15	1753.76
Manufacturer#1	almond antique burnished rose metallic	39	1970-01-04	1173.15	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	12	1	1	6	3	NULL	NULL	NULL	1602.59
Manufacturer#5	almond antique medium spring khaki	29	1970-01-04	1611.66	2	5	2	5	5	3076.1400000000003	7494.629999999999	1464.48	1018.1	1611.66	1788.73	1538.0700000000002	1498.926	6	1	1	5	4	1789.69	1611.66	NULL	1464.48
Manufacturer#5	almond antique blue firebrick mint	7	NULL	1789.69	1	1	1	1	0	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1	1	1	6	5	1789.69	1611.66	1018.1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	36	1970-01-01	1018.1	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	2	1	1	1	1	1789.69	1611.66	1611.66	1789.69
Manufacturer#5	almond antique medium spring khaki	6	1970-01-01	1611.66	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	3	1	1	1	1	1789.69	1611.66	1788.73	1018.1
Manufacturer#5	almond antique sky peru orange	22	1970-01-02	1788.73	3	3	3	3	3	4418.49	4418.49	1018.1	1018.1	1788.73	1788.73	1472.83	1472.83	4	1	1	3	2	1789.69	1611.66	1464.48	1611.66
Manufacturer#5	almond azure blanched chiffon midnight	18	1970-01-03	1464.48	2	4	2	4	4	3253.21	5882.969999999999	1464.48	1018.1	1788.73	1788.73	1626.605	1470.7424999999998	5	1	1	4	3	1789.69	1611.66	1611.66	1788.73
Manufacturer#4	almond antique violet mint lemon	16	1970-01-01	1375.42	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	5	1	1	1	1	1290.35	1375.42	1844.92	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	11	1970-01-01	1844.92	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	6	1	1	1	1	1290.35	1375.42	NULL	1375.42
Manufacturer#4	almond azure aquamarine papaya violet	37	1970-01-02	1290.35	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	1	1	1	3	2	1290.35	1375.42	1206.26	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	40	1970-01-05	1206.26	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	2	1	1	4	3	1290.35	1375.42	NULL	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	35	1970-01-05	NULL	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	3	1	1	4	3	1290.35	1375.42	NULL	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	25	NULL	NULL	1	1	1	1	0	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4	1	1	6	4	1290.35	1375.42	1375.42	NULL
Manufacturer#2	almond antique violet chocolate turquoise	15	1970-01-05	1690.68	2	4	2	4	4	3722.66	7222.020000000001	1690.68	1690.68	2031.98	2031.98	1861.33	1805.5050000000003	3	1	1	5	5	1800.7	1690.68	2031.98	900.66
Manufacturer#2	almond aquamarine rose maroon antique	1	NULL	900.66	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	2	1	1	6	6	1800.7	1690.68	1690.68	1800.7
Manufacturer#2	almond antique violet turquoise frosted	13	NULL	1800.7	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	1	1	1	6	6	1800.7	1690.68	900.66	NULL
Manufacturer#2	almond aquamarine sandy cyan gainsboro	32	NULL	1000.6	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	8	1	1	6	6	1800.7	1690.68	NULL	1698.66
Manufacturer#2	almond aquamarine rose maroon antique	3	1970-01-03	1698.66	2	3	2	3	3	3499.36	5300.06	1698.66	1698.66	1800.7	1800.7	1749.68	1766.6866666666667	7	1	1	3	3	1800.7	1690.68	1000.6	1800.7
Manufacturer#2	almond antique violet turquoise frosted	27	1970-01-02	1800.7	2	2	2	2	2	3601.4	3601.4	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	6	1	1	2	2	1800.7	1690.68	1698.66	1800.7
Manufacturer#2	almond antique violet turquoise frosted	21	1970-01-01	1800.7	1	1	1	1	1	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	5	1	1	1	1	1800.7	1690.68	1800.7	2031.98
Manufacturer#2	almond aquamarine midnight light salmon	34	1970-01-04	2031.98	2	4	2	4	4	3730.6400000000003	7332.040000000001	1698.66	1698.66	2031.98	2031.98	1865.3200000000002	1833.0100000000002	4	1	1	4	4	1800.7	1690.68	1800.7	1690.68
PREHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 3 ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 3 ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BATCH SIZE=2, BUFFERED BATCHES: 3 ************
PREHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	rowindex	p_date	p_retailprice	cs1	cs2	c1	c2	c_order	s1	s2	min1	min2	max1	max2	avg1	avg2	rn	r	dr	r_date	dr_date	fv	lv	lead1	lag1
Manufacturer#3	almond antique forest lavender goldenrod	33	1970-01-03	1190.27	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	1	1	1	2	2	1190.27	1190.27	55.39	NULL
Manufacturer#3	almond antique olive coral navajo	28	1970-01-03	1337.29	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	8	1	1	2	2	1190.27	1190.27	NULL	1922.98
Manufacturer#3	almond antique misty red olive	31	1970-01-01	1922.98	1	1	1	1	1	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	7	1	1	1	1	1190.27	1190.27	1337.29	99.68
Manufacturer#3	almond antique chartreuse khaki white	24	1970-01-04	99.68	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	6	1	1	4	3	1190.27	1190.27	1922.98	NULL
Manufacturer#3	almond antique forest lavender goldenrod	14	1970-01-04	NULL	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	5	1	1	4	3	1190.27	1190.27	99.68	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	10	1970-01-05	1190.27	3	5	3	5	5	1289.95	3817.51	99.68	99.68	1190.27	1337.29	644.975	954.3775	4	1	1	6	4	1190.27	1190.27	NULL	590.27
Manufacturer#3	almond antique forest lavender goldenrod	19	NULL	590.27	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	3	1	1	7	5	1190.27	1190.27	1190.27	55.39
Manufacturer#3	almond antique metallic orange dim	38	NULL	55.39	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	2	1	1	7	5	1190.27	1190.27	590.27	1190.27
Manufacturer#1	almond aquamarine pink moccasin thistle	4	1970-01-04	NULL	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	1	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	9	1970-01-04	1632.66	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	2	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	23	1970-01-03	1632.66	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	3	1	1	4	2	NULL	NULL	1173.15	1632.66
Manufacturer#1	almond antique burnished rose metallic	8	1970-01-03	1173.15	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	4	1	1	4	2	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	12	1970-01-02	1753.76	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	5	1	1	1	1	NULL	NULL	1632.66	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	17	1970-01-02	1632.66	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	6	1	1	1	1	NULL	NULL	1414.42	1753.76
Manufacturer#1	almond aquamarine burnished black steel	2	1970-01-02	1414.42	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	7	1	1	1	1	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	26	NULL	1753.76	1	1	1	1	0	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	8	1	1	12	5	NULL	NULL	1753.76	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	20	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	9	1	1	9	4	NULL	NULL	1753.76	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	5	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	10	1	1	9	4	NULL	NULL	1602.59	1753.76
Manufacturer#1	almond antique salmon chartreuse burlywood	30	1970-01-05	1602.59	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	11	1	1	9	4	NULL	NULL	1173.15	1753.76
Manufacturer#1	almond antique burnished rose metallic	39	1970-01-04	1173.15	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	12	1	1	6	3	NULL	NULL	NULL	1602.59
Manufacturer#5	almond antique medium spring khaki	29	1970-01-04	1611.66	2	5	2	5	5	3076.1400000000003	7494.629999999999	1464.48	1018.1	1611.66	1788.73	1538.0700000000002	1498.926	6	1	1	5	4	1789.69	1611.66	NULL	1464.48
Manufacturer#5	almond antique blue firebrick mint	7	NULL	1789.69	1	1	1	1	0	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1	1	1	6	5	1789.69	1611.66	1018.1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	36	1970-01-01	1018.1	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	2	1	1	1	1	1789.69	1611.66	1611.66	1789.69
Manufacturer#5	almond antique medium spring khaki	6	1970-01-01	1611.66	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	3	1	1	1	1	1789.69	1611.66	1788.73	1018.1
Manufacturer#5	almond antique sky peru orange	22	1970-01-02	1788.73	3	3	3	3	3	4418.49	4418.49	1018.1	1018.1	1788.73	1788.73	1472.83	1472.83	4	1	1	3	2	1789.69	1611.66	1464.48	1611.66
Manufacturer#5	almond azure blanched chiffon midnight	18	1970-01-03	1464.48	2	4	2	4	4	3253.21	5882.969999999999	1464.48	1018.1	1788.73	1788.73	1626.605	1470.7424999999998	5	1	1	4	3	1789.69	1611.66	1611.66	1788.73
Manufacturer#4	almond antique violet mint lemon	16	1970-01-01	1375.42	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	5	1	1	1	1	1290.35	1375.42	1844.92	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	11	1970-01-01	1844.92	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	6	1	1	1	1	1290.35	1375.42	NULL	1375.42
Manufacturer#4	almond azure aquamarine papaya violet	37	1970-01-02	1290.35	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	1	1	1	3	2	1290.35	1375.42	1206.26	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	40	1970-01-05	1206.26	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	2	1	1	4	3	1290.35	1375.42	NULL	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	35	1970-01-05	NULL	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	3	1	1	4	3	1290.35	1375.42	NULL	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	25	NULL	NULL	1	1	1	1	0	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4	1	1	6	4	1290.35	1375.42	1375.42	NULL
Manufacturer#2	almond antique violet chocolate turquoise	15	1970-01-05	1690.68	2	4	2	4	4	3722.66	7222.020000000001	1690.68	1690.68	2031.98	2031.98	1861.33	1805.5050000000003	3	1	1	5	5	1800.7	1690.68	2031.98	900.66
Manufacturer#2	almond aquamarine rose maroon antique	1	NULL	900.66	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	2	1	1	6	6	1800.7	1690.68	1690.68	1800.7
Manufacturer#2	almond antique violet turquoise frosted	13	NULL	1800.7	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	1	1	1	6	6	1800.7	1690.68	900.66	NULL
Manufacturer#2	almond aquamarine sandy cyan gainsboro	32	NULL	1000.6	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	8	1	1	6	6	1800.7	1690.68	NULL	1698.66
Manufacturer#2	almond aquamarine rose maroon antique	3	1970-01-03	1698.66	2	3	2	3	3	3499.36	5300.06	1698.66	1698.66	1800.7	1800.7	1749.68	1766.6866666666667	7	1	1	3	3	1800.7	1690.68	1000.6	1800.7
Manufacturer#2	almond antique violet turquoise frosted	27	1970-01-02	1800.7	2	2	2	2	2	3601.4	3601.4	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	6	1	1	2	2	1800.7	1690.68	1698.66	1800.7
Manufacturer#2	almond antique violet turquoise frosted	21	1970-01-01	1800.7	1	1	1	1	1	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	5	1	1	1	1	1800.7	1690.68	1800.7	2031.98
Manufacturer#2	almond aquamarine midnight light salmon	34	1970-01-04	2031.98	2	4	2	4	4	3730.6400000000003	7332.040000000001	1698.66	1698.66	2031.98	2031.98	1865.3200000000002	1833.0100000000002	4	1	1	4	4	1800.7	1690.68	1800.7	1690.68
PREHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 4 ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 4 ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BATCH SIZE=2, BUFFERED BATCHES: 4 ************
PREHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	rowindex	p_date	p_retailprice	cs1	cs2	c1	c2	c_order	s1	s2	min1	min2	max1	max2	avg1	avg2	rn	r	dr	r_date	dr_date	fv	lv	lead1	lag1
Manufacturer#3	almond antique forest lavender goldenrod	33	1970-01-03	1190.27	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	1	1	1	2	2	1190.27	1190.27	55.39	NULL
Manufacturer#3	almond antique olive coral navajo	28	1970-01-03	1337.29	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	8	1	1	2	2	1190.27	1190.27	NULL	1922.98
Manufacturer#3	almond antique misty red olive	31	1970-01-01	1922.98	1	1	1	1	1	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	7	1	1	1	1	1190.27	1190.27	1337.29	99.68
Manufacturer#3	almond antique chartreuse khaki white	24	1970-01-04	99.68	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	6	1	1	4	3	1190.27	1190.27	1922.98	NULL
Manufacturer#3	almond antique forest lavender goldenrod	14	1970-01-04	NULL	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	5	1	1	4	3	1190.27	1190.27	99.68	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	10	1970-01-05	1190.27	3	5	3	5	5	1289.95	3817.51	99.68	99.68	1190.27	1337.29	644.975	954.3775	4	1	1	6	4	1190.27	1190.27	NULL	590.27
Manufacturer#3	almond antique forest lavender goldenrod	19	NULL	590.27	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	3	1	1	7	5	1190.27	1190.27	1190.27	55.39
Manufacturer#3	almond antique metallic orange dim	38	NULL	55.39	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	2	1	1	7	5	1190.27	1190.27	590.27	1190.27
Manufacturer#1	almond aquamarine pink moccasin thistle	4	1970-01-04	NULL	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	1	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	9	1970-01-04	1632.66	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	2	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	23	1970-01-03	1632.66	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	3	1	1	4	2	NULL	NULL	1173.15	1632.66
Manufacturer#1	almond antique burnished rose metallic	8	1970-01-03	1173.15	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	4	1	1	4	2	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	12	1970-01-02	1753.76	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	5	1	1	1	1	NULL	NULL	1632.66	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	17	1970-01-02	1632.66	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	6	1	1	1	1	NULL	NULL	1414.42	1753.76
Manufacturer#1	almond aquamarine burnished black steel	2	1970-01-02	1414.42	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	7	1	1	1	1	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	26	NULL	1753.76	1	1	1	1	0	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	8	1	1	12	5	NULL	NULL	1753.76	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	20	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	9	1	1	9	4	NULL	NULL	1753.76	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	5	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	10	1	1	9	4	NULL	NULL	1602.59	1753.76
Manufacturer#1	almond antique salmon chartreuse burlywood	30	1970-01-05	1602.59	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	11	1	1	9	4	NULL	NULL	1173.15	1753.76
Manufacturer#1	almond antique burnished rose metallic	39	1970-01-04	1173.15	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	12	1	1	6	3	NULL	NULL	NULL	1602.59
Manufacturer#5	almond antique medium spring khaki	29	1970-01-04	1611.66	2	5	2	5	5	3076.1400000000003	7494.629999999999	1464.48	1018.1	1611.66	1788.73	1538.0700000000002	1498.926	6	1	1	5	4	1789.69	1611.66	NULL	1464.48
Manufacturer#5	almond antique blue firebrick mint	7	NULL	1789.69	1	1	1	1	0	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1	1	1	6	5	1789.69	1611.66	1018.1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	36	1970-01-01	1018.1	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	2	1	1	1	1	1789.69	1611.66	1611.66	1789.69
Manufacturer#5	almond antique medium spring khaki	6	1970-01-01	1611.66	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	3	1	1	1	1	1789.69	1611.66	1788.73	1018.1
Manufacturer#5	almond antique sky peru orange	22	1970-01-02	1788.73	3	3	3	3	3	4418.49	4418.49	1018.1	1018.1	1788.73	1788.73	1472.83	1472.83	4	1	1	3	2	1789.69	1611.66	1464.48	1611.66
Manufacturer#5	almond azure blanched chiffon midnight	18	1970-01-03	1464.48	2	4	2	4	4	3253.21	5882.969999999999	1464.48	1018.1	1788.73	1788.73	1626.605	1470.7424999999998	5	1	1	4	3	1789.69	1611.66	1611.66	1788.73
Manufacturer#4	almond antique violet mint lemon	16	1970-01-01	1375.42	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	5	1	1	1	1	1290.35	1375.42	1844.92	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	11	1970-01-01	1844.92	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	6	1	1	1	1	1290.35	1375.42	NULL	1375.42
Manufacturer#4	almond azure aquamarine papaya violet	37	1970-01-02	1290.35	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	1	1	1	3	2	1290.35	1375.42	1206.26	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	40	1970-01-05	1206.26	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	2	1	1	4	3	1290.35	1375.42	NULL	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	35	1970-01-05	NULL	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	3	1	1	4	3	1290.35	1375.42	NULL	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	25	NULL	NULL	1	1	1	1	0	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4	1	1	6	4	1290.35	1375.42	1375.42	NULL
Manufacturer#2	almond antique violet chocolate turquoise	15	1970-01-05	1690.68	2	4	2	4	4	3722.66	7222.020000000001	1690.68	1690.68	2031.98	2031.98	1861.33	1805.5050000000003	3	1	1	5	5	1800.7	1690.68	2031.98	900.66
Manufacturer#2	almond aquamarine rose maroon antique	1	NULL	900.66	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	2	1	1	6	6	1800.7	1690.68	1690.68	1800.7
Manufacturer#2	almond antique violet turquoise frosted	13	NULL	1800.7	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	1	1	1	6	6	1800.7	1690.68	900.66	NULL
Manufacturer#2	almond aquamarine sandy cyan gainsboro	32	NULL	1000.6	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	8	1	1	6	6	1800.7	1690.68	NULL	1698.66
Manufacturer#2	almond aquamarine rose maroon antique	3	1970-01-03	1698.66	2	3	2	3	3	3499.36	5300.06	1698.66	1698.66	1800.7	1800.7	1749.68	1766.6866666666667	7	1	1	3	3	1800.7	1690.68	1000.6	1800.7
Manufacturer#2	almond antique violet turquoise frosted	27	1970-01-02	1800.7	2	2	2	2	2	3601.4	3601.4	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	6	1	1	2	2	1800.7	1690.68	1698.66	1800.7
Manufacturer#2	almond antique violet turquoise frosted	21	1970-01-01	1800.7	1	1	1	1	1	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	5	1	1	1	1	1800.7	1690.68	1800.7	2031.98
Manufacturer#2	almond aquamarine midnight light salmon	34	1970-01-04	2031.98	2	4	2	4	4	3730.6400000000003	7332.040000000001	1698.66	1698.66	2031.98	2031.98	1865.3200000000002	1833.0100000000002	4	1	1	4	4	1800.7	1690.68	1800.7	1690.68
PREHOOK: query: select "************ BATCH SIZE=1, BUFFERED BATCHES: 2 ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BATCH SIZE=1, BUFFERED BATCHES: 2 ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BATCH SIZE=1, BUFFERED BATCHES: 2 ************
PREHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	rowindex	p_date	p_retailprice	cs1	cs2	c1	c2	c_order	s1	s2	min1	min2	max1	max2	avg1	avg2	rn	r	dr	r_date	dr_date	fv	lv	lead1	lag1
Manufacturer#3	almond antique forest lavender goldenrod	33	1970-01-03	1190.27	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	1	1	1	2	2	1190.27	1190.27	55.39	NULL
Manufacturer#3	almond antique olive coral navajo	28	1970-01-03	1337.29	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	8	1	1	2	2	1190.27	1190.27	NULL	1922.98
Manufacturer#3	almond antique misty red olive	31	1970-01-01	1922.98	1	1	1	1	1	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	7	1	1	1	1	1190.27	1190.27	1337.29	99.68
Manufacturer#3	almond antique chartreuse khaki white	24	1970-01-04	99.68	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	6	1	1	4	3	1190.27	1190.27	1922.98	NULL
Manufacturer#3	almond antique forest lavender goldenrod	14	1970-01-04	NULL	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	5	1	1	4	3	1190.27	1190.27	99.68	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	10	1970-01-05	1190.27	3	5	3	5	5	1289.95	3817.51	99.68	99.68	1190.27	1337.29	644.975	954.3775	4	1	1	6	4	1190.27	1190.27	NULL	590.27
Manufacturer#3	almond antique forest lavender goldenrod	19	NULL	590.27	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	3	1	1	7	5	1190.27	1190.27	1190.27	55.39
Manufacturer#3	almond antique metallic orange dim	38	NULL	55.39	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	2	1	1	7	5	1190.27	1190.27	590.27	1190.27
Manufacturer#1	almond aquamarine pink moccasin thistle	4	1970-01-04	NULL	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	1	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	9	1970-01-04	1632.66	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	2	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	23	1970-01-03	1632.66	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	3	1	1	4	2	NULL	NULL	1173.15	1632.66
Manufacturer#1	almond antique burnished rose metallic	8	1970-01-03	1173.15	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	4	1	1	4	2	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	12	1970-01-02	1753.76	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	5	1	1	1	1	NULL	NULL	1632.66	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	17	1970-01-02	1632.66	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	6	1	1	1	1	NULL	NULL	1414.42	1753.76
Manufacturer#1	almond aquamarine burnished black steel	2	1970-01-02	1414.42	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	7	1	1	1	1	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	26	NULL	1753.76	1	1	1	1	0	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	8	1	1	12	5	NULL	NULL	1753.76	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	20	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	9	1	1	9	4	NULL	NULL	1753.76	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	5	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	10	1	1	9	4	NULL	NULL	1602.59	1753.76
Manufacturer#1	almond antique salmon chartreuse burlywood	30	1970-01-05	1602.59	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	11	1	1	9	4	NULL	NULL	1173.15	1753.76
Manufacturer#1	almond antique burnished rose metallic	39	1970-01-04	1173.15	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	12	1	1	6	3	NULL	NULL	NULL	1602.59
Manufacturer#5	almond antique medium spring khaki	29	1970-01-04	1611.66	2	5	2	5	5	3076.1400000000003	7494.629999999999	1464.48	1018.1	1611.66	1788.73	1538.0700000000002	1498.926	6	1	1	5	4	1789.69	1611.66	NULL	1464.48
Manufacturer#5	almond antique blue firebrick mint	7	NULL	1789.69	1	1	1	1	0	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1	1	1	6	5	1789.69	1611.66	1018.1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	36	1970-01-01	1018.1	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	2	1	1	1	1	1789.69	1611.66	1611.66	1789.69
Manufacturer#5	almond antique medium spring khaki	6	1970-01-01	1611.66	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	3	1	1	1	1	1789.69	1611.66	1788.73	1018.1
Manufacturer#5	almond antique sky peru orange	22	1970-01-02	1788.73	3	3	3	3	3	4418.49	4418.49	1018.1	1018.1	1788.73	1788.73	1472.83	1472.83	4	1	1	3	2	1789.69	1611.66	1464.48	1611.66
Manufacturer#5	almond azure blanched chiffon midnight	18	1970-01-03	1464.48	2	4	2	4	4	3253.21	5882.969999999999	1464.48	1018.1	1788.73	1788.73	1626.605	1470.7424999999998	5	1	1	4	3	1789.69	1611.66	1611.66	1788.73
Manufacturer#4	almond antique violet mint lemon	16	1970-01-01	1375.42	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	5	1	1	1	1	1290.35	1375.42	1844.92	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	11	1970-01-01	1844.92	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	6	1	1	1	1	1290.35	1375.42	NULL	1375.42
Manufacturer#4	almond azure aquamarine papaya violet	37	1970-01-02	1290.35	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	1	1	1	3	2	1290.35	1375.42	1206.26	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	40	1970-01-05	1206.26	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	2	1	1	4	3	1290.35	1375.42	NULL	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	35	1970-01-05	NULL	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	3	1	1	4	3	1290.35	1375.42	NULL	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	25	NULL	NULL	1	1	1	1	0	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4	1	1	6	4	1290.35	1375.42	1375.42	NULL
Manufacturer#2	almond antique violet chocolate turquoise	15	1970-01-05	1690.68	2	4	2	4	4	3722.66	7222.020000000001	1690.68	1690.68	2031.98	2031.98	1861.33	1805.5050000000003	3	1	1	5	5	1800.7	1690.68	2031.98	900.66
Manufacturer#2	almond aquamarine rose maroon antique	1	NULL	900.66	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	2	1	1	6	6	1800.7	1690.68	1690.68	1800.7
Manufacturer#2	almond antique violet turquoise frosted	13	NULL	1800.7	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	1	1	1	6	6	1800.7	1690.68	900.66	NULL
Manufacturer#2	almond aquamarine sandy cyan gainsboro	32	NULL	1000.6	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	8	1	1	6	6	1800.7	1690.68	NULL	1698.66
Manufacturer#2	almond aquamarine rose maroon antique	3	1970-01-03	1698.66	2	3	2	3	3	3499.36	5300.06	1698.66	1698.66	1800.7	1800.7	1749.68	1766.6866666666667	7	1	1	3	3	1800.7	1690.68	1000.6	1800.7
Manufacturer#2	almond antique violet turquoise frosted	27	1970-01-02	1800.7	2	2	2	2	2	3601.4	3601.4	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	6	1	1	2	2	1800.7	1690.68	1698.66	1800.7
Manufacturer#2	almond antique violet turquoise frosted	21	1970-01-01	1800.7	1	1	1	1	1	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	5	1	1	1	1	1800.7	1690.68	1800.7	2031.98
Manufacturer#2	almond aquamarine midnight light salmon	34	1970-01-04	2031.98	2	4	2	4	4	3730.6400000000003	7332.040000000001	1698.66	1698.66	2031.98	2031.98	1865.3200000000002	1833.0100000000002	4	1	1	4	4	1800.7	1690.68	1800.7	1690.68
PREHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 3 ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 3 ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BATCH SIZE=2, BUFFERED BATCHES: 3 ************
PREHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	rowindex	p_date	p_retailprice	cs1	cs2	c1	c2	c_order	s1	s2	min1	min2	max1	max2	avg1	avg2	rn	r	dr	r_date	dr_date	fv	lv	lead1	lag1
Manufacturer#3	almond antique forest lavender goldenrod	33	1970-01-03	1190.27	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	1	1	1	2	2	1190.27	1190.27	55.39	NULL
Manufacturer#3	almond antique olive coral navajo	28	1970-01-03	1337.29	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	8	1	1	2	2	1190.27	1190.27	NULL	1922.98
Manufacturer#3	almond antique misty red olive	31	1970-01-01	1922.98	1	1	1	1	1	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	7	1	1	1	1	1190.27	1190.27	1337.29	99.68
Manufacturer#3	almond antique chartreuse khaki white	24	1970-01-04	99.68	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	6	1	1	4	3	1190.27	1190.27	1922.98	NULL
Manufacturer#3	almond antique forest lavender goldenrod	14	1970-01-04	NULL	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	5	1	1	4	3	1190.27	1190.27	99.68	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	10	1970-01-05	1190.27	3	5	3	5	5	1289.95	3817.51	99.68	99.68	1190.27	1337.29	644.975	954.3775	4	1	1	6	4	1190.27	1190.27	NULL	590.27
Manufacturer#3	almond antique forest lavender goldenrod	19	NULL	590.27	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	3	1	1	7	5	1190.27	1190.27	1190.27	55.39
Manufacturer#3	almond antique metallic orange dim	38	NULL	55.39	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	2	1	1	7	5	1190.27	1190.27	590.27	1190.27
Manufacturer#1	almond aquamarine pink moccasin thistle	4	1970-01-04	NULL	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	1	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	9	1970-01-04	1632.66	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	2	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	23	1970-01-03	1632.66	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	3	1	1	4	2	NULL	NULL	1173.15	1632.66
Manufacturer#1	almond antique burnished rose metallic	8	1970-01-03	1173.15	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	4	1	1	4	2	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	12	1970-01-02	1753.76	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	5	1	1	1	1	NULL	NULL	1632.66	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	17	1970-01-02	1632.66	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	6	1	1	1	1	NULL	NULL	1414.42	1753.76
Manufacturer#1	almond aquamarine burnished black steel	2	1970-01-02	1414.42	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	7	1	1	1	1	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	26	NULL	1753.76	1	1	1	1	0	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	8	1	1	12	5	NULL	NULL	1753.76	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	20	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	9	1	1	9	4	NULL	NULL	1753.76	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	5	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	10	1	1	9	4	NULL	NULL	1602.59	1753.76
Manufacturer#1	almond antique salmon chartreuse burlywood	30	1970-01-05	1602.59	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	11	1	1	9	4	NULL	NULL	1173.15	1753.76
Manufacturer#1	almond antique burnished rose metallic	39	1970-01-04	1173.15	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	12	1	1	6	3	NULL	NULL	NULL	1602.59
Manufacturer#5	almond antique medium spring khaki	29	1970-01-04	1611.66	2	5	2	5	5	3076.1400000000003	7494.629999999999	1464.48	1018.1	1611.66	1788.73	1538.0700000000002	1498.926	6	1	1	5	4	1789.69	1611.66	NULL	1464.48
Manufacturer#5	almond antique blue firebrick mint	7	NULL	1789.69	1	1	1	1	0	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1	1	1	6	5	1789.69	1611.66	1018.1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	36	1970-01-01	1018.1	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	2	1	1	1	1	1789.69	1611.66	1611.66	1789.69
Manufacturer#5	almond antique medium spring khaki	6	1970-01-01	1611.66	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	3	1	1	1	1	1789.69	1611.66	1788.73	1018.1
Manufacturer#5	almond antique sky peru orange	22	1970-01-02	1788.73	3	3	3	3	3	4418.49	4418.49	1018.1	1018.1	1788.73	1788.73	1472.83	1472.83	4	1	1	3	2	1789.69	1611.66	1464.48	1611.66
Manufacturer#5	almond azure blanched chiffon midnight	18	1970-01-03	1464.48	2	4	2	4	4	3253.21	5882.969999999999	1464.48	1018.1	1788.73	1788.73	1626.605	1470.7424999999998	5	1	1	4	3	1789.69	1611.66	1611.66	1788.73
Manufacturer#4	almond antique violet mint lemon	16	1970-01-01	1375.42	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	5	1	1	1	1	1290.35	1375.42	1844.92	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	11	1970-01-01	1844.92	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	6	1	1	1	1	1290.35	1375.42	NULL	1375.42
Manufacturer#4	almond azure aquamarine papaya violet	37	1970-01-02	1290.35	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	1	1	1	3	2	1290.35	1375.42	1206.26	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	40	1970-01-05	1206.26	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	2	1	1	4	3	1290.35	1375.42	NULL	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	35	1970-01-05	NULL	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	3	1	1	4	3	1290.35	1375.42	NULL	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	25	NULL	NULL	1	1	1	1	0	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4	1	1	6	4	1290.35	1375.42	1375.42	NULL
Manufacturer#2	almond antique violet chocolate turquoise	15	1970-01-05	1690.68	2	4	2	4	4	3722.66	7222.020000000001	1690.68	1690.68	2031.98	2031.98	1861.33	1805.5050000000003	3	1	1	5	5	1800.7	1690.68	2031.98	900.66
Manufacturer#2	almond aquamarine rose maroon antique	1	NULL	900.66	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	2	1	1	6	6	1800.7	1690.68	1690.68	1800.7
Manufacturer#2	almond antique violet turquoise frosted	13	NULL	1800.7	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	1	1	1	6	6	1800.7	1690.68	900.66	NULL
Manufacturer#2	almond aquamarine sandy cyan gainsboro	32	NULL	1000.6	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	8	1	1	6	6	1800.7	1690.68	NULL	1698.66
Manufacturer#2	almond aquamarine rose maroon antique	3	1970-01-03	1698.66	2	3	2	3	3	3499.36	5300.06	1698.66	1698.66	1800.7	1800.7	1749.68	1766.6866666666667	7	1	1	3	3	1800.7	1690.68	1000.6	1800.7
Manufacturer#2	almond antique violet turquoise frosted	27	1970-01-02	1800.7	2	2	2	2	2	3601.4	3601.4	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	6	1	1	2	2	1800.7	1690.68	1698.66	1800.7
Manufacturer#2	almond antique violet turquoise frosted	21	1970-01-01	1800.7	1	1	1	1	1	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	5	1	1	1	1	1800.7	1690.68	1800.7	2031.98
Manufacturer#2	almond aquamarine midnight light salmon	34	1970-01-04	2031.98	2	4	2	4	4	3730.6400000000003	7332.040000000001	1698.66	1698.66	2031.98	2031.98	1865.3200000000002	1833.0100000000002	4	1	1	4	4	1800.7	1690.68	1800.7	1690.68
PREHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 5 ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 5 ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BATCH SIZE=2, BUFFERED BATCHES: 5 ************
PREHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	rowindex	p_date	p_retailprice	cs1	cs2	c1	c2	c_order	s1	s2	min1	min2	max1	max2	avg1	avg2	rn	r	dr	r_date	dr_date	fv	lv	lead1	lag1
Manufacturer#3	almond antique forest lavender goldenrod	33	1970-01-03	1190.27	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	1	1	1	2	2	1190.27	1190.27	55.39	NULL
Manufacturer#3	almond antique olive coral navajo	28	1970-01-03	1337.29	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	8	1	1	2	2	1190.27	1190.27	NULL	1922.98
Manufacturer#3	almond antique misty red olive	31	1970-01-01	1922.98	1	1	1	1	1	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	7	1	1	1	1	1190.27	1190.27	1337.29	99.68
Manufacturer#3	almond antique chartreuse khaki white	24	1970-01-04	99.68	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	6	1	1	4	3	1190.27	1190.27	1922.98	NULL
Manufacturer#3	almond antique forest lavender goldenrod	14	1970-01-04	NULL	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	5	1	1	4	3	1190.27	1190.27	99.68	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	10	1970-01-05	1190.27	3	5	3	5	5	1289.95	3817.51	99.68	99.68	1190.27	1337.29	644.975	954.3775	4	1	1	6	4	1190.27	1190.27	NULL	590.27
Manufacturer#3	almond antique forest lavender goldenrod	19	NULL	590.27	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	3	1	1	7	5	1190.27	1190.27	1190.27	55.39
Manufacturer#3	almond antique metallic orange dim	38	NULL	55.39	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	2	1	1	7	5	1190.27	1190.27	590.27	1190.27
Manufacturer#1	almond aquamarine pink moccasin thistle	4	1970-01-04	NULL	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	1	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	9	1970-01-04	1632.66	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	2	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	23	1970-01-03	1632.66	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	3	1	1	4	2	NULL	NULL	1173.15	1632.66
Manufacturer#1	almond antique burnished rose metallic	8	1970-01-03	1173.15	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	4	1	1	4	2	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	12	1970-01-02	1753.76	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	5	1	1	1	1	NULL	NULL	1632.66	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	17	1970-01-02	1632.66	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	6	1	1	1	1	NULL	NULL	1414.42	1753.76
Manufacturer#1	almond aquamarine burnished black steel	2	1970-01-02	1414.42	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	7	1	1	1	1	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	26	NULL	1753.76	1	1	1	1	0	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	8	1	1	12	5	NULL	NULL	1753.76	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	20	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	9	1	1	9	4	NULL	NULL	1753.76	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	5	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	10	1	1	9	4	NULL	NULL	1602.59	1753.76
Manufacturer#1	almond antique salmon chartreuse burlywood	30	1970-01-05	1602.59	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	11	1	1	9	4	NULL	NULL	1173.15	1753.76
Manufacturer#1	almond antique burnished rose metallic	39	1970-01-04	1173.15	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	12	1	1	6	3	NULL	NULL	NULL	1602.59
Manufacturer#5	almond antique medium spring khaki	29	1970-01-04	1611.66	2	5	2	5	5	3076.1400000000003	7494.629999999999	1464.48	1018.1	1611.66	1788.73	1538.0700000000002	1498.926	6	1	1	5	4	1789.69	1611.66	NULL	1464.48
Manufacturer#5	almond antique blue firebrick mint	7	NULL	1789.69	1	1	1	1	0	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1	1	1	6	5	1789.69	1611.66	1018.1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	36	1970-01-01	1018.1	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	2	1	1	1	1	1789.69	1611.66	1611.66	1789.69
Manufacturer#5	almond antique medium spring khaki	6	1970-01-01	1611.66	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	3	1	1	1	1	1789.69	1611.66	1788.73	1018.1
Manufacturer#5	almond antique sky peru orange	22	1970-01-02	1788.73	3	3	3	3	3	4418.49	4418.49	1018.1	1018.1	1788.73	1788.73	1472.83	1472.83	4	1	1	3	2	1789.69	1611.66	1464.48	1611.66
Manufacturer#5	almond azure blanched chiffon midnight	18	1970-01-03	1464.48	2	4	2	4	4	3253.21	5882.969999999999	1464.48	1018.1	1788.73	1788.73	1626.605	1470.7424999999998	5	1	1	4	3	1789.69	1611.66	1611.66	1788.73
Manufacturer#4	almond antique violet mint lemon	16	1970-01-01	1375.42	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	5	1	1	1	1	1290.35	1375.42	1844.92	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	11	1970-01-01	1844.92	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	6	1	1	1	1	1290.35	1375.42	NULL	1375.42
Manufacturer#4	almond azure aquamarine papaya violet	37	1970-01-02	1290.35	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	1	1	1	3	2	1290.35	1375.42	1206.26	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	40	1970-01-05	1206.26	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	2	1	1	4	3	1290.35	1375.42	NULL	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	35	1970-01-05	NULL	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	3	1	1	4	3	1290.35	1375.42	NULL	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	25	NULL	NULL	1	1	1	1	0	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4	1	1	6	4	1290.35	1375.42	1375.42	NULL
Manufacturer#2	almond antique violet chocolate turquoise	15	1970-01-05	1690.68	2	4	2	4	4	3722.66	7222.020000000001	1690.68	1690.68	2031.98	2031.98	1861.33	1805.5050000000003	3	1	1	5	5	1800.7	1690.68	2031.98	900.66
Manufacturer#2	almond aquamarine rose maroon antique	1	NULL	900.66	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	2	1	1	6	6	1800.7	1690.68	1690.68	1800.7
Manufacturer#2	almond antique violet turquoise frosted	13	NULL	1800.7	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	1	1	1	6	6	1800.7	1690.68	900.66	NULL
Manufacturer#2	almond aquamarine sandy cyan gainsboro	32	NULL	1000.6	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	8	1	1	6	6	1800.7	1690.68	NULL	1698.66
Manufacturer#2	almond aquamarine rose maroon antique	3	1970-01-03	1698.66	2	3	2	3	3	3499.36	5300.06	1698.66	1698.66	1800.7	1800.7	1749.68	1766.6866666666667	7	1	1	3	3	1800.7	1690.68	1000.6	1800.7
Manufacturer#2	almond antique violet turquoise frosted	27	1970-01-02	1800.7	2	2	2	2	2	3601.4	3601.4	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	6	1	1	2	2	1800.7	1690.68	1698.66	1800.7
Manufacturer#2	almond antique violet turquoise frosted	21	1970-01-01	1800.7	1	1	1	1	1	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	5	1	1	1	1	1800.7	1690.68	1800.7	2031.98
Manufacturer#2	almond aquamarine midnight light salmon	34	1970-01-04	2031.98	2	4	2	4	4	3730.6400000000003	7332.040000000001	1698.66	1698.66	2031.98	2031.98	1865.3200000000002	1833.0100000000002	4	1	1	4	4	1800.7	1690.68	1800.7	1690.68
PREHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 10 ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BATCH SIZE=2, BUFFERED BATCHES: 10 ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BATCH SIZE=2, BUFFERED BATCHES: 10 ************
PREHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and current row) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	rowindex	p_date	p_retailprice	cs1	cs2	c1	c2	c_order	s1	s2	min1	min2	max1	max2	avg1	avg2	rn	r	dr	r_date	dr_date	fv	lv	lead1	lag1
Manufacturer#3	almond antique forest lavender goldenrod	33	1970-01-03	1190.27	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	1	1	1	2	2	1190.27	1190.27	55.39	NULL
Manufacturer#3	almond antique olive coral navajo	28	1970-01-03	1337.29	2	3	2	3	3	2527.56	4450.54	1190.27	1190.27	1337.29	1922.98	1263.78	1483.5133333333333	8	1	1	2	2	1190.27	1190.27	NULL	1922.98
Manufacturer#3	almond antique misty red olive	31	1970-01-01	1922.98	1	1	1	1	1	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	1922.98	7	1	1	1	1	1190.27	1190.27	1337.29	99.68
Manufacturer#3	almond antique chartreuse khaki white	24	1970-01-04	99.68	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	6	1	1	4	3	1190.27	1190.27	1922.98	NULL
Manufacturer#3	almond antique forest lavender goldenrod	14	1970-01-04	NULL	4	5	4	5	5	2627.24	4550.22	99.68	99.68	1337.29	1922.98	875.7466666666666	1137.555	5	1	1	4	3	1190.27	1190.27	99.68	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	10	1970-01-05	1190.27	3	5	3	5	5	1289.95	3817.51	99.68	99.68	1190.27	1337.29	644.975	954.3775	4	1	1	6	4	1190.27	1190.27	NULL	590.27
Manufacturer#3	almond antique forest lavender goldenrod	19	NULL	590.27	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	3	1	1	7	5	1190.27	1190.27	1190.27	55.39
Manufacturer#3	almond antique metallic orange dim	38	NULL	55.39	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	2	1	1	7	5	1190.27	1190.27	590.27	1190.27
Manufacturer#1	almond aquamarine pink moccasin thistle	4	1970-01-04	NULL	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	1	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	9	1970-01-04	1632.66	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	2	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	23	1970-01-03	1632.66	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	3	1	1	4	2	NULL	NULL	1173.15	1632.66
Manufacturer#1	almond antique burnished rose metallic	8	1970-01-03	1173.15	5	5	5	5	5	7606.650000000001	7606.650000000001	1173.15	1173.15	1753.76	1753.76	1521.3300000000002	1521.3300000000002	4	1	1	4	2	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	12	1970-01-02	1753.76	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	5	1	1	1	1	NULL	NULL	1632.66	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	17	1970-01-02	1632.66	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	6	1	1	1	1	NULL	NULL	1414.42	1753.76
Manufacturer#1	almond aquamarine burnished black steel	2	1970-01-02	1414.42	3	3	3	3	3	4800.84	4800.84	1414.42	1414.42	1753.76	1753.76	1600.28	1600.28	7	1	1	1	1	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	26	NULL	1753.76	1	1	1	1	0	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	8	1	1	12	5	NULL	NULL	1753.76	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	20	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	9	1	1	9	4	NULL	NULL	1753.76	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	5	1970-01-05	1753.76	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	10	1	1	9	4	NULL	NULL	1602.59	1753.76
Manufacturer#1	almond antique salmon chartreuse burlywood	30	1970-01-05	1602.59	6	11	6	11	11	7915.92	15522.57	1173.15	1173.15	1753.76	1753.76	1583.184	1552.257	11	1	1	9	4	NULL	NULL	1173.15	1753.76
Manufacturer#1	almond antique burnished rose metallic	39	1970-01-04	1173.15	5	8	5	8	8	5611.620000000001	10412.460000000001	1173.15	1173.15	1632.66	1753.76	1402.9050000000002	1487.4942857142858	12	1	1	6	3	NULL	NULL	NULL	1602.59
Manufacturer#5	almond antique medium spring khaki	29	1970-01-04	1611.66	2	5	2	5	5	3076.1400000000003	7494.629999999999	1464.48	1018.1	1611.66	1788.73	1538.0700000000002	1498.926	6	1	1	5	4	1789.69	1611.66	NULL	1464.48
Manufacturer#5	almond antique blue firebrick mint	7	NULL	1789.69	1	1	1	1	0	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1	1	1	6	5	1789.69	1611.66	1018.1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	36	1970-01-01	1018.1	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	2	1	1	1	1	1789.69	1611.66	1611.66	1789.69
Manufacturer#5	almond antique medium spring khaki	6	1970-01-01	1611.66	2	2	2	2	2	2629.76	2629.76	1018.1	1018.1	1611.66	1611.66	1314.88	1314.88	3	1	1	1	1	1789.69	1611.66	1788.73	1018.1
Manufacturer#5	almond antique sky peru orange	22	1970-01-02	1788.73	3	3	3	3	3	4418.49	4418.49	1018.1	1018.1	1788.73	1788.73	1472.83	1472.83	4	1	1	3	2	1789.69	1611.66	1464.48	1611.66
Manufacturer#5	almond azure blanched chiffon midnight	18	1970-01-03	1464.48	2	4	2	4	4	3253.21	5882.969999999999	1464.48	1018.1	1788.73	1788.73	1626.605	1470.7424999999998	5	1	1	4	3	1789.69	1611.66	1611.66	1788.73
Manufacturer#4	almond antique violet mint lemon	16	1970-01-01	1375.42	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	5	1	1	1	1	1290.35	1375.42	1844.92	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	11	1970-01-01	1844.92	2	2	2	2	2	3220.34	3220.34	1375.42	1375.42	1844.92	1844.92	1610.17	1610.17	6	1	1	1	1	1290.35	1375.42	NULL	1375.42
Manufacturer#4	almond azure aquamarine papaya violet	37	1970-01-02	1290.35	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	1	1	1	3	2	1290.35	1375.42	1206.26	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	40	1970-01-05	1206.26	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	2	1	1	4	3	1290.35	1375.42	NULL	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	35	1970-01-05	NULL	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	3	1	1	4	3	1290.35	1375.42	NULL	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	25	NULL	NULL	1	1	1	1	0	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4	1	1	6	4	1290.35	1375.42	1375.42	NULL
Manufacturer#2	almond antique violet chocolate turquoise	15	1970-01-05	1690.68	2	4	2	4	4	3722.66	7222.020000000001	1690.68	1690.68	2031.98	2031.98	1861.33	1805.5050000000003	3	1	1	5	5	1800.7	1690.68	2031.98	900.66
Manufacturer#2	almond aquamarine rose maroon antique	1	NULL	900.66	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	2	1	1	6	6	1800.7	1690.68	1690.68	1800.7
Manufacturer#2	almond antique violet turquoise frosted	13	NULL	1800.7	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	1	1	1	6	6	1800.7	1690.68	900.66	NULL
Manufacturer#2	almond aquamarine sandy cyan gainsboro	32	NULL	1000.6	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	8	1	1	6	6	1800.7	1690.68	NULL	1698.66
Manufacturer#2	almond aquamarine rose maroon antique	3	1970-01-03	1698.66	2	3	2	3	3	3499.36	5300.06	1698.66	1698.66	1800.7	1800.7	1749.68	1766.6866666666667	7	1	1	3	3	1800.7	1690.68	1000.6	1800.7
Manufacturer#2	almond antique violet turquoise frosted	27	1970-01-02	1800.7	2	2	2	2	2	3601.4	3601.4	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	6	1	1	2	2	1800.7	1690.68	1698.66	1800.7
Manufacturer#2	almond antique violet turquoise frosted	21	1970-01-01	1800.7	1	1	1	1	1	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	1800.7	5	1	1	1	1	1800.7	1690.68	1800.7	2031.98
Manufacturer#2	almond aquamarine midnight light salmon	34	1970-01-04	2031.98	2	4	2	4	4	3730.6400000000003	7332.040000000001	1698.66	1698.66	2031.98	2031.98	1865.3200000000002	1833.0100000000002	4	1	1	4	4	1800.7	1690.68	1800.7	1690.68
PREHOOK: query: select "************ FOLLOWING ROWS NON-VECTORIZED REFERENCE ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ FOLLOWING ROWS NON-VECTORIZED REFERENCE ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ FOLLOWING ROWS NON-VECTORIZED REFERENCE ************
PREHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	rowindex	p_date	p_retailprice	cs1	cs2	c1	c2	c_order	s1	s2	min1	min2	max1	max2	avg1	avg2	rn	r	dr	r_date	dr_date	fv	lv	lead1	lag1
Manufacturer#3	almond antique forest lavender goldenrod	33	1970-01-03	1190.27	5	5	5	5	5	3817.51	4550.219999999999	99.68	99.68	1337.29	1922.98	954.3775	1137.5549999999998	1	1	1	2	2	1190.27	1190.27	55.39	NULL
Manufacturer#3	almond antique olive coral navajo	28	1970-01-03	1337.29	5	5	5	5	5	3817.51	4550.219999999999	99.68	99.68	1337.29	1922.98	954.3775	1137.5549999999998	8	1	1	2	2	1190.27	1190.27	NULL	1922.98
Manufacturer#3	almond antique misty red olive	31	1970-01-01	1922.98	5	1	5	1	1	4550.22	1922.98	99.68	1922.98	1922.98	1922.98	1137.555	1922.98	7	1	1	1	1	1190.27	1190.27	1337.29	99.68
Manufacturer#3	almond antique chartreuse khaki white	24	1970-01-04	99.68	5	6	5	6	6	3817.51	5740.49	99.68	99.68	1337.29	1922.98	954.3775	1148.098	6	1	1	4	3	1190.27	1190.27	1922.98	NULL
Manufacturer#3	almond antique forest lavender goldenrod	14	1970-01-04	NULL	5	6	5	6	6	3817.51	5740.49	99.68	99.68	1337.29	1922.98	954.3775	1148.098	5	1	1	4	3	1190.27	1190.27	99.68	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	10	1970-01-05	1190.27	3	5	3	5	5	1289.9500000000003	3817.5099999999998	99.68	99.68	1190.27	1337.29	644.9750000000001	954.3774999999999	4	1	1	6	4	1190.27	1190.27	NULL	590.27
Manufacturer#3	almond antique forest lavender goldenrod	19	NULL	590.27	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	3	1	1	7	5	1190.27	1190.27	1190.27	55.39
Manufacturer#3	almond antique metallic orange dim	38	NULL	55.39	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	2	1	1	7	5	1190.27	1190.27	590.27	1190.27
Manufacturer#1	almond aquamarine pink moccasin thistle	4	1970-01-04	NULL	8	11	8	11	11	10721.73	15522.57	1173.15	1173.15	1753.76	1753.76	1531.6757142857143	1552.257	1	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	9	1970-01-04	1632.66	8	11	8	11	11	10721.73	15522.57	1173.15	1173.15	1753.76	1753.76	1531.6757142857143	1552.257	2	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	23	1970-01-03	1632.66	11	8	11	8	8	15522.57	10412.46	1173.15	1173.15	1753.76	1753.76	1552.257	1487.4942857142855	3	1	1	4	2	NULL	NULL	1173.15	1632.66
Manufacturer#1	almond antique burnished rose metallic	8	1970-01-03	1173.15	11	8	11	8	8	15522.57	10412.46	1173.15	1173.15	1753.76	1753.76	1552.257	1487.4942857142855	4	1	1	4	2	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	12	1970-01-02	1753.76	11	5	11	5	5	15522.57	7606.65	1173.15	1173.15	1753.76	1753.76	1552.257	1521.33	5	1	1	1	1	NULL	NULL	1632.66	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	17	1970-01-02	1632.66	11	5	11	5	5	15522.57	7606.65	1173.15	1173.15	1753.76	1753.76	1552.257	1521.33	6	1	1	1	1	NULL	NULL	1414.42	1753.76
Manufacturer#1	almond aquamarine burnished black steel	2	1970-01-02	1414.42	11	5	11	5	5	15522.57	7606.65	1173.15	1173.15	1753.76	1753.76	1552.257	1521.33	7	1	1	1	1	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	26	NULL	1753.76	1	1	1	1	0	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	8	1	1	12	5	NULL	NULL	1753.76	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	20	1970-01-05	1753.76	6	11	6	11	11	7915.919999999999	15522.57	1173.15	1173.15	1753.76	1753.76	1583.1839999999997	1552.257	9	1	1	9	4	NULL	NULL	1753.76	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	5	1970-01-05	1753.76	6	11	6	11	11	7915.919999999999	15522.57	1173.15	1173.15	1753.76	1753.76	1583.1839999999997	1552.257	10	1	1	9	4	NULL	NULL	1602.59	1753.76
Manufacturer#1	almond antique salmon chartreuse burlywood	30	1970-01-05	1602.59	6	11	6	11	11	7915.919999999999	15522.57	1173.15	1173.15	1753.76	1753.76	1583.1839999999997	1552.257	11	1	1	9	4	NULL	NULL	1173.15	1753.76
Manufacturer#1	almond antique burnished rose metallic	39	1970-01-04	1173.15	8	11	8	11	11	10721.73	15522.57	1173.15	1173.15	1753.76	1753.76	1531.6757142857143	1552.257	12	1	1	6	3	NULL	NULL	NULL	1602.59
Manufacturer#5	almond antique medium spring khaki	29	1970-01-04	1611.66	2	5	2	5	5	3076.139999999999	7494.629999999999	1464.48	1018.1	1611.66	1788.73	1538.0699999999995	1498.926	6	1	1	5	4	1789.69	1611.66	NULL	1464.48
Manufacturer#5	almond antique blue firebrick mint	7	NULL	1789.69	1	1	1	1	0	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1	1	1	6	5	1789.69	1611.66	1018.1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	36	1970-01-01	1018.1	5	3	5	3	3	7494.629999999999	4418.49	1018.1	1018.1	1788.73	1788.73	1498.926	1472.83	2	1	1	1	1	1789.69	1611.66	1611.66	1789.69
Manufacturer#5	almond antique medium spring khaki	6	1970-01-01	1611.66	5	3	5	3	3	7494.629999999999	4418.49	1018.1	1018.1	1788.73	1788.73	1498.926	1472.83	3	1	1	1	1	1789.69	1611.66	1788.73	1018.1
Manufacturer#5	almond antique sky peru orange	22	1970-01-02	1788.73	5	4	5	4	4	7494.629999999999	5882.969999999999	1018.1	1018.1	1788.73	1788.73	1498.926	1470.7424999999998	4	1	1	3	2	1789.69	1611.66	1464.48	1611.66
Manufacturer#5	almond azure blanched chiffon midnight	18	1970-01-03	1464.48	3	5	3	5	5	4864.869999999999	7494.629999999999	1464.48	1018.1	1788.73	1788.73	1621.623333333333	1498.926	5	1	1	4	3	1789.69	1611.66	1611.66	1788.73
Manufacturer#4	almond antique violet mint lemon	16	1970-01-01	1375.42	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	5	1	1	1	1	1290.35	1375.42	1844.92	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	11	1970-01-01	1844.92	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	6	1	1	1	1	1290.35	1375.42	NULL	1375.42
Manufacturer#4	almond azure aquamarine papaya violet	37	1970-01-02	1290.35	5	3	5	3	3	5716.950000000001	4510.6900000000005	1206.26	1290.35	1844.92	1844.92	1429.2375000000002	1503.5633333333335	1	1	1	3	2	1290.35	1375.42	1206.26	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	40	1970-01-05	1206.26	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	2	1	1	4	3	1290.35	1375.42	NULL	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	35	1970-01-05	NULL	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	3	1	1	4	3	1290.35	1375.42	NULL	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	25	NULL	NULL	1	1	1	1	0	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4	1	1	6	4	1290.35	1375.42	1375.42	NULL
Manufacturer#2	almond antique violet chocolate turquoise	15	1970-01-05	1690.68	2	4	2	4	4	3722.6600000000017	7222.020000000001	1690.68	1690.68	2031.98	2031.98	1861.3300000000008	1805.5050000000003	3	1	1	5	5	1800.7	1690.68	2031.98	900.66
Manufacturer#2	almond aquamarine rose maroon antique	1	NULL	900.66	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	2	1	1	6	6	1800.7	1690.68	1690.68	1800.7
Manufacturer#2	almond antique violet turquoise frosted	13	NULL	1800.7	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	1	1	1	6	6	1800.7	1690.68	900.66	NULL
Manufacturer#2	almond aquamarine sandy cyan gainsboro	32	NULL	1000.6	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	8	1	1	6	6	1800.7	1690.68	NULL	1698.66
Manufacturer#2	almond aquamarine rose maroon antique	3	1970-01-03	1698.66	4	4	4	4	4	7222.020000000001	7332.040000000001	1690.68	1698.66	2031.98	2031.98	1805.5050000000003	1833.0100000000002	7	1	1	3	3	1800.7	1690.68	1000.6	1800.7
Manufacturer#2	almond antique violet turquoise frosted	27	1970-01-02	1800.7	5	3	5	3	3	9022.720000000001	5300.06	1690.68	1698.66	2031.98	1800.7	1804.5440000000003	1766.6866666666667	6	1	1	2	2	1800.7	1690.68	1698.66	1800.7
Manufacturer#2	almond antique violet turquoise frosted	21	1970-01-01	1800.7	4	2	4	2	2	7332.040000000001	3601.4	1698.66	1800.7	2031.98	1800.7	1833.0100000000002	1800.7	5	1	1	1	1	1800.7	1690.68	1800.7	2031.98
Manufacturer#2	almond aquamarine midnight light salmon	34	1970-01-04	2031.98	3	5	3	5	5	5421.3200000000015	9022.720000000001	1690.68	1690.68	2031.98	2031.98	1807.1066666666673	1804.5440000000003	4	1	1	4	4	1800.7	1690.68	1800.7	1690.68
PREHOOK: query: select "************ FOLLOWING ROWS ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ FOLLOWING ROWS ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ FOLLOWING ROWS ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_mfgr (type: string), p_date (type: date)
                    null sort order: az
                    sort order: ++
                    Map-reduce partition columns: p_mfgr (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkObjectHashOperator
                        keyColumns: 0:string, 2:date
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        partitionColumns: 0:string
                        valueColumns: 1:string, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_name (type: string), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                notVectorizedReason: PTF operator: count only CURRENT ROW end frame is supported for RANGE
                vectorized: false
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: date), VALUE._col3 (type: double), VALUE._col8 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col5, _col10
                Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col2 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(1)~FOLLOWING(3)
                              isStar: true
                            window function definition
                              alias: count_window_1
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~FOLLOWING(1)
                              isStar: true
                            window function definition
                              alias: count_window_2
                              arguments: _col10
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(1)~FOLLOWING(3)
                            window function definition
                              alias: count_window_3
                              arguments: _col10
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~FOLLOWING(1)
                            window function definition
                              alias: count_window_4
                              arguments: _col2
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~FOLLOWING(1)
                            window function definition
                              alias: sum_window_5
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(1)~FOLLOWING(3)
                            window function definition
                              alias: sum_window_6
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(3)~FOLLOWING(1)
                            window function definition
                              alias: min_window_7
                              arguments: _col5
                              name: min
                              window function: GenericUDAFMinEvaluator
                              window frame: RANGE PRECEDING(1)~FOLLOWING(3)
                            window function definition
                              alias: min_window_8
                              arguments: _col5
                              name: min
                              window function: GenericUDAFMinEvaluator
                              window frame: RANGE PRECEDING(3)~FOLLOWING(1)
                            window function definition
                              alias: max_window_9
                              arguments: _col5
                              name: max
                              window function: GenericUDAFMaxEvaluator
                              window frame: RANGE PRECEDING(1)~FOLLOWING(3)
                            window function definition
                              alias: max_window_10
                              arguments: _col5
                              name: max
                              window function: GenericUDAFMaxEvaluator
                              window frame: RANGE PRECEDING(3)~FOLLOWING(1)
                            window function definition
                              alias: avg_window_11
                              arguments: _col5
                              name: avg
                              window function: GenericUDAFAverageEvaluatorDouble
                              window frame: RANGE PRECEDING(1)~FOLLOWING(3)
                            window function definition
                              alias: avg_window_12
                              arguments: _col5
                              name: avg
                              window function: GenericUDAFAverageEvaluatorDouble
                              window frame: RANGE PRECEDING(3)~FOLLOWING(1)
                            window function definition
                              alias: rank_window_16
                              arguments: _col2
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                            window function definition
                              alias: dense_rank_window_17
                              arguments: _col2
                              name: dense_rank
                              window function: GenericUDAFDenseRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col0 (type: string), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col10 (type: int)
                    outputColumnNames: count_window_0, count_window_1, count_window_2, count_window_3, count_window_4, sum_window_5, sum_window_6, min_window_7, min_window_8, max_window_9, max_window_10, avg_window_11, avg_window_12, rank_window_16, dense_rank_window_17, _col0, _col1, _col2, _col5, _col10
                    Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: string)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: string)
                      Statistics: Num rows: 40 Data size: 11104 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: count_window_0 (type: bigint), count_window_1 (type: bigint), count_window_2 (type: bigint), count_window_3 (type: bigint), count_window_4 (type: bigint), sum_window_5 (type: double), sum_window_6 (type: double), min_window_7 (type: double), min_window_8 (type: double), max_window_9 (type: double), max_window_10 (type: double), avg_window_11 (type: double), avg_window_12 (type: double), rank_window_16 (type: int), dense_rank_window_17 (type: int), _col1 (type: string), _col2 (type: date), _col5 (type: double), _col10 (type: int)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 20
                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:bigint, VALUE._col3:bigint, VALUE._col4:bigint, VALUE._col5:double, VALUE._col6:double, VALUE._col7:double, VALUE._col8:double, VALUE._col9:double, VALUE._col10:double, VALUE._col11:double, VALUE._col12:double, VALUE._col13:int, VALUE._col14:int, VALUE._col15:string, VALUE._col16:date, VALUE._col19:double, VALUE._col24:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, bigint, bigint, double, double, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: double), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: int), VALUE._col14 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col15 (type: string), VALUE._col16 (type: date), VALUE._col19 (type: double), VALUE._col24 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col25
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 16, 17, 18, 19]
                Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: bigint, _col1: bigint, _col2: bigint, _col3: bigint, _col4: bigint, _col5: double, _col6: double, _col7: double, _col8: double, _col9: double, _col10: double, _col11: double, _col12: double, _col13: int, _col14: int, _col15: string, _col16: string, _col17: date, _col20: double, _col25: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col15 ASC NULLS FIRST
                        partition by: _col15
                        raw input shape:
                        window functions:
                            window function definition
                              alias: row_number_window_13
                              name: row_number
                              window function: GenericUDAFRowNumberEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                            window function definition
                              alias: rank_window_14
                              arguments: _col15
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                            window function definition
                              alias: dense_rank_window_15
                              arguments: _col15
                              name: dense_rank
                              window function: GenericUDAFDenseRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                            window function definition
                              alias: first_value_window_18
                              arguments: _col20
                              name: first_value
                              window function: GenericUDAFFirstValueEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                            window function definition
                              alias: lead_window_20
                              arguments: _col20
                              name: lead
                              window function: GenericUDAFLeadEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                            window function definition
                              alias: lag_window_21
                              arguments: _col20
                              name: lag
                              window function: GenericUDAFLagEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorRowNumber, VectorPTFEvaluatorRank, VectorPTFEvaluatorDenseRank, VectorPTFEvaluatorDoubleFirstValue, VectorPTFEvaluatorLead, VectorPTFEvaluatorLag]
                      functionInputExpressions: [null, col 0:string, col 0:string, col 18:double, col 18:double, col 18:double]
                      functionNames: [row_number, rank, dense_rank, first_value, lead, lag]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
                      orderExpressions: [col 0:string]
                      outputColumns: [20, 21, 22, 23, 24, 25, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 16, 17, 18, 19]
                      outputTypes: [int, int, int, double, double, double, bigint, bigint, bigint, bigint, bigint, double, double, double, double, double, double, double, double, int, int, string, string, date, double, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: [20, 21, 22, 23]
                  Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col15 (type: string), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col25 (type: int)
                    outputColumnNames: row_number_window_13, rank_window_14, dense_rank_window_15, first_value_window_18, lead_window_20, lag_window_21, _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col20, _col25
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [20, 21, 22, 23, 24, 25, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 16, 17, 18, 19]
                    Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col15 (type: string)
                      null sort order: z
                      sort order: -
                      Map-reduce partition columns: _col15 (type: string)
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkStringOperator
                          keyColumns: 0:string
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 20:int, 21:int, 22:int, 23:double, 24:double, 25:double, 1:bigint, 2:bigint, 3:bigint, 4:bigint, 5:bigint, 6:double, 7:double, 8:double, 9:double, 10:double, 11:double, 12:double, 13:double, 14:int, 15:int, 16:string, 17:date, 18:double, 19:int
                      Statistics: Num rows: 40 Data size: 15104 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: row_number_window_13 (type: int), rank_window_14 (type: int), dense_rank_window_15 (type: int), first_value_window_18 (type: double), lead_window_20 (type: double), lag_window_21 (type: double), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: int), _col14 (type: int), _col16 (type: string), _col17 (type: date), _col20 (type: double), _col25 (type: int)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: z
                reduceColumnSortOrder: -
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 26
                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:int, VALUE._col1:int, VALUE._col2:int, VALUE._col3:double, VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:bigint, VALUE._col8:bigint, VALUE._col9:bigint, VALUE._col10:bigint, VALUE._col11:double, VALUE._col12:double, VALUE._col13:double, VALUE._col14:double, VALUE._col15:double, VALUE._col16:double, VALUE._col17:double, VALUE._col18:double, VALUE._col19:int, VALUE._col20:int, VALUE._col21:string, VALUE._col22:date, VALUE._col25:double, VALUE._col30:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double), VALUE._col6 (type: bigint), VALUE._col7 (type: bigint), VALUE._col8 (type: bigint), VALUE._col9 (type: bigint), VALUE._col10 (type: bigint), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: double), VALUE._col14 (type: double), VALUE._col15 (type: double), VALUE._col16 (type: double), VALUE._col17 (type: double), VALUE._col18 (type: double), VALUE._col19 (type: int), VALUE._col20 (type: int), KEY.reducesinkkey0 (type: string), VALUE._col21 (type: string), VALUE._col22 (type: date), VALUE._col25 (type: double), VALUE._col30 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col26, _col31
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 0, 22, 23, 24, 25]
                Statistics: Num rows: 40 Data size: 15584 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: int, _col1: int, _col2: int, _col3: double, _col4: double, _col5: double, _col6: bigint, _col7: bigint, _col8: bigint, _col9: bigint, _col10: bigint, _col11: double, _col12: double, _col13: double, _col14: double, _col15: double, _col16: double, _col17: double, _col18: double, _col19: int, _col20: int, _col21: string, _col22: string, _col23: date, _col26: double, _col31: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col21 DESC NULLS LAST
                        partition by: _col21
                        raw input shape:
                        window functions:
                            window function definition
                              alias: first_value_window_19
                              arguments: _col26
                              name: first_value
                              window function: GenericUDAFFirstValueEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: true
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorDoubleFirstValue]
                      functionInputExpressions: [col 24:double]
                      functionNames: [first_value]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25]
                      orderExpressions: [col 0:string]
                      outputColumns: [26, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 0, 22, 23, 24, 25]
                      outputTypes: [double, int, int, int, double, double, double, bigint, bigint, bigint, bigint, bigint, double, double, double, double, double, double, double, double, int, int, string, string, date, double, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: [26]
                  Statistics: Num rows: 40 Data size: 15584 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col21 (type: string), _col22 (type: string), _col31 (type: int), _col23 (type: date), _col26 (type: double), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col0 (type: int), _col1 (type: int), _col2 (type: int), _col19 (type: int), _col20 (type: int), _col3 (type: double), first_value_window_19 (type: double), _col4 (type: double), _col5 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [0, 22, 25, 23, 24, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 1, 2, 3, 20, 21, 4, 26, 5, 6]
                    Statistics: Num rows: 40 Data size: 13984 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 13984 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as cs1,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as cs2,
count(rowindex) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as c1,
count(rowindex) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c2,
count(p_date) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as c_order,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as s1,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as s2,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as min1,
min(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as min2,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as max1,
max(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as max2,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 1 preceding and 3 following) as avg1,
avg(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and 1 following) as avg2,
row_number() over(partition by p_mfgr) as rn,
rank() over(partition by p_mfgr) as r,
dense_rank() over(partition by p_mfgr) as dr,
rank() over(partition by p_mfgr order by p_date) as r_date,
dense_rank() over(partition by p_mfgr order by p_date) as dr_date,
first_value(p_retailprice) over(partition by p_mfgr) as fv,
last_value(p_retailprice) over(partition by p_mfgr) as lv,
lead(p_retailprice) over(partition by p_mfgr) as lead1,
lag(p_retailprice) over(partition by p_mfgr) as lag1
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	rowindex	p_date	p_retailprice	cs1	cs2	c1	c2	c_order	s1	s2	min1	min2	max1	max2	avg1	avg2	rn	r	dr	r_date	dr_date	fv	lv	lead1	lag1
Manufacturer#3	almond antique forest lavender goldenrod	33	1970-01-03	1190.27	5	5	5	5	5	3817.51	4550.219999999999	99.68	99.68	1337.29	1922.98	954.3775	1137.5549999999998	1	1	1	2	2	1190.27	1190.27	55.39	NULL
Manufacturer#3	almond antique olive coral navajo	28	1970-01-03	1337.29	5	5	5	5	5	3817.51	4550.219999999999	99.68	99.68	1337.29	1922.98	954.3775	1137.5549999999998	8	1	1	2	2	1190.27	1190.27	NULL	1922.98
Manufacturer#3	almond antique misty red olive	31	1970-01-01	1922.98	5	1	5	1	1	4550.22	1922.98	99.68	1922.98	1922.98	1922.98	1137.555	1922.98	7	1	1	1	1	1190.27	1190.27	1337.29	99.68
Manufacturer#3	almond antique chartreuse khaki white	24	1970-01-04	99.68	5	6	5	6	6	3817.51	5740.49	99.68	99.68	1337.29	1922.98	954.3775	1148.098	6	1	1	4	3	1190.27	1190.27	1922.98	NULL
Manufacturer#3	almond antique forest lavender goldenrod	14	1970-01-04	NULL	5	6	5	6	6	3817.51	5740.49	99.68	99.68	1337.29	1922.98	954.3775	1148.098	5	1	1	4	3	1190.27	1190.27	99.68	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	10	1970-01-05	1190.27	3	5	3	5	5	1289.9500000000003	3817.5099999999998	99.68	99.68	1190.27	1337.29	644.9750000000001	954.3774999999999	4	1	1	6	4	1190.27	1190.27	NULL	590.27
Manufacturer#3	almond antique forest lavender goldenrod	19	NULL	590.27	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	3	1	1	7	5	1190.27	1190.27	1190.27	55.39
Manufacturer#3	almond antique metallic orange dim	38	NULL	55.39	2	2	2	2	0	645.66	645.66	55.39	55.39	590.27	590.27	322.83	322.83	2	1	1	7	5	1190.27	1190.27	590.27	1190.27
Manufacturer#1	almond aquamarine pink moccasin thistle	4	1970-01-04	NULL	8	11	8	11	11	10721.73	15522.57	1173.15	1173.15	1753.76	1753.76	1531.6757142857143	1552.257	1	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	9	1970-01-04	1632.66	8	11	8	11	11	10721.73	15522.57	1173.15	1173.15	1753.76	1753.76	1531.6757142857143	1552.257	2	1	1	6	3	NULL	NULL	1632.66	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	23	1970-01-03	1632.66	11	8	11	8	8	15522.57	10412.46	1173.15	1173.15	1753.76	1753.76	1552.257	1487.4942857142855	3	1	1	4	2	NULL	NULL	1173.15	1632.66
Manufacturer#1	almond antique burnished rose metallic	8	1970-01-03	1173.15	11	8	11	8	8	15522.57	10412.46	1173.15	1173.15	1753.76	1753.76	1552.257	1487.4942857142855	4	1	1	4	2	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	12	1970-01-02	1753.76	11	5	11	5	5	15522.57	7606.65	1173.15	1173.15	1753.76	1753.76	1552.257	1521.33	5	1	1	1	1	NULL	NULL	1632.66	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	17	1970-01-02	1632.66	11	5	11	5	5	15522.57	7606.65	1173.15	1173.15	1753.76	1753.76	1552.257	1521.33	6	1	1	1	1	NULL	NULL	1414.42	1753.76
Manufacturer#1	almond aquamarine burnished black steel	2	1970-01-02	1414.42	11	5	11	5	5	15522.57	7606.65	1173.15	1173.15	1753.76	1753.76	1552.257	1521.33	7	1	1	1	1	NULL	NULL	1753.76	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	26	NULL	1753.76	1	1	1	1	0	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	1753.76	8	1	1	12	5	NULL	NULL	1753.76	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	20	1970-01-05	1753.76	6	11	6	11	11	7915.919999999999	15522.57	1173.15	1173.15	1753.76	1753.76	1583.1839999999997	1552.257	9	1	1	9	4	NULL	NULL	1753.76	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	5	1970-01-05	1753.76	6	11	6	11	11	7915.919999999999	15522.57	1173.15	1173.15	1753.76	1753.76	1583.1839999999997	1552.257	10	1	1	9	4	NULL	NULL	1602.59	1753.76
Manufacturer#1	almond antique salmon chartreuse burlywood	30	1970-01-05	1602.59	6	11	6	11	11	7915.919999999999	15522.57	1173.15	1173.15	1753.76	1753.76	1583.1839999999997	1552.257	11	1	1	9	4	NULL	NULL	1173.15	1753.76
Manufacturer#1	almond antique burnished rose metallic	39	1970-01-04	1173.15	8	11	8	11	11	10721.73	15522.57	1173.15	1173.15	1753.76	1753.76	1531.6757142857143	1552.257	12	1	1	6	3	NULL	NULL	NULL	1602.59
Manufacturer#5	almond antique medium spring khaki	29	1970-01-04	1611.66	2	5	2	5	5	3076.139999999999	7494.629999999999	1464.48	1018.1	1611.66	1788.73	1538.0699999999995	1498.926	6	1	1	5	4	1789.69	1611.66	NULL	1464.48
Manufacturer#5	almond antique blue firebrick mint	7	NULL	1789.69	1	1	1	1	0	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1789.69	1	1	1	6	5	1789.69	1611.66	1018.1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	36	1970-01-01	1018.1	5	3	5	3	3	7494.629999999999	4418.49	1018.1	1018.1	1788.73	1788.73	1498.926	1472.83	2	1	1	1	1	1789.69	1611.66	1611.66	1789.69
Manufacturer#5	almond antique medium spring khaki	6	1970-01-01	1611.66	5	3	5	3	3	7494.629999999999	4418.49	1018.1	1018.1	1788.73	1788.73	1498.926	1472.83	3	1	1	1	1	1789.69	1611.66	1788.73	1018.1
Manufacturer#5	almond antique sky peru orange	22	1970-01-02	1788.73	5	4	5	4	4	7494.629999999999	5882.969999999999	1018.1	1018.1	1788.73	1788.73	1498.926	1470.7424999999998	4	1	1	3	2	1789.69	1611.66	1464.48	1611.66
Manufacturer#5	almond azure blanched chiffon midnight	18	1970-01-03	1464.48	3	5	3	5	5	4864.869999999999	7494.629999999999	1464.48	1018.1	1788.73	1788.73	1621.623333333333	1498.926	5	1	1	4	3	1789.69	1611.66	1611.66	1788.73
Manufacturer#4	almond antique violet mint lemon	16	1970-01-01	1375.42	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	5	1	1	1	1	1290.35	1375.42	1844.92	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	11	1970-01-01	1844.92	3	3	3	3	3	4510.6900000000005	4510.6900000000005	1290.35	1290.35	1844.92	1844.92	1503.5633333333335	1503.5633333333335	6	1	1	1	1	1290.35	1375.42	NULL	1375.42
Manufacturer#4	almond azure aquamarine papaya violet	37	1970-01-02	1290.35	5	3	5	3	3	5716.950000000001	4510.6900000000005	1206.26	1290.35	1844.92	1844.92	1429.2375000000002	1503.5633333333335	1	1	1	3	2	1290.35	1375.42	1206.26	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	40	1970-01-05	1206.26	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	2	1	1	4	3	1290.35	1375.42	NULL	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	35	1970-01-05	NULL	2	3	2	3	3	1206.26	2496.6099999999997	1206.26	1206.26	1206.26	1290.35	1206.26	1248.3049999999998	3	1	1	4	3	1290.35	1375.42	NULL	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	25	NULL	NULL	1	1	1	1	0	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4	1	1	6	4	1290.35	1375.42	1375.42	NULL
Manufacturer#2	almond antique violet chocolate turquoise	15	1970-01-05	1690.68	2	4	2	4	4	3722.6600000000017	7222.020000000001	1690.68	1690.68	2031.98	2031.98	1861.3300000000008	1805.5050000000003	3	1	1	5	5	1800.7	1690.68	2031.98	900.66
Manufacturer#2	almond aquamarine rose maroon antique	1	NULL	900.66	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	2	1	1	6	6	1800.7	1690.68	1690.68	1800.7
Manufacturer#2	almond antique violet turquoise frosted	13	NULL	1800.7	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	1	1	1	6	6	1800.7	1690.68	900.66	NULL
Manufacturer#2	almond aquamarine sandy cyan gainsboro	32	NULL	1000.6	3	3	3	3	0	3701.96	3701.96	900.66	900.66	1800.7	1800.7	1233.9866666666667	1233.9866666666667	8	1	1	6	6	1800.7	1690.68	NULL	1698.66
Manufacturer#2	almond aquamarine rose maroon antique	3	1970-01-03	1698.66	4	4	4	4	4	7222.020000000001	7332.040000000001	1690.68	1698.66	2031.98	2031.98	1805.5050000000003	1833.0100000000002	7	1	1	3	3	1800.7	1690.68	1000.6	1800.7
Manufacturer#2	almond antique violet turquoise frosted	27	1970-01-02	1800.7	5	3	5	3	3	9022.720000000001	5300.06	1690.68	1698.66	2031.98	1800.7	1804.5440000000003	1766.6866666666667	6	1	1	2	2	1800.7	1690.68	1698.66	1800.7
Manufacturer#2	almond antique violet turquoise frosted	21	1970-01-01	1800.7	4	2	4	2	2	7332.040000000001	3601.4	1698.66	1800.7	2031.98	1800.7	1833.0100000000002	1800.7	5	1	1	1	1	1800.7	1690.68	1800.7	2031.98
Manufacturer#2	almond aquamarine midnight light salmon	34	1970-01-04	2031.98	3	5	3	5	5	5421.3200000000015	9022.720000000001	1690.68	1690.68	2031.98	2031.98	1807.1066666666673	1804.5440000000003	4	1	1	4	4	1800.7	1690.68	1800.7	1690.68
PREHOOK: query: select "************ STRING WINDOW RANGE TYPE ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ STRING WINDOW RANGE TYPE ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ STRING WINDOW RANGE TYPE ************
PREHOOK: query: select "************ STRING WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ STRING WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ STRING WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************
PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	2	2346.3
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	2	2346.3
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	4	7015.04
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	1	1602.59
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	1	1414.42
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	4	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	4	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	4	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	4	4897.9800000000005
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	1	1690.68
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	3	5402.1
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	1	2031.98
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	2	2599.32
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	2	2599.32
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	1	1000.6
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	1	99.68
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	4	2970.81
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	4	2970.81
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	4	2970.81
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	4	2970.81
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	1	55.39
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	1	1922.98
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	1	1337.29
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	1	NULL
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	1	1375.42
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	2	1206.26
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	2	1206.26
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	1	1844.92
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	1	1290.35
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	1	1789.69
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	2	3223.32
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	2	3223.32
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	1	1788.73
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	1	1018.1
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	1	1464.48
PREHOOK: query: select "************ STRING WINDOW RANGE TYPE (VECTORIZED) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ STRING WINDOW RANGE TYPE (VECTORIZED) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ STRING WINDOW RANGE TYPE (VECTORIZED) ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_mfgr (type: string), p_name (type: string)
                    null sort order: az
                    sort order: ++
                    Map-reduce partition columns: p_mfgr (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkObjectHashOperator
                        keyColumns: 0:string, 1:string
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        partitionColumns: 0:string
                        valueColumns: 2:date, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: az
                reduceColumnSortOrder: ++
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 6
                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:string, VALUE._col0:date, VALUE._col1:timestamp, VALUE._col3:double, VALUE._col8:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: date), VALUE._col1 (type: timestamp), VALUE._col3 (type: double), VALUE._col8 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5]
                Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col1 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(3)~CURRENT
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 4:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0, 1]
                      native: true
                      nonKeyInputColumns: [2, 3, 4, 5]
                      orderExpressions: [col 1:string]
                      outputColumns: [6, 7, 0, 1, 2, 3, 4, 5]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [0, 1, 3, 5, 2, 4, 6, 7]
                    Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_name range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	2	2346.3
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	2	2346.3
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	4	7015.04
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	1	1602.59
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	1	1414.42
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	4	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	4	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	4	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	4	4897.9800000000005
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	1	1690.68
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	3	5402.1
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	1	2031.98
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	2	2599.32
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	2	2599.32
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	1	1000.6
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	1	99.68
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	4	2970.81
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	4	2970.81
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	4	2970.81
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	4	2970.81
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	1	55.39
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	1	1922.98
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	1	1337.29
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	1	NULL
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	1	1375.42
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	2	1206.26
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	2	1206.26
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	1	1844.92
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	1	1290.35
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	1	1789.69
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	2	3223.32
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	2	3223.32
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	1	1788.73
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	1	1018.1
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	1	1464.48
PREHOOK: query: select "************ STRING PARTITION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ STRING PARTITION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ STRING PARTITION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_name) as cs,
sum(p_retailprice) over(partition by p_name) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_name) as cs,
sum(p_retailprice) over(partition by p_name) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_name (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: p_name (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkStringOperator
                        keyColumns: 1:string
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        valueColumns: 0:string, 2:date, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_mfgr (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 6
                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col9:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), VALUE._col9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 0, 2, 3, 4, 5]
                Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col1 ASC NULLS FIRST
                        partition by: _col1
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 4:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5]
                      orderExpressions: [col 0:string]
                      outputColumns: [6, 7, 1, 0, 2, 3, 4, 5]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 0, 3, 5, 2, 4, 6, 7]
                    Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_name) as cs,
sum(p_retailprice) over(partition by p_name) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_name) as cs,
sum(p_retailprice) over(partition by p_name) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	1	1789.69
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	2	2346.3
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	2	2346.3
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	1	99.68
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	1	NULL
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	2	3223.32
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	2	3223.32
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	1	55.39
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	1	1602.59
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	1	1788.73
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	1	1375.42
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	1	1414.42
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	1	1018.1
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	1	1000.6
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	1	1290.35
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	1	1464.48
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	4	7015.04
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	4	2970.81
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	4	2970.81
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	4	2970.81
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	4	2970.81
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	1	1922.98
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	1	1337.29
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	1	1690.68
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	3	5402.1
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	2	1206.26
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	2	1206.26
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	1	2031.98
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	4	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	4	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	4	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	4	4897.9800000000005
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	2	2599.32
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	2	2599.32
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	1	1844.92
PREHOOK: query: select "************ STRING PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ STRING PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ STRING PARTITION WITH CONSTANT PARTITION EXPRESSION ************
PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_name) as cs,
sum(p_retailprice) over(partition by p_name) as s
from vector_ptf_part_simple_orc
where p_name = 'almond antique chartreuse lavender yellow'
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_name) as cs,
sum(p_retailprice) over(partition by p_name) as s
from vector_ptf_part_simple_orc
where p_name = 'almond antique chartreuse lavender yellow'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	4	7015.04
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_name) as cs,
sum(p_retailprice) over(partition by p_name) as s
from vector_ptf_part_simple_orc
where p_name = 'almond antique chartreuse lavender yellow'
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_name) as cs,
sum(p_retailprice) over(partition by p_name) as s
from vector_ptf_part_simple_orc
where p_name = 'almond antique chartreuse lavender yellow'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  filterExpr: (p_name = 'almond antique chartreuse lavender yellow') (type: boolean)
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Filter Operator
                    Filter Vectorization:
                        className: VectorFilterOperator
                        native: true
                        predicateExpression: FilterStringGroupColEqualStringScalar(col 1:string, val almond antique chartreuse lavender yellow)
                    predicate: (p_name = 'almond antique chartreuse lavender yellow') (type: boolean)
                    Statistics: Num rows: 2 Data size: 656 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: 'almond antique chartreuse lavender yellow' (type: string)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: 'almond antique chartreuse lavender yellow' (type: string)
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkStringOperator
                          keyColumns: 13:string
                          keyExpressions: ConstantVectorExpression(val almond antique chartreuse lavender yellow) -> 13:string
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 0:string, 2:date, 3:timestamp, 5:double, 10:int
                      Statistics: Num rows: 2 Data size: 656 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: p_mfgr (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [string]
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 6
                    dataColumns: KEY.reducesinkkey0:string, VALUE._col0:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col10:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double, string, string, string]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col10 (type: int)
                outputColumnNames: _col0, _col2, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5]
                Statistics: Num rows: 2 Data size: 412 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col2: date, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: 'almond antique chartreuse lavender yellow' ASC NULLS FIRST
                        partition by: 'almond antique chartreuse lavender yellow'
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 4:double]
                      functionNames: [count, sum]
                      keyInputColumns: []
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5]
                      orderExpressions: [ConstantVectorExpression(val almond antique chartreuse lavender yellow) -> 9:string]
                      outputColumns: [6, 7, 1, 2, 3, 4, 5]
                      outputTypes: [bigint, double, string, date, timestamp, double, int]
                      partitionExpressions: [ConstantVectorExpression(val almond antique chartreuse lavender yellow) -> 8:string]
                      streamingColumns: []
                  Statistics: Num rows: 2 Data size: 412 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), 'almond antique chartreuse lavender yellow' (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 10, 3, 5, 2, 4, 6, 7]
                        selectExpressions: ConstantVectorExpression(val almond antique chartreuse lavender yellow) -> 10:string
                    Statistics: Num rows: 2 Data size: 694 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 2 Data size: 694 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select "************ TIMESTAMP WINDOW RANGE TYPE ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ TIMESTAMP WINDOW RANGE TYPE ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ TIMESTAMP WINDOW RANGE TYPE ************
PREHOOK: query: select "************ TIMESTAMP WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ TIMESTAMP WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ TIMESTAMP WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************
PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	3	4800.84
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	3	4800.84
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	3	4800.84
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	2	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	2	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	3	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	3	2805.8100000000004
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	3	2805.8100000000004
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	1	1753.76
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	1	1800.7
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	1	1800.7
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	1	1698.66
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	1	2031.98
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	1	1690.68
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	3	3701.96
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	3	3701.96
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	3	3701.96
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	1	1922.98
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	2	2527.56
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	2	2527.56
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	2	99.68
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	2	99.68
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	1	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	2	645.66
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	2	645.66
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	2	3220.34
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	2	3220.34
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	1	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	2	1206.26
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	2	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	2	2629.76
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	2	2629.76
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	1	1788.73
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	1	1464.48
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	1	1611.66
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	1	1789.69
PREHOOK: query: select "************ TIMESTAMP WINDOW RANGE TYPE (VECTORIZED) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ TIMESTAMP WINDOW RANGE TYPE (VECTORIZED) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ TIMESTAMP WINDOW RANGE TYPE (VECTORIZED) ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_mfgr (type: string), p_timestamp (type: timestamp)
                    null sort order: az
                    sort order: ++
                    Map-reduce partition columns: p_mfgr (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkObjectHashOperator
                        keyColumns: 0:string, 3:timestamp
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        partitionColumns: 0:string
                        valueColumns: 1:string, 2:date, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_name (type: string), p_date (type: date), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: az
                reduceColumnSortOrder: ++
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 6
                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:timestamp, VALUE._col0:string, VALUE._col1:date, VALUE._col3:double, VALUE._col8:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), KEY.reducesinkkey1 (type: timestamp), VALUE._col3 (type: double), VALUE._col8 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [0, 2, 3, 1, 4, 5]
                Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col3 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(3)~CURRENT
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 4:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0, 1]
                      native: true
                      nonKeyInputColumns: [2, 3, 4, 5]
                      orderExpressions: [col 1:timestamp]
                      outputColumns: [6, 7, 0, 2, 3, 1, 4, 5]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [0, 2, 1, 5, 3, 4, 6, 7]
                    Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_timestamp range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	3	4800.84
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	3	4800.84
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	3	4800.84
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	2	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	2	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	3	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	3	2805.8100000000004
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	3	2805.8100000000004
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	1	1753.76
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	1	1800.7
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	1	1800.7
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	1	1698.66
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	1	2031.98
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	1	1690.68
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	3	3701.96
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	3	3701.96
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	3	3701.96
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	1	1922.98
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	2	2527.56
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	2	2527.56
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	2	99.68
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	2	99.68
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	1	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	2	645.66
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	2	645.66
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	2	3220.34
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	2	3220.34
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	1	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	2	1206.26
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	2	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	2	2629.76
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	2	2629.76
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	1	1788.73
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	1	1464.48
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	1	1611.66
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	1	1789.69
PREHOOK: query: select "************ TIMESTAMP PARTITION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ TIMESTAMP PARTITION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ TIMESTAMP PARTITION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_timestamp) as cs,
sum(p_retailprice) over(partition by p_timestamp) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_timestamp) as cs,
sum(p_retailprice) over(partition by p_timestamp) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_timestamp (type: timestamp)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: p_timestamp (type: timestamp)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkMultiKeyOperator
                        keyColumns: 3:timestamp
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        valueColumns: 0:string, 1:string, 2:date, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 6
                    dataColumns: KEY.reducesinkkey0:timestamp, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col4:double, VALUE._col9:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), KEY.reducesinkkey0 (type: timestamp), VALUE._col4 (type: double), VALUE._col9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 0, 4, 5]
                Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col3 ASC NULLS FIRST
                        partition by: _col3
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 4:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5]
                      orderExpressions: [col 0:timestamp]
                      outputColumns: [6, 7, 1, 2, 3, 0, 4, 5]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
                      partitionExpressions: [col 0:timestamp]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 0, 5, 3, 4, 6, 7]
                    Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_timestamp) as cs,
sum(p_retailprice) over(partition by p_timestamp) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_timestamp) as cs,
sum(p_retailprice) over(partition by p_timestamp) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	6	9573.78
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	6	9573.78
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	6	9573.78
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	6	9573.78
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	6	9573.78
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	6	9573.78
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	6	8496.51
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	6	8496.51
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	6	8496.51
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	6	8496.51
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	6	8496.51
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	6	8496.51
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	7	6549.13
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	7	6549.13
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	7	6549.13
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	7	6549.13
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	7	6549.13
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	7	6549.13
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	7	6549.13
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	7	9197.32
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	7	9197.32
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	7	9197.32
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	7	9197.32
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	7	9197.32
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	7	9197.32
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	7	9197.32
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	8	7891.07
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	8	7891.07
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	8	7891.07
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	8	7891.07
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	8	7891.07
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	8	7891.07
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	8	7891.07
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	8	7891.07
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	6	9680.619999999999
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	6	9680.619999999999
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	6	9680.619999999999
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	6	9680.619999999999
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	6	9680.619999999999
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	6	9680.619999999999
PREHOOK: query: select "************ TIMESTAMP PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ TIMESTAMP PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ TIMESTAMP PARTITION WITH CONSTANT PARTITION EXPRESSION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_timestamp) as cs,
sum(p_retailprice) over(partition by p_timestamp) as s
from vector_ptf_part_simple_orc
where p_timestamp = '1970-01-03 00:00:00.0'
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_timestamp) as cs,
sum(p_retailprice) over(partition by p_timestamp) as s
from vector_ptf_part_simple_orc
where p_timestamp = '1970-01-03 00:00:00.0'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  filterExpr: (p_timestamp = TIMESTAMP'1970-01-03 00:00:00') (type: boolean)
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Filter Operator
                    Filter Vectorization:
                        className: VectorFilterOperator
                        native: true
                        predicateExpression: FilterTimestampColEqualTimestampScalar(col 3:timestamp, val 1970-01-03 00:00:00)
                    predicate: (p_timestamp = TIMESTAMP'1970-01-03 00:00:00') (type: boolean)
                    Statistics: Num rows: 20 Data size: 6264 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: TIMESTAMP'1970-01-03 00:00:00' (type: timestamp)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: TIMESTAMP'1970-01-03 00:00:00' (type: timestamp)
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkMultiKeyOperator
                          keyColumns: 13:timestamp
                          keyExpressions: ConstantVectorExpression(val 1970-01-03 00:00:00) -> 13:timestamp
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 0:string, 1:string, 2:date, 5:double, 10:int
                      Statistics: Num rows: 20 Data size: 6264 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [timestamp]
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 6
                    dataColumns: KEY.reducesinkkey0:timestamp, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col5:double, VALUE._col10:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double, timestamp, timestamp, timestamp]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col5 (type: double), VALUE._col10 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5]
                Statistics: Num rows: 20 Data size: 5584 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: TIMESTAMP'1970-01-03 00:00:00' ASC NULLS FIRST
                        partition by: TIMESTAMP'1970-01-03 00:00:00'
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 4:double]
                      functionNames: [count, sum]
                      keyInputColumns: []
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5]
                      orderExpressions: [ConstantVectorExpression(val 1970-01-03 00:00:00) -> 9:timestamp]
                      outputColumns: [6, 7, 1, 2, 3, 4, 5]
                      outputTypes: [bigint, double, string, string, date, double, int]
                      partitionExpressions: [ConstantVectorExpression(val 1970-01-03 00:00:00) -> 8:timestamp]
                      streamingColumns: []
                  Statistics: Num rows: 20 Data size: 5584 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), TIMESTAMP'1970-01-03 00:00:00' (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 10, 5, 3, 4, 6, 7]
                        selectExpressions: ConstantVectorExpression(val 1970-01-03 00:00:00) -> 10:timestamp
                    Statistics: Num rows: 20 Data size: 6464 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 20 Data size: 6464 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_timestamp) as cs,
sum(p_retailprice) over(partition by p_timestamp) as s
from vector_ptf_part_simple_orc
where p_timestamp = '1970-01-03 00:00:00.0'
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_timestamp) as cs,
sum(p_retailprice) over(partition by p_timestamp) as s
from vector_ptf_part_simple_orc
where p_timestamp = '1970-01-03 00:00:00.0'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	6	8496.51
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	6	8496.51
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	6	8496.51
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	6	8496.51
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	6	8496.51
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	6	8496.51
PREHOOK: query: select "************ DATE WINDOW RANGE TYPE ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ DATE WINDOW RANGE TYPE ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ DATE WINDOW RANGE TYPE ************
PREHOOK: query: select "************ DATE WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ DATE WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ DATE WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************
PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	3	4800.84
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	3	4800.84
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	3	4800.84
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	5	7606.650000000001
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	5	7606.650000000001
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	8	10412.460000000001
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	8	10412.460000000001
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	8	10412.460000000001
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	11	15522.57
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	11	15522.57
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	11	15522.57
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	1	1753.76
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	1	1800.7
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	2	3601.4
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	3	5300.06
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	4	7332.040000000001
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	4	7222.020000000001
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	3	3701.96
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	3	3701.96
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	3	3701.96
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	1	1922.98
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	3	4450.54
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	3	4450.54
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	5	4550.22
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	5	4550.22
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	5	3817.51
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	2	645.66
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	2	645.66
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	2	3220.34
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	2	3220.34
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	3	4510.6900000000005
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	3	2496.6099999999997
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	3	2496.6099999999997
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	2	2629.76
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	2	2629.76
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	3	4418.49
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	4	5882.969999999999
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	5	7494.629999999999
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	1	1789.69
PREHOOK: query: select "************ DATE WINDOW RANGE TYPE (VECTORIZED) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ DATE WINDOW RANGE TYPE (VECTORIZED) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ DATE WINDOW RANGE TYPE (VECTORIZED) ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_mfgr (type: string), p_date (type: date)
                    null sort order: az
                    sort order: ++
                    Map-reduce partition columns: p_mfgr (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkObjectHashOperator
                        keyColumns: 0:string, 2:date
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        partitionColumns: 0:string
                        valueColumns: 1:string, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_name (type: string), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: az
                reduceColumnSortOrder: ++
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 6
                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:date, VALUE._col0:string, VALUE._col1:timestamp, VALUE._col3:double, VALUE._col8:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: date), VALUE._col1 (type: timestamp), VALUE._col3 (type: double), VALUE._col8 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [0, 2, 1, 3, 4, 5]
                Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col2 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(3)~CURRENT
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 4:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0, 1]
                      native: true
                      nonKeyInputColumns: [2, 3, 4, 5]
                      orderExpressions: [col 1:date]
                      outputColumns: [6, 7, 0, 2, 1, 3, 4, 5]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [0, 2, 3, 5, 1, 4, 6, 7]
                    Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_date range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	3	4800.84
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	3	4800.84
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	3	4800.84
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	5	7606.650000000001
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	5	7606.650000000001
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	8	10412.460000000001
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	8	10412.460000000001
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	8	10412.460000000001
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	11	15522.57
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	11	15522.57
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	11	15522.57
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	1	1753.76
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	1	1800.7
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	2	3601.4
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	3	5300.06
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	4	7332.040000000001
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	4	7222.020000000001
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	3	3701.96
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	3	3701.96
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	3	3701.96
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	1	1922.98
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	3	4450.54
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	3	4450.54
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	5	4550.22
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	5	4550.22
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	5	3817.51
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	2	645.66
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	2	645.66
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	2	3220.34
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	2	3220.34
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	3	4510.6900000000005
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	3	2496.6099999999997
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	3	2496.6099999999997
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	2	2629.76
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	2	2629.76
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	3	4418.49
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	4	5882.969999999999
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	5	7494.629999999999
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	1	1789.69
PREHOOK: query: select "************ DATE PARTITION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ DATE PARTITION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ DATE PARTITION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_date) as cs,
sum(p_retailprice) over(partition by p_date) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_date) as cs,
sum(p_retailprice) over(partition by p_date) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_date (type: date)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: p_date (type: date)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkLongOperator
                        keyColumns: 2:date
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        valueColumns: 0:string, 1:string, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_mfgr (type: string), p_name (type: string), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 6
                    dataColumns: KEY.reducesinkkey0:date, VALUE._col0:string, VALUE._col1:string, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col9:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), KEY.reducesinkkey0 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), VALUE._col9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 0, 3, 4, 5]
                Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col2 ASC NULLS FIRST
                        partition by: _col2
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 4:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5]
                      orderExpressions: [col 0:date]
                      outputColumns: [6, 7, 1, 2, 0, 3, 4, 5]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
                      partitionExpressions: [col 0:date]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 3, 5, 0, 4, 6, 7]
                    Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 12264 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_date) as cs,
sum(p_retailprice) over(partition by p_date) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_date) as cs,
sum(p_retailprice) over(partition by p_date) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	6	9680.619999999999
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	6	9680.619999999999
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	6	9680.619999999999
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	6	9680.619999999999
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	6	9680.619999999999
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	6	9680.619999999999
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	8	7891.070000000001
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	8	7891.070000000001
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	8	7891.070000000001
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	8	7891.070000000001
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	8	7891.070000000001
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	8	7891.070000000001
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	8	7891.070000000001
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	8	7891.070000000001
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	6	9573.78
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	6	9573.78
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	6	9573.78
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	6	9573.78
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	6	9573.78
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	6	9573.78
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	6	8496.51
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	6	8496.51
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	6	8496.51
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	6	8496.51
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	6	8496.51
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	6	8496.51
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	7	6549.130000000001
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	7	6549.130000000001
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	7	6549.130000000001
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	7	6549.130000000001
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	7	6549.130000000001
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	7	6549.130000000001
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	7	6549.130000000001
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	7	9197.32
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	7	9197.32
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	7	9197.32
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	7	9197.32
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	7	9197.32
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	7	9197.32
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	7	9197.32
PREHOOK: query: select "************ DATE PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ DATE PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ DATE PARTITION WITH CONSTANT PARTITION EXPRESSION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_date) as cs,
sum(p_retailprice) over(partition by p_date) as s
from vector_ptf_part_simple_orc
where p_date = '1970-01-03'
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_date) as cs,
sum(p_retailprice) over(partition by p_date) as s
from vector_ptf_part_simple_orc
where p_date = '1970-01-03'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  filterExpr: (p_date = DATE'1970-01-03') (type: boolean)
                  Statistics: Num rows: 40 Data size: 12424 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Filter Operator
                    Filter Vectorization:
                        className: VectorFilterOperator
                        native: true
                        predicateExpression: FilterDateColEqualDateScalar(col 2:date, val 2)
                    predicate: (p_date = DATE'1970-01-03') (type: boolean)
                    Statistics: Num rows: 20 Data size: 6264 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: DATE'1970-01-03' (type: date)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: DATE'1970-01-03' (type: date)
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkLongOperator
                          keyColumns: 13:date
                          keyExpressions: ConstantVectorExpression(val 2) -> 13:date
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 0:string, 1:string, 3:timestamp, 5:double, 10:int
                      Statistics: Num rows: 20 Data size: 6264 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: p_mfgr (type: string), p_name (type: string), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint]
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 6
                    dataColumns: KEY.reducesinkkey0:date, VALUE._col0:string, VALUE._col1:string, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col10:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double, bigint, bigint, bigint]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col10 (type: int)
                outputColumnNames: _col0, _col1, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5]
                Statistics: Num rows: 20 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: DATE'1970-01-03' ASC NULLS FIRST
                        partition by: DATE'1970-01-03'
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 4:double]
                      functionNames: [count, sum]
                      keyInputColumns: []
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5]
                      orderExpressions: [ConstantVectorExpression(val 2) -> 9:date]
                      outputColumns: [6, 7, 1, 2, 3, 4, 5]
                      outputTypes: [bigint, double, string, string, timestamp, double, int]
                      partitionExpressions: [ConstantVectorExpression(val 2) -> 8:date]
                      streamingColumns: []
                  Statistics: Num rows: 20 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), DATE'1970-01-03' (type: date), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 3, 5, 10, 4, 6, 7]
                        selectExpressions: ConstantVectorExpression(val 2) -> 10:date
                    Statistics: Num rows: 20 Data size: 6576 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 20 Data size: 6576 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_date) as cs,
sum(p_retailprice) over(partition by p_date) as s
from vector_ptf_part_simple_orc
where p_date = '1970-01-03'
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_date) as cs,
sum(p_retailprice) over(partition by p_date) as s
from vector_ptf_part_simple_orc
where p_date = '1970-01-03'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	6	8496.51
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	6	8496.51
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	6	8496.51
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	6	8496.51
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	6	8496.51
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	6	8496.51
PREHOOK: query: select "************ INT WINDOW RANGE TYPE ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ INT WINDOW RANGE TYPE ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ INT WINDOW RANGE TYPE ************
PREHOOK: query: select "************ INT WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ INT WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ INT WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************
PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_int	cs	s
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	115200	3	4800.84
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	115200	3	4800.84
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	115200	3	4800.84
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	201600	2	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	201600	2	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	288000	3	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	288000	3	2805.8100000000004
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	288000	3	2805.8100000000004
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	374400	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	374400	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	374400	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	NULL	1	1753.76
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	28800	1	1800.7
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	115200	1	1800.7
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	201600	1	1698.66
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	288000	1	2031.98
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	374400	1	1690.68
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	NULL	3	3701.96
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	NULL	3	3701.96
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	NULL	3	3701.96
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	28800	1	1922.98
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	201600	2	2527.56
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	201600	2	2527.56
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	288000	2	99.68
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	288000	2	99.68
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	374400	1	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	NULL	2	645.66
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	NULL	2	645.66
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	28800	2	3220.34
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	28800	2	3220.34
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	115200	1	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	374400	2	1206.26
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	374400	2	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	NULL	1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	28800	2	2629.76
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	28800	2	2629.76
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	115200	1	1788.73
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	201600	1	1464.48
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	288000	1	1611.66
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	NULL	1	1789.69
PREHOOK: query: select "************ INT WINDOW RANGE TYPE (VECTORIZED) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ INT WINDOW RANGE TYPE (VECTORIZED) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ INT WINDOW RANGE TYPE (VECTORIZED) ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_mfgr (type: string), p_int (type: int)
                    null sort order: az
                    sort order: ++
                    Map-reduce partition columns: p_mfgr (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkObjectHashOperator
                        keyColumns: 0:string, 4:int
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        partitionColumns: 0:string
                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 4, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: az
                reduceColumnSortOrder: ++
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:int, VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col3:double, VALUE._col8:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), KEY.reducesinkkey1 (type: int), VALUE._col3 (type: double), VALUE._col8 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [0, 2, 3, 4, 1, 5, 6]
                Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col4: int, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col4 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(3)~CURRENT
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0, 1]
                      native: true
                      nonKeyInputColumns: [2, 3, 4, 5, 6]
                      orderExpressions: [col 1:int]
                      outputColumns: [7, 8, 0, 2, 3, 4, 1, 5, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, int, double, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), _col4 (type: int), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [0, 2, 4, 6, 3, 5, 1, 7, 8]
                    Statistics: Num rows: 40 Data size: 12364 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 12364 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_int range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_int	cs	s
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	115200	3	4800.84
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	115200	3	4800.84
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	115200	3	4800.84
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	201600	2	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	201600	2	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	288000	3	2805.8100000000004
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	288000	3	2805.8100000000004
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	288000	3	2805.8100000000004
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	374400	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	374400	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	374400	3	5110.11
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	NULL	1	1753.76
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	28800	1	1800.7
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	115200	1	1800.7
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	201600	1	1698.66
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	288000	1	2031.98
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	374400	1	1690.68
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	NULL	3	3701.96
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	NULL	3	3701.96
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	NULL	3	3701.96
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	28800	1	1922.98
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	201600	2	2527.56
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	201600	2	2527.56
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	288000	2	99.68
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	288000	2	99.68
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	374400	1	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	NULL	2	645.66
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	NULL	2	645.66
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	28800	2	3220.34
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	28800	2	3220.34
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	115200	1	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	374400	2	1206.26
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	374400	2	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	NULL	1	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	28800	2	2629.76
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	28800	2	2629.76
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	115200	1	1788.73
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	201600	1	1464.48
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	288000	1	1611.66
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	NULL	1	1789.69
PREHOOK: query: select "************ INT PARTITION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ INT PARTITION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ INT PARTITION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_int) as cs,
sum(p_retailprice) over(partition by p_int) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_int) as cs,
sum(p_retailprice) over(partition by p_int) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_int (type: int)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: p_int (type: int)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkLongOperator
                        keyColumns: 4:int
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 4, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:int, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col4:double, VALUE._col9:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), KEY.reducesinkkey0 (type: int), VALUE._col4 (type: double), VALUE._col9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 0, 5, 6]
                Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col4: int, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col4 ASC NULLS FIRST
                        partition by: _col4
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
                      orderExpressions: [col 0:int]
                      outputColumns: [7, 8, 1, 2, 3, 4, 0, 5, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, int, double, int]
                      partitionExpressions: [col 0:int]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), _col4 (type: int), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 5, 0, 7, 8]
                    Statistics: Num rows: 40 Data size: 12364 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 12364 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_int) as cs,
sum(p_retailprice) over(partition by p_int) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_int) as cs,
sum(p_retailprice) over(partition by p_int) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_int	cs	s
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	115200	6	9680.62
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	115200	6	9680.62
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	115200	6	9680.62
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	115200	6	9680.62
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	115200	6	9680.62
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	115200	6	9680.62
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	288000	7	6549.13
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	288000	7	6549.13
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	288000	7	6549.13
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	288000	7	6549.13
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	288000	7	6549.13
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	288000	7	6549.13
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	288000	7	6549.13
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	NULL	8	7891.07
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	NULL	8	7891.07
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	NULL	8	7891.07
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	NULL	8	7891.07
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	NULL	8	7891.07
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	NULL	8	7891.07
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	NULL	8	7891.07
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	NULL	8	7891.07
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	28800	6	9573.78
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	28800	6	9573.78
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	28800	6	9573.78
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	28800	6	9573.78
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	28800	6	9573.78
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	28800	6	9573.78
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	201600	6	8496.51
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	201600	6	8496.51
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	201600	6	8496.51
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	201600	6	8496.51
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	201600	6	8496.51
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	201600	6	8496.51
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	374400	7	9197.32
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	374400	7	9197.32
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	374400	7	9197.32
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	374400	7	9197.32
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	374400	7	9197.32
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	374400	7	9197.32
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	374400	7	9197.32
PREHOOK: query: select "************ INT PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ INT PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ INT PARTITION WITH CONSTANT PARTITION EXPRESSION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_int) as cs,
sum(p_retailprice) over(partition by p_int) as s
from vector_ptf_part_simple_orc
where p_date = 115200
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_int,
count(*) over(partition by p_int) as cs,
sum(p_retailprice) over(partition by p_int) as s
from vector_ptf_part_simple_orc
where p_date = 115200
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  filterExpr: (CAST( p_date AS STRING) = '115200') (type: boolean)
                  Statistics: Num rows: 40 Data size: 12556 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Filter Operator
                    Filter Vectorization:
                        className: VectorFilterOperator
                        native: true
                        predicateExpression: FilterStringGroupColEqualStringScalar(col 13:string, val 115200)(children: CastDateToString(col 2:date) -> 13:string)
                    predicate: (CAST( p_date AS STRING) = '115200') (type: boolean)
                    Statistics: Num rows: 20 Data size: 6332 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: p_int (type: int)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: p_int (type: int)
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkLongOperator
                          keyColumns: 4:int
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 10:int
                      Statistics: Num rows: 20 Data size: 6332 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 4, 5, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [string]
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:int, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col4:double, VALUE._col9:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), KEY.reducesinkkey0 (type: int), VALUE._col4 (type: double), VALUE._col9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 0, 5, 6]
                Statistics: Num rows: 20 Data size: 6332 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col4: int, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col4 ASC NULLS FIRST
                        partition by: _col4
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
                      orderExpressions: [col 0:int]
                      outputColumns: [7, 8, 1, 2, 3, 4, 0, 5, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, int, double, int]
                      partitionExpressions: [col 0:int]
                      streamingColumns: []
                  Statistics: Num rows: 20 Data size: 6332 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), _col4 (type: int), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 5, 0, 7, 8]
                    Statistics: Num rows: 20 Data size: 6236 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 20 Data size: 6236 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_int) as cs,
sum(p_retailprice) over(partition by p_int) as s
from vector_ptf_part_simple_orc
where p_int = 115200
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,
count(*) over(partition by p_int) as cs,
sum(p_retailprice) over(partition by p_int) as s
from vector_ptf_part_simple_orc
where p_int = 115200
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	cs	s
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	6	9680.62
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	6	9680.62
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	6	9680.62
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	6	9680.62
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	6	9680.62
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	6	9680.62
PREHOOK: query: select "************ DECIMAL WINDOW RANGE TYPE ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ DECIMAL WINDOW RANGE TYPE ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ DECIMAL WINDOW RANGE TYPE ************
PREHOOK: query: select "************ DECIMAL WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ DECIMAL WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ DECIMAL WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************
PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_decimal	p_retailprice	cs	s
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.1500	1173.15	2	2346.3
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.1500	1173.15	2	2346.3
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.4200	1414.42	1	1414.42
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.5900	1602.59	1	1602.59
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.6600	1632.66	3	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.6600	1632.66	3	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.6600	1632.66	3	4897.9800000000005
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	NULL	1	NULL
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.6600	900.66	1	900.66
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6000	1000.6	1	1000.6
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.6800	1690.68	1	1690.68
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.6600	1698.66	1	1698.66
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7000	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7000	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7000	1800.7	3	5402.1
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.9800	2031.98	1	2031.98
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.3900	55.39	1	55.39
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.6800	99.68	1	99.68
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.2700	590.27	1	590.27
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.2700	1190.27	2	2380.54
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.2700	1190.27	2	2380.54
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.2900	1337.29	1	1337.29
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.9800	1922.98	1	1922.98
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	NULL	1	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.2600	1206.26	1	1206.26
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.3500	1290.35	1	1290.35
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.4200	1375.42	1	1375.42
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.9200	1844.92	1	1844.92
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	NULL	2	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	NULL	2	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1000	1018.1	1	1018.1
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.4800	1464.48	1	1464.48
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.6600	1611.66	2	3223.32
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.6600	1611.66	2	3223.32
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.7300	1788.73	1	1788.73
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.6900	1789.69	2	3578.42
PREHOOK: query: select "************ DECIMAL WINDOW RANGE TYPE (VECTORIZED) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ DECIMAL WINDOW RANGE TYPE (VECTORIZED) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ DECIMAL WINDOW RANGE TYPE (VECTORIZED) ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_mfgr (type: string), p_decimal (type: decimal(10,4))
                    null sort order: az
                    sort order: ++
                    Map-reduce partition columns: p_mfgr (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkObjectHashOperator
                        keyColumns: 0:string, 6:decimal(10,4)
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        partitionColumns: 0:string
                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 6, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: az
                reduceColumnSortOrder: ++
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:decimal(10,4), VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col8:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), KEY.reducesinkkey1 (type: decimal(10,4)), VALUE._col8 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [0, 2, 3, 4, 5, 1, 6]
                Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col6: decimal(10,4), _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col6 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(3)~CURRENT
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0, 1]
                      native: true
                      nonKeyInputColumns: [2, 3, 4, 5, 6]
                      orderExpressions: [col 1:decimal(10,4)]
                      outputColumns: [7, 8, 0, 2, 3, 4, 5, 1, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, decimal(10,4), int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col6 (type: decimal(10,4)), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [0, 2, 4, 6, 3, 1, 5, 7, 8]
                    Statistics: Num rows: 40 Data size: 15960 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 15960 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as cs,
sum(p_retailprice) over(partition by p_mfgr order by p_decimal range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_decimal	p_retailprice	cs	s
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.1500	1173.15	2	2346.3
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.1500	1173.15	2	2346.3
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.4200	1414.42	1	1414.42
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.5900	1602.59	1	1602.59
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.6600	1632.66	3	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.6600	1632.66	3	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.6600	1632.66	3	4897.9800000000005
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	NULL	1	NULL
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.6600	900.66	1	900.66
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6000	1000.6	1	1000.6
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.6800	1690.68	1	1690.68
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.6600	1698.66	1	1698.66
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7000	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7000	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7000	1800.7	3	5402.1
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.9800	2031.98	1	2031.98
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.3900	55.39	1	55.39
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.6800	99.68	1	99.68
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.2700	590.27	1	590.27
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.2700	1190.27	2	2380.54
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.2700	1190.27	2	2380.54
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.2900	1337.29	1	1337.29
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.9800	1922.98	1	1922.98
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	NULL	1	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.2600	1206.26	1	1206.26
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.3500	1290.35	1	1290.35
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.4200	1375.42	1	1375.42
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.9200	1844.92	1	1844.92
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	NULL	2	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	NULL	2	NULL
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1000	1018.1	1	1018.1
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.4800	1464.48	1	1464.48
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.6600	1611.66	2	3223.32
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.6600	1611.66	2	3223.32
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.7300	1788.73	1	1788.73
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.6900	1789.69	2	3578.42
PREHOOK: query: select "************ DECIMAL PARTITION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ DECIMAL PARTITION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ DECIMAL PARTITION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_decimal) as cs,
sum(p_retailprice) over(partition by p_decimal) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_decimal) as cs,
sum(p_retailprice) over(partition by p_decimal) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_decimal (type: decimal(10,4))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: p_decimal (type: decimal(10,4))
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkMultiKeyOperator
                        keyColumns: 6:decimal(10,4)
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 6, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:decimal(10,4), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col9:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), KEY.reducesinkkey0 (type: decimal(10,4)), VALUE._col9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 0, 6]
                Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col6: decimal(10,4), _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col6 ASC NULLS FIRST
                        partition by: _col6
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
                      orderExpressions: [col 0:decimal(10,4)]
                      outputColumns: [7, 8, 1, 2, 3, 4, 5, 0, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, decimal(10,4), int]
                      partitionExpressions: [col 0:decimal(10,4)]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col6 (type: decimal(10,4)), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 0, 5, 7, 8]
                    Statistics: Num rows: 40 Data size: 15960 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 15960 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_decimal) as cs,
sum(p_retailprice) over(partition by p_decimal) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_decimal) as cs,
sum(p_retailprice) over(partition by p_decimal) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_decimal	p_retailprice	cs	s
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.2700	590.27	1	590.27
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.1500	1173.15	2	2346.3
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.1500	1173.15	2	2346.3
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.2900	1337.29	1	1337.29
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.4200	1414.42	1	1414.42
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.6800	1690.68	1	1690.68
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.6900	1789.69	1	1789.69
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7000	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7000	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7000	1800.7	3	5402.1
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.9200	1844.92	1	1844.92
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.9800	1922.98	1	1922.98
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.9800	2031.98	1	2031.98
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	NULL	4	NULL
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	NULL	4	NULL
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	NULL	4	NULL
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	NULL	4	NULL
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.3900	55.39	1	55.39
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.6800	99.68	1	99.68
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.6600	900.66	1	900.66
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6000	1000.6	1	1000.6
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1000	1018.1	1	1018.1
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.2700	1190.27	2	2380.54
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.2700	1190.27	2	2380.54
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.2600	1206.26	1	1206.26
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.3500	1290.35	1	1290.35
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.4200	1375.42	1	1375.42
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.4800	1464.48	1	1464.48
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.5900	1602.59	1	1602.59
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.6600	1611.66	2	3223.32
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.6600	1611.66	2	3223.32
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.6600	1632.66	3	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.6600	1632.66	3	4897.9800000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.6600	1632.66	3	4897.9800000000005
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.6600	1698.66	1	1698.66
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.7600	1753.76	4	7015.04
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.7600	1753.76	4	7015.04
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.7300	1788.73	1	1788.73
PREHOOK: query: select "************ DECIMAL PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ DECIMAL PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ DECIMAL PARTITION WITH CONSTANT PARTITION EXPRESSION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_decimal) as cs,
sum(p_retailprice) over(partition by p_decimal) as s
from vector_ptf_part_simple_orc
where p_decimal = 1800.7000
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_decimal) as cs,
sum(p_retailprice) over(partition by p_decimal) as s
from vector_ptf_part_simple_orc
where p_decimal = 1800.7000
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  filterExpr: (p_decimal = 1800.7) (type: boolean)
                  Statistics: Num rows: 40 Data size: 16568 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Filter Operator
                    Filter Vectorization:
                        className: VectorFilterOperator
                        native: true
                        predicateExpression: FilterDecimal64ColEqualDecimal64Scalar(col 6:decimal(10,4)/DECIMAL_64, val 18007000)
                    predicate: (p_decimal = 1800.7) (type: boolean)
                    Statistics: Num rows: 2 Data size: 880 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: CAST( 1800.7 AS decimal(10,4)) (type: decimal(10,4))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: CAST( 1800.7 AS decimal(10,4)) (type: decimal(10,4))
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkMultiKeyOperator
                          keyColumns: 13:decimal(10,4)
                          keyExpressions: ConstantVectorExpression(val 1800.7) -> 13:decimal(10,4)
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 10:int
                      Statistics: Num rows: 2 Data size: 880 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 6, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [decimal(10,4)]
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:decimal(10,4), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col10:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double, decimal(10,4), decimal(10,4), decimal(10,4)]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col10 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6]
                Statistics: Num rows: 2 Data size: 656 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: CAST( 1800.7 AS decimal(10,4)) ASC NULLS FIRST
                        partition by: CAST( 1800.7 AS decimal(10,4))
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: []
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
                      orderExpressions: [ConstantVectorExpression(val 1800.7) -> 10:decimal(10,4)]
                      outputColumns: [7, 8, 1, 2, 3, 4, 5, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
                      partitionExpressions: [ConstantVectorExpression(val 1800.7) -> 9:decimal(10,4)]
                      streamingColumns: []
                  Statistics: Num rows: 2 Data size: 656 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), 1800.7 (type: decimal(10,4)), _col5 (type: double), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 11, 5, 7, 8]
                        selectExpressions: ConstantVectorExpression(val 1800.7) -> 11:decimal(10,4)
                    Statistics: Num rows: 2 Data size: 912 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 2 Data size: 912 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_decimal) as cs,
sum(p_retailprice) over(partition by p_decimal) as s
from vector_ptf_part_simple_orc
where p_decimal = 1800.7000
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_decimal, p_retailprice,
count(*) over(partition by p_decimal) as cs,
sum(p_retailprice) over(partition by p_decimal) as s
from vector_ptf_part_simple_orc
where p_decimal = 1800.7000
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_decimal	p_retailprice	cs	s
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7000	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7000	1800.7	3	5402.1
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7000	1800.7	3	5402.1
PREHOOK: query: select "************ CHAR WINDOW RANGE TYPE ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ CHAR WINDOW RANGE TYPE ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ CHAR WINDOW RANGE TYPE ************
PREHOOK: query: select "************ CHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ CHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ CHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************
PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,
       count(*) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,
       count(*) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	cs	s
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	A	3	2926.91
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	A	3	2926.91
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	A	3	2926.91
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	B	3	4800.84
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	B	3	4800.84
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	B	3	4800.84
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	C	2	3356.35
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	C	2	3356.35
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	4	6192.23
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	4	6192.23
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	4	6192.23
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	4	6192.23
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	A	2	1901.26
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	A	2	1901.26
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	B	2	3601.4
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	B	2	3601.4
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	C	2	3730.6400000000003
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	C	2	3730.6400000000003
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	2	3491.38
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	2	3491.38
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	A	1	1337.29
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	B	1	1190.27
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	C	3	1289.95
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	C	3	1289.95
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	C	3	1289.95
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	3	2568.6400000000003
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	3	2568.6400000000003
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	3	2568.6400000000003
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	A	2	NULL
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	A	2	NULL
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	B	1	1375.42
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	C	2	2496.6099999999997
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	C	2	2496.6099999999997
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	1	1844.92
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	A	1	1788.73
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	B	2	2629.76
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	B	2	2629.76
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	C	2	3076.1400000000003
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	C	2	3076.1400000000003
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	1	1789.69
PREHOOK: query: select "************ CHAR WINDOW RANGE TYPE (VECTORIZED) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ CHAR WINDOW RANGE TYPE (VECTORIZED) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ CHAR WINDOW RANGE TYPE (VECTORIZED) ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
                                    count(*) over(partition by p_mfgr order by p_char range between 3 preceding and
                                    current row) as cs,
                                    sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
                                    count(*) over(partition by p_mfgr order by p_char range between 3 preceding and
                                    current row) as cs,
                                    sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_mfgr (type: string), p_char (type: char(1))
                    null sort order: az
                    sort order: ++
                    Map-reduce partition columns: p_mfgr (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkObjectHashOperator
                        keyColumns: 0:string, 7:char(1)
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        partitionColumns: 0:string
                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 7, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: az
                reduceColumnSortOrder: ++
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:char(1), VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col8:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), KEY.reducesinkkey1 (type: char(1)), VALUE._col8 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [0, 2, 3, 4, 5, 1, 6]
                Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: char(1), _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col7 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(3)~CURRENT
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0, 1]
                      native: true
                      nonKeyInputColumns: [2, 3, 4, 5, 6]
                      orderExpressions: [col 1:char(1)]
                      outputColumns: [7, 8, 0, 2, 3, 4, 5, 1, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, char(1), int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), _col7 (type: char(1)), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [0, 2, 4, 6, 3, 5, 1, 7, 8]
                    Statistics: Num rows: 40 Data size: 15664 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 15664 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
       count(*) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
       count(*) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_char range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	cs	s
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	A	3	2926.91
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	A	3	2926.91
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	A	3	2926.91
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	B	3	4800.84
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	B	3	4800.84
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	B	3	4800.84
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	C	2	3356.35
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	C	2	3356.35
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	4	6192.2300000000005
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	4	6192.2300000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	4	6192.2300000000005
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	4	6192.2300000000005
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	A	2	1901.26
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	A	2	1901.26
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	B	2	3601.4
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	B	2	3601.4
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	C	2	3730.6400000000003
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	C	2	3730.6400000000003
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	2	3491.38
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	2	3491.38
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	A	1	1337.29
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	B	1	1190.27
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	C	3	1289.95
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	C	3	1289.95
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	C	3	1289.95
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	3	2568.6400000000003
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	3	2568.6400000000003
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	3	2568.6400000000003
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	A	2	NULL
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	A	2	NULL
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	B	1	1375.42
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	C	2	2496.6099999999997
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	C	2	2496.6099999999997
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	1	1844.92
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	A	1	1788.73
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	B	2	2629.76
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	B	2	2629.76
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	C	2	3076.1400000000003
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	C	2	3076.1400000000003
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	1	1789.69
PREHOOK: query: select "************ CHAR PARTITION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ CHAR PARTITION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ CHAR PARTITION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
                                    count(*) over(partition by p_char) as cs,
                                    sum(p_retailprice) over(partition by p_char) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
                                    count(*) over(partition by p_char) as cs,
                                    sum(p_retailprice) over(partition by p_char) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_char (type: char(1))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: p_char (type: char(1))
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkStringOperator
                        keyColumns: 7:char(1)
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 7, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:char(1), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col9:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), KEY.reducesinkkey0 (type: char(1)), VALUE._col9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 0, 6]
                Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: char(1), _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col7 ASC NULLS FIRST
                        partition by: _col7
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
                      orderExpressions: [col 0:char(1)]
                      outputColumns: [7, 8, 1, 2, 3, 4, 5, 0, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, char(1), int]
                      partitionExpressions: [col 0:char(1)]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), _col7 (type: char(1)), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 5, 0, 7, 8]
                    Statistics: Num rows: 40 Data size: 15664 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 15664 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
       count(*) over(partition by p_char) as cs,
       sum(p_retailprice) over(partition by p_char) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
       count(*) over(partition by p_char) as cs,
       sum(p_retailprice) over(partition by p_char) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	cs	s
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	A	9	7954.1900000000005
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	A	9	7954.1900000000005
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	A	9	7954.1900000000005
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	A	9	7954.1900000000005
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	A	9	7954.1900000000005
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	A	9	7954.1900000000005
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	A	9	7954.1900000000005
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	A	9	7954.1900000000005
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	A	9	7954.1900000000005
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	B	9	13597.69
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	B	9	13597.69
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	B	9	13597.69
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	B	9	13597.69
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	B	9	13597.69
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	B	9	13597.69
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	B	9	13597.69
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	B	9	13597.69
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	B	9	13597.69
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	C	11	13949.690000000002
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	C	11	13949.690000000002
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	C	11	13949.690000000002
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	C	11	13949.690000000002
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	C	11	13949.690000000002
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	C	11	13949.690000000002
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	C	11	13949.690000000002
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	C	11	13949.690000000002
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	C	11	13949.690000000002
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	C	11	13949.690000000002
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	C	11	13949.690000000002
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	11	15886.86
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	11	15886.86
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	11	15886.86
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	11	15886.86
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	11	15886.86
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	11	15886.86
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	11	15886.86
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	11	15886.86
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	11	15886.86
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	11	15886.86
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	11	15886.86
PREHOOK: query: select "************ CHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ CHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ CHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
                                    count(*) over(partition by p_char) as cs,
                                    sum(p_retailprice) over(partition by p_char) as s
from vector_ptf_part_simple_orc
where p_char = 'D'
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,
                                    count(*) over(partition by p_char) as cs,
                                    sum(p_retailprice) over(partition by p_char) as s
from vector_ptf_part_simple_orc
where p_char = 'D'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  filterExpr: (p_char = 'D') (type: boolean)
                  Statistics: Num rows: 40 Data size: 15824 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Filter Operator
                    Filter Vectorization:
                        className: VectorFilterOperator
                        native: true
                        predicateExpression: FilterStringGroupColEqualCharScalar(col 7:char(1), val D)
                    predicate: (p_char = 'D') (type: boolean)
                    Statistics: Num rows: 10 Data size: 4034 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: CAST( 'D' AS CHAR(1)) (type: char(1))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: CAST( 'D' AS CHAR(1)) (type: char(1))
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkStringOperator
                          keyColumns: 13:char(1)
                          keyExpressions: VectorUDFAdaptor(CAST( 'D' AS CHAR(1))) -> 13:char(1)
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 10:int
                      Statistics: Num rows: 10 Data size: 4034 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: true
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 7, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [string]
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:char(1), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col10:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double, string, string, string]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col10 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6]
                Statistics: Num rows: 10 Data size: 3184 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: CAST( 'D' AS CHAR(1)) ASC NULLS FIRST
                        partition by: CAST( 'D' AS CHAR(1))
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: []
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
                      orderExpressions: [VectorUDFAdaptor(CAST( 'D' AS CHAR(1))) -> 10:char(1)]
                      outputColumns: [7, 8, 1, 2, 3, 4, 5, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
                      partitionExpressions: [VectorUDFAdaptor(CAST( 'D' AS CHAR(1))) -> 9:char(1)]
                      streamingColumns: []
                  Statistics: Num rows: 10 Data size: 3184 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), 'D' (type: char(1)), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 5, 11, 7, 8]
                        selectExpressions: ConstantVectorExpression(val D) -> 11:char(1)
                    Statistics: Num rows: 10 Data size: 3994 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 10 Data size: 3994 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,
       count(*) over(partition by p_char) as cs,
       sum(p_retailprice) over(partition by p_char) as s
from vector_ptf_part_simple_orc
where p_char = 'D'
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,
       count(*) over(partition by p_char) as cs,
       sum(p_retailprice) over(partition by p_char) as s
from vector_ptf_part_simple_orc
where p_char = 'D'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	cs	s
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	11	15886.86
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	11	15886.86
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	11	15886.86
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	11	15886.86
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	11	15886.86
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	11	15886.86
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	11	15886.86
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	11	15886.86
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	11	15886.86
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	11	15886.86
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	11	15886.86
PREHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ VARCHAR WINDOW RANGE TYPE ************
PREHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ VARCHAR WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************
PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
       count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
       count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_varchar	cs	s
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	AB	1	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	AC	1	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	AD	1	1753.76
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	AK	1	1632.66
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	BB	1	1602.59
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	CC	1	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	DA	1	1753.76
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	DC	1	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	DE	1	NULL
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	EF	1	1753.76
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	RS	1	1632.66
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	SM	1	1173.15
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	AA	1	1800.7
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	AB	1	1800.7
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	AC	1	1800.7
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	BD	1	1000.6
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	CA	1	1698.66
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	CB	1	2031.98
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	DA	1	900.66
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	LM	1	1690.68
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	AC	1	1337.29
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	AY	1	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	BB	1	NULL
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	BC	1	1922.98
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	CA	1	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	CD	1	590.27
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	DB	1	55.39
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	DD	1	99.68
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	CC	1	NULL
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	DA	1	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	DD	1	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	EE	1	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	FD	1	1844.92
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	OP	1	1375.42
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	AA	2	3223.32
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	AA	2	3223.32
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	AB	1	1464.48
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	BB	1	1788.73
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	CD	1	1018.1
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	FD	1	1789.69
PREHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE (VECTORIZED) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ VARCHAR WINDOW RANGE TYPE (VECTORIZED) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ VARCHAR WINDOW RANGE TYPE (VECTORIZED) ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
                                    count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
                                    sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
                                    count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
                                    sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_mfgr (type: string), p_varchar (type: varchar(5))
                    null sort order: az
                    sort order: ++
                    Map-reduce partition columns: p_mfgr (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkObjectHashOperator
                        keyColumns: 0:string, 8:varchar(5)
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        partitionColumns: 0:string
                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 8, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: az
                reduceColumnSortOrder: ++
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:varchar(5), VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col8:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), KEY.reducesinkkey1 (type: varchar(5)), VALUE._col8 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col8, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [0, 2, 3, 4, 5, 1, 6]
                Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col8: varchar(5), _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col8 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(3)~CURRENT
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0, 1]
                      native: true
                      nonKeyInputColumns: [2, 3, 4, 5, 6]
                      orderExpressions: [col 1:varchar(5)]
                      outputColumns: [7, 8, 0, 2, 3, 4, 5, 1, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, varchar(5), int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), _col8 (type: varchar(5)), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [0, 2, 4, 6, 3, 5, 1, 7, 8]
                    Statistics: Num rows: 40 Data size: 15704 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 15704 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
       count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
       count(*) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_varchar range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_varchar	cs	s
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	AB	1	1414.42
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	AC	1	1753.76
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	AD	1	1753.76
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	AK	1	1632.66
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	BB	1	1602.59
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	CC	1	1632.66
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	DA	1	1753.76
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	DC	1	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	DE	1	NULL
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	EF	1	1753.76
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	RS	1	1632.66
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	SM	1	1173.15
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	AA	1	1800.7
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	AB	1	1800.7
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	AC	1	1800.7
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	BD	1	1000.6
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	CA	1	1698.66
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	CB	1	2031.98
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	DA	1	900.66
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	LM	1	1690.68
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	AC	1	1337.29
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	AY	1	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	BB	1	NULL
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	BC	1	1922.98
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	CA	1	1190.27
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	CD	1	590.27
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	DB	1	55.39
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	DD	1	99.68
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	CC	1	NULL
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	DA	1	1290.35
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	DD	1	1206.26
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	EE	1	NULL
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	FD	1	1844.92
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	OP	1	1375.42
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	AA	2	3223.32
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	AA	2	3223.32
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	AB	1	1464.48
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	BB	1	1788.73
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	CD	1	1018.1
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	FD	1	1789.69
PREHOOK: query: select "************ VARCHAR PARTITION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ VARCHAR PARTITION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ VARCHAR PARTITION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
                                    count(*) over(partition by p_varchar) as cs,
                                    sum(p_retailprice) over(partition by p_varchar) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
                                    count(*) over(partition by p_varchar) as cs,
                                    sum(p_retailprice) over(partition by p_varchar) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_varchar (type: varchar(5))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: p_varchar (type: varchar(5))
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkStringOperator
                        keyColumns: 8:varchar(5)
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 10:int
                    Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 8, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:varchar(5), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col9:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), KEY.reducesinkkey0 (type: varchar(5)), VALUE._col9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col8, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 0, 6]
                Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col8: varchar(5), _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col8 ASC NULLS FIRST
                        partition by: _col8
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
                      orderExpressions: [col 0:varchar(5)]
                      outputColumns: [7, 8, 1, 2, 3, 4, 5, 0, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, varchar(5), int]
                      partitionExpressions: [col 0:varchar(5)]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), _col8 (type: varchar(5)), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 5, 0, 7, 8]
                    Statistics: Num rows: 40 Data size: 15704 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 15704 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
       count(*) over(partition by p_varchar) as cs,
       sum(p_retailprice) over(partition by p_varchar) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
       count(*) over(partition by p_varchar) as cs,
       sum(p_retailprice) over(partition by p_varchar) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_varchar	cs	s
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	AC	3	4891.75
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	AC	3	4891.75
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	AC	3	4891.75
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	AK	1	1632.66
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	BB	3	3391.3199999999997
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	BB	3	3391.3199999999997
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	BB	3	3391.3199999999997
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	BD	1	1000.6
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	CA	2	2888.9300000000003
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	CA	2	2888.9300000000003
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	CC	2	1632.66
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	CC	2	1632.66
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	CD	2	1608.37
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	CD	2	1608.37
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	DA	3	3944.7699999999995
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	DA	3	3944.7699999999995
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	DA	3	3944.7699999999995
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	DD	2	1305.94
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	DD	2	1305.94
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	EE	1	NULL
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	LM	1	1690.68
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	SM	1	1173.15
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	AA	3	5024.02
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	AA	3	5024.02
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	AA	3	5024.02
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	AB	3	4679.6
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	AB	3	4679.6
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	AB	3	4679.6
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	AD	1	1753.76
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	AY	1	1190.27
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	BC	1	1922.98
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	CB	1	2031.98
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	DB	1	55.39
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	DC	1	1173.15
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	DE	1	NULL
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	EF	1	1753.76
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	FD	2	3634.61
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	FD	2	3634.61
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	OP	1	1375.42
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	RS	1	1632.66
PREHOOK: query: select "************ VARCHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ VARCHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ VARCHAR PARTITION WITH CONSTANT PARTITION EXPRESSION ************
PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
       count(*) over(partition by p_varchar) as cs,
       sum(p_retailprice) over(partition by p_varchar) as s
from vector_ptf_part_simple_orc
where p_name = 'DA'
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_varchar,
       count(*) over(partition by p_varchar) as cs,
       sum(p_retailprice) over(partition by p_varchar) as s
from vector_ptf_part_simple_orc
where p_name = 'DA'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_varchar	cs	s
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_varchar,
                                    count(*) over(partition by p_varchar) as cs,
                                    sum(p_retailprice) over(partition by p_varchar) as s
from vector_ptf_part_simple_orc
where p_varchar = 'DA'
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_varchar,
                                    count(*) over(partition by p_varchar) as cs,
                                    sum(p_retailprice) over(partition by p_varchar) as s
from vector_ptf_part_simple_orc
where p_varchar = 'DA'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  filterExpr: (p_varchar = 'DA') (type: boolean)
                  Statistics: Num rows: 40 Data size: 15864 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Filter Operator
                    Filter Vectorization:
                        className: VectorFilterOperator
                        native: true
                        predicateExpression: FilterStringGroupColEqualVarCharScalar(col 8:varchar(5), val DA)
                    predicate: (p_varchar = 'DA') (type: boolean)
                    Statistics: Num rows: 2 Data size: 828 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: CAST( 'DA' AS varchar(5)) (type: varchar(5))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: CAST( 'DA' AS varchar(5)) (type: varchar(5))
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkStringOperator
                          keyColumns: 13:varchar(5)
                          keyExpressions: VectorUDFAdaptor(CAST( 'DA' AS varchar(5))) -> 13:varchar(5)
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 10:int
                      Statistics: Num rows: 2 Data size: 828 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: true
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 8, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [string]
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 7
                    dataColumns: KEY.reducesinkkey0:varchar(5), VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col10:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double, string, string, string]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col10 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6]
                Statistics: Num rows: 2 Data size: 656 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: CAST( 'DA' AS varchar(5)) ASC NULLS FIRST
                        partition by: CAST( 'DA' AS varchar(5))
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: []
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6]
                      orderExpressions: [VectorUDFAdaptor(CAST( 'DA' AS varchar(5))) -> 10:varchar(5)]
                      outputColumns: [7, 8, 1, 2, 3, 4, 5, 6]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, int]
                      partitionExpressions: [VectorUDFAdaptor(CAST( 'DA' AS varchar(5))) -> 9:varchar(5)]
                      streamingColumns: []
                  Statistics: Num rows: 2 Data size: 656 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), 'DA' (type: varchar(5)), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 4, 6, 3, 5, 11, 7, 8]
                        selectExpressions: ConstantVectorExpression(val DA) -> 11:varchar(5)
                    Statistics: Num rows: 2 Data size: 860 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 2 Data size: 860 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select "************ BOOLEAN WINDOW RANGE TYPE ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BOOLEAN WINDOW RANGE TYPE ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BOOLEAN WINDOW RANGE TYPE ************
PREHOOK: query: select "************ BOOLEAN WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BOOLEAN WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BOOLEAN WINDOW RANGE TYPE (NON-VECTORIZED REFERENCE) ************
PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char, p_boolean,
       count(*) over(partition by p_mfgr order by p_boolean range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_boolean range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char, p_boolean,
       count(*) over(partition by p_mfgr order by p_boolean range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_boolean range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	p_boolean	cs	s
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	A	false	5	7486.48
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	B	false	5	7486.48
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	false	5	7486.48
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	A	false	5	7486.48
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	B	false	5	7486.48
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	true	7	9789.85
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	C	true	7	9789.85
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	C	true	7	9789.85
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	true	7	9789.85
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	B	true	7	9789.85
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	A	true	7	9789.85
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	true	7	9789.85
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	B	false	2	3601.4
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	B	false	2	3601.4
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	A	true	4	6432.0
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	C	true	4	6432.0
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	true	4	6432.0
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	C	true	4	6432.0
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	NULL	2	2691.28
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	A	NULL	2	2691.28
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	A	false	5	4550.219999999999
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	C	false	5	4550.219999999999
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	B	false	5	4550.219999999999
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	C	false	5	4550.219999999999
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	false	5	4550.219999999999
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	true	3	1835.93
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	C	true	3	1835.93
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	true	3	1835.93
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	A	false	3	1844.92
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	false	3	1844.92
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	A	false	3	1844.92
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	C	true	2	2581.6800000000003
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	B	true	2	2581.6800000000003
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	C	NULL	1	1290.35
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	B	false	3	5012.05
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	A	false	3	5012.05
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	C	false	3	5012.05
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	true	3	4272.27
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	B	true	3	4272.27
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	C	true	3	4272.27
PREHOOK: query: select "************ BOOLEAN WINDOW RANGE TYPE (VECTORIZED) ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BOOLEAN WINDOW RANGE TYPE (VECTORIZED) ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BOOLEAN WINDOW RANGE TYPE (VECTORIZED) ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char, p_boolean,
                                    count(*) over(partition by p_mfgr order by p_boolean range between 3 preceding and
                                    current row) as cs,
                                    sum(p_retailprice) over(partition by p_mfgr order by p_boolean range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char, p_boolean,
                                    count(*) over(partition by p_mfgr order by p_boolean range between 3 preceding and
                                    current row) as cs,
                                    sum(p_retailprice) over(partition by p_mfgr order by p_boolean range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 15976 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_mfgr (type: string), p_boolean (type: boolean)
                    null sort order: az
                    sort order: ++
                    Map-reduce partition columns: p_mfgr (type: string)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkObjectHashOperator
                        keyColumns: 0:string, 9:boolean
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        partitionColumns: 0:string
                        valueColumns: 1:string, 2:date, 3:timestamp, 5:double, 7:char(1), 10:int
                    Statistics: Num rows: 40 Data size: 15976 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), p_char (type: char(1)), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 7, 9, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: az
                reduceColumnSortOrder: ++
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 8
                    dataColumns: KEY.reducesinkkey0:string, KEY.reducesinkkey1:boolean, VALUE._col0:string, VALUE._col1:date, VALUE._col2:timestamp, VALUE._col4:double, VALUE._col6:char(1), VALUE._col8:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: date), VALUE._col2 (type: timestamp), VALUE._col4 (type: double), VALUE._col6 (type: char(1)), KEY.reducesinkkey1 (type: boolean), VALUE._col8 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7, _col9, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [0, 2, 3, 4, 5, 6, 1, 7]
                Statistics: Num rows: 40 Data size: 15976 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: char(1), _col9: boolean, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col9 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: RANGE PRECEDING(3)~CURRENT
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: RANGE PRECEDING(3)~CURRENT
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0, 1]
                      native: true
                      nonKeyInputColumns: [2, 3, 4, 5, 6, 7]
                      orderExpressions: [col 1:boolean]
                      outputColumns: [8, 9, 0, 2, 3, 4, 5, 6, 1, 7]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, char(1), boolean, int]
                      partitionExpressions: [col 0:string]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 15976 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), _col7 (type: char(1)), _col9 (type: boolean), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [0, 2, 4, 7, 3, 5, 6, 1, 8, 9]
                    Statistics: Num rows: 40 Data size: 15804 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 15804 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char, p_boolean,
       count(*) over(partition by p_mfgr order by p_boolean range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_boolean range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char, p_boolean,
       count(*) over(partition by p_mfgr order by p_boolean range between 3 preceding and current row) as cs,
       sum(p_retailprice) over(partition by p_mfgr order by p_boolean range between 3 preceding and current row) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	p_boolean	cs	s
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	A	false	5	7486.48
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	B	false	5	7486.48
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	false	5	7486.48
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	A	false	5	7486.48
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	B	false	5	7486.48
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	true	7	9789.85
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	C	true	7	9789.85
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	C	true	7	9789.85
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	true	7	9789.85
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	B	true	7	9789.85
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	A	true	7	9789.85
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	true	7	9789.85
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	B	false	2	3601.4
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	B	false	2	3601.4
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	A	true	4	6432.0
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	C	true	4	6432.0
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	true	4	6432.0
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	C	true	4	6432.0
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	NULL	2	2691.28
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	A	NULL	2	2691.28
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	A	false	5	4550.219999999999
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	C	false	5	4550.219999999999
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	B	false	5	4550.219999999999
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	C	false	5	4550.219999999999
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	false	5	4550.219999999999
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	true	3	1835.93
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	C	true	3	1835.93
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	true	3	1835.93
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	A	false	3	1844.92
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	false	3	1844.92
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	A	false	3	1844.92
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	C	true	2	2581.6800000000003
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	B	true	2	2581.6800000000003
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	C	NULL	1	1290.35
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	B	false	3	5012.05
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	A	false	3	5012.05
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	C	false	3	5012.05
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	true	3	4272.27
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	B	true	3	4272.27
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	C	true	3	4272.27
PREHOOK: query: select "************ BOOLEAN PARTITION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BOOLEAN PARTITION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BOOLEAN PARTITION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,p_boolean,
                                    count(*) over(partition by p_boolean) as cs,
                                    sum(p_retailprice) over(partition by p_boolean) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,p_boolean,
                                    count(*) over(partition by p_boolean) as cs,
                                    sum(p_retailprice) over(partition by p_boolean) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 15976 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Reduce Output Operator
                    key expressions: p_boolean (type: boolean)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: p_boolean (type: boolean)
                    Reduce Sink Vectorization:
                        className: VectorReduceSinkLongOperator
                        keyColumns: 9:boolean
                        native: true
                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                        valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 7:char(1), 10:int
                    Statistics: Num rows: 40 Data size: 15976 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), p_char (type: char(1)), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 7, 9, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 8
                    dataColumns: KEY.reducesinkkey0:boolean, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col7:char(1), VALUE._col9:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col7 (type: char(1)), KEY.reducesinkkey0 (type: boolean), VALUE._col9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7, _col9, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6, 0, 7]
                Statistics: Num rows: 40 Data size: 15976 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: char(1), _col9: boolean, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col9 ASC NULLS FIRST
                        partition by: _col9
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6, 7]
                      orderExpressions: [col 0:boolean]
                      outputColumns: [8, 9, 1, 2, 3, 4, 5, 6, 0, 7]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, char(1), boolean, int]
                      partitionExpressions: [col 0:boolean]
                      streamingColumns: []
                  Statistics: Num rows: 40 Data size: 15976 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), _col7 (type: char(1)), _col9 (type: boolean), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 4, 7, 3, 5, 6, 0, 8, 9]
                    Statistics: Num rows: 40 Data size: 15804 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 40 Data size: 15804 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,p_boolean,
       count(*) over(partition by p_boolean) as cs,
       sum(p_retailprice) over(partition by p_boolean) as s
from vector_ptf_part_simple_orc
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,p_boolean,
       count(*) over(partition by p_boolean) as cs,
       sum(p_retailprice) over(partition by p_boolean) as s
from vector_ptf_part_simple_orc
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	p_boolean	cs	s
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	40	1970-01-05	1206.26	C	true	19	24911.730000000003
Manufacturer#1	almond aquamarine burnished black steel	1970-01-02 00:00:00	2	1970-01-02	1414.42	B	true	19	24911.730000000003
Manufacturer#2	almond aquamarine rose maroon antique	1970-01-03 00:00:00	3	1970-01-03	1698.66	C	true	19	24911.730000000003
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	4	1970-01-04	NULL	A	true	19	24911.730000000003
Manufacturer#5	almond antique blue firebrick mint	NULL	7	NULL	1789.69	D	true	19	24911.730000000003
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-05 00:00:00	10	1970-01-05	1190.27	C	true	19	24911.730000000003
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-02 00:00:00	12	1970-01-02	1753.76	D	true	19	24911.730000000003
Manufacturer#4	almond antique violet mint lemon	1970-01-01 00:00:00	16	1970-01-01	1375.42	B	true	19	24911.730000000003
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-02 00:00:00	17	1970-01-02	1632.66	D	true	19	24911.730000000003
Manufacturer#5	almond azure blanched chiffon midnight	1970-01-03 00:00:00	18	1970-01-03	1464.48	C	true	19	24911.730000000003
Manufacturer#3	almond antique forest lavender goldenrod	NULL	19	NULL	590.27	D	true	19	24911.730000000003
Manufacturer#2	almond aquamarine rose maroon antique	NULL	1	NULL	900.66	A	true	19	24911.730000000003
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-03 00:00:00	23	1970-01-03	1632.66	D	true	19	24911.730000000003
Manufacturer#1	almond antique chartreuse lavender yellow	NULL	26	NULL	1753.76	C	true	19	24911.730000000003
Manufacturer#2	almond antique violet turquoise frosted	1970-01-02 00:00:00	27	1970-01-02	1800.7	D	true	19	24911.730000000003
Manufacturer#1	almond antique salmon chartreuse burlywood	1970-01-05 00:00:00	30	1970-01-05	1602.59	C	true	19	24911.730000000003
Manufacturer#2	almond aquamarine midnight light salmon	1970-01-04 00:00:00	34	1970-01-04	2031.98	C	true	19	24911.730000000003
Manufacturer#5	almond aquamarine dodger light gainsboro	1970-01-01 00:00:00	36	1970-01-01	1018.1	B	true	19	24911.730000000003
Manufacturer#3	almond antique metallic orange dim	NULL	38	NULL	55.39	D	true	19	24911.730000000003
Manufacturer#4	almond azure aquamarine papaya violet	1970-01-02 00:00:00	37	1970-01-02	1290.35	C	NULL	3	3981.6299999999997
Manufacturer#2	almond antique violet chocolate turquoise	1970-01-05 00:00:00	15	1970-01-05	1690.68	D	NULL	3	3981.6299999999997
Manufacturer#2	almond aquamarine sandy cyan gainsboro	NULL	32	NULL	1000.6	A	NULL	3	3981.6299999999997
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	A	false	18	22495.07
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	B	false	18	22495.07
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	A	false	18	22495.07
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	B	false	18	22495.07
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	C	false	18	22495.07
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	A	false	18	22495.07
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	B	false	18	22495.07
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	C	false	18	22495.07
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	A	false	18	22495.07
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	A	false	18	22495.07
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	false	18	22495.07
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	false	18	22495.07
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	A	false	18	22495.07
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	B	false	18	22495.07
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	C	false	18	22495.07
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	B	false	18	22495.07
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	false	18	22495.07
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	B	false	18	22495.07
PREHOOK: query: select "************ BOOLEAN PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
POSTHOOK: query: select "************ BOOLEAN PARTITION WITH CONSTANT PARTITION EXPRESSION ************"
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
#### A masked pattern was here ####
_c0
************ BOOLEAN PARTITION WITH CONSTANT PARTITION EXPRESSION ************
PREHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,p_boolean,
                                    count(*) over(partition by p_boolean) as cs,
                                    sum(p_retailprice) over(partition by p_boolean) as s
from vector_ptf_part_simple_orc
where p_boolean = true
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: EXPLAIN VECTORIZATION DETAIL select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice,p_char,p_boolean,
                                    count(*) over(partition by p_boolean) as cs,
                                    sum(p_retailprice) over(partition by p_boolean) as s
from vector_ptf_part_simple_orc
where p_boolean = true
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
Explain
PLAN VECTORIZATION:
  enabled: true
  enabledConditionsMet: [hive.vectorized.execution.enabled IS true]

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
#### A masked pattern was here ####
      Edges:
        Reducer 2 <- Map 1 (SIMPLE_EDGE)
#### A masked pattern was here ####
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: vector_ptf_part_simple_orc
                  Statistics: Num rows: 40 Data size: 15976 Basic stats: COMPLETE Column stats: COMPLETE
                  TableScan Vectorization:
                      native: true
                      vectorizationSchemaColumns: [0:p_mfgr:string, 1:p_name:string, 2:p_date:date, 3:p_timestamp:timestamp, 4:p_int:int, 5:p_retailprice:double, 6:p_decimal:decimal(10,4)/DECIMAL_64, 7:p_char:char(1), 8:p_varchar:varchar(5), 9:p_boolean:boolean, 10:rowindex:int, 11:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 12:ROW__IS__DELETED:boolean]
                  Filter Operator
                    Filter Vectorization:
                        className: VectorFilterOperator
                        native: true
                        predicateExpression: SelectColumnIsTrue(col 9:boolean)
                    predicate: p_boolean (type: boolean)
                    Statistics: Num rows: 19 Data size: 7627 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: p_boolean (type: boolean)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: p_boolean (type: boolean)
                      Reduce Sink Vectorization:
                          className: VectorReduceSinkLongOperator
                          keyColumns: 9:boolean
                          native: true
                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
                          valueColumns: 0:string, 1:string, 2:date, 3:timestamp, 5:double, 7:char(1), 10:int
                      Statistics: Num rows: 19 Data size: 7627 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: p_mfgr (type: string), p_name (type: string), p_date (type: date), p_timestamp (type: timestamp), p_retailprice (type: double), p_char (type: char(1)), rowindex (type: int)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
            Map Vectorization:
                enabled: true
                enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
                inputFormatFeatureSupport: [DECIMAL_64]
                featureSupportInUse: [DECIMAL_64]
                inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                allNative: true
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 11
                    includeColumns: [0, 1, 2, 3, 5, 7, 9, 10]
                    dataColumns: p_mfgr:string, p_name:string, p_date:date, p_timestamp:timestamp, p_int:int, p_retailprice:double, p_decimal:decimal(10,4)/DECIMAL_64, p_char:char(1), p_varchar:varchar(5), p_boolean:boolean, rowindex:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: []
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Vectorization:
                enabled: true
                enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                reduceColumnNullOrder: a
                reduceColumnSortOrder: +
                allNative: false
                usesVectorUDFAdaptor: false
                vectorized: true
                rowBatchContext:
                    dataColumnCount: 8
                    dataColumns: KEY.reducesinkkey0:boolean, VALUE._col0:string, VALUE._col1:string, VALUE._col2:date, VALUE._col3:timestamp, VALUE._col5:double, VALUE._col7:char(1), VALUE._col9:int
                    partitionColumnCount: 0
                    scratchColumnTypeNames: [bigint, double]
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: date), VALUE._col3 (type: timestamp), VALUE._col5 (type: double), VALUE._col7 (type: char(1)), KEY.reducesinkkey0 (type: boolean), VALUE._col9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col7, _col9, _col10
                Select Vectorization:
                    className: VectorSelectOperator
                    native: true
                    projectedOutputColumnNums: [1, 2, 3, 4, 5, 6, 0, 7]
                Statistics: Num rows: 19 Data size: 7627 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: string, _col1: string, _col2: date, _col3: timestamp, _col5: double, _col7: char(1), _col9: boolean, _col10: int
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col9 ASC NULLS FIRST
                        partition by: _col9
                        raw input shape:
                        window functions:
                            window function definition
                              alias: count_window_0
                              name: count
                              window function: GenericUDAFCountEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isStar: true
                            window function definition
                              alias: sum_window_1
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumDouble
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  PTF Vectorization:
                      allEvaluatorsAreStreaming: false
                      className: VectorPTFOperator
                      evaluatorClasses: [VectorPTFEvaluatorCountStar, VectorPTFEvaluatorDoubleSum]
                      functionInputExpressions: [null, col 5:double]
                      functionNames: [count, sum]
                      keyInputColumns: [0]
                      native: true
                      nonKeyInputColumns: [1, 2, 3, 4, 5, 6, 7]
                      orderExpressions: [col 0:boolean]
                      outputColumns: [8, 9, 1, 2, 3, 4, 5, 6, 0, 7]
                      outputTypes: [bigint, double, string, string, date, timestamp, double, char(1), boolean, int]
                      partitionExpressions: [col 0:boolean]
                      streamingColumns: []
                  Statistics: Num rows: 19 Data size: 7627 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: string), _col3 (type: timestamp), _col10 (type: int), _col2 (type: date), _col5 (type: double), _col7 (type: char(1)), _col9 (type: boolean), count_window_0 (type: bigint), sum_window_1 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                    Select Vectorization:
                        className: VectorSelectOperator
                        native: true
                        projectedOutputColumnNums: [1, 2, 4, 7, 3, 5, 6, 0, 8, 9]
                    Statistics: Num rows: 19 Data size: 7527 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      File Sink Vectorization:
                          className: VectorFileSinkOperator
                          native: false
                      Statistics: Num rows: 19 Data size: 7527 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

PREHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,p_boolean,
       count(*) over(partition by p_boolean) as cs,
       sum(p_retailprice) over(partition by p_boolean) as s
from vector_ptf_part_simple_orc
where p_boolean = false
PREHOOK: type: QUERY
PREHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
POSTHOOK: query: select p_mfgr, p_name, p_timestamp, rowindex, p_date, p_retailprice, p_char,p_boolean,
       count(*) over(partition by p_boolean) as cs,
       sum(p_retailprice) over(partition by p_boolean) as s
from vector_ptf_part_simple_orc
where p_boolean = false
POSTHOOK: type: QUERY
POSTHOOK: Input: default@vector_ptf_part_simple_orc
#### A masked pattern was here ####
p_mfgr	p_name	p_timestamp	rowindex	p_date	p_retailprice	p_char	p_boolean	cs	s
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	5	1970-01-05	1753.76	B	false	18	22495.070000000003
Manufacturer#5	almond antique medium spring khaki	1970-01-01 00:00:00	6	1970-01-01	1611.66	C	false	18	22495.070000000003
Manufacturer#1	almond antique burnished rose metallic	1970-01-03 00:00:00	8	1970-01-03	1173.15	A	false	18	22495.070000000003
Manufacturer#1	almond aquamarine pink moccasin thistle	1970-01-04 00:00:00	9	1970-01-04	1632.66	B	false	18	22495.070000000003
Manufacturer#4	almond aquamarine yellow dodger mint	1970-01-01 00:00:00	11	1970-01-01	1844.92	D	false	18	22495.070000000003
Manufacturer#2	almond antique violet turquoise frosted	NULL	13	NULL	1800.7	B	false	18	22495.070000000003
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-04 00:00:00	14	1970-01-04	NULL	C	false	18	22495.070000000003
Manufacturer#1	almond antique chartreuse lavender yellow	1970-01-05 00:00:00	20	1970-01-05	1753.76	A	false	18	22495.070000000003
Manufacturer#2	almond antique violet turquoise frosted	1970-01-01 00:00:00	21	1970-01-01	1800.7	B	false	18	22495.070000000003
Manufacturer#5	almond antique sky peru orange	1970-01-02 00:00:00	22	1970-01-02	1788.73	A	false	18	22495.070000000003
Manufacturer#3	almond antique chartreuse khaki white	1970-01-04 00:00:00	24	1970-01-04	99.68	C	false	18	22495.070000000003
Manufacturer#4	almond antique gainsboro frosted violet	NULL	25	NULL	NULL	A	false	18	22495.070000000003
Manufacturer#3	almond antique olive coral navajo	1970-01-03 00:00:00	28	1970-01-03	1337.29	A	false	18	22495.070000000003
Manufacturer#5	almond antique medium spring khaki	1970-01-04 00:00:00	29	1970-01-04	1611.66	B	false	18	22495.070000000003
Manufacturer#3	almond antique misty red olive	1970-01-01 00:00:00	31	1970-01-01	1922.98	D	false	18	22495.070000000003
Manufacturer#3	almond antique forest lavender goldenrod	1970-01-03 00:00:00	33	1970-01-03	1190.27	B	false	18	22495.070000000003
Manufacturer#4	almond aquamarine floral ivory bisque	1970-01-05 00:00:00	35	1970-01-05	NULL	A	false	18	22495.070000000003
Manufacturer#1	almond antique burnished rose metallic	1970-01-04 00:00:00	39	1970-01-04	1173.15	D	false	18	22495.070000000003
