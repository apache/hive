PREHOOK: query: explain create table src_orc_merge_test_part(key int, value string) partitioned by (ds string, ts string) stored as orc
PREHOOK: type: CREATETABLE
POSTHOOK: query: explain create table src_orc_merge_test_part(key int, value string) partitioned by (ds string, ts string) stored as orc
POSTHOOK: type: CREATETABLE
Stage-0
   Create Table Operator:
      columns:["key int","value string"]
      input format:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
      name:default.src_orc_merge_test_part
      output format:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
      partition columns:["ds string","ts string"]
PREHOOK: query: create table src_orc_merge_test_part(key int, value string) partitioned by (ds string, ts string) stored as orc
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@src_orc_merge_test_part
POSTHOOK: query: create table src_orc_merge_test_part(key int, value string) partitioned by (ds string, ts string) stored as orc
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@src_orc_merge_test_part
PREHOOK: query: alter table src_orc_merge_test_part add partition (ds='2012-01-03', ts='2012-01-03+14:46:31')
PREHOOK: type: ALTERTABLE_ADDPARTS
PREHOOK: Output: default@src_orc_merge_test_part
POSTHOOK: query: alter table src_orc_merge_test_part add partition (ds='2012-01-03', ts='2012-01-03+14:46:31')
POSTHOOK: type: ALTERTABLE_ADDPARTS
POSTHOOK: Output: default@src_orc_merge_test_part
POSTHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
PREHOOK: query: desc extended src_orc_merge_test_part partition (ds='2012-01-03', ts='2012-01-03+14:46:31')
PREHOOK: type: DESCTABLE
PREHOOK: Input: default@src_orc_merge_test_part
POSTHOOK: query: desc extended src_orc_merge_test_part partition (ds='2012-01-03', ts='2012-01-03+14:46:31')
POSTHOOK: type: DESCTABLE
POSTHOOK: Input: default@src_orc_merge_test_part
key                 	int                 	                    
value               	string              	                    
ds                  	string              	                    
ts                  	string              	                    
	 	 
# Partition Information	 	 
# col_name            	data_type           	comment             
	 	 
ds                  	string              	                    
ts                  	string              	                    
	 	 
#### A masked pattern was here ####
PREHOOK: query: explain insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src
PREHOOK: type: QUERY
POSTHOOK: query: explain insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src
POSTHOOK: type: QUERY
Plan optimized by CBO.

Stage-3
   Stats-Aggr Operator
      Stage-0
         Move Operator
            partition:{"ts":"2012-01-03+14:46:31","ds":"2012-01-03"}
            table:{"serde:":"org.apache.hadoop.hive.ql.io.orc.OrcSerde","name:":"default.src_orc_merge_test_part","input format:":"org.apache.hadoop.hive.ql.io.orc.OrcInputFormat","output format:":"org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat"}
            Stage-2
               Dependency Collection{}
                  Stage-1
                     Map 1
                     File Output Operator [FS_3]
                        compressed:false
                        Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                        table:{"serde:":"org.apache.hadoop.hive.ql.io.orc.OrcSerde","name:":"default.src_orc_merge_test_part","input format:":"org.apache.hadoop.hive.ql.io.orc.OrcInputFormat","output format:":"org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat"}
                        Select Operator [SEL_1]
                           outputColumnNames:["_col0","_col1"]
                           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           TableScan [TS_0]
                              alias:src
                              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
POSTHOOK: query: insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03+14:46:31).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03+14:46:31).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: explain insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 100
PREHOOK: type: QUERY
POSTHOOK: query: explain insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 100
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-3
   Stats-Aggr Operator
      Stage-0
         Move Operator
            partition:{"ts":"2012-01-03+14:46:31","ds":"2012-01-03"}
            table:{"serde:":"org.apache.hadoop.hive.ql.io.orc.OrcSerde","name:":"default.src_orc_merge_test_part","input format:":"org.apache.hadoop.hive.ql.io.orc.OrcInputFormat","output format:":"org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat"}
            Stage-2
               Dependency Collection{}
                  Stage-1
                     Reducer 2
                     File Output Operator [FS_7]
                        compressed:false
                        Statistics:Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
                        table:{"serde:":"org.apache.hadoop.hive.ql.io.orc.OrcSerde","name:":"default.src_orc_merge_test_part","input format:":"org.apache.hadoop.hive.ql.io.orc.OrcInputFormat","output format:":"org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat"}
                        Select Operator [SEL_6]
                           outputColumnNames:["_col0","_col1"]
                           Statistics:Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
                           Limit [LIM_5]
                              Number of rows:100
                              Statistics:Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
                              Select Operator [SEL_4]
                              |  outputColumnNames:["_col0","_col1"]
                              |  Statistics:Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
                              |<-Map 1 [SIMPLE_EDGE]
                                 Reduce Output Operator [RS_3]
                                    sort order:
                                    Statistics:Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
                                    value expressions:_col0 (type: string), _col1 (type: string)
                                    Limit [LIM_2]
                                       Number of rows:100
                                       Statistics:Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
                                       Select Operator [SEL_1]
                                          outputColumnNames:["_col0","_col1"]
                                          Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                          TableScan [TS_0]
                                             alias:src
                                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select count(1) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
PREHOOK: type: QUERY
POSTHOOK: query: explain select count(1) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_8]
            compressed:false
            Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_6]
            |  aggregations:["count(VALUE._col0)"]
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
               Reduce Output Operator [RS_5]
                  sort order:
                  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint)
                  Group By Operator [GBY_4]
                     aggregations:["count(1)"]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                     Select Operator [SEL_2]
                        Statistics:Num rows: 500 Data size: 47000 Basic stats: COMPLETE Column stats: NONE
                        TableScan [TS_0]
                           alias:src_orc_merge_test_part
                           Statistics:Num rows: 500 Data size: 47000 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select sum(hash(key)), sum(hash(value)) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
PREHOOK: type: QUERY
POSTHOOK: query: explain select sum(hash(key)), sum(hash(value)) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_8]
            compressed:false
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_6]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
               Reduce Output Operator [RS_5]
                  sort order:
                  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint)
                  Group By Operator [GBY_4]
                     aggregations:["sum(_col0)","sum(_col1)"]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                     Select Operator [SEL_2]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 500 Data size: 47000 Basic stats: COMPLETE Column stats: NONE
                        TableScan [TS_0]
                           alias:src_orc_merge_test_part
                           Statistics:Num rows: 500 Data size: 47000 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: alter table src_orc_merge_test_part partition (ds='2012-01-03', ts='2012-01-03+14:46:31') concatenate
PREHOOK: type: ALTER_PARTITION_MERGE
PREHOOK: Input: default@src_orc_merge_test_part
PREHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
POSTHOOK: query: alter table src_orc_merge_test_part partition (ds='2012-01-03', ts='2012-01-03+14:46:31') concatenate
POSTHOOK: type: ALTER_PARTITION_MERGE
POSTHOOK: Input: default@src_orc_merge_test_part
POSTHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
PREHOOK: query: explain select count(1) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
PREHOOK: type: QUERY
POSTHOOK: query: explain select count(1) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_8]
            compressed:false
            Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_6]
            |  aggregations:["count(VALUE._col0)"]
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
               Reduce Output Operator [RS_5]
                  sort order:
                  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint)
                  Group By Operator [GBY_4]
                     aggregations:["count(1)"]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                     Select Operator [SEL_2]
                        Statistics:Num rows: 1 Data size: 2527 Basic stats: PARTIAL Column stats: NONE
                        TableScan [TS_0]
                           alias:src_orc_merge_test_part
                           Statistics:Num rows: 1 Data size: 2527 Basic stats: PARTIAL Column stats: NONE
PREHOOK: query: explain select sum(hash(key)), sum(hash(value)) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
PREHOOK: type: QUERY
POSTHOOK: query: explain select sum(hash(key)), sum(hash(value)) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31'
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_8]
            compressed:false
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_6]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
               Reduce Output Operator [RS_5]
                  sort order:
                  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint)
                  Group By Operator [GBY_4]
                     aggregations:["sum(_col0)","sum(_col1)"]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                     Select Operator [SEL_2]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 24 Data size: 2527 Basic stats: COMPLETE Column stats: NONE
                        TableScan [TS_0]
                           alias:src_orc_merge_test_part
                           Statistics:Num rows: 24 Data size: 2527 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: drop table src_orc_merge_test_part
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@src_orc_merge_test_part
PREHOOK: Output: default@src_orc_merge_test_part
POSTHOOK: query: drop table src_orc_merge_test_part
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@src_orc_merge_test_part
POSTHOOK: Output: default@src_orc_merge_test_part
Warning: Map Join MAPJOIN[20][bigTable=?] in task 'Map 1' is a cross product
PREHOOK: query: explain select sum(hash(a.k1,a.v1,a.k2, a.v2))
from (
select src1.key as k1, src1.value as v1, 
       src2.key as k2, src2.value as v2 FROM 
  (select * FROM src WHERE src.key < 10) src1 
    JOIN 
  (select * FROM src WHERE src.key < 10) src2
  SORT BY k1, v1, k2, v2
) a
PREHOOK: type: QUERY
POSTHOOK: query: explain select sum(hash(a.k1,a.v1,a.k2, a.v2))
from (
select src1.key as k1, src1.value as v1, 
       src2.key as k2, src2.value as v2 FROM 
  (select * FROM src WHERE src.key < 10) src1 
    JOIN 
  (select * FROM src WHERE src.key < 10) src2
  SORT BY k1, v1, k2, v2
) a
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Map 1 <- Map 4 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_17]
            compressed:false
            Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_15]
            |  aggregations:["sum(VALUE._col0)"]
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 2 [SIMPLE_EDGE]
               Reduce Output Operator [RS_14]
                  sort order:
                  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint)
                  Group By Operator [GBY_13]
                     aggregations:["sum(hash(_col0,_col1,_col2,_col3))"]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                     Select Operator [SEL_11]
                     |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                     |  Statistics:Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
                     |<-Map 1 [SIMPLE_EDGE]
                        Reduce Output Operator [RS_10]
                           key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
                           sort order:++++
                           Statistics:Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
                           Map Join Operator [MAPJOIN_20]
                           |  condition map:[{"":"Inner Join 0 to 1"}]
                           |  keys:{}
                           |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |  Statistics:Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
                           |<-Map 4 [BROADCAST_EDGE]
                           |  Reduce Output Operator [RS_7]
                           |     sort order:
                           |     Statistics:Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
                           |     value expressions:_col0 (type: string), _col1 (type: string)
                           |     Select Operator [SEL_5]
                           |        outputColumnNames:["_col0","_col1"]
                           |        Statistics:Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
                           |        Filter Operator [FIL_19]
                           |           predicate:(key < 10) (type: boolean)
                           |           Statistics:Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
                           |           TableScan [TS_3]
                           |              alias:src
                           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |<-Select Operator [SEL_2]
                                 outputColumnNames:["_col0","_col1"]
                                 Statistics:Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
                                 Filter Operator [FIL_18]
                                    predicate:(key < 10) (type: boolean)
                                    Statistics:Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
                                    TableScan [TS_0]
                                       alias:src
                                       Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key
PREHOOK: type: QUERY
POSTHOOK: query: explain select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_7]
            compressed:false
            Statistics:Num rows: 10 Data size: 885 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_6]
               outputColumnNames:["_col0","_col1","_col2"]
               Statistics:Num rows: 10 Data size: 885 Basic stats: COMPLETE Column stats: COMPLETE
               Group By Operator [GBY_5]
               |  aggregations:["sum(VALUE._col0)"]
               |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
               |  outputColumnNames:["_col0","_col1","_col2","_col3"]
               |  Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 1 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_4]
                     key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                     Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                     sort order:+++
                     Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col3 (type: bigint)
                     Group By Operator [GBY_3]
                        aggregations:["sum(_col1)"]
                        keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                        outputColumnNames:["_col0","_col1","_col2","_col3"]
                        Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator [SEL_1]
                           outputColumnNames:["_col0","_col1","_col2"]
                           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                           TableScan [TS_0]
                              alias:cbo_t1
                              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select x, y, count(*) from (select key, (c_int+c_float+1+2) as x, sum(c_int) as y from cbo_t1 group by c_float, cbo_t1.c_int, key) R group by y, x
PREHOOK: type: QUERY
POSTHOOK: query: explain select x, y, count(*) from (select key, (c_int+c_float+1+2) as x, sum(c_int) as y from cbo_t1 group by c_float, cbo_t1.c_int, key) R group by y, x
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_12]
            compressed:false
            Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_11]
               outputColumnNames:["_col0","_col1","_col2"]
               Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
               Group By Operator [GBY_10]
               |  aggregations:["count(VALUE._col0)"]
               |  keys:KEY._col0 (type: bigint), KEY._col1 (type: float)
               |  outputColumnNames:["_col0","_col1","_col2"]
               |  Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Reducer 2 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_9]
                     key expressions:_col0 (type: bigint), _col1 (type: float)
                     Map-reduce partition columns:_col0 (type: bigint), _col1 (type: float)
                     sort order:++
                     Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col2 (type: bigint)
                     Group By Operator [GBY_8]
                        aggregations:["count()"]
                        keys:_col0 (type: bigint), _col1 (type: float)
                        outputColumnNames:["_col0","_col1","_col2"]
                        Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator [SEL_6]
                           outputColumnNames:["_col0","_col1"]
                           Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                           Group By Operator [GBY_5]
                           |  aggregations:["sum(VALUE._col0)"]
                           |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                           |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |  Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_4]
                                 key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                 Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                 sort order:+++
                                 Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:_col3 (type: bigint)
                                 Group By Operator [GBY_3]
                                    aggregations:["sum(_col1)"]
                                    keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                    outputColumnNames:["_col0","_col1","_col2","_col3"]
                                    Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                                    Select Operator [SEL_1]
                                       outputColumnNames:["_col0","_col1","_col2"]
                                       Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                       TableScan [TS_0]
                                          alias:cbo_t1
                                          Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0) group by c_float, cbo_t1.c_int, key order by a) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key order by q/10 desc, r asc) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c order by cbo_t3.c_int+c desc, c
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0) group by c_float, cbo_t1.c_int, key order by a) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key order by q/10 desc, r asc) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c order by cbo_t3.c_int+c desc, c
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 10 <- Reducer 9 (SIMPLE_EDGE)
Reducer 5 <- Map 11 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Reducer 10 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
Reducer 7 <- Reducer 6 (SIMPLE_EDGE)
Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
Reducer 9 <- Map 8 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 7
         File Output Operator [FS_45]
            compressed:false
            Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_44]
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 6 [SIMPLE_EDGE]
               Reduce Output Operator [RS_43]
                  key expressions:(UDFToLong(_col0) + _col1) (type: bigint), _col1 (type: bigint)
                  sort order:-+
                  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col0 (type: int), _col2 (type: bigint)
                  Group By Operator [GBY_41]
                  |  aggregations:["count(VALUE._col0)"]
                  |  keys:KEY._col0 (type: int), KEY._col1 (type: bigint)
                  |  outputColumnNames:["_col0","_col1","_col2"]
                  |  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 5 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_40]
                        key expressions:_col0 (type: int), _col1 (type: bigint)
                        Map-reduce partition columns:_col0 (type: int), _col1 (type: bigint)
                        sort order:++
                        Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col2 (type: bigint)
                        Group By Operator [GBY_39]
                           aggregations:["count()"]
                           keys:_col0 (type: int), _col1 (type: bigint)
                           outputColumnNames:["_col0","_col1","_col2"]
                           Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_37]
                              outputColumnNames:["_col0","_col1"]
                              Statistics:Num rows: 2 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                              Filter Operator [FIL_36]
                                 predicate:((_col1 > 0) or (_col6 >= 0)) (type: boolean)
                                 Statistics:Num rows: 2 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                                 Merge Join Operator [MERGEJOIN_55]
                                 |  condition map:[{"":"Inner Join 0 to 1"}]
                                 |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                 |  outputColumnNames:["_col1","_col2","_col6"]
                                 |  Statistics:Num rows: 3 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Map 11 [SIMPLE_EDGE]
                                 |  Reduce Output Operator [RS_34]
                                 |     key expressions:_col0 (type: string)
                                 |     Map-reduce partition columns:_col0 (type: string)
                                 |     sort order:+
                                 |     Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                                 |     value expressions:_col1 (type: int)
                                 |     Select Operator [SEL_30]
                                 |        outputColumnNames:["_col0","_col1"]
                                 |        Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                                 |        Filter Operator [FIL_53]
                                 |           predicate:key is not null (type: boolean)
                                 |           Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                                 |           TableScan [TS_29]
                                 |              alias:cbo_t3
                                 |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Reducer 4 [SIMPLE_EDGE]
                                    Reduce Output Operator [RS_32]
                                       key expressions:_col0 (type: string)
                                       Map-reduce partition columns:_col0 (type: string)
                                       sort order:+
                                       Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                       value expressions:_col1 (type: int), _col2 (type: bigint)
                                       Select Operator [SEL_28]
                                          outputColumnNames:["_col0","_col1","_col2"]
                                          Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                          Filter Operator [FIL_27]
                                             predicate:((_col1 + _col4) >= 0) (type: boolean)
                                             Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             Merge Join Operator [MERGEJOIN_54]
                                             |  condition map:[{"":"Inner Join 0 to 1"}]
                                             |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                             |  outputColumnNames:["_col0","_col1","_col2","_col4"]
                                             |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             |<-Reducer 10 [SIMPLE_EDGE]
                                             |  Reduce Output Operator [RS_25]
                                             |     key expressions:_col0 (type: string)
                                             |     Map-reduce partition columns:_col0 (type: string)
                                             |     sort order:+
                                             |     Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                             |     value expressions:_col1 (type: int)
                                             |     Select Operator [SEL_20]
                                             |     |  outputColumnNames:["_col0","_col1"]
                                             |     |  Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                             |     |<-Reducer 9 [SIMPLE_EDGE]
                                             |        Reduce Output Operator [RS_19]
                                             |           key expressions:_col3 (type: double), _col2 (type: bigint)
                                             |           sort order:-+
                                             |           Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                                             |           value expressions:_col0 (type: string), _col1 (type: int)
                                             |           Select Operator [SEL_18]
                                             |              outputColumnNames:["_col0","_col1","_col2","_col3"]
                                             |              Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                                             |              Group By Operator [GBY_17]
                                             |              |  aggregations:["sum(VALUE._col0)"]
                                             |              |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                             |              |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                                             |              |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             |              |<-Map 8 [SIMPLE_EDGE]
                                             |                 Reduce Output Operator [RS_16]
                                             |                    key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                             |                    Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                             |                    sort order:+++
                                             |                    Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             |                    value expressions:_col3 (type: bigint)
                                             |                    Group By Operator [GBY_15]
                                             |                       aggregations:["sum(_col1)"]
                                             |                       keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                             |                       outputColumnNames:["_col0","_col1","_col2","_col3"]
                                             |                       Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             |                       Select Operator [SEL_13]
                                             |                          outputColumnNames:["_col0","_col1","_col2"]
                                             |                          Statistics:Num rows: 3 Data size: 279 Basic stats: COMPLETE Column stats: COMPLETE
                                             |                          Filter Operator [FIL_52]
                                             |                             predicate:((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and key is not null) (type: boolean)
                                             |                             Statistics:Num rows: 3 Data size: 279 Basic stats: COMPLETE Column stats: COMPLETE
                                             |                             TableScan [TS_11]
                                             |                                alias:cbo_t2
                                             |                                Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                             |<-Reducer 3 [SIMPLE_EDGE]
                                                Reduce Output Operator [RS_23]
                                                   key expressions:_col0 (type: string)
                                                   Map-reduce partition columns:_col0 (type: string)
                                                   sort order:+
                                                   Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                                   value expressions:_col1 (type: int), _col2 (type: bigint)
                                                   Select Operator [SEL_9]
                                                   |  outputColumnNames:["_col0","_col1","_col2"]
                                                   |  Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                                   |<-Reducer 2 [SIMPLE_EDGE]
                                                      Reduce Output Operator [RS_8]
                                                         key expressions:_col0 (type: string)
                                                         sort order:+
                                                         Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                                         value expressions:_col1 (type: int), _col2 (type: bigint)
                                                         Select Operator [SEL_7]
                                                            outputColumnNames:["_col0","_col1","_col2"]
                                                            Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                                            Group By Operator [GBY_6]
                                                            |  aggregations:["sum(VALUE._col0)"]
                                                            |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                                            |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                            |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                            |<-Map 1 [SIMPLE_EDGE]
                                                               Reduce Output Operator [RS_5]
                                                                  key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                                  Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                                  sort order:+++
                                                                  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                                  value expressions:_col3 (type: bigint)
                                                                  Group By Operator [GBY_4]
                                                                     aggregations:["sum(_col1)"]
                                                                     keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                                     outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                                     Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                                     Select Operator [SEL_2]
                                                                        outputColumnNames:["_col0","_col1","_col2"]
                                                                        Statistics:Num rows: 3 Data size: 279 Basic stats: COMPLETE Column stats: COMPLETE
                                                                        Filter Operator [FIL_51]
                                                                           predicate:((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and key is not null) (type: boolean)
                                                                           Statistics:Num rows: 3 Data size: 279 Basic stats: COMPLETE Column stats: COMPLETE
                                                                           TableScan [TS_0]
                                                                              alias:cbo_t1
                                                                              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by b % c asc, b desc) cbo_t1 left outer join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key  having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t2 on cbo_t1.a=p left outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c  having cbo_t3.c_int > 0 and (c_int >=1 or c >= 1) and (c_int + c) >= 0  order by cbo_t3.c_int % c asc, cbo_t3.c_int desc
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by b % c asc, b desc) cbo_t1 left outer join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key  having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t2 on cbo_t1.a=p left outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c  having cbo_t3.c_int > 0 and (c_int >=1 or c >= 1) and (c_int + c) >= 0  order by cbo_t3.c_int % c asc, cbo_t3.c_int desc
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 5 <- Map 10 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
Reducer 7 <- Reducer 6 (SIMPLE_EDGE)
Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
Reducer 9 <- Map 8 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 7
         File Output Operator [FS_44]
            compressed:false
            Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_43]
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 6 [SIMPLE_EDGE]
               Reduce Output Operator [RS_42]
                  key expressions:(UDFToLong(_col0) % _col1) (type: bigint), _col0 (type: int)
                  sort order:+-
                  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col1 (type: bigint), _col2 (type: bigint)
                  Group By Operator [GBY_40]
                  |  aggregations:["count(VALUE._col0)"]
                  |  keys:KEY._col0 (type: int), KEY._col1 (type: bigint)
                  |  outputColumnNames:["_col0","_col1","_col2"]
                  |  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 5 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_39]
                        key expressions:_col0 (type: int), _col1 (type: bigint)
                        Map-reduce partition columns:_col0 (type: int), _col1 (type: bigint)
                        sort order:++
                        Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col2 (type: bigint)
                        Group By Operator [GBY_38]
                           aggregations:["count()"]
                           keys:_col0 (type: int), _col1 (type: bigint)
                           outputColumnNames:["_col0","_col1","_col2"]
                           Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_34]
                              outputColumnNames:["_col0","_col1"]
                              Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                              Filter Operator [FIL_48]
                                 predicate:((((_col6 > 0) and ((_col6 >= 1) or (_col2 >= 1))) and ((UDFToLong(_col6) + _col2) >= 0)) and ((_col1 > 0) or (_col6 >= 0))) (type: boolean)
                                 Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                                 Merge Join Operator [MERGEJOIN_53]
                                 |  condition map:[{"":"Left Outer Join0 to 1"}]
                                 |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                 |  outputColumnNames:["_col1","_col2","_col6"]
                                 |  Statistics:Num rows: 4 Data size: 64 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Map 10 [SIMPLE_EDGE]
                                 |  Reduce Output Operator [RS_31]
                                 |     key expressions:_col0 (type: string)
                                 |     Map-reduce partition columns:_col0 (type: string)
                                 |     sort order:+
                                 |     Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                                 |     value expressions:_col1 (type: int)
                                 |     Select Operator [SEL_29]
                                 |        outputColumnNames:["_col0","_col1"]
                                 |        Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                                 |        TableScan [TS_28]
                                 |           alias:cbo_t3
                                 |           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Reducer 4 [SIMPLE_EDGE]
                                    Reduce Output Operator [RS_30]
                                       key expressions:_col0 (type: string)
                                       Map-reduce partition columns:_col0 (type: string)
                                       sort order:+
                                       Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                       value expressions:_col1 (type: int), _col2 (type: bigint)
                                       Select Operator [SEL_27]
                                          outputColumnNames:["_col0","_col1","_col2"]
                                          Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                          Filter Operator [FIL_26]
                                             predicate:((_col1 + _col4) >= 0) (type: boolean)
                                             Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             Merge Join Operator [MERGEJOIN_52]
                                             |  condition map:[{"":"Left Outer Join0 to 1"}]
                                             |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                             |  outputColumnNames:["_col0","_col1","_col2","_col4"]
                                             |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             |<-Reducer 3 [SIMPLE_EDGE]
                                             |  Reduce Output Operator [RS_23]
                                             |     key expressions:_col0 (type: string)
                                             |     Map-reduce partition columns:_col0 (type: string)
                                             |     sort order:+
                                             |     Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                             |     value expressions:_col1 (type: int), _col2 (type: bigint)
                                             |     Select Operator [SEL_11]
                                             |     |  outputColumnNames:["_col0","_col1","_col2"]
                                             |     |  Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                             |     |<-Reducer 2 [SIMPLE_EDGE]
                                             |        Reduce Output Operator [RS_10]
                                             |           key expressions:_col3 (type: bigint), _col1 (type: int)
                                             |           sort order:+-
                                             |           Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                                             |           value expressions:_col0 (type: string), _col2 (type: bigint)
                                             |           Select Operator [SEL_9]
                                             |              outputColumnNames:["_col0","_col1","_col2","_col3"]
                                             |              Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                                             |              Group By Operator [GBY_8]
                                             |              |  aggregations:["sum(VALUE._col0)"]
                                             |              |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                             |              |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                                             |              |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             |              |<-Map 1 [SIMPLE_EDGE]
                                             |                 Reduce Output Operator [RS_7]
                                             |                    key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                             |                    Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                             |                    sort order:+++
                                             |                    Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             |                    value expressions:_col3 (type: bigint)
                                             |                    Group By Operator [GBY_6]
                                             |                       aggregations:["sum(_col1)"]
                                             |                       keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                             |                       outputColumnNames:["_col0","_col1","_col2","_col3"]
                                             |                       Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             |                       Select Operator [SEL_2]
                                             |                          outputColumnNames:["_col0","_col1","_col2"]
                                             |                          Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                             |                          Filter Operator [FIL_49]
                                             |                             predicate:((((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and (c_float > 0.0)) and ((c_int >= 1) or (c_float >= 1.0))) and ((UDFToFloat(c_int) + c_float) >= 0.0)) (type: boolean)
                                             |                             Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                             |                             TableScan [TS_0]
                                             |                                alias:cbo_t1
                                             |                                Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                             |<-Reducer 9 [SIMPLE_EDGE]
                                                Reduce Output Operator [RS_24]
                                                   key expressions:_col0 (type: string)
                                                   Map-reduce partition columns:_col0 (type: string)
                                                   sort order:+
                                                   Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                                   value expressions:_col1 (type: int)
                                                   Select Operator [SEL_22]
                                                      outputColumnNames:["_col0","_col1"]
                                                      Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                                      Group By Operator [GBY_21]
                                                      |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                                      |  outputColumnNames:["_col0","_col1","_col2"]
                                                      |  Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                      |<-Map 8 [SIMPLE_EDGE]
                                                         Reduce Output Operator [RS_20]
                                                            key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                            Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                            sort order:+++
                                                            Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                            Group By Operator [GBY_19]
                                                               keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                               outputColumnNames:["_col0","_col1","_col2"]
                                                               Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                               Select Operator [SEL_15]
                                                                  outputColumnNames:["_col0","_col1","_col2"]
                                                                  Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                                  Filter Operator [FIL_50]
                                                                     predicate:((((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and (c_float > 0.0)) and ((c_int >= 1) or (c_float >= 1.0))) and ((UDFToFloat(c_int) + c_float) >= 0.0)) (type: boolean)
                                                                     Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                                     TableScan [TS_13]
                                                                        alias:cbo_t2
                                                                        Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by b+c, a desc) cbo_t1 right outer join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t2 on cbo_t1.a=p right outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 2) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by b+c, a desc) cbo_t1 right outer join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t2 on cbo_t1.a=p right outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 2) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Map 8 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
Reducer 7 <- Map 6 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 5
         File Output Operator [FS_36]
            compressed:false
            Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_34]
            |  aggregations:["count(VALUE._col0)"]
            |  keys:KEY._col0 (type: int), KEY._col1 (type: bigint)
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 4 [SIMPLE_EDGE]
               Reduce Output Operator [RS_33]
                  key expressions:_col0 (type: int), _col1 (type: bigint)
                  Map-reduce partition columns:_col0 (type: int), _col1 (type: bigint)
                  sort order:++
                  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col2 (type: bigint)
                  Group By Operator [GBY_32]
                     aggregations:["count()"]
                     keys:_col0 (type: int), _col1 (type: bigint)
                     outputColumnNames:["_col0","_col1","_col2"]
                     Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_30]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator [FIL_29]
                           predicate:(((_col1 + _col4) >= 2) and ((_col1 > 0) or (_col6 >= 0))) (type: boolean)
                           Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                           Merge Join Operator [MERGEJOIN_41]
                           |  condition map:[{"":"Right Outer Join0 to 1"},{"":"Right Outer Join0 to 2"}]
                           |  keys:{"2":"_col0 (type: string)","1":"_col0 (type: string)","0":"_col0 (type: string)"}
                           |  outputColumnNames:["_col1","_col2","_col4","_col6"]
                           |  Statistics:Num rows: 4 Data size: 80 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 8 [SIMPLE_EDGE]
                           |  Reduce Output Operator [RS_27]
                           |     key expressions:_col0 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:+
                           |     Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                           |     value expressions:_col1 (type: int)
                           |     Select Operator [SEL_24]
                           |        outputColumnNames:["_col0","_col1"]
                           |        Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                           |        TableScan [TS_23]
                           |           alias:cbo_t3
                           |           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 3 [SIMPLE_EDGE]
                           |  Reduce Output Operator [RS_25]
                           |     key expressions:_col0 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:+
                           |     Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                           |     value expressions:_col1 (type: int), _col2 (type: bigint)
                           |     Select Operator [SEL_11]
                           |     |  outputColumnNames:["_col0","_col1","_col2"]
                           |     |  Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                           |     |<-Reducer 2 [SIMPLE_EDGE]
                           |        Reduce Output Operator [RS_10]
                           |           key expressions:_col3 (type: bigint), _col0 (type: string)
                           |           sort order:+-
                           |           Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                           |           value expressions:_col1 (type: int), _col2 (type: bigint)
                           |           Select Operator [SEL_9]
                           |              outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |              Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                           |              Group By Operator [GBY_8]
                           |              |  aggregations:["sum(VALUE._col0)"]
                           |              |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                           |              |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |              |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                           |              |<-Map 1 [SIMPLE_EDGE]
                           |                 Reduce Output Operator [RS_7]
                           |                    key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                           |                    Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                           |                    sort order:+++
                           |                    Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                           |                    value expressions:_col3 (type: bigint)
                           |                    Group By Operator [GBY_6]
                           |                       aggregations:["sum(_col1)"]
                           |                       keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                           |                       outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |                       Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                           |                       Select Operator [SEL_2]
                           |                          outputColumnNames:["_col0","_col1","_col2"]
                           |                          Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                           |                          Filter Operator [FIL_39]
                           |                             predicate:((((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and (c_float > 0.0)) and ((c_int >= 1) or (c_float >= 1.0))) and ((UDFToFloat(c_int) + c_float) >= 0.0)) (type: boolean)
                           |                             Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                           |                             TableScan [TS_0]
                           |                                alias:cbo_t1
                           |                                Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 7 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_26]
                                 key expressions:_col0 (type: string)
                                 Map-reduce partition columns:_col0 (type: string)
                                 sort order:+
                                 Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:_col1 (type: int)
                                 Select Operator [SEL_22]
                                    outputColumnNames:["_col0","_col1"]
                                    Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                    Group By Operator [GBY_21]
                                    |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                    |  outputColumnNames:["_col0","_col1","_col2"]
                                    |  Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 6 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_20]
                                          key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                          Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                          sort order:+++
                                          Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                          Group By Operator [GBY_19]
                                             keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                             outputColumnNames:["_col0","_col1","_col2"]
                                             Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                             Select Operator [SEL_15]
                                                outputColumnNames:["_col0","_col1","_col2"]
                                                Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                Filter Operator [FIL_40]
                                                   predicate:((((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and (c_float > 0.0)) and ((c_int >= 1) or (c_float >= 1.0))) and ((UDFToFloat(c_int) + c_float) >= 0.0)) (type: boolean)
                                                   Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                   TableScan [TS_13]
                                                      alias:cbo_t2
                                                      Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by c+a desc) cbo_t1 full outer join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by p+q desc, r asc) cbo_t2 on cbo_t1.a=p full outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c having cbo_t3.c_int > 0 and (c_int >=1 or c >= 1) and (c_int + c) >= 0 order by cbo_t3.c_int
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by c+a desc) cbo_t1 full outer join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by p+q desc, r asc) cbo_t2 on cbo_t1.a=p full outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c having cbo_t3.c_int > 0 and (c_int >=1 or c >= 1) and (c_int + c) >= 0 order by cbo_t3.c_int
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Map 10 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
Reducer 9 <- Reducer 8 (SIMPLE_EDGE)
Reducer 8 <- Map 7 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 6
         File Output Operator [FS_43]
            compressed:false
            Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_42]
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 5 [SIMPLE_EDGE]
               Reduce Output Operator [RS_41]
                  key expressions:_col0 (type: int)
                  sort order:+
                  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col1 (type: bigint), _col2 (type: bigint)
                  Group By Operator [GBY_39]
                  |  aggregations:["count(VALUE._col0)"]
                  |  keys:KEY._col0 (type: int), KEY._col1 (type: bigint)
                  |  outputColumnNames:["_col0","_col1","_col2"]
                  |  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 4 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_38]
                        key expressions:_col0 (type: int), _col1 (type: bigint)
                        Map-reduce partition columns:_col0 (type: int), _col1 (type: bigint)
                        sort order:++
                        Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col2 (type: bigint)
                        Group By Operator [GBY_37]
                           aggregations:["count()"]
                           keys:_col0 (type: int), _col1 (type: bigint)
                           outputColumnNames:["_col0","_col1","_col2"]
                           Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_33]
                              outputColumnNames:["_col0","_col1"]
                              Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                              Filter Operator [FIL_45]
                                 predicate:(((((_col6 > 0) and ((_col6 >= 1) or (_col2 >= 1))) and ((UDFToLong(_col6) + _col2) >= 0)) and ((_col1 + _col4) >= 0)) and ((_col1 > 0) or (_col6 >= 0))) (type: boolean)
                                 Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                                 Merge Join Operator [MERGEJOIN_48]
                                 |  condition map:[{"":"Outer Join 0 to 1"},{"":"Outer Join 0 to 2"}]
                                 |  keys:{"2":"_col0 (type: string)","1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                 |  outputColumnNames:["_col1","_col2","_col4","_col6"]
                                 |  Statistics:Num rows: 4 Data size: 80 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Map 10 [SIMPLE_EDGE]
                                 |  Reduce Output Operator [RS_30]
                                 |     key expressions:_col0 (type: string)
                                 |     Map-reduce partition columns:_col0 (type: string)
                                 |     sort order:+
                                 |     Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                                 |     value expressions:_col1 (type: int)
                                 |     Select Operator [SEL_27]
                                 |        outputColumnNames:["_col0","_col1"]
                                 |        Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                                 |        TableScan [TS_26]
                                 |           alias:cbo_t3
                                 |           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Reducer 3 [SIMPLE_EDGE]
                                 |  Reduce Output Operator [RS_28]
                                 |     key expressions:_col0 (type: string)
                                 |     Map-reduce partition columns:_col0 (type: string)
                                 |     sort order:+
                                 |     Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                 |     value expressions:_col1 (type: int), _col2 (type: bigint)
                                 |     Select Operator [SEL_11]
                                 |     |  outputColumnNames:["_col0","_col1","_col2"]
                                 |     |  Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                 |     |<-Reducer 2 [SIMPLE_EDGE]
                                 |        Reduce Output Operator [RS_10]
                                 |           key expressions:_col3 (type: double)
                                 |           sort order:-
                                 |           Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                                 |           value expressions:_col0 (type: string), _col1 (type: int), _col2 (type: bigint)
                                 |           Select Operator [SEL_9]
                                 |              outputColumnNames:["_col0","_col1","_col2","_col3"]
                                 |              Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                                 |              Group By Operator [GBY_8]
                                 |              |  aggregations:["sum(VALUE._col0)"]
                                 |              |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                 |              |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                                 |              |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                 |              |<-Map 1 [SIMPLE_EDGE]
                                 |                 Reduce Output Operator [RS_7]
                                 |                    key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                 |                    Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                 |                    sort order:+++
                                 |                    Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                 |                    value expressions:_col3 (type: bigint)
                                 |                    Group By Operator [GBY_6]
                                 |                       aggregations:["sum(_col1)"]
                                 |                       keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                 |                       outputColumnNames:["_col0","_col1","_col2","_col3"]
                                 |                       Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                 |                       Select Operator [SEL_2]
                                 |                          outputColumnNames:["_col0","_col1","_col2"]
                                 |                          Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                 |                          Filter Operator [FIL_46]
                                 |                             predicate:((((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and (c_float > 0.0)) and ((c_int >= 1) or (c_float >= 1.0))) and ((UDFToFloat(c_int) + c_float) >= 0.0)) (type: boolean)
                                 |                             Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                 |                             TableScan [TS_0]
                                 |                                alias:cbo_t1
                                 |                                Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Reducer 9 [SIMPLE_EDGE]
                                    Reduce Output Operator [RS_29]
                                       key expressions:_col0 (type: string)
                                       Map-reduce partition columns:_col0 (type: string)
                                       sort order:+
                                       Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                       value expressions:_col1 (type: int)
                                       Select Operator [SEL_24]
                                       |  outputColumnNames:["_col0","_col1"]
                                       |  Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                       |<-Reducer 8 [SIMPLE_EDGE]
                                          Reduce Output Operator [RS_23]
                                             key expressions:_col3 (type: double), _col2 (type: bigint)
                                             sort order:-+
                                             Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                                             value expressions:_col0 (type: string), _col1 (type: int)
                                             Select Operator [SEL_22]
                                                outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                                                Group By Operator [GBY_21]
                                                |  aggregations:["sum(VALUE._col0)"]
                                                |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                                |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                |<-Map 7 [SIMPLE_EDGE]
                                                   Reduce Output Operator [RS_20]
                                                      key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                      Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                      sort order:+++
                                                      Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                      value expressions:_col3 (type: bigint)
                                                      Group By Operator [GBY_19]
                                                         aggregations:["sum(_col1)"]
                                                         keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                         outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                         Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                         Select Operator [SEL_15]
                                                            outputColumnNames:["_col0","_col1","_col2"]
                                                            Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                            Filter Operator [FIL_47]
                                                               predicate:((((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and (c_float > 0.0)) and ((c_int >= 1) or (c_float >= 1.0))) and ((UDFToFloat(c_int) + c_float) >= 0.0)) (type: boolean)
                                                               Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                               TableScan [TS_13]
                                                                  alias:cbo_t2
                                                                  Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Map 8 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
Reducer 7 <- Map 6 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 5
         File Output Operator [FS_41]
            compressed:false
            Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_39]
            |  aggregations:["count(VALUE._col0)"]
            |  keys:KEY._col0 (type: int), KEY._col1 (type: bigint)
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 4 [SIMPLE_EDGE]
               Reduce Output Operator [RS_38]
                  key expressions:_col0 (type: int), _col1 (type: bigint)
                  Map-reduce partition columns:_col0 (type: int), _col1 (type: bigint)
                  sort order:++
                  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col2 (type: bigint)
                  Group By Operator [GBY_37]
                     aggregations:["count()"]
                     keys:_col0 (type: int), _col1 (type: bigint)
                     outputColumnNames:["_col0","_col1","_col2"]
                     Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_35]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 2 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator [FIL_34]
                           predicate:((_col1 > 0) or (_col6 >= 0)) (type: boolean)
                           Statistics:Num rows: 2 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                           Merge Join Operator [MERGEJOIN_51]
                           |  condition map:[{"":"Inner Join 0 to 1"}]
                           |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                           |  outputColumnNames:["_col1","_col2","_col6"]
                           |  Statistics:Num rows: 3 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 8 [SIMPLE_EDGE]
                           |  Reduce Output Operator [RS_32]
                           |     key expressions:_col0 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:+
                           |     Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                           |     value expressions:_col1 (type: int)
                           |     Select Operator [SEL_28]
                           |        outputColumnNames:["_col0","_col1"]
                           |        Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                           |        Filter Operator [FIL_49]
                           |           predicate:key is not null (type: boolean)
                           |           Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                           |           TableScan [TS_27]
                           |              alias:cbo_t3
                           |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 3 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_30]
                                 key expressions:_col0 (type: string)
                                 Map-reduce partition columns:_col0 (type: string)
                                 sort order:+
                                 Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:_col1 (type: int), _col2 (type: bigint)
                                 Select Operator [SEL_26]
                                    outputColumnNames:["_col0","_col1","_col2"]
                                    Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                    Filter Operator [FIL_25]
                                       predicate:((_col1 + _col4) >= 0) (type: boolean)
                                       Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                       Merge Join Operator [MERGEJOIN_50]
                                       |  condition map:[{"":"Inner Join 0 to 1"}]
                                       |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                       |  outputColumnNames:["_col0","_col1","_col2","_col4"]
                                       |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                       |<-Reducer 2 [SIMPLE_EDGE]
                                       |  Reduce Output Operator [RS_21]
                                       |     key expressions:_col0 (type: string)
                                       |     Map-reduce partition columns:_col0 (type: string)
                                       |     sort order:+
                                       |     Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                       |     value expressions:_col1 (type: int), _col2 (type: bigint)
                                       |     Select Operator [SEL_9]
                                       |        outputColumnNames:["_col0","_col1","_col2"]
                                       |        Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                       |        Group By Operator [GBY_8]
                                       |        |  aggregations:["sum(VALUE._col0)"]
                                       |        |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                       |        |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                                       |        |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                       |        |<-Map 1 [SIMPLE_EDGE]
                                       |           Reduce Output Operator [RS_7]
                                       |              key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                       |              Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                       |              sort order:+++
                                       |              Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                       |              value expressions:_col3 (type: bigint)
                                       |              Group By Operator [GBY_6]
                                       |                 aggregations:["sum(_col1)"]
                                       |                 keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                       |                 outputColumnNames:["_col0","_col1","_col2","_col3"]
                                       |                 Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                       |                 Select Operator [SEL_2]
                                       |                    outputColumnNames:["_col0","_col1","_col2"]
                                       |                    Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                       |                    Filter Operator [FIL_47]
                                       |                       predicate:(((((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and (c_float > 0.0)) and ((c_int >= 1) or (c_float >= 1.0))) and ((UDFToFloat(c_int) + c_float) >= 0.0)) and key is not null) (type: boolean)
                                       |                       Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                       |                       TableScan [TS_0]
                                       |                          alias:cbo_t1
                                       |                          Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                       |<-Reducer 7 [SIMPLE_EDGE]
                                          Reduce Output Operator [RS_23]
                                             key expressions:_col0 (type: string)
                                             Map-reduce partition columns:_col0 (type: string)
                                             sort order:+
                                             Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                             value expressions:_col1 (type: int)
                                             Select Operator [SEL_19]
                                                outputColumnNames:["_col0","_col1"]
                                                Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                                Group By Operator [GBY_18]
                                                |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                                |  outputColumnNames:["_col0","_col1","_col2"]
                                                |  Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                |<-Map 6 [SIMPLE_EDGE]
                                                   Reduce Output Operator [RS_17]
                                                      key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                      Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                      sort order:+++
                                                      Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                      Group By Operator [GBY_16]
                                                         keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                         outputColumnNames:["_col0","_col1","_col2"]
                                                         Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                         Select Operator [SEL_12]
                                                            outputColumnNames:["_col0","_col1","_col2"]
                                                            Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                            Filter Operator [FIL_48]
                                                               predicate:(((((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and (c_float > 0.0)) and ((c_int >= 1) or (c_float >= 1.0))) and ((UDFToFloat(c_int) + c_float) >= 0.0)) and key is not null) (type: boolean)
                                                               Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                               TableScan [TS_10]
                                                                  alias:cbo_t2
                                                                  Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select unionsrc.key FROM (select 'tst1' as key, count(1) as value from src) unionsrc
PREHOOK: type: QUERY
POSTHOOK: query: explain select unionsrc.key FROM (select 'tst1' as key, count(1) as value from src) unionsrc
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_8]
            compressed:false
            Statistics:Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_6]
               outputColumnNames:["_col0"]
               Statistics:Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
               Group By Operator [GBY_5]
               |  aggregations:["count(VALUE._col0)"]
               |  outputColumnNames:["_col0"]
               |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 1 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_4]
                     sort order:
                     Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col0 (type: bigint)
                     Group By Operator [GBY_3]
                        aggregations:["count(1)"]
                        outputColumnNames:["_col0"]
                        Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator [SEL_1]
                           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                           TableScan [TS_0]
                              alias:src
                              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select unionsrc.key FROM (select 'max' as key, max(c_int) as value from cbo_t3 s1
	UNION  ALL
    	select 'min' as key,  min(c_int) as value from cbo_t3 s2
    UNION ALL
        select 'avg' as key,  avg(c_int) as value from cbo_t3 s3) unionsrc order by unionsrc.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select unionsrc.key FROM (select 'max' as key, max(c_int) as value from cbo_t3 s1
	UNION  ALL
    	select 'min' as key,  min(c_int) as value from cbo_t3 s2
    UNION ALL
        select 'avg' as key,  avg(c_int) as value from cbo_t3 s3) unionsrc order by unionsrc.key
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Reducer 6 <- Map 5 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 8 <- Map 7 (SIMPLE_EDGE), Union 3 (CONTAINS)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_29]
            compressed:false
            Statistics:Num rows: 3 Data size: 261 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_28]
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 3 Data size: 261 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Union 3 [SIMPLE_EDGE]
               |<-Reducer 2 [CONTAINS]
               |  Reduce Output Operator [RS_27]
               |     key expressions:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 3 Data size: 261 Basic stats: COMPLETE Column stats: COMPLETE
               |     Select Operator [SEL_6]
               |        outputColumnNames:["_col0"]
               |        Statistics:Num rows: 1 Data size: 87 Basic stats: COMPLETE Column stats: COMPLETE
               |        Group By Operator [GBY_5]
               |        |  aggregations:["count(VALUE._col0)"]
               |        |  outputColumnNames:["_col0"]
               |        |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
               |        |<-Map 1 [SIMPLE_EDGE]
               |           Reduce Output Operator [RS_4]
               |              sort order:
               |              Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
               |              value expressions:_col0 (type: bigint)
               |              Group By Operator [GBY_3]
               |                 aggregations:["count(_col0)"]
               |                 outputColumnNames:["_col0"]
               |                 Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
               |                 Select Operator [SEL_1]
               |                    outputColumnNames:["_col0"]
               |                    Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |                    TableScan [TS_0]
               |                       alias:s1
               |                       Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Reducer 6 [CONTAINS]
               |  Reduce Output Operator [RS_27]
               |     key expressions:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 3 Data size: 261 Basic stats: COMPLETE Column stats: COMPLETE
               |     Select Operator [SEL_14]
               |        outputColumnNames:["_col0"]
               |        Statistics:Num rows: 1 Data size: 87 Basic stats: COMPLETE Column stats: COMPLETE
               |        Group By Operator [GBY_13]
               |        |  aggregations:["count(VALUE._col0)"]
               |        |  outputColumnNames:["_col0"]
               |        |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
               |        |<-Map 5 [SIMPLE_EDGE]
               |           Reduce Output Operator [RS_12]
               |              sort order:
               |              Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
               |              value expressions:_col0 (type: bigint)
               |              Group By Operator [GBY_11]
               |                 aggregations:["count(_col0)"]
               |                 outputColumnNames:["_col0"]
               |                 Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
               |                 Select Operator [SEL_9]
               |                    outputColumnNames:["_col0"]
               |                    Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |                    TableScan [TS_8]
               |                       alias:s1
               |                       Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Reducer 8 [CONTAINS]
                  Reduce Output Operator [RS_27]
                     key expressions:_col0 (type: string)
                     sort order:+
                     Statistics:Num rows: 3 Data size: 261 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_24]
                        outputColumnNames:["_col0"]
                        Statistics:Num rows: 1 Data size: 87 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator [GBY_23]
                        |  aggregations:["count(VALUE._col0)"]
                        |  outputColumnNames:["_col0"]
                        |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Map 7 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_22]
                              sort order:
                              Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions:_col0 (type: bigint)
                              Group By Operator [GBY_21]
                                 aggregations:["count(_col0)"]
                                 outputColumnNames:["_col0"]
                                 Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_19]
                                    outputColumnNames:["_col0"]
                                    Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                    TableScan [TS_18]
                                       alias:s1
                                       Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select unionsrc.key, count(1) FROM (select 'max' as key, max(c_int) as value from cbo_t3 s1
    UNION  ALL
        select 'min' as key,  min(c_int) as value from cbo_t3 s2
    UNION ALL
        select 'avg' as key,  avg(c_int) as value from cbo_t3 s3) unionsrc group by unionsrc.key order by unionsrc.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select unionsrc.key, count(1) FROM (select 'max' as key, max(c_int) as value from cbo_t3 s1
    UNION  ALL
        select 'min' as key,  min(c_int) as value from cbo_t3 s2
    UNION ALL
        select 'avg' as key,  avg(c_int) as value from cbo_t3 s3) unionsrc group by unionsrc.key order by unionsrc.key
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Reducer 7 <- Map 6 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 9 <- Map 8 (SIMPLE_EDGE), Union 3 (CONTAINS)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 5
         File Output Operator [FS_34]
            compressed:false
            Statistics:Num rows: 1 Data size: 95 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_33]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 95 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 4 [SIMPLE_EDGE]
               Reduce Output Operator [RS_32]
                  key expressions:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 1 Data size: 95 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col1 (type: bigint)
                  Group By Operator [GBY_30]
                  |  aggregations:["count(VALUE._col0)"]
                  |  keys:KEY._col0 (type: string)
                  |  outputColumnNames:["_col0","_col1"]
                  |  Statistics:Num rows: 1 Data size: 95 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Union 3 [SIMPLE_EDGE]
                     |<-Reducer 2 [CONTAINS]
                     |  Reduce Output Operator [RS_29]
                     |     key expressions:_col0 (type: string)
                     |     Map-reduce partition columns:_col0 (type: string)
                     |     sort order:+
                     |     Statistics:Num rows: 1 Data size: 95 Basic stats: COMPLETE Column stats: COMPLETE
                     |     value expressions:_col1 (type: bigint)
                     |     Group By Operator [GBY_28]
                     |        aggregations:["count(1)"]
                     |        keys:_col0 (type: string)
                     |        outputColumnNames:["_col0","_col1"]
                     |        Statistics:Num rows: 1 Data size: 95 Basic stats: COMPLETE Column stats: COMPLETE
                     |        Select Operator [SEL_6]
                     |           outputColumnNames:["_col0"]
                     |           Statistics:Num rows: 1 Data size: 87 Basic stats: COMPLETE Column stats: COMPLETE
                     |           Group By Operator [GBY_5]
                     |           |  aggregations:["count(VALUE._col0)"]
                     |           |  outputColumnNames:["_col0"]
                     |           |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                     |           |<-Map 1 [SIMPLE_EDGE]
                     |              Reduce Output Operator [RS_4]
                     |                 sort order:
                     |                 Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                     |                 value expressions:_col0 (type: bigint)
                     |                 Group By Operator [GBY_3]
                     |                    aggregations:["count(_col0)"]
                     |                    outputColumnNames:["_col0"]
                     |                    Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                     |                    Select Operator [SEL_1]
                     |                       outputColumnNames:["_col0"]
                     |                       Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                     |                       TableScan [TS_0]
                     |                          alias:s1
                     |                          Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                     |<-Reducer 7 [CONTAINS]
                     |  Reduce Output Operator [RS_29]
                     |     key expressions:_col0 (type: string)
                     |     Map-reduce partition columns:_col0 (type: string)
                     |     sort order:+
                     |     Statistics:Num rows: 1 Data size: 95 Basic stats: COMPLETE Column stats: COMPLETE
                     |     value expressions:_col1 (type: bigint)
                     |     Group By Operator [GBY_28]
                     |        aggregations:["count(1)"]
                     |        keys:_col0 (type: string)
                     |        outputColumnNames:["_col0","_col1"]
                     |        Statistics:Num rows: 1 Data size: 95 Basic stats: COMPLETE Column stats: COMPLETE
                     |        Select Operator [SEL_14]
                     |           outputColumnNames:["_col0"]
                     |           Statistics:Num rows: 1 Data size: 87 Basic stats: COMPLETE Column stats: COMPLETE
                     |           Group By Operator [GBY_13]
                     |           |  aggregations:["count(VALUE._col0)"]
                     |           |  outputColumnNames:["_col0"]
                     |           |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                     |           |<-Map 6 [SIMPLE_EDGE]
                     |              Reduce Output Operator [RS_12]
                     |                 sort order:
                     |                 Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                     |                 value expressions:_col0 (type: bigint)
                     |                 Group By Operator [GBY_11]
                     |                    aggregations:["count(_col0)"]
                     |                    outputColumnNames:["_col0"]
                     |                    Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                     |                    Select Operator [SEL_9]
                     |                       outputColumnNames:["_col0"]
                     |                       Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                     |                       TableScan [TS_8]
                     |                          alias:s1
                     |                          Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                     |<-Reducer 9 [CONTAINS]
                        Reduce Output Operator [RS_29]
                           key expressions:_col0 (type: string)
                           Map-reduce partition columns:_col0 (type: string)
                           sort order:+
                           Statistics:Num rows: 1 Data size: 95 Basic stats: COMPLETE Column stats: COMPLETE
                           value expressions:_col1 (type: bigint)
                           Group By Operator [GBY_28]
                              aggregations:["count(1)"]
                              keys:_col0 (type: string)
                              outputColumnNames:["_col0","_col1"]
                              Statistics:Num rows: 1 Data size: 95 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator [SEL_24]
                                 outputColumnNames:["_col0"]
                                 Statistics:Num rows: 1 Data size: 87 Basic stats: COMPLETE Column stats: COMPLETE
                                 Group By Operator [GBY_23]
                                 |  aggregations:["count(VALUE._col0)"]
                                 |  outputColumnNames:["_col0"]
                                 |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Map 8 [SIMPLE_EDGE]
                                    Reduce Output Operator [RS_22]
                                       sort order:
                                       Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                       value expressions:_col0 (type: bigint)
                                       Group By Operator [GBY_21]
                                          aggregations:["count(_col0)"]
                                          outputColumnNames:["_col0"]
                                          Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                          Select Operator [SEL_19]
                                             outputColumnNames:["_col0"]
                                             Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                             TableScan [TS_18]
                                                alias:s1
                                                Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t1.key from cbo_t1 join cbo_t3 where cbo_t1.key=cbo_t3.key and cbo_t1.key >= 1
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t1.key from cbo_t1 join cbo_t3 where cbo_t1.key=cbo_t3.key and cbo_t1.key >= 1
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_12]
            compressed:false
            Statistics:Num rows: 18 Data size: 1530 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_17]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 18 Data size: 1530 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_7]
            |     key expressions:_col0 (type: string)
            |     Map-reduce partition columns:_col0 (type: string)
            |     sort order:+
            |     Statistics:Num rows: 6 Data size: 425 Basic stats: COMPLETE Column stats: COMPLETE
            |     Select Operator [SEL_2]
            |        outputColumnNames:["_col0"]
            |        Statistics:Num rows: 6 Data size: 425 Basic stats: COMPLETE Column stats: COMPLETE
            |        Filter Operator [FIL_15]
            |           predicate:(UDFToDouble(key) >= 1.0) (type: boolean)
            |           Statistics:Num rows: 6 Data size: 425 Basic stats: COMPLETE Column stats: COMPLETE
            |           TableScan [TS_0]
            |              alias:cbo_t1
            |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_9]
                  key expressions:_col0 (type: string)
                  Map-reduce partition columns:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 6 Data size: 425 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_5]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 6 Data size: 425 Basic stats: COMPLETE Column stats: COMPLETE
                     Filter Operator [FIL_16]
                        predicate:(UDFToDouble(key) >= 1.0) (type: boolean)
                        Statistics:Num rows: 6 Data size: 425 Basic stats: COMPLETE Column stats: COMPLETE
                        TableScan [TS_3]
                           alias:cbo_t3
                           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t1.c_int, cbo_t2.c_int from cbo_t1 left outer join  cbo_t2 on cbo_t1.key=cbo_t2.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t1.c_int, cbo_t2.c_int from cbo_t1 left outer join  cbo_t2 on cbo_t1.key=cbo_t2.key
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_8]
            compressed:false
            Statistics:Num rows: 100 Data size: 800 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_7]
               outputColumnNames:["_col0","_col1"]
               Statistics:Num rows: 100 Data size: 800 Basic stats: COMPLETE Column stats: COMPLETE
               Merge Join Operator [MERGEJOIN_11]
               |  condition map:[{"":"Left Outer Join0 to 1"}]
               |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
               |  outputColumnNames:["_col1","_col3"]
               |  Statistics:Num rows: 100 Data size: 800 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_4]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
               |     value expressions:_col1 (type: int)
               |     Select Operator [SEL_1]
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
               |        TableScan [TS_0]
               |           alias:cbo_t1
               |           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_5]
                     key expressions:_col0 (type: string)
                     Map-reduce partition columns:_col0 (type: string)
                     sort order:+
                     Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col1 (type: int)
                     Select Operator [SEL_3]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                        TableScan [TS_2]
                           alias:cbo_t2
                           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t1.c_int, cbo_t2.c_int from cbo_t1 full outer join  cbo_t2 on cbo_t1.key=cbo_t2.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t1.c_int, cbo_t2.c_int from cbo_t1 full outer join  cbo_t2 on cbo_t1.key=cbo_t2.key
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_8]
            compressed:false
            Statistics:Num rows: 100 Data size: 800 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_7]
               outputColumnNames:["_col0","_col1"]
               Statistics:Num rows: 100 Data size: 800 Basic stats: COMPLETE Column stats: COMPLETE
               Merge Join Operator [MERGEJOIN_9]
               |  condition map:[{"":"Outer Join 0 to 1"}]
               |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
               |  outputColumnNames:["_col1","_col3"]
               |  Statistics:Num rows: 100 Data size: 800 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_4]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
               |     value expressions:_col1 (type: int)
               |     Select Operator [SEL_1]
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
               |        TableScan [TS_0]
               |           alias:cbo_t1
               |           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_5]
                     key expressions:_col0 (type: string)
                     Map-reduce partition columns:_col0 (type: string)
                     sort order:+
                     Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col1 (type: int)
                     Select Operator [SEL_3]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                        TableScan [TS_2]
                           alias:cbo_t2
                           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select b, cbo_t1.c, cbo_t2.p, q, cbo_t3.c_int from (select key as a, c_int as b, cbo_t1.c_float as c from cbo_t1) cbo_t1 join (select cbo_t2.key as p, cbo_t2.c_int as q, c_float as r from cbo_t2) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key
PREHOOK: type: QUERY
POSTHOOK: query: explain select b, cbo_t1.c, cbo_t2.p, q, cbo_t3.c_int from (select key as a, c_int as b, cbo_t1.c_float as c from cbo_t1) cbo_t1 join (select cbo_t2.key as p, cbo_t2.c_int as q, c_float as r from cbo_t2) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_14]
            compressed:false
            Statistics:Num rows: 291 Data size: 29391 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_13]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4"]
               Statistics:Num rows: 291 Data size: 29391 Basic stats: COMPLETE Column stats: COMPLETE
               Merge Join Operator [MERGEJOIN_24]
               |  condition map:[{"":"Inner Join 0 to 1"},{"":"Inner Join 0 to 2"}]
               |  keys:{"2":"_col0 (type: string)","1":"_col0 (type: string)","0":"_col0 (type: string)"}
               |  outputColumnNames:["_col1","_col2","_col4","_col5","_col6"]
               |  Statistics:Num rows: 291 Data size: 29391 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_7]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 18 Data size: 1488 Basic stats: COMPLETE Column stats: COMPLETE
               |     value expressions:_col1 (type: int), _col2 (type: float)
               |     Select Operator [SEL_1]
               |        outputColumnNames:["_col0","_col1","_col2"]
               |        Statistics:Num rows: 18 Data size: 1488 Basic stats: COMPLETE Column stats: COMPLETE
               |        Filter Operator [FIL_21]
               |           predicate:key is not null (type: boolean)
               |           Statistics:Num rows: 18 Data size: 1488 Basic stats: COMPLETE Column stats: COMPLETE
               |           TableScan [TS_0]
               |              alias:cbo_t1
               |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 3 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_9]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
               |     value expressions:_col1 (type: int)
               |     Select Operator [SEL_3]
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
               |        Filter Operator [FIL_22]
               |           predicate:key is not null (type: boolean)
               |           Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
               |           TableScan [TS_2]
               |              alias:cbo_t3
               |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 4 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_11]
                     key expressions:_col0 (type: string)
                     Map-reduce partition columns:_col0 (type: string)
                     sort order:+
                     Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col1 (type: int)
                     Select Operator [SEL_5]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator [FIL_23]
                           predicate:key is not null (type: boolean)
                           Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                           TableScan [TS_4]
                              alias:cbo_t2
                              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select key, cbo_t1.c_int, cbo_t2.p, q from cbo_t1 join (select cbo_t2.key as p, cbo_t2.c_int as q, c_float as r from cbo_t2) cbo_t2 on cbo_t1.key=p join (select key as a, c_int as b, cbo_t3.c_float as c from cbo_t3)cbo_t3 on cbo_t1.key=a
PREHOOK: type: QUERY
POSTHOOK: query: explain select key, cbo_t1.c_int, cbo_t2.p, q from cbo_t1 join (select cbo_t2.key as p, cbo_t2.c_int as q, c_float as r from cbo_t2) cbo_t2 on cbo_t1.key=p join (select key as a, c_int as b, cbo_t3.c_float as c from cbo_t3)cbo_t3 on cbo_t1.key=a
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_14]
            compressed:false
            Statistics:Num rows: 291 Data size: 51798 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_13]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 291 Data size: 51798 Basic stats: COMPLETE Column stats: COMPLETE
               Merge Join Operator [MERGEJOIN_24]
               |  condition map:[{"":"Inner Join 0 to 1"},{"":"Inner Join 0 to 2"}]
               |  keys:{"2":"_col0 (type: string)","1":"_col0 (type: string)","0":"_col0 (type: string)"}
               |  outputColumnNames:["_col0","_col1","_col3","_col4"]
               |  Statistics:Num rows: 291 Data size: 51798 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_7]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
               |     value expressions:_col1 (type: int)
               |     Select Operator [SEL_1]
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
               |        Filter Operator [FIL_21]
               |           predicate:key is not null (type: boolean)
               |           Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
               |           TableScan [TS_0]
               |              alias:cbo_t1
               |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 3 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_9]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 18 Data size: 1360 Basic stats: COMPLETE Column stats: COMPLETE
               |     Select Operator [SEL_3]
               |        outputColumnNames:["_col0"]
               |        Statistics:Num rows: 18 Data size: 1360 Basic stats: COMPLETE Column stats: COMPLETE
               |        Filter Operator [FIL_22]
               |           predicate:key is not null (type: boolean)
               |           Statistics:Num rows: 18 Data size: 1360 Basic stats: COMPLETE Column stats: COMPLETE
               |           TableScan [TS_2]
               |              alias:cbo_t3
               |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 4 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_11]
                     key expressions:_col0 (type: string)
                     Map-reduce partition columns:_col0 (type: string)
                     sort order:+
                     Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col1 (type: int)
                     Select Operator [SEL_5]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator [FIL_23]
                           predicate:key is not null (type: boolean)
                           Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                           TableScan [TS_4]
                              alias:cbo_t2
                              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select * from (select q, b, cbo_t2.p, cbo_t1.c, cbo_t3.c_int from (select key as a, c_int as b, cbo_t1.c_float as c from cbo_t1  where (cbo_t1.c_int + 1 == 2) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)) cbo_t1 full outer join (select cbo_t2.key as p, cbo_t2.c_int as q, c_float as r from cbo_t2  where (cbo_t2.c_int + 1 == 2) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q == 2) and (b > 0 or c_int >= 0)) R where  (q + 1 = 2) and (R.b > 0 or c_int >= 0)
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from (select q, b, cbo_t2.p, cbo_t1.c, cbo_t3.c_int from (select key as a, c_int as b, cbo_t1.c_float as c from cbo_t1  where (cbo_t1.c_int + 1 == 2) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)) cbo_t1 full outer join (select cbo_t2.key as p, cbo_t2.c_int as q, c_float as r from cbo_t2  where (cbo_t2.c_int + 1 == 2) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q == 2) and (b > 0 or c_int >= 0)) R where  (q + 1 = 2) and (R.b > 0 or c_int >= 0)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
Reducer 3 <- Map 5 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_22]
            compressed:false
            Statistics:Num rows: 4 Data size: 404 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_19]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4"]
               Statistics:Num rows: 4 Data size: 404 Basic stats: COMPLETE Column stats: COMPLETE
               Filter Operator [FIL_18]
                  predicate:(((_col4 + 1) = 2) and ((_col1 > 0) or (_col6 >= 0))) (type: boolean)
                  Statistics:Num rows: 4 Data size: 404 Basic stats: COMPLETE Column stats: COMPLETE
                  Merge Join Operator [MERGEJOIN_32]
                  |  condition map:[{"":"Inner Join 0 to 1"}]
                  |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                  |  outputColumnNames:["_col1","_col2","_col3","_col4","_col6"]
                  |  Statistics:Num rows: 14 Data size: 1414 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 5 [SIMPLE_EDGE]
                  |  Reduce Output Operator [RS_16]
                  |     key expressions:_col0 (type: string)
                  |     Map-reduce partition columns:_col0 (type: string)
                  |     sort order:+
                  |     Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                  |     value expressions:_col1 (type: int)
                  |     Select Operator [SEL_12]
                  |        outputColumnNames:["_col0","_col1"]
                  |        Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                  |        Filter Operator [FIL_30]
                  |           predicate:key is not null (type: boolean)
                  |           Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                  |           TableScan [TS_11]
                  |              alias:cbo_t3
                  |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_14]
                        key expressions:_col0 (type: string)
                        Map-reduce partition columns:_col0 (type: string)
                        sort order:+
                        Statistics:Num rows: 4 Data size: 728 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col1 (type: int), _col2 (type: float), _col3 (type: string), _col4 (type: int)
                        Filter Operator [FIL_27]
                           predicate:((((_col1 + _col4) = 2) and _col0 is not null) and ((_col4 + 1) = 2)) (type: boolean)
                           Statistics:Num rows: 4 Data size: 728 Basic stats: COMPLETE Column stats: COMPLETE
                           Merge Join Operator [MERGEJOIN_31]
                           |  condition map:[{"":"Outer Join 0 to 1"}]
                           |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                           |  outputColumnNames:["_col0","_col1","_col2","_col3","_col4"]
                           |  Statistics:Num rows: 18 Data size: 3276 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                           |  Reduce Output Operator [RS_6]
                           |     key expressions:_col0 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:+
                           |     Statistics:Num rows: 6 Data size: 465 Basic stats: COMPLETE Column stats: COMPLETE
                           |     value expressions:_col1 (type: int), _col2 (type: float)
                           |     Select Operator [SEL_2]
                           |        outputColumnNames:["_col0","_col1","_col2"]
                           |        Statistics:Num rows: 6 Data size: 465 Basic stats: COMPLETE Column stats: COMPLETE
                           |        Filter Operator [FIL_28]
                           |           predicate:(((c_int + 1) = 2) and ((c_int > 0) or (c_float >= 0.0))) (type: boolean)
                           |           Statistics:Num rows: 6 Data size: 465 Basic stats: COMPLETE Column stats: COMPLETE
                           |           TableScan [TS_0]
                           |              alias:cbo_t1
                           |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 4 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_7]
                                 key expressions:_col0 (type: string)
                                 Map-reduce partition columns:_col0 (type: string)
                                 sort order:+
                                 Statistics:Num rows: 6 Data size: 445 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:_col1 (type: int)
                                 Select Operator [SEL_5]
                                    outputColumnNames:["_col0","_col1"]
                                    Statistics:Num rows: 6 Data size: 445 Basic stats: COMPLETE Column stats: COMPLETE
                                    Filter Operator [FIL_29]
                                       predicate:(((c_int + 1) = 2) and ((c_int > 0) or (c_float >= 0.0))) (type: boolean)
                                       Statistics:Num rows: 6 Data size: 465 Basic stats: COMPLETE Column stats: COMPLETE
                                       TableScan [TS_3]
                                          alias:cbo_t2
                                          Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select * from (select q, b, cbo_t2.p, cbo_t1.c, cbo_t3.c_int from (select key as a, c_int as b, cbo_t1.c_float as c from cbo_t1  where (cbo_t1.c_int + 1 == 2) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)) cbo_t1 right outer join (select cbo_t2.key as p, cbo_t2.c_int as q, c_float as r from cbo_t2  where (cbo_t2.c_int + 1 == 2) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)) cbo_t2 on cbo_t1.a=p right outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q == 2) and (b > 0 or c_int >= 0)) R where  (q + 1 = 2) and (R.b > 0 or c_int >= 0)
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from (select q, b, cbo_t2.p, cbo_t1.c, cbo_t3.c_int from (select key as a, c_int as b, cbo_t1.c_float as c from cbo_t1  where (cbo_t1.c_int + 1 == 2) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)) cbo_t1 right outer join (select cbo_t2.key as p, cbo_t2.c_int as q, c_float as r from cbo_t2  where (cbo_t2.c_int + 1 == 2) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)) cbo_t2 on cbo_t1.a=p right outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q == 2) and (b > 0 or c_int >= 0)) R where  (q + 1 = 2) and (R.b > 0 or c_int >= 0)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_16]
            compressed:false
            Statistics:Num rows: 12 Data size: 1212 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_13]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4"]
               Statistics:Num rows: 12 Data size: 1212 Basic stats: COMPLETE Column stats: COMPLETE
               Filter Operator [FIL_20]
                  predicate:((((_col4 + 1) = 2) and ((_col1 > 0) or (_col6 >= 0))) and ((_col1 + _col4) = 2)) (type: boolean)
                  Statistics:Num rows: 12 Data size: 1212 Basic stats: COMPLETE Column stats: COMPLETE
                  Merge Join Operator [MERGEJOIN_23]
                  |  condition map:[{"":"Right Outer Join0 to 1"},{"":"Right Outer Join0 to 2"}]
                  |  keys:{"2":"_col0 (type: string)","1":"_col0 (type: string)","0":"_col0 (type: string)"}
                  |  outputColumnNames:["_col1","_col2","_col3","_col4","_col6"]
                  |  Statistics:Num rows: 72 Data size: 7272 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 1 [SIMPLE_EDGE]
                  |  Reduce Output Operator [RS_8]
                  |     key expressions:_col0 (type: string)
                  |     Map-reduce partition columns:_col0 (type: string)
                  |     sort order:+
                  |     Statistics:Num rows: 6 Data size: 465 Basic stats: COMPLETE Column stats: COMPLETE
                  |     value expressions:_col1 (type: int), _col2 (type: float)
                  |     Select Operator [SEL_2]
                  |        outputColumnNames:["_col0","_col1","_col2"]
                  |        Statistics:Num rows: 6 Data size: 465 Basic stats: COMPLETE Column stats: COMPLETE
                  |        Filter Operator [FIL_21]
                  |           predicate:(((c_int + 1) = 2) and ((c_int > 0) or (c_float >= 0.0))) (type: boolean)
                  |           Statistics:Num rows: 6 Data size: 465 Basic stats: COMPLETE Column stats: COMPLETE
                  |           TableScan [TS_0]
                  |              alias:cbo_t1
                  |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 3 [SIMPLE_EDGE]
                  |  Reduce Output Operator [RS_9]
                  |     key expressions:_col0 (type: string)
                  |     Map-reduce partition columns:_col0 (type: string)
                  |     sort order:+
                  |     Statistics:Num rows: 6 Data size: 445 Basic stats: COMPLETE Column stats: COMPLETE
                  |     value expressions:_col1 (type: int)
                  |     Select Operator [SEL_5]
                  |        outputColumnNames:["_col0","_col1"]
                  |        Statistics:Num rows: 6 Data size: 445 Basic stats: COMPLETE Column stats: COMPLETE
                  |        Filter Operator [FIL_22]
                  |           predicate:(((c_int + 1) = 2) and ((c_int > 0) or (c_float >= 0.0))) (type: boolean)
                  |           Statistics:Num rows: 6 Data size: 465 Basic stats: COMPLETE Column stats: COMPLETE
                  |           TableScan [TS_3]
                  |              alias:cbo_t2
                  |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 4 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_10]
                        key expressions:_col0 (type: string)
                        Map-reduce partition columns:_col0 (type: string)
                        sort order:+
                        Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col1 (type: int)
                        Select Operator [SEL_7]
                           outputColumnNames:["_col0","_col1"]
                           Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                           TableScan [TS_6]
                              alias:cbo_t3
                              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key order by x limit 1
PREHOOK: type: QUERY
POSTHOOK: query: explain select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key order by x limit 1
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:1
      Stage-1
         Reducer 3
         File Output Operator [FS_10]
            compressed:false
            Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Limit [LIM_9]
               Number of rows:1
               Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
               Select Operator [SEL_8]
               |  outputColumnNames:["_col0","_col1","_col2"]
               |  Statistics:Num rows: 10 Data size: 885 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Reducer 2 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_7]
                     key expressions:_col1 (type: int)
                     sort order:+
                     Statistics:Num rows: 10 Data size: 885 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col0 (type: string), _col2 (type: bigint)
                     Select Operator [SEL_6]
                        outputColumnNames:["_col0","_col1","_col2"]
                        Statistics:Num rows: 10 Data size: 885 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator [GBY_5]
                        |  aggregations:["sum(VALUE._col0)"]
                        |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                        |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                        |  Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Map 1 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_4]
                              key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                              Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                              sort order:+++
                              Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions:_col3 (type: bigint)
                              Group By Operator [GBY_3]
                                 aggregations:["sum(_col1)"]
                                 keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                 outputColumnNames:["_col0","_col1","_col2","_col3"]
                                 Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_1]
                                    outputColumnNames:["_col0","_col1","_col2"]
                                    Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                    TableScan [TS_0]
                                       alias:cbo_t1
                                       Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select x, y, count(*) from (select key, (c_int+c_float+1+2) as x, sum(c_int) as y from cbo_t1 group by c_float, cbo_t1.c_int, key) R group by y, x order by x,y limit 1
PREHOOK: type: QUERY
POSTHOOK: query: explain select x, y, count(*) from (select key, (c_int+c_float+1+2) as x, sum(c_int) as y from cbo_t1 group by c_float, cbo_t1.c_int, key) R group by y, x order by x,y limit 1
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:1
      Stage-1
         Reducer 4
         File Output Operator [FS_15]
            compressed:false
            Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Limit [LIM_14]
               Number of rows:1
               Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
               Select Operator [SEL_13]
               |  outputColumnNames:["_col0","_col1","_col2"]
               |  Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Reducer 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_12]
                     key expressions:_col0 (type: float), _col1 (type: bigint)
                     sort order:++
                     Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col2 (type: bigint)
                     Select Operator [SEL_11]
                        outputColumnNames:["_col0","_col1","_col2"]
                        Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator [GBY_10]
                        |  aggregations:["count(VALUE._col0)"]
                        |  keys:KEY._col0 (type: bigint), KEY._col1 (type: float)
                        |  outputColumnNames:["_col0","_col1","_col2"]
                        |  Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Reducer 2 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_9]
                              key expressions:_col0 (type: bigint), _col1 (type: float)
                              Map-reduce partition columns:_col0 (type: bigint), _col1 (type: float)
                              sort order:++
                              Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions:_col2 (type: bigint)
                              Group By Operator [GBY_8]
                                 aggregations:["count()"]
                                 keys:_col0 (type: bigint), _col1 (type: float)
                                 outputColumnNames:["_col0","_col1","_col2"]
                                 Statistics:Num rows: 5 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_6]
                                    outputColumnNames:["_col0","_col1"]
                                    Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                                    Group By Operator [GBY_5]
                                    |  aggregations:["sum(VALUE._col0)"]
                                    |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                    |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                                    |  Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 1 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_4]
                                          key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                          Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                          sort order:+++
                                          Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                                          value expressions:_col3 (type: bigint)
                                          Group By Operator [GBY_3]
                                             aggregations:["sum(_col1)"]
                                             keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                             outputColumnNames:["_col0","_col1","_col2","_col3"]
                                             Statistics:Num rows: 10 Data size: 917 Basic stats: COMPLETE Column stats: COMPLETE
                                             Select Operator [SEL_1]
                                                outputColumnNames:["_col0","_col1","_col2"]
                                                Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                                TableScan [TS_0]
                                                   alias:cbo_t1
                                                   Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select key from(select key from (select key from cbo_t1 limit 5)cbo_t2  limit 5)cbo_t3  limit 5
PREHOOK: type: QUERY
POSTHOOK: query: explain select key from(select key from (select key from cbo_t1 limit 5)cbo_t2  limit 5)cbo_t3  limit 5
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:5
      Stage-1
         Reducer 3
         File Output Operator [FS_13]
            compressed:false
            Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Limit [LIM_12]
               Number of rows:5
               Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
               Limit [LIM_10]
                  Number of rows:5
                  Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_9]
                  |  outputColumnNames:["_col0"]
                  |  Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_8]
                        sort order:
                        Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col0 (type: string)
                        Limit [LIM_7]
                           Number of rows:5
                           Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                           Limit [LIM_5]
                              Number of rows:5
                              Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator [SEL_4]
                              |  outputColumnNames:["_col0"]
                              |  Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                              |<-Map 1 [SIMPLE_EDGE]
                                 Reduce Output Operator [RS_3]
                                    sort order:
                                    Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions:_col0 (type: string)
                                    Limit [LIM_2]
                                       Number of rows:5
                                       Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                                       Select Operator [SEL_1]
                                          outputColumnNames:["_col0"]
                                          Statistics:Num rows: 20 Data size: 1530 Basic stats: COMPLETE Column stats: COMPLETE
                                          TableScan [TS_0]
                                             alias:cbo_t1
                                             Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select key, c_int from(select key, c_int from (select key, c_int from cbo_t1 order by c_int limit 5)cbo_t1  order by c_int limit 5)cbo_t2  order by c_int limit 5
PREHOOK: type: QUERY
POSTHOOK: query: explain select key, c_int from(select key, c_int from (select key, c_int from cbo_t1 order by c_int limit 5)cbo_t1  order by c_int limit 5)cbo_t2  order by c_int limit 5
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:5
      Stage-1
         Reducer 4
         File Output Operator [FS_13]
            compressed:false
            Statistics:Num rows: 5 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Limit [LIM_12]
               Number of rows:5
               Statistics:Num rows: 5 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
               Select Operator [SEL_11]
               |  outputColumnNames:["_col0","_col1"]
               |  Statistics:Num rows: 5 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Reducer 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_10]
                     key expressions:_col1 (type: int)
                     sort order:+
                     Statistics:Num rows: 5 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col0 (type: string)
                     Limit [LIM_8]
                        Number of rows:5
                        Statistics:Num rows: 5 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator [SEL_7]
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 5 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Reducer 2 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_6]
                              key expressions:_col1 (type: int)
                              sort order:+
                              Statistics:Num rows: 5 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions:_col0 (type: string)
                              Limit [LIM_4]
                                 Number of rows:5
                                 Statistics:Num rows: 5 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_3]
                                 |  outputColumnNames:["_col0","_col1"]
                                 |  Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Map 1 [SIMPLE_EDGE]
                                    Reduce Output Operator [RS_2]
                                       key expressions:_col1 (type: int)
                                       sort order:+
                                       Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                                       value expressions:_col0 (type: string)
                                       Select Operator [SEL_1]
                                          outputColumnNames:["_col0","_col1"]
                                          Statistics:Num rows: 20 Data size: 1602 Basic stats: COMPLETE Column stats: COMPLETE
                                          TableScan [TS_0]
                                             alias:cbo_t1
                                             Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0) group by c_float, cbo_t1.c_int, key order by a limit 5) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key order by q/10 desc, r asc limit 5) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c order by cbo_t3.c_int+c desc, c limit 5
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0) group by c_float, cbo_t1.c_int, key order by a limit 5) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key order by q/10 desc, r asc limit 5) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c order by cbo_t3.c_int+c desc, c limit 5
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 10 <- Reducer 9 (SIMPLE_EDGE)
Reducer 5 <- Map 11 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Reducer 10 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
Reducer 7 <- Reducer 6 (SIMPLE_EDGE)
Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
Reducer 9 <- Map 8 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:5
      Stage-1
         Reducer 7
         File Output Operator [FS_48]
            compressed:false
            Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Limit [LIM_47]
               Number of rows:5
               Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
               Select Operator [SEL_46]
               |  outputColumnNames:["_col0","_col1","_col2"]
               |  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Reducer 6 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_45]
                     key expressions:(UDFToLong(_col0) + _col1) (type: bigint), _col1 (type: bigint)
                     sort order:-+
                     Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions:_col0 (type: int), _col2 (type: bigint)
                     Group By Operator [GBY_43]
                     |  aggregations:["count(VALUE._col0)"]
                     |  keys:KEY._col0 (type: int), KEY._col1 (type: bigint)
                     |  outputColumnNames:["_col0","_col1","_col2"]
                     |  Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                     |<-Reducer 5 [SIMPLE_EDGE]
                        Reduce Output Operator [RS_42]
                           key expressions:_col0 (type: int), _col1 (type: bigint)
                           Map-reduce partition columns:_col0 (type: int), _col1 (type: bigint)
                           sort order:++
                           Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                           value expressions:_col2 (type: bigint)
                           Group By Operator [GBY_41]
                              aggregations:["count()"]
                              keys:_col0 (type: int), _col1 (type: bigint)
                              outputColumnNames:["_col0","_col1","_col2"]
                              Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator [SEL_39]
                                 outputColumnNames:["_col0","_col1"]
                                 Statistics:Num rows: 2 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                                 Filter Operator [FIL_38]
                                    predicate:((_col1 > 0) or (_col6 >= 0)) (type: boolean)
                                    Statistics:Num rows: 2 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                                    Merge Join Operator [MERGEJOIN_60]
                                    |  condition map:[{"":"Inner Join 0 to 1"}]
                                    |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                    |  outputColumnNames:["_col1","_col2","_col6"]
                                    |  Statistics:Num rows: 3 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 11 [SIMPLE_EDGE]
                                    |  Reduce Output Operator [RS_36]
                                    |     key expressions:_col0 (type: string)
                                    |     Map-reduce partition columns:_col0 (type: string)
                                    |     sort order:+
                                    |     Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                                    |     value expressions:_col1 (type: int)
                                    |     Select Operator [SEL_32]
                                    |        outputColumnNames:["_col0","_col1"]
                                    |        Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                                    |        Filter Operator [FIL_58]
                                    |           predicate:key is not null (type: boolean)
                                    |           Statistics:Num rows: 18 Data size: 1424 Basic stats: COMPLETE Column stats: COMPLETE
                                    |           TableScan [TS_31]
                                    |              alias:cbo_t3
                                    |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Reducer 4 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_34]
                                          key expressions:_col0 (type: string)
                                          Map-reduce partition columns:_col0 (type: string)
                                          sort order:+
                                          Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                          value expressions:_col1 (type: int), _col2 (type: bigint)
                                          Select Operator [SEL_30]
                                             outputColumnNames:["_col0","_col1","_col2"]
                                             Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                             Filter Operator [FIL_29]
                                                predicate:((_col1 + _col4) >= 0) (type: boolean)
                                                Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                Merge Join Operator [MERGEJOIN_59]
                                                |  condition map:[{"":"Inner Join 0 to 1"}]
                                                |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                                |  outputColumnNames:["_col0","_col1","_col2","_col4"]
                                                |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                |<-Reducer 10 [SIMPLE_EDGE]
                                                |  Reduce Output Operator [RS_27]
                                                |     key expressions:_col0 (type: string)
                                                |     Map-reduce partition columns:_col0 (type: string)
                                                |     sort order:+
                                                |     Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                                |     value expressions:_col1 (type: int)
                                                |     Filter Operator [FIL_56]
                                                |        predicate:_col0 is not null (type: boolean)
                                                |        Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                                |        Limit [LIM_22]
                                                |           Number of rows:5
                                                |           Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                                |           Select Operator [SEL_21]
                                                |           |  outputColumnNames:["_col0","_col1"]
                                                |           |  Statistics:Num rows: 1 Data size: 89 Basic stats: COMPLETE Column stats: COMPLETE
                                                |           |<-Reducer 9 [SIMPLE_EDGE]
                                                |              Reduce Output Operator [RS_20]
                                                |                 key expressions:_col3 (type: double), _col2 (type: bigint)
                                                |                 sort order:-+
                                                |                 Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                                                |                 value expressions:_col0 (type: string), _col1 (type: int)
                                                |                 Select Operator [SEL_19]
                                                |                    outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                |                    Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                                                |                    Group By Operator [GBY_18]
                                                |                    |  aggregations:["sum(VALUE._col0)"]
                                                |                    |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                                |                    |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                |                    |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                |                    |<-Map 8 [SIMPLE_EDGE]
                                                |                       Reduce Output Operator [RS_17]
                                                |                          key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                |                          Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                |                          sort order:+++
                                                |                          Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                |                          value expressions:_col3 (type: bigint)
                                                |                          Group By Operator [GBY_16]
                                                |                             aggregations:["sum(_col1)"]
                                                |                             keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                |                             outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                |                             Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                |                             Select Operator [SEL_14]
                                                |                                outputColumnNames:["_col0","_col1","_col2"]
                                                |                                Statistics:Num rows: 4 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                                                |                                Filter Operator [FIL_57]
                                                |                                   predicate:(((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) (type: boolean)
                                                |                                   Statistics:Num rows: 4 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                                                |                                   TableScan [TS_12]
                                                |                                      alias:cbo_t2
                                                |                                      Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                                                |<-Reducer 3 [SIMPLE_EDGE]
                                                   Reduce Output Operator [RS_25]
                                                      key expressions:_col0 (type: string)
                                                      Map-reduce partition columns:_col0 (type: string)
                                                      sort order:+
                                                      Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                                      value expressions:_col1 (type: int), _col2 (type: bigint)
                                                      Filter Operator [FIL_54]
                                                         predicate:_col0 is not null (type: boolean)
                                                         Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                                         Limit [LIM_10]
                                                            Number of rows:5
                                                            Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                                            Select Operator [SEL_9]
                                                            |  outputColumnNames:["_col0","_col1","_col2"]
                                                            |  Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                                            |<-Reducer 2 [SIMPLE_EDGE]
                                                               Reduce Output Operator [RS_8]
                                                                  key expressions:_col0 (type: string)
                                                                  sort order:+
                                                                  Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                                                  value expressions:_col1 (type: int), _col2 (type: bigint)
                                                                  Select Operator [SEL_7]
                                                                     outputColumnNames:["_col0","_col1","_col2"]
                                                                     Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                                                                     Group By Operator [GBY_6]
                                                                     |  aggregations:["sum(VALUE._col0)"]
                                                                     |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                                                     |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                                     |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                                     |<-Map 1 [SIMPLE_EDGE]
                                                                        Reduce Output Operator [RS_5]
                                                                           key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                                           Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                                           sort order:+++
                                                                           Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                                           value expressions:_col3 (type: bigint)
                                                                           Group By Operator [GBY_4]
                                                                              aggregations:["sum(_col1)"]
                                                                              keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                                              outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                                              Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                                              Select Operator [SEL_2]
                                                                                 outputColumnNames:["_col0","_col1","_col2"]
                                                                                 Statistics:Num rows: 4 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                                                                                 Filter Operator [FIL_55]
                                                                                    predicate:(((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) (type: boolean)
                                                                                    Statistics:Num rows: 4 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                                                                                    TableScan [TS_0]
                                                                                       alias:cbo_t1
                                                                                       Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t1.c_int           from cbo_t1 left semi join   cbo_t2 on cbo_t1.key=cbo_t2.key where (cbo_t1.c_int + 1 == 2) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t1.c_int           from cbo_t1 left semi join   cbo_t2 on cbo_t1.key=cbo_t2.key where (cbo_t1.c_int + 1 == 2) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_13]
            compressed:false
            Statistics:Num rows: 6 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_12]
               outputColumnNames:["_col0"]
               Statistics:Num rows: 6 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
               Merge Join Operator [MERGEJOIN_18]
               |  condition map:[{"":"Left Semi Join 0 to 1"}]
               |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
               |  outputColumnNames:["_col1"]
               |  Statistics:Num rows: 6 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_8]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 5 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
               |     value expressions:_col1 (type: int)
               |     Select Operator [SEL_2]
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 5 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
               |        Filter Operator [FIL_16]
               |           predicate:((((c_int + 1) = 2) and ((c_int > 0) or (c_float >= 0.0))) and key is not null) (type: boolean)
               |           Statistics:Num rows: 5 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
               |           TableScan [TS_0]
               |              alias:cbo_t1
               |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_10]
                     key expressions:_col0 (type: string)
                     Map-reduce partition columns:_col0 (type: string)
                     sort order:+
                     Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator [GBY_6]
                        keys:_col0 (type: string)
                        outputColumnNames:["_col0"]
                        Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator [SEL_4]
                           outputColumnNames:["_col0"]
                           Statistics:Num rows: 18 Data size: 1360 Basic stats: COMPLETE Column stats: COMPLETE
                           Filter Operator [FIL_17]
                              predicate:key is not null (type: boolean)
                              Statistics:Num rows: 18 Data size: 1360 Basic stats: COMPLETE Column stats: COMPLETE
                              TableScan [TS_3]
                                 alias:cbo_t2
                                 Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select * from (select c, b, a from (select key as a, c_int as b, cbo_t1.c_float as c from cbo_t1  where (cbo_t1.c_int + 1 == 2) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)) cbo_t1 left semi join (select cbo_t2.key as p, cbo_t2.c_int as q, c_float as r from cbo_t2  where (cbo_t2.c_int + 1 == 2) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)) cbo_t2 on cbo_t1.a=p left semi join cbo_t3 on cbo_t1.a=key where (b + 1 == 2) and (b > 0 or c >= 0)) R where  (b + 1 = 2) and (R.b > 0 or c >= 0)
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from (select c, b, a from (select key as a, c_int as b, cbo_t1.c_float as c from cbo_t1  where (cbo_t1.c_int + 1 == 2) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)) cbo_t1 left semi join (select cbo_t2.key as p, cbo_t2.c_int as q, c_float as r from cbo_t2  where (cbo_t2.c_int + 1 == 2) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)) cbo_t2 on cbo_t1.a=p left semi join cbo_t3 on cbo_t1.a=key where (b + 1 == 2) and (b > 0 or c >= 0)) R where  (b + 1 = 2) and (R.b > 0 or c >= 0)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_24]
            compressed:false
            Statistics:Num rows: 12 Data size: 1116 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_23]
               outputColumnNames:["_col0","_col1","_col2"]
               Statistics:Num rows: 12 Data size: 1116 Basic stats: COMPLETE Column stats: COMPLETE
               Merge Join Operator [MERGEJOIN_34]
               |  condition map:[{"":"Left Semi Join 0 to 1"},{"":"Left Semi Join 0 to 2"}]
               |  keys:{"2":"_col0 (type: string)","1":"_col0 (type: string)","0":"_col0 (type: string)"}
               |  outputColumnNames:["_col0","_col1","_col2"]
               |  Statistics:Num rows: 12 Data size: 1116 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_17]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 5 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
               |     value expressions:_col1 (type: int), _col2 (type: float)
               |     Select Operator [SEL_2]
               |        outputColumnNames:["_col0","_col1","_col2"]
               |        Statistics:Num rows: 5 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
               |        Filter Operator [FIL_31]
               |           predicate:((((c_int + 1) = 2) and ((c_int > 0) or (c_float >= 0.0))) and key is not null) (type: boolean)
               |           Statistics:Num rows: 5 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
               |           TableScan [TS_0]
               |              alias:cbo_t1
               |              Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 3 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_19]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 2 Data size: 170 Basic stats: COMPLETE Column stats: COMPLETE
               |     Group By Operator [GBY_13]
               |        keys:_col0 (type: string)
               |        outputColumnNames:["_col0"]
               |        Statistics:Num rows: 2 Data size: 170 Basic stats: COMPLETE Column stats: COMPLETE
               |        Select Operator [SEL_9]
               |           outputColumnNames:["_col0"]
               |           Statistics:Num rows: 5 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
               |           Filter Operator [FIL_32]
               |              predicate:((((c_int + 1) = 2) and ((c_int > 0) or (c_float >= 0.0))) and key is not null) (type: boolean)
               |              Statistics:Num rows: 5 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
               |              TableScan [TS_7]
               |                 alias:cbo_t2
               |                 Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Map 4 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_21]
                     key expressions:_col0 (type: string)
                     Map-reduce partition columns:_col0 (type: string)
                     sort order:+
                     Statistics:Num rows: 6 Data size: 425 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator [GBY_15]
                        keys:_col0 (type: string)
                        outputColumnNames:["_col0"]
                        Statistics:Num rows: 6 Data size: 425 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator [SEL_11]
                           outputColumnNames:["_col0"]
                           Statistics:Num rows: 18 Data size: 1360 Basic stats: COMPLETE Column stats: COMPLETE
                           Filter Operator [FIL_33]
                              predicate:key is not null (type: boolean)
                              Statistics:Num rows: 18 Data size: 1360 Basic stats: COMPLETE Column stats: COMPLETE
                              TableScan [TS_10]
                                 alias:cbo_t3
                                 Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select a, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by a+b desc, c asc) cbo_t1 left semi join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by q+r/10 desc, p) cbo_t2 on cbo_t1.a=p left semi join cbo_t3 on cbo_t1.a=key where (b + 1  >= 0) and (b > 0 or a >= 0) group by a, c  having a > 0 and (a >=1 or c >= 1) and (a + c) >= 0 order by c, a
PREHOOK: type: QUERY
POSTHOOK: query: explain select a, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by a+b desc, c asc) cbo_t1 left semi join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by q+r/10 desc, p) cbo_t2 on cbo_t1.a=p left semi join cbo_t3 on cbo_t1.a=key where (b + 1  >= 0) and (b > 0 or a >= 0) group by a, c  having a > 0 and (a >=1 or c >= 1) and (a + c) >= 0 order by c, a
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Map 10 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
Reducer 9 <- Reducer 8 (SIMPLE_EDGE)
Reducer 8 <- Map 7 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 6
         File Output Operator [FS_50]
            compressed:false
            Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_49]
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 5 [SIMPLE_EDGE]
               Reduce Output Operator [RS_48]
                  key expressions:_col1 (type: bigint), _col0 (type: string)
                  sort order:++
                  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col2 (type: bigint)
                  Group By Operator [GBY_46]
                  |  aggregations:["count(VALUE._col0)"]
                  |  keys:KEY._col0 (type: string), KEY._col1 (type: bigint)
                  |  outputColumnNames:["_col0","_col1","_col2"]
                  |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 4 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_45]
                        key expressions:_col0 (type: string), _col1 (type: bigint)
                        Map-reduce partition columns:_col0 (type: string), _col1 (type: bigint)
                        sort order:++
                        Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col2 (type: bigint)
                        Group By Operator [GBY_44]
                           aggregations:["count()"]
                           keys:_col0 (type: string), _col1 (type: bigint)
                           outputColumnNames:["_col0","_col1","_col2"]
                           Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                           Merge Join Operator [MERGEJOIN_63]
                           |  condition map:[{"":"Left Semi Join 0 to 1"},{"":"Left Semi Join 0 to 2"}]
                           |  keys:{"2":"_col0 (type: string)","1":"_col0 (type: string)","0":"_col0 (type: string)"}
                           |  outputColumnNames:["_col0","_col1"]
                           |  Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 10 [SIMPLE_EDGE]
                           |  Reduce Output Operator [RS_41]
                           |     key expressions:_col0 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:+
                           |     Statistics:Num rows: 6 Data size: 425 Basic stats: COMPLETE Column stats: COMPLETE
                           |     Group By Operator [GBY_35]
                           |        keys:_col0 (type: string)
                           |        outputColumnNames:["_col0"]
                           |        Statistics:Num rows: 6 Data size: 425 Basic stats: COMPLETE Column stats: COMPLETE
                           |        Select Operator [SEL_31]
                           |           outputColumnNames:["_col0"]
                           |           Statistics:Num rows: 18 Data size: 1360 Basic stats: COMPLETE Column stats: COMPLETE
                           |           Filter Operator [FIL_61]
                           |              predicate:key is not null (type: boolean)
                           |              Statistics:Num rows: 18 Data size: 1360 Basic stats: COMPLETE Column stats: COMPLETE
                           |              TableScan [TS_30]
                           |                 alias:cbo_t3
                           |                 Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 3 [SIMPLE_EDGE]
                           |  Reduce Output Operator [RS_37]
                           |     key expressions:_col0 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:+
                           |     Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                           |     value expressions:_col1 (type: bigint)
                           |     Select Operator [SEL_11]
                           |     |  outputColumnNames:["_col0","_col1"]
                           |     |  Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                           |     |<-Reducer 2 [SIMPLE_EDGE]
                           |        Reduce Output Operator [RS_10]
                           |           key expressions:_col3 (type: double), _col2 (type: bigint)
                           |           sort order:-+
                           |           Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                           |           value expressions:_col0 (type: string)
                           |           Filter Operator [FIL_57]
                           |              predicate:(((_col1 + 1) >= 0) and ((_col1 > 0) or (UDFToDouble(_col0) >= 0.0))) (type: boolean)
                           |              Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                           |              Select Operator [SEL_9]
                           |                 outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |                 Statistics:Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                           |                 Filter Operator [FIL_58]
                           |                    predicate:(((UDFToDouble(_col2) + UDFToDouble(_col3)) >= 0.0) and ((UDFToDouble(_col2) >= 1.0) or (_col3 >= 1))) (type: boolean)
                           |                    Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                           |                    Select Operator [SEL_62]
                           |                       outputColumnNames:["_col1","_col2","_col3"]
                           |                       Statistics:Num rows: 1 Data size: 97 Basic stats: COMPLETE Column stats: COMPLETE
                           |                       Group By Operator [GBY_8]
                           |                       |  aggregations:["sum(VALUE._col0)"]
                           |                       |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                           |                       |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |                       |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                           |                       |<-Map 1 [SIMPLE_EDGE]
                           |                          Reduce Output Operator [RS_7]
                           |                             key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                           |                             Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                           |                             sort order:+++
                           |                             Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                           |                             value expressions:_col3 (type: bigint)
                           |                             Group By Operator [GBY_6]
                           |                                aggregations:["sum(_col1)"]
                           |                                keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                           |                                outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |                                Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                           |                                Select Operator [SEL_2]
                           |                                   outputColumnNames:["_col0","_col1","_col2"]
                           |                                   Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                           |                                   Filter Operator [FIL_59]
                           |                                      predicate:((((((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and (c_float > 0.0)) and ((c_int >= 1) or (c_float >= 1.0))) and ((UDFToFloat(c_int) + c_float) >= 0.0)) and (UDFToDouble(key) > 0.0)) and key is not null) (type: boolean)
                           |                                      Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                           |                                      TableScan [TS_0]
                           |                                         alias:cbo_t1
                           |                                         Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 9 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_39]
                                 key expressions:_col0 (type: string)
                                 Map-reduce partition columns:_col0 (type: string)
                                 sort order:+
                                 Statistics:Num rows: 1 Data size: 85 Basic stats: COMPLETE Column stats: COMPLETE
                                 Group By Operator [GBY_33]
                                    keys:_col0 (type: string)
                                    outputColumnNames:["_col0"]
                                    Statistics:Num rows: 1 Data size: 85 Basic stats: COMPLETE Column stats: COMPLETE
                                    Select Operator [SEL_28]
                                    |  outputColumnNames:["_col0"]
                                    |  Statistics:Num rows: 1 Data size: 85 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Reducer 8 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_27]
                                          key expressions:_col1 (type: double), _col0 (type: string)
                                          sort order:-+
                                          Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                          Select Operator [SEL_26]
                                             outputColumnNames:["_col0","_col1"]
                                             Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                             Group By Operator [GBY_25]
                                             |  aggregations:["sum(VALUE._col0)"]
                                             |  keys:KEY._col0 (type: float), KEY._col1 (type: int), KEY._col2 (type: string)
                                             |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                                             |  Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                             |<-Map 7 [SIMPLE_EDGE]
                                                Reduce Output Operator [RS_24]
                                                   key expressions:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                   Map-reduce partition columns:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                   sort order:+++
                                                   Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                   value expressions:_col3 (type: bigint)
                                                   Group By Operator [GBY_23]
                                                      aggregations:["sum(_col1)"]
                                                      keys:_col0 (type: float), _col1 (type: int), _col2 (type: string)
                                                      outputColumnNames:["_col0","_col1","_col2","_col3"]
                                                      Statistics:Num rows: 1 Data size: 101 Basic stats: COMPLETE Column stats: COMPLETE
                                                      Select Operator [SEL_19]
                                                         outputColumnNames:["_col0","_col1","_col2"]
                                                         Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                         Filter Operator [FIL_60]
                                                            predicate:(((((((c_int + 1) >= 0) and ((c_int > 0) or (c_float >= 0.0))) and (c_float > 0.0)) and ((c_int >= 1) or (c_float >= 1.0))) and ((UDFToFloat(c_int) + c_float) >= 0.0)) and key is not null) (type: boolean)
                                                            Statistics:Num rows: 1 Data size: 93 Basic stats: COMPLETE Column stats: COMPLETE
                                                            TableScan [TS_17]
                                                               alias:cbo_t2
                                                               Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select cbo_t1.key as x, c_int as c_int, (((c_int+c_float)*10)+5) as y from cbo_t1
PREHOOK: type: QUERY
POSTHOOK: query: explain select cbo_t1.key as x, c_int as c_int, (((c_int+c_float)*10)+5) as y from cbo_t1
POSTHOOK: type: QUERY
Plan optimized by CBO.

Stage-0
   Fetch Operator
      limit:-1
      Select Operator [SEL_1]
         outputColumnNames:["_col0","_col1","_col2"]
         TableScan [TS_0]
            alias:cbo_t1
PREHOOK: query: explain select null from cbo_t1
PREHOOK: type: QUERY
POSTHOOK: query: explain select null from cbo_t1
POSTHOOK: type: QUERY
Plan optimized by CBO.

Stage-0
   Fetch Operator
      limit:-1
      Select Operator [SEL_1]
         outputColumnNames:["_col0"]
         TableScan [TS_0]
            alias:cbo_t1
PREHOOK: query: explain select key from cbo_t1 where c_int = -6  or c_int = +6
PREHOOK: type: QUERY
POSTHOOK: query: explain select key from cbo_t1 where c_int = -6  or c_int = +6
POSTHOOK: type: QUERY
Plan optimized by CBO.

Stage-0
   Fetch Operator
      limit:-1
      Select Operator [SEL_2]
         outputColumnNames:["_col0"]
         Filter Operator [FIL_4]
            predicate:((c_int = -6) or (c_int = 6)) (type: boolean)
            TableScan [TS_0]
               alias:cbo_t1
PREHOOK: query: explain select count(cbo_t1.dt) from cbo_t1 join cbo_t2 on cbo_t1.dt  = cbo_t2.dt  where cbo_t1.dt = '2014'
PREHOOK: type: QUERY
POSTHOOK: query: explain select count(cbo_t1.dt) from cbo_t1 join cbo_t2 on cbo_t1.dt  = cbo_t2.dt  where cbo_t1.dt = '2014'
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_16]
            compressed:false
            Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_14]
            |  aggregations:["count(VALUE._col0)"]
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 2 [SIMPLE_EDGE]
               Reduce Output Operator [RS_13]
                  sort order:
                  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint)
                  Group By Operator [GBY_12]
                     aggregations:["count(_col0)"]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                     Select Operator [SEL_10]
                        outputColumnNames:["_col0"]
                        Statistics:Num rows: 22 Data size: 0 Basic stats: PARTIAL Column stats: NONE
                        Merge Join Operator [MERGEJOIN_20]
                        |  condition map:[{"":"Inner Join 0 to 1"}]
                        |  keys:{}
                        |  Statistics:Num rows: 22 Data size: 0 Basic stats: PARTIAL Column stats: NONE
                        |<-Map 1 [SIMPLE_EDGE]
                        |  Reduce Output Operator [RS_7]
                        |     sort order:
                        |     Statistics:Num rows: 20 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                        |     Select Operator [SEL_2]
                        |        Statistics:Num rows: 20 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                        |        TableScan [TS_0]
                        |           alias:cbo_t1
                        |           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Map 4 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_8]
                              sort order:
                              Statistics:Num rows: 20 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                              Select Operator [SEL_5]
                                 Statistics:Num rows: 20 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                                 TableScan [TS_3]
                                    alias:cbo_t2
                                    Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select * 
from src_cbo b 
where not exists 
  (select distinct a.key 
  from src_cbo a 
  where b.value = a.value and a.value > 'val_2'
  )
PREHOOK: type: QUERY
POSTHOOK: query: explain select * 
from src_cbo b 
where not exists 
  (select distinct a.key 
  from src_cbo a 
  where b.value = a.value and a.value > 'val_2'
  )
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_16]
            compressed:false
            Statistics:Num rows: 1 Data size: 178 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_15]
               outputColumnNames:["_col0","_col1"]
               Statistics:Num rows: 1 Data size: 178 Basic stats: COMPLETE Column stats: COMPLETE
               Filter Operator [FIL_18]
                  predicate:_col3 is null (type: boolean)
                  Statistics:Num rows: 1 Data size: 269 Basic stats: COMPLETE Column stats: COMPLETE
                  Merge Join Operator [MERGEJOIN_20]
                  |  condition map:[{"":"Left Outer Join0 to 1"}]
                  |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
                  |  outputColumnNames:["_col0","_col1","_col3"]
                  |  Statistics:Num rows: 193 Data size: 51917 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 1 [SIMPLE_EDGE]
                  |  Reduce Output Operator [RS_11]
                  |     key expressions:_col1 (type: string)
                  |     Map-reduce partition columns:_col1 (type: string)
                  |     sort order:+
                  |     Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                  |     value expressions:_col0 (type: string)
                  |     Select Operator [SEL_2]
                  |        outputColumnNames:["_col0","_col1"]
                  |        Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                  |        TableScan [TS_0]
                  |           alias:b
                  |           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 4 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_12]
                        key expressions:_col1 (type: string)
                        Map-reduce partition columns:_col1 (type: string)
                        sort order:+
                        Statistics:Num rows: 83 Data size: 7553 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator [SEL_10]
                           outputColumnNames:["_col1"]
                           Statistics:Num rows: 83 Data size: 7553 Basic stats: COMPLETE Column stats: COMPLETE
                           Group By Operator [GBY_9]
                           |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                           |  outputColumnNames:["_col0","_col1"]
                           |  Statistics:Num rows: 83 Data size: 14774 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 3 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_8]
                                 key expressions:_col0 (type: string), _col1 (type: string)
                                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                 sort order:++
                                 Statistics:Num rows: 83 Data size: 14774 Basic stats: COMPLETE Column stats: COMPLETE
                                 Group By Operator [GBY_7]
                                    keys:_col0 (type: string), _col1 (type: string)
                                    outputColumnNames:["_col0","_col1"]
                                    Statistics:Num rows: 83 Data size: 14774 Basic stats: COMPLETE Column stats: COMPLETE
                                    Select Operator [SEL_5]
                                       outputColumnNames:["_col0","_col1"]
                                       Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                                       Filter Operator [FIL_19]
                                          predicate:(value > 'val_2') (type: boolean)
                                          Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                                          TableScan [TS_3]
                                             alias:b
                                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select * 
from src_cbo b 
group by key, value
having not exists 
  (select a.key 
  from src_cbo a 
  where b.value = a.value  and a.key = b.key and a.value > 'val_12'
  )
PREHOOK: type: QUERY
POSTHOOK: query: explain select * 
from src_cbo b 
group by key, value
having not exists 
  (select a.key 
  from src_cbo a 
  where b.value = a.value  and a.key = b.key and a.value > 'val_12'
  )
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Map 4 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_16]
            compressed:false
            Statistics:Num rows: 1 Data size: 178 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_15]
               outputColumnNames:["_col0","_col1"]
               Statistics:Num rows: 1 Data size: 178 Basic stats: COMPLETE Column stats: COMPLETE
               Filter Operator [FIL_18]
                  predicate:_col3 is null (type: boolean)
                  Statistics:Num rows: 1 Data size: 265 Basic stats: COMPLETE Column stats: COMPLETE
                  Merge Join Operator [MERGEJOIN_20]
                  |  condition map:[{"":"Left Outer Join0 to 1"}]
                  |  keys:{"1":"_col0 (type: string), _col1 (type: string)","0":"_col1 (type: string), _col0 (type: string)"}
                  |  outputColumnNames:["_col0","_col1","_col3"]
                  |  Statistics:Num rows: 1 Data size: 265 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 4 [SIMPLE_EDGE]
                  |  Reduce Output Operator [RS_12]
                  |     key expressions:_col0 (type: string), _col1 (type: string)
                  |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                  |     sort order:++
                  |     Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                  |     Select Operator [SEL_10]
                  |        outputColumnNames:["_col0","_col1"]
                  |        Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                  |        Filter Operator [FIL_19]
                  |           predicate:(value > 'val_12') (type: boolean)
                  |           Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                  |           TableScan [TS_8]
                  |              alias:b
                  |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_11]
                        key expressions:_col1 (type: string), _col0 (type: string)
                        Map-reduce partition columns:_col1 (type: string), _col0 (type: string)
                        sort order:++
                        Statistics:Num rows: 250 Data size: 44500 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator [GBY_6]
                        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 250 Data size: 44500 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Map 1 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_5]
                              key expressions:_col0 (type: string), _col1 (type: string)
                              Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                              sort order:++
                              Statistics:Num rows: 250 Data size: 44500 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator [GBY_4]
                                 keys:_col0 (type: string), _col1 (type: string)
                                 outputColumnNames:["_col0","_col1"]
                                 Statistics:Num rows: 250 Data size: 44500 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_2]
                                    outputColumnNames:["_col0","_col1"]
                                    Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                                    TableScan [TS_0]
                                       alias:b
                                       Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: create view cv1 as 
select * 
from src_cbo b 
where exists
  (select a.key 
  from src_cbo a 
  where b.value = a.value  and a.key = b.key and a.value > 'val_9')
PREHOOK: type: CREATEVIEW
PREHOOK: Input: default@src_cbo
PREHOOK: Output: database:default
PREHOOK: Output: default@cv1
POSTHOOK: query: create view cv1 as 
select * 
from src_cbo b 
where exists
  (select a.key 
  from src_cbo a 
  where b.value = a.value  and a.key = b.key and a.value > 'val_9')
POSTHOOK: type: CREATEVIEW
POSTHOOK: Input: default@src_cbo
POSTHOOK: Output: database:default
POSTHOOK: Output: default@cv1
PREHOOK: query: explain select * from cv1
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from cv1
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_14]
            compressed:false
            Statistics:Num rows: 1 Data size: 178 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_19]
            |  condition map:[{"":"Left Semi Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: string), _col1 (type: string)","0":"_col1 (type: string), _col0 (type: string)"}
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 178 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_9]
            |     key expressions:_col1 (type: string), _col0 (type: string)
            |     Map-reduce partition columns:_col1 (type: string), _col0 (type: string)
            |     sort order:++
            |     Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |     Select Operator [SEL_2]
            |        outputColumnNames:["_col0","_col1"]
            |        Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |        Filter Operator [FIL_17]
            |           predicate:(value is not null and key is not null) (type: boolean)
            |           Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |           TableScan [TS_0]
            |              alias:b
            |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_11]
                  key expressions:_col0 (type: string), _col1 (type: string)
                  Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                  sort order:++
                  Statistics:Num rows: 83 Data size: 14774 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator [GBY_7]
                     keys:_col0 (type: string), _col1 (type: string)
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 83 Data size: 14774 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_5]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator [FIL_18]
                           predicate:((value > 'val_9') and key is not null) (type: boolean)
                           Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                           TableScan [TS_3]
                              alias:b
                              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select * 
from (select * 
      from src_cbo b 
      where exists 
          (select a.key 
          from src_cbo a 
          where b.value = a.value  and a.key = b.key and a.value > 'val_9')
     ) a
PREHOOK: type: QUERY
POSTHOOK: query: explain select * 
from (select * 
      from src_cbo b 
      where exists 
          (select a.key 
          from src_cbo a 
          where b.value = a.value  and a.key = b.key and a.value > 'val_9')
     ) a
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_14]
            compressed:false
            Statistics:Num rows: 1 Data size: 178 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_19]
            |  condition map:[{"":"Left Semi Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: string), _col1 (type: string)","0":"_col1 (type: string), _col0 (type: string)"}
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 178 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_9]
            |     key expressions:_col1 (type: string), _col0 (type: string)
            |     Map-reduce partition columns:_col1 (type: string), _col0 (type: string)
            |     sort order:++
            |     Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |     Select Operator [SEL_2]
            |        outputColumnNames:["_col0","_col1"]
            |        Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |        Filter Operator [FIL_17]
            |           predicate:(value is not null and key is not null) (type: boolean)
            |           Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |           TableScan [TS_0]
            |              alias:b
            |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_11]
                  key expressions:_col0 (type: string), _col1 (type: string)
                  Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                  sort order:++
                  Statistics:Num rows: 83 Data size: 14774 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator [GBY_7]
                     keys:_col0 (type: string), _col1 (type: string)
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 83 Data size: 14774 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_5]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator [FIL_18]
                           predicate:((value > 'val_9') and key is not null) (type: boolean)
                           Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                           TableScan [TS_3]
                              alias:b
                              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select * 
from src_cbo 
where src_cbo.key in (select key from src_cbo s1 where s1.key > '9')
PREHOOK: type: QUERY
POSTHOOK: query: explain select * 
from src_cbo 
where src_cbo.key in (select key from src_cbo s1 where s1.key > '9')
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_14]
            compressed:false
            Statistics:Num rows: 168 Data size: 29904 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_19]
            |  condition map:[{"":"Left Semi Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 168 Data size: 29904 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_9]
            |     key expressions:_col0 (type: string)
            |     Map-reduce partition columns:_col0 (type: string)
            |     sort order:+
            |     Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |     value expressions:_col1 (type: string)
            |     Select Operator [SEL_2]
            |        outputColumnNames:["_col0","_col1"]
            |        Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |        Filter Operator [FIL_17]
            |           predicate:key is not null (type: boolean)
            |           Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |           TableScan [TS_0]
            |              alias:src_cbo
            |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_11]
                  key expressions:_col0 (type: string)
                  Map-reduce partition columns:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 69 Data size: 6003 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator [GBY_7]
                     keys:_col0 (type: string)
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 69 Data size: 6003 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_5]
                        outputColumnNames:["_col0"]
                        Statistics:Num rows: 166 Data size: 14442 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator [FIL_18]
                           predicate:(key > '9') (type: boolean)
                           Statistics:Num rows: 166 Data size: 14442 Basic stats: COMPLETE Column stats: COMPLETE
                           TableScan [TS_3]
                              alias:src_cbo
                              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select p.p_partkey, li.l_suppkey 
from (select distinct l_partkey as p_partkey from lineitem) p join lineitem li on p.p_partkey = li.l_partkey 
where li.l_linenumber = 1 and
 li.l_orderkey in (select l_orderkey from lineitem where l_shipmode = 'AIR' and l_linenumber = li.l_linenumber)
PREHOOK: type: QUERY
POSTHOOK: query: explain select p.p_partkey, li.l_suppkey 
from (select distinct l_partkey as p_partkey from lineitem) p join lineitem li on p.p_partkey = li.l_partkey 
where li.l_linenumber = 1 and
 li.l_orderkey in (select l_orderkey from lineitem where l_shipmode = 'AIR' and l_linenumber = li.l_linenumber)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE), Reducer 6 (SIMPLE_EDGE)
Reducer 6 <- Map 5 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_26]
            compressed:false
            Statistics:Num rows: 4 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_25]
               outputColumnNames:["_col0","_col1"]
               Statistics:Num rows: 4 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
               Merge Join Operator [MERGEJOIN_36]
               |  condition map:[{"":"Inner Join 0 to 1"}]
               |  keys:{"1":"_col0 (type: int)","0":"_col1 (type: int)"}
               |  outputColumnNames:["_col1","_col2"]
               |  Statistics:Num rows: 4 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Reducer 2 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_21]
               |     key expressions:_col1 (type: int)
               |     Map-reduce partition columns:_col1 (type: int)
               |     sort order:+
               |     Statistics:Num rows: 12 Data size: 96 Basic stats: COMPLETE Column stats: COMPLETE
               |     value expressions:_col2 (type: int)
               |     Merge Join Operator [MERGEJOIN_35]
               |     |  condition map:[{"":"Left Semi Join 0 to 1"}]
               |     |  keys:{"1":"_col0 (type: int), _col1 (type: int)","0":"_col0 (type: int), _col3 (type: int)"}
               |     |  outputColumnNames:["_col1","_col2"]
               |     |  Statistics:Num rows: 12 Data size: 96 Basic stats: COMPLETE Column stats: COMPLETE
               |     |<-Map 1 [SIMPLE_EDGE]
               |     |  Reduce Output Operator [RS_16]
               |     |     key expressions:_col0 (type: int), _col3 (type: int)
               |     |     Map-reduce partition columns:_col0 (type: int), _col3 (type: int)
               |     |     sort order:++
               |     |     Statistics:Num rows: 16 Data size: 256 Basic stats: COMPLETE Column stats: COMPLETE
               |     |     value expressions:_col1 (type: int), _col2 (type: int)
               |     |     Select Operator [SEL_2]
               |     |        outputColumnNames:["_col0","_col1","_col2","_col3"]
               |     |        Statistics:Num rows: 16 Data size: 256 Basic stats: COMPLETE Column stats: COMPLETE
               |     |        Filter Operator [FIL_32]
               |     |           predicate:(((l_linenumber = 1) and l_orderkey is not null) and l_partkey is not null) (type: boolean)
               |     |           Statistics:Num rows: 16 Data size: 256 Basic stats: COMPLETE Column stats: COMPLETE
               |     |           TableScan [TS_0]
               |     |              alias:lineitem
               |     |              Statistics:Num rows: 100 Data size: 11999 Basic stats: COMPLETE Column stats: COMPLETE
               |     |<-Map 4 [SIMPLE_EDGE]
               |        Reduce Output Operator [RS_18]
               |           key expressions:_col0 (type: int), _col1 (type: int)
               |           Map-reduce partition columns:_col0 (type: int), _col1 (type: int)
               |           sort order:++
               |           Statistics:Num rows: 4 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
               |           Group By Operator [GBY_14]
               |              keys:_col0 (type: int), _col1 (type: int)
               |              outputColumnNames:["_col0","_col1"]
               |              Statistics:Num rows: 4 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
               |              Select Operator [SEL_5]
               |                 outputColumnNames:["_col0","_col1"]
               |                 Statistics:Num rows: 14 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
               |                 Filter Operator [FIL_33]
               |                    predicate:(((l_shipmode = 'AIR') and l_orderkey is not null) and l_linenumber is not null) (type: boolean)
               |                    Statistics:Num rows: 14 Data size: 1344 Basic stats: COMPLETE Column stats: COMPLETE
               |                    TableScan [TS_3]
               |                       alias:lineitem
               |                       Statistics:Num rows: 100 Data size: 11999 Basic stats: COMPLETE Column stats: COMPLETE
               |<-Reducer 6 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_23]
                     key expressions:_col0 (type: int)
                     Map-reduce partition columns:_col0 (type: int)
                     sort order:+
                     Statistics:Num rows: 50 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator [GBY_11]
                     |  keys:KEY._col0 (type: int)
                     |  outputColumnNames:["_col0"]
                     |  Statistics:Num rows: 50 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                     |<-Map 5 [SIMPLE_EDGE]
                        Reduce Output Operator [RS_10]
                           key expressions:_col0 (type: int)
                           Map-reduce partition columns:_col0 (type: int)
                           sort order:+
                           Statistics:Num rows: 50 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                           Group By Operator [GBY_9]
                              keys:_col0 (type: int)
                              outputColumnNames:["_col0"]
                              Statistics:Num rows: 50 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator [SEL_7]
                                 outputColumnNames:["_col0"]
                                 Statistics:Num rows: 100 Data size: 400 Basic stats: COMPLETE Column stats: COMPLETE
                                 Filter Operator [FIL_34]
                                    predicate:l_partkey is not null (type: boolean)
                                    Statistics:Num rows: 100 Data size: 400 Basic stats: COMPLETE Column stats: COMPLETE
                                    TableScan [TS_6]
                                       alias:lineitem
                                       Statistics:Num rows: 100 Data size: 11999 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select key, value, count(*) 
from src_cbo b
where b.key in (select key from src_cbo where src_cbo.key > '8')
group by key, value
having count(*) in (select count(*) from src_cbo s1 where s1.key > '9' group by s1.key )
PREHOOK: type: QUERY
POSTHOOK: query: explain select key, value, count(*) 
from src_cbo b
where b.key in (select key from src_cbo where src_cbo.key > '8')
group by key, value
having count(*) in (select count(*) from src_cbo s1 where s1.key > '9' group by s1.key )
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
Reducer 7 <- Map 6 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_36]
            compressed:false
            Statistics:Num rows: 34 Data size: 6324 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_49]
            |  condition map:[{"":"Left Semi Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: bigint)","0":"_col2 (type: bigint)"}
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 34 Data size: 6324 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 3 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_31]
            |     key expressions:_col2 (type: bigint)
            |     Map-reduce partition columns:_col2 (type: bigint)
            |     sort order:+
            |     Statistics:Num rows: 84 Data size: 15624 Basic stats: COMPLETE Column stats: COMPLETE
            |     value expressions:_col0 (type: string), _col1 (type: string)
            |     Filter Operator [FIL_42]
            |        predicate:_col2 is not null (type: boolean)
            |        Statistics:Num rows: 84 Data size: 15624 Basic stats: COMPLETE Column stats: COMPLETE
            |        Group By Operator [GBY_18]
            |        |  aggregations:["count(VALUE._col0)"]
            |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
            |        |  outputColumnNames:["_col0","_col1","_col2"]
            |        |  Statistics:Num rows: 84 Data size: 15624 Basic stats: COMPLETE Column stats: COMPLETE
            |        |<-Reducer 2 [SIMPLE_EDGE]
            |           Reduce Output Operator [RS_17]
            |              key expressions:_col0 (type: string), _col1 (type: string)
            |              Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
            |              sort order:++
            |              Statistics:Num rows: 84 Data size: 15624 Basic stats: COMPLETE Column stats: COMPLETE
            |              value expressions:_col2 (type: bigint)
            |              Group By Operator [GBY_16]
            |                 aggregations:["count()"]
            |                 keys:_col0 (type: string), _col1 (type: string)
            |                 outputColumnNames:["_col0","_col1","_col2"]
            |                 Statistics:Num rows: 84 Data size: 15624 Basic stats: COMPLETE Column stats: COMPLETE
            |                 Merge Join Operator [MERGEJOIN_48]
            |                 |  condition map:[{"":"Left Semi Join 0 to 1"}]
            |                 |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
            |                 |  outputColumnNames:["_col0","_col1"]
            |                 |  Statistics:Num rows: 168 Data size: 29904 Basic stats: COMPLETE Column stats: COMPLETE
            |                 |<-Map 1 [SIMPLE_EDGE]
            |                 |  Reduce Output Operator [RS_11]
            |                 |     key expressions:_col0 (type: string)
            |                 |     Map-reduce partition columns:_col0 (type: string)
            |                 |     sort order:+
            |                 |     Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |                 |     value expressions:_col1 (type: string)
            |                 |     Select Operator [SEL_2]
            |                 |        outputColumnNames:["_col0","_col1"]
            |                 |        Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |                 |        Filter Operator [FIL_43]
            |                 |           predicate:key is not null (type: boolean)
            |                 |           Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |                 |           TableScan [TS_0]
            |                 |              alias:b
            |                 |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
            |                 |<-Map 5 [SIMPLE_EDGE]
            |                    Reduce Output Operator [RS_13]
            |                       key expressions:_col0 (type: string)
            |                       Map-reduce partition columns:_col0 (type: string)
            |                       sort order:+
            |                       Statistics:Num rows: 69 Data size: 6003 Basic stats: COMPLETE Column stats: COMPLETE
            |                       Group By Operator [GBY_9]
            |                          keys:_col0 (type: string)
            |                          outputColumnNames:["_col0"]
            |                          Statistics:Num rows: 69 Data size: 6003 Basic stats: COMPLETE Column stats: COMPLETE
            |                          Select Operator [SEL_7]
            |                             outputColumnNames:["_col0"]
            |                             Statistics:Num rows: 166 Data size: 14442 Basic stats: COMPLETE Column stats: COMPLETE
            |                             Filter Operator [FIL_44]
            |                                predicate:(key > '8') (type: boolean)
            |                                Statistics:Num rows: 166 Data size: 14442 Basic stats: COMPLETE Column stats: COMPLETE
            |                                TableScan [TS_5]
            |                                   alias:b
            |                                   Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 7 [SIMPLE_EDGE]
               Reduce Output Operator [RS_33]
                  key expressions:_col0 (type: bigint)
                  Map-reduce partition columns:_col0 (type: bigint)
                  sort order:+
                  Statistics:Num rows: 34 Data size: 272 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator [GBY_29]
                     keys:_col0 (type: bigint)
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 34 Data size: 272 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_27]
                        outputColumnNames:["_col0"]
                        Statistics:Num rows: 69 Data size: 552 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator [FIL_45]
                           predicate:_col1 is not null (type: boolean)
                           Statistics:Num rows: 69 Data size: 552 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_47]
                              outputColumnNames:["_col1"]
                              Statistics:Num rows: 69 Data size: 552 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator [GBY_26]
                              |  aggregations:["count(VALUE._col0)"]
                              |  keys:KEY._col0 (type: string)
                              |  outputColumnNames:["_col0","_col1"]
                              |  Statistics:Num rows: 69 Data size: 6555 Basic stats: COMPLETE Column stats: COMPLETE
                              |<-Map 6 [SIMPLE_EDGE]
                                 Reduce Output Operator [RS_25]
                                    key expressions:_col0 (type: string)
                                    Map-reduce partition columns:_col0 (type: string)
                                    sort order:+
                                    Statistics:Num rows: 69 Data size: 6555 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions:_col1 (type: bigint)
                                    Group By Operator [GBY_24]
                                       aggregations:["count()"]
                                       keys:_col0 (type: string)
                                       outputColumnNames:["_col0","_col1"]
                                       Statistics:Num rows: 69 Data size: 6555 Basic stats: COMPLETE Column stats: COMPLETE
                                       Select Operator [SEL_22]
                                          outputColumnNames:["_col0"]
                                          Statistics:Num rows: 166 Data size: 14442 Basic stats: COMPLETE Column stats: COMPLETE
                                          Filter Operator [FIL_46]
                                             predicate:(key > '9') (type: boolean)
                                             Statistics:Num rows: 166 Data size: 14442 Basic stats: COMPLETE Column stats: COMPLETE
                                             TableScan [TS_20]
                                                alias:b
                                                Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select p_mfgr, p_name, avg(p_size) 
from part 
group by p_mfgr, p_name
having p_name in 
  (select first_value(p_name) over(partition by p_mfgr order by p_size) from part)
PREHOOK: type: QUERY
POSTHOOK: query: explain select p_mfgr, p_name, avg(p_size) 
from part 
group by p_mfgr, p_name
having p_name in 
  (select first_value(p_name) over(partition by p_mfgr order by p_size) from part)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE), Reducer 5 (SIMPLE_EDGE)
Reducer 5 <- Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_22]
            compressed:false
            Statistics:Num rows: 3 Data size: 681 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_27]
            |  condition map:[{"":"Left Semi Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: string)","0":"_col1 (type: string)"}
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 3 Data size: 681 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 2 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_17]
            |     key expressions:_col1 (type: string)
            |     Map-reduce partition columns:_col1 (type: string)
            |     sort order:+
            |     Statistics:Num rows: 13 Data size: 2951 Basic stats: COMPLETE Column stats: COMPLETE
            |     value expressions:_col0 (type: string), _col2 (type: double)
            |     Group By Operator [GBY_6]
            |     |  aggregations:["avg(VALUE._col0)"]
            |     |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
            |     |  outputColumnNames:["_col0","_col1","_col2"]
            |     |  Statistics:Num rows: 13 Data size: 2951 Basic stats: COMPLETE Column stats: COMPLETE
            |     |<-Map 1 [SIMPLE_EDGE]
            |        Reduce Output Operator [RS_5]
            |           key expressions:_col0 (type: string), _col1 (type: string)
            |           Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
            |           sort order:++
            |           Statistics:Num rows: 13 Data size: 2847 Basic stats: COMPLETE Column stats: COMPLETE
            |           value expressions:_col2 (type: struct<count:bigint,sum:double,input:int>)
            |           Group By Operator [GBY_4]
            |              aggregations:["avg(_col2)"]
            |              keys:_col0 (type: string), _col1 (type: string)
            |              outputColumnNames:["_col0","_col1","_col2"]
            |              Statistics:Num rows: 13 Data size: 2847 Basic stats: COMPLETE Column stats: COMPLETE
            |              Select Operator [SEL_2]
            |                 outputColumnNames:["_col0","_col1","_col2"]
            |                 Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
            |                 Filter Operator [FIL_25]
            |                    predicate:p_name is not null (type: boolean)
            |                    Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
            |                    TableScan [TS_0]
            |                       alias:part
            |                       Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 5 [SIMPLE_EDGE]
               Reduce Output Operator [RS_19]
                  key expressions:_col0 (type: string)
                  Map-reduce partition columns:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 6 Data size: 1104 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator [GBY_15]
                     keys:_col0 (type: string)
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 6 Data size: 1104 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_12]
                        outputColumnNames:["_col0"]
                        Statistics:Num rows: 13 Data size: 2392 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator [FIL_26]
                           predicate:first_value_window_0 is not null (type: boolean)
                           Statistics:Num rows: 13 Data size: 2899 Basic stats: COMPLETE Column stats: COMPLETE
                           PTF Operator [PTF_11]
                              Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col5"}]
                              Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator [SEL_10]
                              |  outputColumnNames:["_col1","_col2","_col5"]
                              |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                              |<-Map 4 [SIMPLE_EDGE]
                                 Reduce Output Operator [RS_9]
                                    key expressions:p_mfgr (type: string), p_size (type: int)
                                    Map-reduce partition columns:p_mfgr (type: string)
                                    sort order:++
                                    Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions:p_name (type: string)
                                    TableScan [TS_8]
                                       alias:part
                                       Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select * 
from src_cbo 
where src_cbo.key not in  
  ( select key  from src_cbo s1 
    where s1.key > '2'
  ) order by key
PREHOOK: type: QUERY
POSTHOOK: query: explain select * 
from src_cbo 
where src_cbo.key not in  
  ( select key  from src_cbo s1 
    where s1.key > '2'
  ) order by key
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 6 (SIMPLE_EDGE)
Reducer 3 <- Map 7 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
Reducer 6 <- Map 5 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_29]
            compressed:false
            Statistics:Num rows: 302 Data size: 53756 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_28]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 302 Data size: 53756 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_27]
                  key expressions:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 302 Data size: 53756 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col1 (type: string)
                  Select Operator [SEL_26]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 302 Data size: 53756 Basic stats: COMPLETE Column stats: NONE
                     Filter Operator [FIL_32]
                        predicate:_col3 is null (type: boolean)
                        Statistics:Num rows: 302 Data size: 53756 Basic stats: COMPLETE Column stats: NONE
                        Merge Join Operator [MERGEJOIN_37]
                        |  condition map:[{"":"Left Outer Join0 to 1"}]
                        |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                        |  outputColumnNames:["_col0","_col1","_col3"]
                        |  Statistics:Num rows: 605 Data size: 107690 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 7 [SIMPLE_EDGE]
                        |  Reduce Output Operator [RS_23]
                        |     key expressions:_col0 (type: string)
                        |     Map-reduce partition columns:_col0 (type: string)
                        |     sort order:+
                        |     Statistics:Num rows: 166 Data size: 14442 Basic stats: COMPLETE Column stats: COMPLETE
                        |     Select Operator [SEL_17]
                        |        outputColumnNames:["_col0"]
                        |        Statistics:Num rows: 166 Data size: 14442 Basic stats: COMPLETE Column stats: COMPLETE
                        |        Filter Operator [FIL_35]
                        |           predicate:(key > '2') (type: boolean)
                        |           Statistics:Num rows: 166 Data size: 14442 Basic stats: COMPLETE Column stats: COMPLETE
                        |           TableScan [TS_15]
                        |              alias:src_cbo
                        |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Reducer 2 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_22]
                              key expressions:_col0 (type: string)
                              Map-reduce partition columns:_col0 (type: string)
                              sort order:+
                              Statistics:Num rows: 550 Data size: 97900 Basic stats: COMPLETE Column stats: NONE
                              value expressions:_col1 (type: string)
                              Merge Join Operator [MERGEJOIN_36]
                              |  condition map:[{"":"Inner Join 0 to 1"}]
                              |  keys:{}
                              |  outputColumnNames:["_col0","_col1"]
                              |  Statistics:Num rows: 550 Data size: 97900 Basic stats: COMPLETE Column stats: NONE
                              |<-Map 1 [SIMPLE_EDGE]
                              |  Reduce Output Operator [RS_19]
                              |     sort order:
                              |     Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                              |     value expressions:_col0 (type: string), _col1 (type: string)
                              |     Select Operator [SEL_2]
                              |        outputColumnNames:["_col0","_col1"]
                              |        Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                              |        TableScan [TS_0]
                              |           alias:src_cbo
                              |           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                              |<-Reducer 6 [SIMPLE_EDGE]
                                 Reduce Output Operator [RS_20]
                                    sort order:
                                    Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                                    Select Operator [SEL_12]
                                       Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                                       Filter Operator [FIL_33]
                                          predicate:(_col0 = 0) (type: boolean)
                                          Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                          Group By Operator [GBY_11]
                                          |  aggregations:["count(VALUE._col0)"]
                                          |  outputColumnNames:["_col0"]
                                          |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                          |<-Map 5 [SIMPLE_EDGE]
                                             Reduce Output Operator [RS_10]
                                                sort order:
                                                Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                                value expressions:_col0 (type: bigint)
                                                Group By Operator [GBY_9]
                                                   aggregations:["count()"]
                                                   outputColumnNames:["_col0"]
                                                   Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                                   Select Operator [SEL_5]
                                                      Statistics:Num rows: 1 Data size: 87 Basic stats: COMPLETE Column stats: COMPLETE
                                                      Filter Operator [FIL_34]
                                                         predicate:((key > '2') and key is null) (type: boolean)
                                                         Statistics:Num rows: 1 Data size: 87 Basic stats: COMPLETE Column stats: COMPLETE
                                                         TableScan [TS_3]
                                                            alias:src_cbo
                                                            Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select p_mfgr, b.p_name, p_size 
from part b 
where b.p_name not in 
  (select p_name 
  from (select p_mfgr, p_name, p_size as r from part) a 
  where r < 10 and b.p_mfgr = a.p_mfgr 
  )
PREHOOK: type: QUERY
POSTHOOK: query: explain select p_mfgr, b.p_name, p_size 
from part b 
where b.p_name not in 
  (select p_name 
  from (select p_mfgr, p_name, p_size as r from part) a 
  where r < 10 and b.p_mfgr = a.p_mfgr 
  )
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 5 (SIMPLE_EDGE)
Reducer 3 <- Map 6 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
Reducer 5 <- Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_27]
            compressed:false
            Statistics:Num rows: 15 Data size: 3507 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_26]
               outputColumnNames:["_col0","_col1","_col2"]
               Statistics:Num rows: 15 Data size: 3507 Basic stats: COMPLETE Column stats: NONE
               Filter Operator [FIL_30]
                  predicate:_col4 is null (type: boolean)
                  Statistics:Num rows: 15 Data size: 3507 Basic stats: COMPLETE Column stats: NONE
                  Merge Join Operator [MERGEJOIN_35]
                  |  condition map:[{"":"Left Outer Join0 to 1"}]
                  |  keys:{"1":"_col0 (type: string), _col1 (type: string)","0":"_col0 (type: string), _col1 (type: string)"}
                  |  outputColumnNames:["_col0","_col1","_col2","_col4"]
                  |  Statistics:Num rows: 30 Data size: 7014 Basic stats: COMPLETE Column stats: NONE
                  |<-Map 6 [SIMPLE_EDGE]
                  |  Reduce Output Operator [RS_23]
                  |     key expressions:_col0 (type: string), _col1 (type: string)
                  |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                  |     sort order:++
                  |     Statistics:Num rows: 8 Data size: 1752 Basic stats: COMPLETE Column stats: COMPLETE
                  |     Select Operator [SEL_17]
                  |        outputColumnNames:["_col0","_col1"]
                  |        Statistics:Num rows: 8 Data size: 1752 Basic stats: COMPLETE Column stats: COMPLETE
                  |        Filter Operator [FIL_33]
                  |           predicate:(p_size < 10) (type: boolean)
                  |           Statistics:Num rows: 8 Data size: 1784 Basic stats: COMPLETE Column stats: COMPLETE
                  |           TableScan [TS_15]
                  |              alias:b
                  |              Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_22]
                        key expressions:_col0 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                        sort order:++
                        Statistics:Num rows: 28 Data size: 6377 Basic stats: COMPLETE Column stats: NONE
                        value expressions:_col2 (type: int)
                        Merge Join Operator [MERGEJOIN_34]
                        |  condition map:[{"":"Inner Join 0 to 1"}]
                        |  keys:{}
                        |  outputColumnNames:["_col0","_col1","_col2"]
                        |  Statistics:Num rows: 28 Data size: 6377 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 1 [SIMPLE_EDGE]
                        |  Reduce Output Operator [RS_19]
                        |     sort order:
                        |     Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                        |     value expressions:_col0 (type: string), _col1 (type: string), _col2 (type: int)
                        |     Select Operator [SEL_2]
                        |        outputColumnNames:["_col0","_col1","_col2"]
                        |        Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                        |        TableScan [TS_0]
                        |           alias:b
                        |           Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Reducer 5 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_20]
                              sort order:
                              Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                              Select Operator [SEL_12]
                                 Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                                 Filter Operator [FIL_31]
                                    predicate:(_col0 = 0) (type: boolean)
                                    Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                    Group By Operator [GBY_11]
                                    |  aggregations:["count(VALUE._col0)"]
                                    |  outputColumnNames:["_col0"]
                                    |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 4 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_10]
                                          sort order:
                                          Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                          value expressions:_col0 (type: bigint)
                                          Group By Operator [GBY_9]
                                             aggregations:["count()"]
                                             outputColumnNames:["_col0"]
                                             Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                             Select Operator [SEL_5]
                                                Statistics:Num rows: 1 Data size: 223 Basic stats: COMPLETE Column stats: COMPLETE
                                                Filter Operator [FIL_32]
                                                   predicate:((p_size < 10) and (p_name is null or p_mfgr is null)) (type: boolean)
                                                   Statistics:Num rows: 1 Data size: 223 Basic stats: COMPLETE Column stats: COMPLETE
                                                   TableScan [TS_3]
                                                      alias:b
                                                      Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select p_name, p_size 
from 
part where part.p_size not in 
  (select avg(p_size) 
  from (select p_size from part) a 
  where p_size < 10
  ) order by p_name
PREHOOK: type: QUERY
POSTHOOK: query: explain select p_name, p_size 
from 
part where part.p_size not in 
  (select avg(p_size) 
  from (select p_size from part) a 
  where p_size < 10
  ) order by p_name
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 6 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE), Reducer 8 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
Reducer 6 <- Map 5 (SIMPLE_EDGE)
Reducer 8 <- Map 7 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_39]
            compressed:false
            Statistics:Num rows: 1 Data size: 146 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_38]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 146 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_37]
                  key expressions:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 1 Data size: 146 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col1 (type: int)
                  Merge Join Operator [MERGEJOIN_49]
                  |  condition map:[{"":"Inner Join 0 to 1"}]
                  |  keys:{}
                  |  outputColumnNames:["_col0","_col1"]
                  |  Statistics:Num rows: 1 Data size: 146 Basic stats: COMPLETE Column stats: NONE
                  |<-Reducer 2 [SIMPLE_EDGE]
                  |  Reduce Output Operator [RS_31]
                  |     sort order:
                  |     Statistics:Num rows: 1 Data size: 133 Basic stats: COMPLETE Column stats: COMPLETE
                  |     value expressions:_col0 (type: string), _col1 (type: int)
                  |     Filter Operator [FIL_42]
                  |        predicate:_col2 is null (type: boolean)
                  |        Statistics:Num rows: 1 Data size: 133 Basic stats: COMPLETE Column stats: COMPLETE
                  |        Merge Join Operator [MERGEJOIN_48]
                  |        |  condition map:[{"":"Left Outer Join0 to 1"}]
                  |        |  keys:{"1":"_col0 (type: double)","0":"UDFToDouble(_col1) (type: double)"}
                  |        |  outputColumnNames:["_col0","_col1","_col2"]
                  |        |  Statistics:Num rows: 1 Data size: 133 Basic stats: COMPLETE Column stats: COMPLETE
                  |        |<-Map 1 [SIMPLE_EDGE]
                  |        |  Reduce Output Operator [RS_28]
                  |        |     key expressions:UDFToDouble(_col1) (type: double)
                  |        |     Map-reduce partition columns:UDFToDouble(_col1) (type: double)
                  |        |     sort order:+
                  |        |     Statistics:Num rows: 26 Data size: 3250 Basic stats: COMPLETE Column stats: COMPLETE
                  |        |     value expressions:_col0 (type: string), _col1 (type: int)
                  |        |     Select Operator [SEL_2]
                  |        |        outputColumnNames:["_col0","_col1"]
                  |        |        Statistics:Num rows: 26 Data size: 3250 Basic stats: COMPLETE Column stats: COMPLETE
                  |        |        TableScan [TS_0]
                  |        |           alias:part
                  |        |           Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                  |        |<-Reducer 6 [SIMPLE_EDGE]
                  |           Reduce Output Operator [RS_29]
                  |              key expressions:_col0 (type: double)
                  |              Map-reduce partition columns:_col0 (type: double)
                  |              sort order:+
                  |              Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  |              Group By Operator [GBY_9]
                  |              |  aggregations:["avg(VALUE._col0)"]
                  |              |  outputColumnNames:["_col0"]
                  |              |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  |              |<-Map 5 [SIMPLE_EDGE]
                  |                 Reduce Output Operator [RS_8]
                  |                    sort order:
                  |                    Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                  |                    value expressions:_col0 (type: struct<count:bigint,sum:double,input:int>)
                  |                    Group By Operator [GBY_7]
                  |                       aggregations:["avg(_col0)"]
                  |                       outputColumnNames:["_col0"]
                  |                       Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                  |                       Select Operator [SEL_5]
                  |                          outputColumnNames:["_col0"]
                  |                          Statistics:Num rows: 8 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                  |                          Filter Operator [FIL_44]
                  |                             predicate:(p_size < 10) (type: boolean)
                  |                             Statistics:Num rows: 8 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                  |                             TableScan [TS_3]
                  |                                alias:part
                  |                                Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 8 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_32]
                        sort order:
                        Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                        Select Operator [SEL_24]
                           Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                           Filter Operator [FIL_45]
                              predicate:(_col0 = 0) (type: boolean)
                              Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator [GBY_23]
                                 aggregations:["count()"]
                                 outputColumnNames:["_col0"]
                                 Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_18]
                                    Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                    Filter Operator [FIL_46]
                                       predicate:_col0 is null (type: boolean)
                                       Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                       Group By Operator [GBY_17]
                                       |  aggregations:["avg(VALUE._col0)"]
                                       |  outputColumnNames:["_col0"]
                                       |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                       |<-Map 7 [SIMPLE_EDGE]
                                          Reduce Output Operator [RS_16]
                                             sort order:
                                             Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                                             value expressions:_col0 (type: struct<count:bigint,sum:double,input:int>)
                                             Group By Operator [GBY_15]
                                                aggregations:["avg(_col0)"]
                                                outputColumnNames:["_col0"]
                                                Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                                                Select Operator [SEL_13]
                                                   outputColumnNames:["_col0"]
                                                   Statistics:Num rows: 8 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                                                   Filter Operator [FIL_47]
                                                      predicate:(p_size < 10) (type: boolean)
                                                      Statistics:Num rows: 8 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                                                      TableScan [TS_11]
                                                         alias:part
                                                         Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select b.p_mfgr, min(p_retailprice) 
from part b 
group by b.p_mfgr
having b.p_mfgr not in 
  (select p_mfgr 
  from (select p_mfgr, min(p_retailprice) l, max(p_retailprice) r, avg(p_retailprice) a from part group by p_mfgr) a 
  where min(p_retailprice) = l and r - l > 600
  )
  order by b.p_mfgr
PREHOOK: type: QUERY
POSTHOOK: query: explain select b.p_mfgr, min(p_retailprice) 
from part b 
group by b.p_mfgr
having b.p_mfgr not in 
  (select p_mfgr 
  from (select p_mfgr, min(p_retailprice) l, max(p_retailprice) r, avg(p_retailprice) a from part group by p_mfgr) a 
  where min(p_retailprice) = l and r - l > 600
  )
  order by b.p_mfgr
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE), Reducer 8 (SIMPLE_EDGE)
Reducer 10 <- Map 9 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Reducer 10 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
Reducer 7 <- Map 6 (SIMPLE_EDGE)
Reducer 8 <- Reducer 7 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 5
         File Output Operator [FS_44]
            compressed:false
            Statistics:Num rows: 2 Data size: 256 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_43]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 2 Data size: 256 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 4 [SIMPLE_EDGE]
               Reduce Output Operator [RS_42]
                  key expressions:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 2 Data size: 256 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col1 (type: double)
                  Select Operator [SEL_41]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 2 Data size: 256 Basic stats: COMPLETE Column stats: NONE
                     Filter Operator [FIL_47]
                        predicate:_col3 is null (type: boolean)
                        Statistics:Num rows: 2 Data size: 256 Basic stats: COMPLETE Column stats: NONE
                        Merge Join Operator [MERGEJOIN_53]
                        |  condition map:[{"":"Left Outer Join0 to 1"}]
                        |  keys:{"1":"_col0 (type: string), _col1 (type: double)","0":"_col0 (type: string), _col1 (type: double)"}
                        |  outputColumnNames:["_col0","_col1","_col3"]
                        |  Statistics:Num rows: 5 Data size: 641 Basic stats: COMPLETE Column stats: NONE
                        |<-Reducer 10 [SIMPLE_EDGE]
                        |  Reduce Output Operator [RS_38]
                        |     key expressions:_col0 (type: string), _col1 (type: double)
                        |     Map-reduce partition columns:_col0 (type: string), _col1 (type: double)
                        |     sort order:++
                        |     Statistics:Num rows: 1 Data size: 106 Basic stats: COMPLETE Column stats: COMPLETE
                        |     Select Operator [SEL_32]
                        |        outputColumnNames:["_col0","_col1"]
                        |        Statistics:Num rows: 1 Data size: 106 Basic stats: COMPLETE Column stats: COMPLETE
                        |        Filter Operator [FIL_50]
                        |           predicate:((_col2 - _col1) > 600.0) (type: boolean)
                        |           Statistics:Num rows: 1 Data size: 114 Basic stats: COMPLETE Column stats: COMPLETE
                        |           Group By Operator [GBY_30]
                        |           |  aggregations:["min(VALUE._col0)","max(VALUE._col1)"]
                        |           |  keys:KEY._col0 (type: string)
                        |           |  outputColumnNames:["_col0","_col1","_col2"]
                        |           |  Statistics:Num rows: 5 Data size: 570 Basic stats: COMPLETE Column stats: COMPLETE
                        |           |<-Map 9 [SIMPLE_EDGE]
                        |              Reduce Output Operator [RS_29]
                        |                 key expressions:_col0 (type: string)
                        |                 Map-reduce partition columns:_col0 (type: string)
                        |                 sort order:+
                        |                 Statistics:Num rows: 5 Data size: 570 Basic stats: COMPLETE Column stats: COMPLETE
                        |                 value expressions:_col1 (type: double), _col2 (type: double)
                        |                 Group By Operator [GBY_28]
                        |                    aggregations:["min(_col1)","max(_col1)"]
                        |                    keys:_col0 (type: string)
                        |                    outputColumnNames:["_col0","_col1","_col2"]
                        |                    Statistics:Num rows: 5 Data size: 570 Basic stats: COMPLETE Column stats: COMPLETE
                        |                    Select Operator [SEL_26]
                        |                       outputColumnNames:["_col0","_col1"]
                        |                       Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                        |                       TableScan [TS_25]
                        |                          alias:b
                        |                          Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Reducer 3 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_37]
                              key expressions:_col0 (type: string), _col1 (type: double)
                              Map-reduce partition columns:_col0 (type: string), _col1 (type: double)
                              sort order:++
                              Statistics:Num rows: 5 Data size: 583 Basic stats: COMPLETE Column stats: NONE
                              Merge Join Operator [MERGEJOIN_52]
                              |  condition map:[{"":"Inner Join 0 to 1"}]
                              |  keys:{}
                              |  outputColumnNames:["_col0","_col1"]
                              |  Statistics:Num rows: 5 Data size: 583 Basic stats: COMPLETE Column stats: NONE
                              |<-Reducer 2 [SIMPLE_EDGE]
                              |  Reduce Output Operator [RS_34]
                              |     sort order:
                              |     Statistics:Num rows: 5 Data size: 530 Basic stats: COMPLETE Column stats: COMPLETE
                              |     value expressions:_col0 (type: string), _col1 (type: double)
                              |     Group By Operator [GBY_6]
                              |     |  aggregations:["min(VALUE._col0)"]
                              |     |  keys:KEY._col0 (type: string)
                              |     |  outputColumnNames:["_col0","_col1"]
                              |     |  Statistics:Num rows: 5 Data size: 530 Basic stats: COMPLETE Column stats: COMPLETE
                              |     |<-Map 1 [SIMPLE_EDGE]
                              |        Reduce Output Operator [RS_5]
                              |           key expressions:_col0 (type: string)
                              |           Map-reduce partition columns:_col0 (type: string)
                              |           sort order:+
                              |           Statistics:Num rows: 5 Data size: 530 Basic stats: COMPLETE Column stats: COMPLETE
                              |           value expressions:_col1 (type: double)
                              |           Group By Operator [GBY_4]
                              |              aggregations:["min(_col1)"]
                              |              keys:_col0 (type: string)
                              |              outputColumnNames:["_col0","_col1"]
                              |              Statistics:Num rows: 5 Data size: 530 Basic stats: COMPLETE Column stats: COMPLETE
                              |              Select Operator [SEL_2]
                              |                 outputColumnNames:["_col0","_col1"]
                              |                 Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                              |                 TableScan [TS_0]
                              |                    alias:b
                              |                    Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                              |<-Reducer 8 [SIMPLE_EDGE]
                                 Reduce Output Operator [RS_35]
                                    sort order:
                                    Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                                    Select Operator [SEL_22]
                                       Statistics:Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                                       Filter Operator [FIL_48]
                                          predicate:(_col0 = 0) (type: boolean)
                                          Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                          Group By Operator [GBY_21]
                                          |  aggregations:["count(VALUE._col0)"]
                                          |  outputColumnNames:["_col0"]
                                          |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                          |<-Reducer 7 [SIMPLE_EDGE]
                                             Reduce Output Operator [RS_20]
                                                sort order:
                                                Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                                value expressions:_col0 (type: bigint)
                                                Group By Operator [GBY_19]
                                                   aggregations:["count()"]
                                                   outputColumnNames:["_col0"]
                                                   Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                                   Select Operator [SEL_15]
                                                      Statistics:Num rows: 1 Data size: 114 Basic stats: COMPLETE Column stats: COMPLETE
                                                      Filter Operator [FIL_49]
                                                         predicate:((_col0 is null or _col1 is null) and ((_col2 - _col1) > 600.0)) (type: boolean)
                                                         Statistics:Num rows: 1 Data size: 114 Basic stats: COMPLETE Column stats: COMPLETE
                                                         Group By Operator [GBY_13]
                                                         |  aggregations:["min(VALUE._col0)","max(VALUE._col1)"]
                                                         |  keys:KEY._col0 (type: string)
                                                         |  outputColumnNames:["_col0","_col1","_col2"]
                                                         |  Statistics:Num rows: 5 Data size: 570 Basic stats: COMPLETE Column stats: COMPLETE
                                                         |<-Map 6 [SIMPLE_EDGE]
                                                            Reduce Output Operator [RS_12]
                                                               key expressions:_col0 (type: string)
                                                               Map-reduce partition columns:_col0 (type: string)
                                                               sort order:+
                                                               Statistics:Num rows: 5 Data size: 570 Basic stats: COMPLETE Column stats: COMPLETE
                                                               value expressions:_col1 (type: double), _col2 (type: double)
                                                               Group By Operator [GBY_11]
                                                                  aggregations:["min(_col1)","max(_col1)"]
                                                                  keys:_col0 (type: string)
                                                                  outputColumnNames:["_col0","_col1","_col2"]
                                                                  Statistics:Num rows: 5 Data size: 570 Basic stats: COMPLETE Column stats: COMPLETE
                                                                  Select Operator [SEL_9]
                                                                     outputColumnNames:["_col0","_col1"]
                                                                     Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                                                     TableScan [TS_8]
                                                                        alias:b
                                                                        Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select count(c_int) over(), sum(c_float) over(), max(c_int) over(), min(c_int) over(), row_number() over(), rank() over(), dense_rank() over(), percent_rank() over(), lead(c_int, 2, c_int) over(), lag(c_float, 2, c_float) over() from cbo_t1
PREHOOK: type: QUERY
POSTHOOK: query: explain select count(c_int) over(), sum(c_float) over(), max(c_int) over(), min(c_int) over(), row_number() over(), rank() over(), dense_rank() over(), percent_rank() over(), lead(c_int, 2, c_int) over(), lag(c_float, 2, c_float) over() from cbo_t1
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:false
            Statistics:Num rows: 20 Data size: 1040 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_4]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9"]
               Statistics:Num rows: 20 Data size: 1040 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_3]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"0","name:":"windowingtablefunction","order by:":"0"}]
                  Statistics:Num rows: 20 Data size: 144 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_2]
                  |  outputColumnNames:["_col2","_col3"]
                  |  Statistics:Num rows: 20 Data size: 144 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 1 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_1]
                        key expressions:0 (type: int)
                        Map-reduce partition columns:0 (type: int)
                        sort order:+
                        Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:c_int (type: int), c_float (type: float)
                        TableScan [TS_0]
                           alias:cbo_t1
                           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select * from (select count(c_int) over(), sum(c_float) over(), max(c_int) over(), min(c_int) over(), row_number() over(), rank() over(), dense_rank() over(), percent_rank() over(), lead(c_int, 2, c_int) over(), lag(c_float, 2, c_float) over() from cbo_t1) cbo_t1
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from (select count(c_int) over(), sum(c_float) over(), max(c_int) over(), min(c_int) over(), row_number() over(), rank() over(), dense_rank() over(), percent_rank() over(), lead(c_int, 2, c_int) over(), lag(c_float, 2, c_float) over() from cbo_t1) cbo_t1
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:false
            Statistics:Num rows: 20 Data size: 1040 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_4]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9"]
               Statistics:Num rows: 20 Data size: 1040 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_3]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"0","name:":"windowingtablefunction","order by:":"0"}]
                  Statistics:Num rows: 20 Data size: 144 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_2]
                  |  outputColumnNames:["_col2","_col3"]
                  |  Statistics:Num rows: 20 Data size: 144 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 1 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_1]
                        key expressions:0 (type: int)
                        Map-reduce partition columns:0 (type: int)
                        sort order:+
                        Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:c_int (type: int), c_float (type: float)
                        TableScan [TS_0]
                           alias:cbo_t1
                           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select i, a, h, b, c, d, e, f, g, a as x, a +1 as y from (select max(c_int) over (partition by key order by value range UNBOUNDED PRECEDING) a, min(c_int) over (partition by key order by value range current row) b, count(c_int) over(partition by key order by value range 1 PRECEDING) c, avg(value) over (partition by key order by value range between unbounded preceding and unbounded following) d, sum(value) over (partition by key order by value range between unbounded preceding and current row) e, avg(c_float) over (partition by key order by value range between 1 preceding and unbounded following) f, sum(c_float) over (partition by key order by value range between 1 preceding and current row) g, max(c_float) over (partition by key order by value range between 1 preceding and unbounded following) h, min(c_float) over (partition by key order by value range between 1 preceding and 1 following) i from cbo_t1) cbo_t1
PREHOOK: type: QUERY
POSTHOOK: query: explain select i, a, h, b, c, d, e, f, g, a as x, a +1 as y from (select max(c_int) over (partition by key order by value range UNBOUNDED PRECEDING) a, min(c_int) over (partition by key order by value range current row) b, count(c_int) over(partition by key order by value range 1 PRECEDING) c, avg(value) over (partition by key order by value range between unbounded preceding and unbounded following) d, sum(value) over (partition by key order by value range between unbounded preceding and current row) e, avg(c_float) over (partition by key order by value range between 1 preceding and unbounded following) f, sum(c_float) over (partition by key order by value range between 1 preceding and current row) g, max(c_float) over (partition by key order by value range between 1 preceding and unbounded following) h, min(c_float) over (partition by key order by value range between 1 preceding and 1 following) i from cbo_t1) cbo_t1
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:false
            Statistics:Num rows: 20 Data size: 1280 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_4]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10"]
               Statistics:Num rows: 20 Data size: 1280 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_3]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col0","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 20 Data size: 3204 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_2]
                  |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                  |  Statistics:Num rows: 20 Data size: 3204 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 1 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_1]
                        key expressions:key (type: string), value (type: string)
                        Map-reduce partition columns:key (type: string)
                        sort order:++
                        Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:c_int (type: int), c_float (type: float)
                        TableScan [TS_0]
                           alias:cbo_t1
                           Statistics:Num rows: 20 Data size: 262 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select *, rank() over(partition by key order by value) as rr from src1
PREHOOK: type: QUERY
POSTHOOK: query: explain select *, rank() over(partition by key order by value) as rr from src1
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:false
            Statistics:Num rows: 25 Data size: 4475 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_4]
               outputColumnNames:["_col0","_col1","_col2"]
               Statistics:Num rows: 25 Data size: 4475 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_3]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col0","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 25 Data size: 4375 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_2]
                  |  outputColumnNames:["_col0","_col1"]
                  |  Statistics:Num rows: 25 Data size: 4375 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 1 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_1]
                        key expressions:key (type: string), value (type: string)
                        Map-reduce partition columns:key (type: string)
                        sort order:++
                        Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: COMPLETE
                        TableScan [TS_0]
                           alias:src1
                           Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select SUM(HASH(tmp.key)), SUM(HASH(tmp.cnt))
FROM (select x.key AS key, count(1) AS cnt
      FROM src1 x JOIN src y ON (x.key = y.key)
      GROUP BY x.key) tmp
PREHOOK: type: QUERY
POSTHOOK: query: explain
select SUM(HASH(tmp.key)), SUM(HASH(tmp.cnt))
FROM (select x.key AS key, count(1) AS cnt
      FROM src1 x JOIN src y ON (x.key = y.key)
      GROUP BY x.key) tmp
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_20]
            compressed:false
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_18]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_17]
                  sort order:
                  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint)
                  Group By Operator [GBY_16]
                     aggregations:["sum(_col0)","sum(_col1)"]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_14]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator [GBY_13]
                        |  aggregations:["count(VALUE._col0)"]
                        |  keys:KEY._col0 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Reducer 2 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_12]
                              key expressions:_col0 (type: string)
                              Map-reduce partition columns:_col0 (type: string)
                              sort order:+
                              Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions:_col1 (type: bigint)
                              Group By Operator [GBY_11]
                                 aggregations:["count(1)"]
                                 keys:_col0 (type: string)
                                 outputColumnNames:["_col0","_col1"]
                                 Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_9]
                                    outputColumnNames:["_col0"]
                                    Statistics:Num rows: 60 Data size: 5160 Basic stats: COMPLETE Column stats: COMPLETE
                                    Merge Join Operator [MERGEJOIN_25]
                                    |  condition map:[{"":"Inner Join 0 to 1"}]
                                    |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                    |  outputColumnNames:["_col1"]
                                    |  Statistics:Num rows: 60 Data size: 5160 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 1 [SIMPLE_EDGE]
                                    |  Reduce Output Operator [RS_5]
                                    |     key expressions:_col0 (type: string)
                                    |     Map-reduce partition columns:_col0 (type: string)
                                    |     sort order:+
                                    |     Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                    |     Select Operator [SEL_1]
                                    |        outputColumnNames:["_col0"]
                                    |        Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                    |        Filter Operator [FIL_23]
                                    |           predicate:key is not null (type: boolean)
                                    |           Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                    |           TableScan [TS_0]
                                    |              alias:y
                                    |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 5 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_7]
                                          key expressions:_col0 (type: string)
                                          Map-reduce partition columns:_col0 (type: string)
                                          sort order:+
                                          Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                          Select Operator [SEL_3]
                                             outputColumnNames:["_col0"]
                                             Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                             Filter Operator [FIL_24]
                                                predicate:key is not null (type: boolean)
                                                Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                                TableScan [TS_2]
                                                   alias:x
                                                   Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select SUM(HASH(tmp.key)), SUM(HASH(tmp.cnt))
FROM (select x.key AS key, count(1) AS cnt
      FROM src1 x JOIN src y ON (x.key = y.key)
      GROUP BY x.key) tmp
PREHOOK: type: QUERY
POSTHOOK: query: explain
select SUM(HASH(tmp.key)), SUM(HASH(tmp.cnt))
FROM (select x.key AS key, count(1) AS cnt
      FROM src1 x JOIN src y ON (x.key = y.key)
      GROUP BY x.key) tmp
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_20]
            compressed:false
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_18]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_17]
                  sort order:
                  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint)
                  Group By Operator [GBY_16]
                     aggregations:["sum(_col0)","sum(_col1)"]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_14]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator [GBY_13]
                        |  aggregations:["count(VALUE._col0)"]
                        |  keys:KEY._col0 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Reducer 2 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_12]
                              key expressions:_col0 (type: string)
                              Map-reduce partition columns:_col0 (type: string)
                              sort order:+
                              Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions:_col1 (type: bigint)
                              Group By Operator [GBY_11]
                                 aggregations:["count(1)"]
                                 keys:_col0 (type: string)
                                 outputColumnNames:["_col0","_col1"]
                                 Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_9]
                                    outputColumnNames:["_col0"]
                                    Statistics:Num rows: 60 Data size: 5160 Basic stats: COMPLETE Column stats: COMPLETE
                                    Merge Join Operator [MERGEJOIN_25]
                                    |  condition map:[{"":"Inner Join 0 to 1"}]
                                    |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                    |  outputColumnNames:["_col1"]
                                    |  Statistics:Num rows: 60 Data size: 5160 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 1 [SIMPLE_EDGE]
                                    |  Reduce Output Operator [RS_5]
                                    |     key expressions:_col0 (type: string)
                                    |     Map-reduce partition columns:_col0 (type: string)
                                    |     sort order:+
                                    |     Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                    |     Select Operator [SEL_1]
                                    |        outputColumnNames:["_col0"]
                                    |        Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                    |        Filter Operator [FIL_23]
                                    |           predicate:key is not null (type: boolean)
                                    |           Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                    |           TableScan [TS_0]
                                    |              alias:y
                                    |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 5 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_7]
                                          key expressions:_col0 (type: string)
                                          Map-reduce partition columns:_col0 (type: string)
                                          sort order:+
                                          Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                          Select Operator [SEL_3]
                                             outputColumnNames:["_col0"]
                                             Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                             Filter Operator [FIL_24]
                                                predicate:key is not null (type: boolean)
                                                Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                                TableScan [TS_2]
                                                   alias:x
                                                   Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select SUM(HASH(tmp.key)), SUM(HASH(tmp.cnt))
FROM (select x.key AS key, count(1) AS cnt
      FROM src1 x JOIN src y ON (x.key = y.key)
      GROUP BY x.key) tmp
PREHOOK: type: QUERY
POSTHOOK: query: explain
select SUM(HASH(tmp.key)), SUM(HASH(tmp.cnt))
FROM (select x.key AS key, count(1) AS cnt
      FROM src1 x JOIN src y ON (x.key = y.key)
      GROUP BY x.key) tmp
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Map 1 <- Map 4 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_20]
            compressed:false
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_18]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 2 [SIMPLE_EDGE]
               Reduce Output Operator [RS_17]
                  sort order:
                  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint)
                  Group By Operator [GBY_16]
                     aggregations:["sum(_col0)","sum(_col1)"]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_14]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator [GBY_13]
                        |  aggregations:["count(VALUE._col0)"]
                        |  keys:KEY._col0 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Map 1 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_12]
                              key expressions:_col0 (type: string)
                              Map-reduce partition columns:_col0 (type: string)
                              sort order:+
                              Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions:_col1 (type: bigint)
                              Group By Operator [GBY_11]
                                 aggregations:["count(1)"]
                                 keys:_col0 (type: string)
                                 outputColumnNames:["_col0","_col1"]
                                 Statistics:Num rows: 14 Data size: 1316 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_9]
                                    outputColumnNames:["_col0"]
                                    Statistics:Num rows: 60 Data size: 5160 Basic stats: COMPLETE Column stats: COMPLETE
                                    Map Join Operator [MAPJOIN_25]
                                    |  condition map:[{"":"Inner Join 0 to 1"}]
                                    |  keys:{"Map 1":"_col0 (type: string)","Map 4":"_col0 (type: string)"}
                                    |  outputColumnNames:["_col1"]
                                    |  Statistics:Num rows: 60 Data size: 5160 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 4 [BROADCAST_EDGE]
                                    |  Reduce Output Operator [RS_7]
                                    |     key expressions:_col0 (type: string)
                                    |     Map-reduce partition columns:_col0 (type: string)
                                    |     sort order:+
                                    |     Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                    |     Select Operator [SEL_3]
                                    |        outputColumnNames:["_col0"]
                                    |        Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                    |        Filter Operator [FIL_24]
                                    |           predicate:key is not null (type: boolean)
                                    |           Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                    |           TableScan [TS_2]
                                    |              alias:x
                                    |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Select Operator [SEL_1]
                                          outputColumnNames:["_col0"]
                                          Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                          Filter Operator [FIL_23]
                                             predicate:key is not null (type: boolean)
                                             Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                             TableScan [TS_0]
                                                alias:y
                                                Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select SUM(HASH(tmp.key)), SUM(HASH(tmp.cnt))
FROM (select x.key AS key, count(1) AS cnt
      FROM src1 x LEFT SEMI JOIN src y ON (x.key = y.key)
      GROUP BY x.key) tmp
PREHOOK: type: QUERY
POSTHOOK: query: explain
select SUM(HASH(tmp.key)), SUM(HASH(tmp.cnt))
FROM (select x.key AS key, count(1) AS cnt
      FROM src1 x LEFT SEMI JOIN src y ON (x.key = y.key)
      GROUP BY x.key) tmp
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_22]
            compressed:false
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_20]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_19]
                  sort order:
                  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint)
                  Group By Operator [GBY_18]
                     aggregations:["sum(_col0)","sum(_col1)"]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_16]
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 12 Data size: 1128 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator [GBY_15]
                        |  aggregations:["count(VALUE._col0)"]
                        |  keys:KEY._col0 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 12 Data size: 1128 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Reducer 2 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_14]
                              key expressions:_col0 (type: string)
                              Map-reduce partition columns:_col0 (type: string)
                              sort order:+
                              Statistics:Num rows: 12 Data size: 1128 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions:_col1 (type: bigint)
                              Group By Operator [GBY_13]
                                 aggregations:["count(1)"]
                                 keys:_col0 (type: string)
                                 outputColumnNames:["_col0","_col1"]
                                 Statistics:Num rows: 12 Data size: 1128 Basic stats: COMPLETE Column stats: COMPLETE
                                 Merge Join Operator [MERGEJOIN_27]
                                 |  condition map:[{"":"Left Semi Join 0 to 1"}]
                                 |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                 |  outputColumnNames:["_col0"]
                                 |  Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Map 1 [SIMPLE_EDGE]
                                 |  Reduce Output Operator [RS_7]
                                 |     key expressions:_col0 (type: string)
                                 |     Map-reduce partition columns:_col0 (type: string)
                                 |     sort order:+
                                 |     Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                 |     Select Operator [SEL_1]
                                 |        outputColumnNames:["_col0"]
                                 |        Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                 |        Filter Operator [FIL_25]
                                 |           predicate:key is not null (type: boolean)
                                 |           Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                                 |           TableScan [TS_0]
                                 |              alias:x
                                 |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Map 5 [SIMPLE_EDGE]
                                    Reduce Output Operator [RS_9]
                                       key expressions:_col0 (type: string)
                                       Map-reduce partition columns:_col0 (type: string)
                                       sort order:+
                                       Statistics:Num rows: 205 Data size: 17835 Basic stats: COMPLETE Column stats: COMPLETE
                                       Group By Operator [GBY_5]
                                          keys:_col0 (type: string)
                                          outputColumnNames:["_col0"]
                                          Statistics:Num rows: 205 Data size: 17835 Basic stats: COMPLETE Column stats: COMPLETE
                                          Select Operator [SEL_3]
                                             outputColumnNames:["_col0"]
                                             Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                             Filter Operator [FIL_26]
                                                predicate:key is not null (type: boolean)
                                                Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                                TableScan [TS_2]
                                                   alias:y
                                                   Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain create table abcd (a int, b int, c int, d int)
PREHOOK: type: CREATETABLE
POSTHOOK: query: explain create table abcd (a int, b int, c int, d int)
POSTHOOK: type: CREATETABLE
Stage-0
   Create Table Operator:
      columns:["a int","b int","c int","d int"]
      input format:org.apache.hadoop.mapred.TextInputFormat
      name:default.abcd
      output format:org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
PREHOOK: query: create table abcd (a int, b int, c int, d int)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@abcd
POSTHOOK: query: create table abcd (a int, b int, c int, d int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@abcd
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/in4.txt' INTO TABLE abcd
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@abcd
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/in4.txt' INTO TABLE abcd
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@abcd
PREHOOK: query: explain select a, count(distinct b), count(distinct c), sum(d) from abcd group by a
PREHOOK: type: QUERY
POSTHOOK: query: explain select a, count(distinct b), count(distinct c), sum(d) from abcd group by a
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_7]
            compressed:false
            Statistics:Num rows: 2 Data size: 39 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_5]
            |  aggregations:["count(DISTINCT KEY._col1:0._col0)","count(DISTINCT KEY._col1:1._col0)","sum(VALUE._col2)"]
            |  keys:KEY._col0 (type: int)
            |  outputColumnNames:["_col0","_col1","_col2","_col3"]
            |  Statistics:Num rows: 2 Data size: 39 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
               Reduce Output Operator [RS_4]
                  key expressions:_col0 (type: int), _col1 (type: int), _col2 (type: int)
                  Map-reduce partition columns:_col0 (type: int)
                  sort order:+++
                  Statistics:Num rows: 4 Data size: 78 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col5 (type: bigint)
                  Group By Operator [GBY_3]
                     aggregations:["count(DISTINCT _col1)","count(DISTINCT _col2)","sum(_col3)"]
                     keys:_col0 (type: int), _col1 (type: int), _col2 (type: int)
                     outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
                     Statistics:Num rows: 4 Data size: 78 Basic stats: COMPLETE Column stats: NONE
                     Select Operator [SEL_1]
                        outputColumnNames:["_col0","_col1","_col2","_col3"]
                        Statistics:Num rows: 4 Data size: 78 Basic stats: COMPLETE Column stats: NONE
                        TableScan [TS_0]
                           alias:abcd
                           Statistics:Num rows: 4 Data size: 78 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select a, count(distinct b), count(distinct c), sum(d) from abcd group by a
PREHOOK: type: QUERY
POSTHOOK: query: explain select a, count(distinct b), count(distinct c), sum(d) from abcd group by a
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:false
            Statistics:Num rows: 2 Data size: 39 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_4]
            |  aggregations:["count(DISTINCT KEY._col1:0._col0)","count(DISTINCT KEY._col1:1._col0)","sum(VALUE._col0)"]
            |  keys:KEY._col0 (type: int)
            |  outputColumnNames:["_col0","_col1","_col2","_col3"]
            |  Statistics:Num rows: 2 Data size: 39 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
               Reduce Output Operator [RS_3]
                  key expressions:_col0 (type: int), _col1 (type: int), _col2 (type: int)
                  Map-reduce partition columns:_col0 (type: int)
                  sort order:+++
                  Statistics:Num rows: 4 Data size: 78 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col3 (type: int)
                  Select Operator [SEL_1]
                     outputColumnNames:["_col0","_col1","_col2","_col3"]
                     Statistics:Num rows: 4 Data size: 78 Basic stats: COMPLETE Column stats: NONE
                     TableScan [TS_0]
                        alias:abcd
                        Statistics:Num rows: 4 Data size: 78 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain create table src_rc_merge_test(key int, value string) stored as rcfile
PREHOOK: type: CREATETABLE
POSTHOOK: query: explain create table src_rc_merge_test(key int, value string) stored as rcfile
POSTHOOK: type: CREATETABLE
Stage-0
   Create Table Operator:
      columns:["key int","value string"]
      input format:org.apache.hadoop.hive.ql.io.RCFileInputFormat
      name:default.src_rc_merge_test
      output format:org.apache.hadoop.hive.ql.io.RCFileOutputFormat
PREHOOK: query: create table src_rc_merge_test(key int, value string) stored as rcfile
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@src_rc_merge_test
POSTHOOK: query: create table src_rc_merge_test(key int, value string) stored as rcfile
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@src_rc_merge_test
PREHOOK: query: load data local inpath '../../data/files/smbbucket_1.rc' into table src_rc_merge_test
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@src_rc_merge_test
POSTHOOK: query: load data local inpath '../../data/files/smbbucket_1.rc' into table src_rc_merge_test
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@src_rc_merge_test
PREHOOK: query: explain create table tgt_rc_merge_test(key int, value string) stored as rcfile
PREHOOK: type: CREATETABLE
POSTHOOK: query: explain create table tgt_rc_merge_test(key int, value string) stored as rcfile
POSTHOOK: type: CREATETABLE
Stage-0
   Create Table Operator:
      columns:["key int","value string"]
      input format:org.apache.hadoop.hive.ql.io.RCFileInputFormat
      name:default.tgt_rc_merge_test
      output format:org.apache.hadoop.hive.ql.io.RCFileOutputFormat
PREHOOK: query: create table tgt_rc_merge_test(key int, value string) stored as rcfile
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tgt_rc_merge_test
POSTHOOK: query: create table tgt_rc_merge_test(key int, value string) stored as rcfile
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tgt_rc_merge_test
PREHOOK: query: insert into table tgt_rc_merge_test select * from src_rc_merge_test
PREHOOK: type: QUERY
PREHOOK: Input: default@src_rc_merge_test
PREHOOK: Output: default@tgt_rc_merge_test
POSTHOOK: query: insert into table tgt_rc_merge_test select * from src_rc_merge_test
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src_rc_merge_test
POSTHOOK: Output: default@tgt_rc_merge_test
POSTHOOK: Lineage: tgt_rc_merge_test.key SIMPLE [(src_rc_merge_test)src_rc_merge_test.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: tgt_rc_merge_test.value SIMPLE [(src_rc_merge_test)src_rc_merge_test.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: show table extended like `tgt_rc_merge_test`
PREHOOK: type: SHOW_TABLESTATUS
POSTHOOK: query: show table extended like `tgt_rc_merge_test`
POSTHOOK: type: SHOW_TABLESTATUS
tableName:tgt_rc_merge_test
#### A masked pattern was here ####
inputformat:org.apache.hadoop.hive.ql.io.RCFileInputFormat
outputformat:org.apache.hadoop.hive.ql.io.RCFileOutputFormat
columns:struct columns { i32 key, string value}
partitioned:false
partitionColumns:
totalNumberFiles:1
totalFileSize:171
maxFileSize:171
minFileSize:171
#### A masked pattern was here ####

PREHOOK: query: explain select count(1) from tgt_rc_merge_test
PREHOOK: type: QUERY
POSTHOOK: query: explain select count(1) from tgt_rc_merge_test
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_4]
            |  aggregations:["count(1)"]
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 1 [SIMPLE_EDGE]
               Reduce Output Operator [RS_3]
                  sort order:
                  Statistics:Num rows: 5 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_1]
                     Statistics:Num rows: 5 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                     TableScan [TS_0]
                        alias:tgt_rc_merge_test
                        Statistics:Num rows: 5 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select sum(hash(key)), sum(hash(value)) from tgt_rc_merge_test
PREHOOK: type: QUERY
POSTHOOK: query: explain select sum(hash(key)), sum(hash(value)) from tgt_rc_merge_test
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_4]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
               Reduce Output Operator [RS_3]
                  sort order:
                  Statistics:Num rows: 5 Data size: 32 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: int), _col1 (type: int)
                  Select Operator [SEL_1]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 5 Data size: 32 Basic stats: COMPLETE Column stats: NONE
                     TableScan [TS_0]
                        alias:tgt_rc_merge_test
                        Statistics:Num rows: 5 Data size: 32 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: alter table tgt_rc_merge_test concatenate
PREHOOK: type: ALTER_TABLE_MERGE
PREHOOK: Input: default@tgt_rc_merge_test
PREHOOK: Output: default@tgt_rc_merge_test
POSTHOOK: query: alter table tgt_rc_merge_test concatenate
POSTHOOK: type: ALTER_TABLE_MERGE
POSTHOOK: Input: default@tgt_rc_merge_test
POSTHOOK: Output: default@tgt_rc_merge_test
PREHOOK: query: show table extended like `tgt_rc_merge_test`
PREHOOK: type: SHOW_TABLESTATUS
POSTHOOK: query: show table extended like `tgt_rc_merge_test`
POSTHOOK: type: SHOW_TABLESTATUS
tableName:tgt_rc_merge_test
#### A masked pattern was here ####
inputformat:org.apache.hadoop.hive.ql.io.RCFileInputFormat
outputformat:org.apache.hadoop.hive.ql.io.RCFileOutputFormat
columns:struct columns { i32 key, string value}
partitioned:false
partitionColumns:
totalNumberFiles:1
totalFileSize:171
maxFileSize:171
minFileSize:171
#### A masked pattern was here ####

PREHOOK: query: explain select count(1) from tgt_rc_merge_test
PREHOOK: type: QUERY
POSTHOOK: query: explain select count(1) from tgt_rc_merge_test
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_4]
            |  aggregations:["count(1)"]
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 1 [SIMPLE_EDGE]
               Reduce Output Operator [RS_3]
                  sort order:
                  Statistics:Num rows: 1 Data size: 171 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_1]
                     Statistics:Num rows: 1 Data size: 171 Basic stats: COMPLETE Column stats: COMPLETE
                     TableScan [TS_0]
                        alias:tgt_rc_merge_test
                        Statistics:Num rows: 1 Data size: 171 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select sum(hash(key)), sum(hash(value)) from tgt_rc_merge_test
PREHOOK: type: QUERY
POSTHOOK: query: explain select sum(hash(key)), sum(hash(value)) from tgt_rc_merge_test
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_4]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
               Reduce Output Operator [RS_3]
                  sort order:
                  Statistics:Num rows: 1 Data size: 171 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: int), _col1 (type: int)
                  Select Operator [SEL_1]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 1 Data size: 171 Basic stats: COMPLETE Column stats: NONE
                     TableScan [TS_0]
                        alias:tgt_rc_merge_test
                        Statistics:Num rows: 1 Data size: 171 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: drop table src_rc_merge_test
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@src_rc_merge_test
PREHOOK: Output: default@src_rc_merge_test
POSTHOOK: query: drop table src_rc_merge_test
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@src_rc_merge_test
POSTHOOK: Output: default@src_rc_merge_test
PREHOOK: query: drop table tgt_rc_merge_test
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@tgt_rc_merge_test
PREHOOK: Output: default@tgt_rc_merge_test
POSTHOOK: query: drop table tgt_rc_merge_test
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@tgt_rc_merge_test
POSTHOOK: Output: default@tgt_rc_merge_test
PREHOOK: query: explain select src.key from src cross join src src2
PREHOOK: type: QUERY
POSTHOOK: query: explain select src.key from src cross join src src2
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_9]
            compressed:true
            Statistics:Num rows: 550 Data size: 47850 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_11]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{}
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 550 Data size: 47850 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_5]
            |     sort order:
            |     Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
            |     value expressions:_col0 (type: string)
            |     Select Operator [SEL_1]
            |        outputColumnNames:["_col0"]
            |        Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
            |        TableScan [TS_0]
            |           alias:src
            |           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_6]
                  sort order:
                  Statistics:Num rows: 500 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                  Select Operator [SEL_3]
                     Statistics:Num rows: 500 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
                     TableScan [TS_2]
                        alias:src
                        Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain create table nzhang_Tmp(a int, b string)
PREHOOK: type: CREATETABLE
POSTHOOK: query: explain create table nzhang_Tmp(a int, b string)
POSTHOOK: type: CREATETABLE
Stage-0
   Create Table Operator:
      columns:["a int","b string"]
      input format:org.apache.hadoop.mapred.TextInputFormat
      name:default.nzhang_Tmp
      output format:org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
PREHOOK: query: create table nzhang_Tmp(a int, b string)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@nzhang_Tmp
POSTHOOK: query: create table nzhang_Tmp(a int, b string)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@nzhang_Tmp
PREHOOK: query: explain create table nzhang_CTAS1 as select key k, value from src sort by k, value limit 10
PREHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: query: explain create table nzhang_CTAS1 as select key k, value from src sort by k, value limit 10
POSTHOOK: type: CREATETABLE_AS_SELECT
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-3
   Stats-Aggr Operator
      Stage-4
         Create Table Operator:
            columns:["k string","value string"]
            input format:org.apache.hadoop.mapred.TextInputFormat
            name:default.nzhang_CTAS1
            output format:org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
            Stage-2
               Dependency Collection{}
                  Stage-1
                     Reducer 3
                     File Output Operator [FS_8]
                        compressed:true
                        Statistics:Num rows: 10 Data size: 1780 Basic stats: COMPLETE Column stats: COMPLETE
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.nzhang_CTAS1","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                        Limit [LIM_7]
                           Number of rows:10
                           Statistics:Num rows: 10 Data size: 1780 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_6]
                           |  outputColumnNames:["_col0","_col1"]
                           |  Statistics:Num rows: 10 Data size: 1780 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 2 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_5]
                                 key expressions:_col0 (type: string), _col1 (type: string)
                                 sort order:++
                                 Statistics:Num rows: 10 Data size: 1780 Basic stats: COMPLETE Column stats: COMPLETE
                                 Limit [LIM_4]
                                    Number of rows:10
                                    Statistics:Num rows: 10 Data size: 1780 Basic stats: COMPLETE Column stats: COMPLETE
                                    Select Operator [SEL_3]
                                    |  outputColumnNames:["_col0","_col1"]
                                    |  Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 1 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_2]
                                          key expressions:_col0 (type: string), _col1 (type: string)
                                          sort order:++
                                          Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                                          Select Operator [SEL_1]
                                             outputColumnNames:["_col0","_col1"]
                                             Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                                             TableScan [TS_0]
                                                alias:src
                                                Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
            Stage-0
               Move Operator
                   Please refer to the previous Stage-1
PREHOOK: query: create table nzhang_CTAS1 as select key k, value from src sort by k, value limit 10
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@src
PREHOOK: Output: database:default
PREHOOK: Output: default@nzhang_CTAS1
POSTHOOK: query: create table nzhang_CTAS1 as select key k, value from src sort by k, value limit 10
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@src
POSTHOOK: Output: database:default
POSTHOOK: Output: default@nzhang_CTAS1
PREHOOK: query: explain create table nzhang_ctas3 row format serde "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe" stored as RCFile as select key/2 half_key, concat(value, "_con") conb  from src sort by half_key, conb limit 10
PREHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: query: explain create table nzhang_ctas3 row format serde "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe" stored as RCFile as select key/2 half_key, concat(value, "_con") conb  from src sort by half_key, conb limit 10
POSTHOOK: type: CREATETABLE_AS_SELECT
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-3
   Stats-Aggr Operator
      Stage-4
         Create Table Operator:
            columns:["half_key double","conb string"]
            input format:org.apache.hadoop.hive.ql.io.RCFileInputFormat
            name:default.nzhang_ctas3
            output format:org.apache.hadoop.hive.ql.io.RCFileOutputFormat
            Stage-2
               Dependency Collection{}
                  Stage-1
                     Reducer 3
                     File Output Operator [FS_8]
                        compressed:true
                        Statistics:Num rows: 10 Data size: 1920 Basic stats: COMPLETE Column stats: COMPLETE
                        table:{"serde:":"org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe","name:":"default.nzhang_ctas3","input format:":"org.apache.hadoop.hive.ql.io.RCFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.RCFileOutputFormat"}
                        Limit [LIM_7]
                           Number of rows:10
                           Statistics:Num rows: 10 Data size: 1920 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_6]
                           |  outputColumnNames:["_col0","_col1"]
                           |  Statistics:Num rows: 10 Data size: 1920 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 2 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_5]
                                 key expressions:_col0 (type: double), _col1 (type: string)
                                 sort order:++
                                 Statistics:Num rows: 10 Data size: 1920 Basic stats: COMPLETE Column stats: COMPLETE
                                 Limit [LIM_4]
                                    Number of rows:10
                                    Statistics:Num rows: 10 Data size: 1920 Basic stats: COMPLETE Column stats: COMPLETE
                                    Select Operator [SEL_3]
                                    |  outputColumnNames:["_col0","_col1"]
                                    |  Statistics:Num rows: 500 Data size: 96000 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 1 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_2]
                                          key expressions:_col0 (type: double), _col1 (type: string)
                                          sort order:++
                                          Statistics:Num rows: 500 Data size: 96000 Basic stats: COMPLETE Column stats: COMPLETE
                                          Select Operator [SEL_1]
                                             outputColumnNames:["_col0","_col1"]
                                             Statistics:Num rows: 500 Data size: 96000 Basic stats: COMPLETE Column stats: COMPLETE
                                             TableScan [TS_0]
                                                alias:src
                                                Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
            Stage-0
               Move Operator
                   Please refer to the previous Stage-1
PREHOOK: query: create table nzhang_ctas3 row format serde "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe" stored as RCFile as select key/2 half_key, concat(value, "_con") conb  from src sort by half_key, conb limit 10
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@src
PREHOOK: Output: database:default
PREHOOK: Output: default@nzhang_ctas3
POSTHOOK: query: create table nzhang_ctas3 row format serde "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe" stored as RCFile as select key/2 half_key, concat(value, "_con") conb  from src sort by half_key, conb limit 10
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@src
POSTHOOK: Output: database:default
POSTHOOK: Output: default@nzhang_ctas3
PREHOOK: query: explain create table if not exists nzhang_ctas3 as select key, value from src sort by key, value limit 2
PREHOOK: type: CREATETABLE
POSTHOOK: query: explain create table if not exists nzhang_ctas3 as select key, value from src sort by key, value limit 2
POSTHOOK: type: CREATETABLE
PREHOOK: query: create table if not exists nzhang_ctas3 as select key, value from src sort by key, value limit 2
PREHOOK: type: CREATETABLE
POSTHOOK: query: create table if not exists nzhang_ctas3 as select key, value from src sort by key, value limit 2
POSTHOOK: type: CREATETABLE
PREHOOK: query: explain create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
PREHOOK: type: CREATETABLE
POSTHOOK: query: explain create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
POSTHOOK: type: CREATETABLE
Stage-0
   Create Table Operator:
      # buckets:2
      bucket columns:["a"]
      columns:["a int","b varchar(128)"]
      input format:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
      name:default.acid_dtt
      output format:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
PREHOOK: query: create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@acid_dtt
POSTHOOK: query: create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@acid_dtt
PREHOOK: query: explain
select src1.key as k1, src1.value as v1, 
       src2.key as k2, src2.value as v2 FROM 
  (select * FROM src WHERE src.key < 10) src1 
    JOIN 
  (select * FROM src WHERE src.key < 10) src2
  SORT BY k1, v1, k2, v2
PREHOOK: type: QUERY
POSTHOOK: query: explain
select src1.key as k1, src1.value as v1, 
       src2.key as k2, src2.value as v2 FROM 
  (select * FROM src WHERE src.key < 10) src1 
    JOIN 
  (select * FROM src WHERE src.key < 10) src2
  SORT BY k1, v1, k2, v2
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_12]
            compressed:true
            Statistics:Num rows: 13778 Data size: 4904968 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_11]
            |  outputColumnNames:["_col0","_col1","_col2","_col3"]
            |  Statistics:Num rows: 13778 Data size: 4904968 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 2 [SIMPLE_EDGE]
               Reduce Output Operator [RS_10]
                  key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
                  sort order:++++
                  Statistics:Num rows: 13778 Data size: 4904968 Basic stats: COMPLETE Column stats: COMPLETE
                  Merge Join Operator [MERGEJOIN_15]
                  |  condition map:[{"":"Inner Join 0 to 1"}]
                  |  keys:{}
                  |  outputColumnNames:["_col0","_col1","_col2","_col3"]
                  |  Statistics:Num rows: 13778 Data size: 4904968 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 1 [SIMPLE_EDGE]
                  |  Reduce Output Operator [RS_6]
                  |     sort order:
                  |     Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                  |     value expressions:_col0 (type: string), _col1 (type: string)
                  |     Select Operator [SEL_2]
                  |        outputColumnNames:["_col0","_col1"]
                  |        Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                  |        Filter Operator [FIL_13]
                  |           predicate:(key < 10) (type: boolean)
                  |           Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                  |           TableScan [TS_0]
                  |              alias:src
                  |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 4 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_7]
                        sort order:
                        Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col0 (type: string), _col1 (type: string)
                        Select Operator [SEL_5]
                           outputColumnNames:["_col0","_col1"]
                           Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                           Filter Operator [FIL_14]
                              predicate:(key < 10) (type: boolean)
                              Statistics:Num rows: 166 Data size: 29548 Basic stats: COMPLETE Column stats: COMPLETE
                              TableScan [TS_3]
                                 alias:src
                                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: CREATE TABLE myinput1(key int, value int)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@myinput1
POSTHOOK: query: CREATE TABLE myinput1(key int, value int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@myinput1
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/in8.txt' INTO TABLE myinput1
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@myinput1
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/in8.txt' INTO TABLE myinput1
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@myinput1
PREHOOK: query: explain select * from myinput1 a join myinput1 b on a.key<=>b.value
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from myinput1 a join myinput1 b on a.key<=>b.value
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_5]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_7]
               |  condition map:[{"":"Inner Join 0 to 1"}]
               |  keys:{"1":"value (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6"]
               |  Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_2]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_3]
                     key expressions:value (type: int)
                     Map-reduce partition columns:value (type: int)
                     sort order:+
                     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                     value expressions:key (type: int)
                     TableScan [TS_1]
                        alias:b
                        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select * from myinput1 a join myinput1 b on a.key<=>b.value join myinput1 c on a.key=c.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from myinput1 a join myinput1 b on a.key<=>b.value join myinput1 c on a.key=c.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_11]
            compressed:true
            Statistics:Num rows: 4 Data size: 37 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_10]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 4 Data size: 37 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_21]
               |  condition map:[{"":"Inner Join 0 to 1"},{"":"Inner Join 0 to 2"}]
               |  keys:{"2":"key (type: int)","1":"value (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6","_col10","_col11"]
               |  Statistics:Num rows: 4 Data size: 37 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_4]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     Filter Operator [FIL_18]
               |        predicate:key is not null (type: boolean)
               |        Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_0]
               |           alias:a
               |           Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_6]
               |     key expressions:value (type: int)
               |     Map-reduce partition columns:value (type: int)
               |     sort order:+
               |     Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:key (type: int)
               |     Filter Operator [FIL_19]
               |        predicate:value is not null (type: boolean)
               |        Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_1]
               |           alias:b
               |           Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 4 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_8]
                     key expressions:key (type: int)
                     Map-reduce partition columns:key (type: int)
                     sort order:+
                     Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                     value expressions:value (type: int)
                     Filter Operator [FIL_20]
                        predicate:key is not null (type: boolean)
                        Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                        TableScan [TS_2]
                           alias:c
                           Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select * from myinput1 a join myinput1 b on a.key<=>b.value join myinput1 c on a.key<=>c.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from myinput1 a join myinput1 b on a.key<=>b.value join myinput1 c on a.key<=>c.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_8]
            compressed:true
            Statistics:Num rows: 6 Data size: 57 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_7]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 6 Data size: 57 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_9]
               |  condition map:[{"":"Inner Join 0 to 1"},{"":"Inner Join 0 to 2"}]
               |  keys:{"2":"key (type: int)","1":"value (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6","_col10","_col11"]
               |  Statistics:Num rows: 6 Data size: 57 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_3]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_4]
               |     key expressions:value (type: int)
               |     Map-reduce partition columns:value (type: int)
               |     sort order:+
               |     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:key (type: int)
               |     TableScan [TS_1]
               |        alias:b
               |        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 4 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_5]
                     key expressions:key (type: int)
                     Map-reduce partition columns:key (type: int)
                     sort order:+
                     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                     value expressions:value (type: int)
                     TableScan [TS_2]
                        alias:c
                        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select * from myinput1 a join myinput1 b on a.key<=>b.value AND a.value=b.key join myinput1 c on a.key<=>c.key AND a.value=c.value
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from myinput1 a join myinput1 b on a.key<=>b.value AND a.value=b.key join myinput1 c on a.key<=>c.key AND a.value=c.value
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_11]
            compressed:true
            Statistics:Num rows: 4 Data size: 37 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_10]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 4 Data size: 37 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_15]
               |  condition map:[{"":"Inner Join 0 to 1"},{"":"Inner Join 0 to 2"}]
               |  keys:{"2":"key (type: int), value (type: int)","1":"value (type: int), key (type: int)","0":"key (type: int), value (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6","_col10","_col11"]
               |  Statistics:Num rows: 4 Data size: 37 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_4]
               |     key expressions:key (type: int), value (type: int)
               |     Map-reduce partition columns:key (type: int), value (type: int)
               |     sort order:++
               |     Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
               |     Filter Operator [FIL_12]
               |        predicate:value is not null (type: boolean)
               |        Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_0]
               |           alias:a
               |           Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_6]
               |     key expressions:value (type: int), key (type: int)
               |     Map-reduce partition columns:value (type: int), key (type: int)
               |     sort order:++
               |     Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
               |     Filter Operator [FIL_13]
               |        predicate:key is not null (type: boolean)
               |        Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_1]
               |           alias:b
               |           Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 4 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_8]
                     key expressions:key (type: int), value (type: int)
                     Map-reduce partition columns:key (type: int), value (type: int)
                     sort order:++
                     Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                     Filter Operator [FIL_14]
                        predicate:value is not null (type: boolean)
                        Statistics:Num rows: 2 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                        TableScan [TS_2]
                           alias:c
                           Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select * from myinput1 a join myinput1 b on a.key<=>b.value AND a.value<=>b.key join myinput1 c on a.key<=>c.key AND a.value<=>c.value
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from myinput1 a join myinput1 b on a.key<=>b.value AND a.value<=>b.key join myinput1 c on a.key<=>c.key AND a.value<=>c.value
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_8]
            compressed:true
            Statistics:Num rows: 6 Data size: 57 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_7]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 6 Data size: 57 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_9]
               |  condition map:[{"":"Inner Join 0 to 1"},{"":"Inner Join 0 to 2"}]
               |  keys:{"2":"key (type: int), value (type: int)","1":"value (type: int), key (type: int)","0":"key (type: int), value (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6","_col10","_col11"]
               |  Statistics:Num rows: 6 Data size: 57 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_3]
               |     key expressions:key (type: int), value (type: int)
               |     Map-reduce partition columns:key (type: int), value (type: int)
               |     sort order:++
               |     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_4]
               |     key expressions:value (type: int), key (type: int)
               |     Map-reduce partition columns:value (type: int), key (type: int)
               |     sort order:++
               |     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |     TableScan [TS_1]
               |        alias:b
               |        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 4 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_5]
                     key expressions:key (type: int), value (type: int)
                     Map-reduce partition columns:key (type: int), value (type: int)
                     sort order:++
                     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                     TableScan [TS_2]
                        alias:c
                        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select * FROM myinput1 a LEFT OUTER JOIN myinput1 b ON a.key<=>b.value
PREHOOK: type: QUERY
POSTHOOK: query: explain select * FROM myinput1 a LEFT OUTER JOIN myinput1 b ON a.key<=>b.value
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_5]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_7]
               |  condition map:[{"":"Left Outer Join0 to 1"}]
               |  keys:{"1":"value (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6"]
               |  Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_2]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_3]
                     key expressions:value (type: int)
                     Map-reduce partition columns:value (type: int)
                     sort order:+
                     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                     value expressions:key (type: int)
                     TableScan [TS_1]
                        alias:b
                        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select * FROM myinput1 a RIGHT OUTER JOIN myinput1 b ON a.key<=>b.value
PREHOOK: type: QUERY
POSTHOOK: query: explain select * FROM myinput1 a RIGHT OUTER JOIN myinput1 b ON a.key<=>b.value
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_5]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_7]
               |  condition map:[{"":"Right Outer Join0 to 1"}]
               |  keys:{"1":"value (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6"]
               |  Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_2]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_3]
                     key expressions:value (type: int)
                     Map-reduce partition columns:value (type: int)
                     sort order:+
                     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                     value expressions:key (type: int)
                     TableScan [TS_1]
                        alias:b
                        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select * FROM myinput1 a FULL OUTER JOIN myinput1 b ON a.key<=>b.value
PREHOOK: type: QUERY
POSTHOOK: query: explain select * FROM myinput1 a FULL OUTER JOIN myinput1 b ON a.key<=>b.value
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_5]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_7]
               |  condition map:[{"":"Outer Join 0 to 1"}]
               |  keys:{"1":"value (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6"]
               |  Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_2]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_3]
                     key expressions:value (type: int)
                     Map-reduce partition columns:value (type: int)
                     sort order:+
                     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                     value expressions:key (type: int)
                     TableScan [TS_1]
                        alias:b
                        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select /*+ MAPJOIN(b) */ * FROM myinput1 a JOIN myinput1 b ON a.key<=>b.value
PREHOOK: type: QUERY
POSTHOOK: query: explain select /*+ MAPJOIN(b) */ * FROM myinput1 a JOIN myinput1 b ON a.key<=>b.value
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_5]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_7]
               |  condition map:[{"":"Inner Join 0 to 1"}]
               |  keys:{"1":"value (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6"]
               |  Statistics:Num rows: 3 Data size: 28 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_2]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_3]
                     key expressions:value (type: int)
                     Map-reduce partition columns:value (type: int)
                     sort order:+
                     Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                     value expressions:key (type: int)
                     TableScan [TS_1]
                        alias:b
                        Statistics:Num rows: 3 Data size: 26 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: CREATE TABLE smb_input(key int, value int)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@smb_input
POSTHOOK: query: CREATE TABLE smb_input(key int, value int)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@smb_input
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/in4.txt' into table smb_input
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@smb_input
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/in4.txt' into table smb_input
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@smb_input
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/in5.txt' into table smb_input
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@smb_input
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/in5.txt' into table smb_input
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@smb_input
PREHOOK: query: CREATE TABLE smb_input1(key int, value int) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@smb_input1
POSTHOOK: query: CREATE TABLE smb_input1(key int, value int) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@smb_input1
PREHOOK: query: CREATE TABLE smb_input2(key int, value int) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@smb_input2
POSTHOOK: query: CREATE TABLE smb_input2(key int, value int) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@smb_input2
PREHOOK: query: from smb_input
insert overwrite table smb_input1 select *
insert overwrite table smb_input2 select *
PREHOOK: type: QUERY
PREHOOK: Input: default@smb_input
PREHOOK: Output: default@smb_input1
PREHOOK: Output: default@smb_input2
POSTHOOK: query: from smb_input
insert overwrite table smb_input1 select *
insert overwrite table smb_input2 select *
POSTHOOK: type: QUERY
POSTHOOK: Input: default@smb_input
POSTHOOK: Output: default@smb_input1
POSTHOOK: Output: default@smb_input2
POSTHOOK: Lineage: smb_input1.key SIMPLE [(smb_input)smb_input.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: smb_input1.value SIMPLE [(smb_input)smb_input.FieldSchema(name:value, type:int, comment:null), ]
POSTHOOK: Lineage: smb_input2.key SIMPLE [(smb_input)smb_input.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: smb_input2.value SIMPLE [(smb_input)smb_input.FieldSchema(name:value, type:int, comment:null), ]
PREHOOK: query: explain select /*+ MAPJOIN(a) */ * FROM smb_input1 a JOIN smb_input1 b ON a.key <=> b.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select /*+ MAPJOIN(a) */ * FROM smb_input1 a JOIN smb_input1 b ON a.key <=> b.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_5]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_7]
               |  condition map:[{"":"Inner Join 0 to 1"}]
               |  keys:{"1":"key (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6"]
               |  Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_2]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_3]
                     key expressions:key (type: int)
                     Map-reduce partition columns:key (type: int)
                     sort order:+
                     Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
                     value expressions:value (type: int)
                     TableScan [TS_1]
                        alias:b
                        Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select /*+ MAPJOIN(a) */ * FROM smb_input1 a JOIN smb_input1 b ON a.key <=> b.key AND a.value <=> b.value
PREHOOK: type: QUERY
POSTHOOK: query: explain select /*+ MAPJOIN(a) */ * FROM smb_input1 a JOIN smb_input1 b ON a.key <=> b.key AND a.value <=> b.value
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_5]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_7]
               |  condition map:[{"":"Inner Join 0 to 1"}]
               |  keys:{"1":"key (type: int), value (type: int)","0":"key (type: int), value (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6"]
               |  Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_2]
               |     key expressions:key (type: int), value (type: int)
               |     Map-reduce partition columns:key (type: int), value (type: int)
               |     sort order:++
               |     Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_3]
                     key expressions:key (type: int), value (type: int)
                     Map-reduce partition columns:key (type: int), value (type: int)
                     sort order:++
                     Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
                     TableScan [TS_1]
                        alias:b
                        Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select /*+ MAPJOIN(a) */ * FROM smb_input1 a RIGHT OUTER JOIN smb_input1 b ON a.key <=> b.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select /*+ MAPJOIN(a) */ * FROM smb_input1 a RIGHT OUTER JOIN smb_input1 b ON a.key <=> b.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_5]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_7]
               |  condition map:[{"":"Right Outer Join0 to 1"}]
               |  keys:{"1":"key (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6"]
               |  Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_2]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_3]
                     key expressions:key (type: int)
                     Map-reduce partition columns:key (type: int)
                     sort order:+
                     Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
                     value expressions:value (type: int)
                     TableScan [TS_1]
                        alias:b
                        Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select /*+ MAPJOIN(b) */ * FROM smb_input1 a JOIN smb_input1 b ON a.key <=> b.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select /*+ MAPJOIN(b) */ * FROM smb_input1 a JOIN smb_input1 b ON a.key <=> b.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_5]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_7]
               |  condition map:[{"":"Inner Join 0 to 1"}]
               |  keys:{"1":"key (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6"]
               |  Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_2]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_3]
                     key expressions:key (type: int)
                     Map-reduce partition columns:key (type: int)
                     sort order:+
                     Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
                     value expressions:value (type: int)
                     TableScan [TS_1]
                        alias:b
                        Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select /*+ MAPJOIN(b) */ * FROM smb_input1 a LEFT OUTER JOIN smb_input1 b ON a.key <=> b.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select /*+ MAPJOIN(b) */ * FROM smb_input1 a LEFT OUTER JOIN smb_input1 b ON a.key <=> b.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Less_than_equal_greater_than].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_6]
            compressed:true
            Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_5]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_7]
               |  condition map:[{"":"Left Outer Join0 to 1"}]
               |  keys:{"1":"key (type: int)","0":"key (type: int)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6"]
               |  Statistics:Num rows: 28 Data size: 209 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_2]
               |     key expressions:key (type: int)
               |     Map-reduce partition columns:key (type: int)
               |     sort order:+
               |     Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: int)
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_3]
                     key expressions:key (type: int)
                     Map-reduce partition columns:key (type: int)
                     sort order:+
                     Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
                     value expressions:value (type: int)
                     TableScan [TS_1]
                        alias:b
                        Statistics:Num rows: 26 Data size: 190 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: drop table sales
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table sales
POSTHOOK: type: DROPTABLE
PREHOOK: query: drop table things
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table things
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE TABLE sales (name STRING, id INT)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@sales
POSTHOOK: query: CREATE TABLE sales (name STRING, id INT)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@sales
PREHOOK: query: CREATE TABLE things (id INT, name STRING) partitioned by (ds string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@things
POSTHOOK: query: CREATE TABLE things (id INT, name STRING) partitioned by (ds string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@things
PREHOOK: query: load data local inpath '../../data/files/sales.txt' INTO TABLE sales
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@sales
POSTHOOK: query: load data local inpath '../../data/files/sales.txt' INTO TABLE sales
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@sales
PREHOOK: query: load data local inpath '../../data/files/things.txt' INTO TABLE things partition(ds='2011-10-23')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@things
POSTHOOK: query: load data local inpath '../../data/files/things.txt' INTO TABLE things partition(ds='2011-10-23')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@things
POSTHOOK: Output: default@things@ds=2011-10-23
PREHOOK: query: load data local inpath '../../data/files/things2.txt' INTO TABLE things partition(ds='2011-10-24')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@things
POSTHOOK: query: load data local inpath '../../data/files/things2.txt' INTO TABLE things partition(ds='2011-10-24')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@things
POSTHOOK: Output: default@things@ds=2011-10-24
PREHOOK: query: explain select name,id FROM sales LEFT SEMI JOIN things ON (sales.id = things.id)
PREHOOK: type: QUERY
POSTHOOK: query: explain select name,id FROM sales LEFT SEMI JOIN things ON (sales.id = things.id)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_12]
            compressed:true
            Statistics:Num rows: 1 Data size: 14 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_17]
            |  condition map:[{"":"Left Semi Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: int)","0":"_col1 (type: int)"}
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 14 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_7]
            |     key expressions:_col1 (type: int)
            |     Map-reduce partition columns:_col1 (type: int)
            |     sort order:+
            |     Statistics:Num rows: 1 Data size: 13 Basic stats: COMPLETE Column stats: NONE
            |     value expressions:_col0 (type: string)
            |     Select Operator [SEL_1]
            |        outputColumnNames:["_col0","_col1"]
            |        Statistics:Num rows: 1 Data size: 13 Basic stats: COMPLETE Column stats: NONE
            |        Filter Operator [FIL_15]
            |           predicate:id is not null (type: boolean)
            |           Statistics:Num rows: 1 Data size: 13 Basic stats: COMPLETE Column stats: NONE
            |           TableScan [TS_0]
            |              alias:sales
            |              Statistics:Num rows: 1 Data size: 13 Basic stats: COMPLETE Column stats: NONE
            |<-Map 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_9]
                  key expressions:_col0 (type: int)
                  Map-reduce partition columns:_col0 (type: int)
                  sort order:+
                  Statistics:Num rows: 1 Data size: 6 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator [GBY_5]
                     keys:_col0 (type: int)
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 1 Data size: 6 Basic stats: COMPLETE Column stats: NONE
                     Select Operator [SEL_3]
                        outputColumnNames:["_col0"]
                        Statistics:Num rows: 1 Data size: 6 Basic stats: COMPLETE Column stats: NONE
                        Filter Operator [FIL_16]
                           predicate:id is not null (type: boolean)
                           Statistics:Num rows: 1 Data size: 6 Basic stats: COMPLETE Column stats: NONE
                           TableScan [TS_2]
                              alias:things
                              Statistics:Num rows: 2 Data size: 12 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: drop table sales
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@sales
PREHOOK: Output: default@sales
POSTHOOK: query: drop table sales
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@sales
POSTHOOK: Output: default@sales
PREHOOK: query: drop table things
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@things
PREHOOK: Output: default@things
POSTHOOK: query: drop table things
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@things
POSTHOOK: Output: default@things
PREHOOK: query: explain select srcpart.key from srcpart join src on (srcpart.value=src.value) join src1 on (srcpart.key=src1.key) where srcpart.value > 'val_450'
PREHOOK: type: QUERY
POSTHOOK: query: explain select srcpart.key from srcpart join src on (srcpart.value=src.value) join src1 on (srcpart.key=src1.key) where srcpart.value > 'val_450'
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
Map 1 <- Map 3 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_19]
            compressed:true
            Statistics:Num rows: 555 Data size: 48285 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_29]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: string)","0":"_col1 (type: string)"}
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 555 Data size: 48285 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_14]
            |     key expressions:_col1 (type: string)
            |     Map-reduce partition columns:_col1 (type: string)
            |     sort order:+
            |     Statistics:Num rows: 241 Data size: 42898 Basic stats: COMPLETE Column stats: COMPLETE
            |     value expressions:_col0 (type: string)
            |     Map Join Operator [MAPJOIN_28]
            |     |  condition map:[{"":"Inner Join 0 to 1"}]
            |     |  keys:{"Map 1":"_col0 (type: string)","Map 3":"_col0 (type: string)"}
            |     |  outputColumnNames:["_col0","_col1"]
            |     |  Statistics:Num rows: 241 Data size: 42898 Basic stats: COMPLETE Column stats: COMPLETE
            |     |<-Map 3 [BROADCAST_EDGE]
            |     |  Reduce Output Operator [RS_11]
            |     |     key expressions:_col0 (type: string)
            |     |     Map-reduce partition columns:_col0 (type: string)
            |     |     sort order:+
            |     |     Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
            |     |     Select Operator [SEL_4]
            |     |        outputColumnNames:["_col0"]
            |     |        Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
            |     |        Filter Operator [FIL_26]
            |     |           predicate:key is not null (type: boolean)
            |     |           Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
            |     |           TableScan [TS_3]
            |     |              alias:src1
            |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: COMPLETE
            |     |<-Select Operator [SEL_2]
            |           outputColumnNames:["_col0","_col1"]
            |           Statistics:Num rows: 666 Data size: 118548 Basic stats: COMPLETE Column stats: COMPLETE
            |           Filter Operator [FIL_25]
            |              predicate:(((value > 'val_450') and key is not null) and value is not null) (type: boolean)
            |              Statistics:Num rows: 666 Data size: 118548 Basic stats: COMPLETE Column stats: COMPLETE
            |              TableScan [TS_0]
            |                 alias:srcpart
            |                 Statistics:Num rows: 2000 Data size: 21248 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 4 [SIMPLE_EDGE]
               Reduce Output Operator [RS_16]
                  key expressions:_col0 (type: string)
                  Map-reduce partition columns:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 166 Data size: 15106 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_7]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 166 Data size: 15106 Basic stats: COMPLETE Column stats: COMPLETE
                     Filter Operator [FIL_27]
                        predicate:(value > 'val_450') (type: boolean)
                        Statistics:Num rows: 166 Data size: 15106 Basic stats: COMPLETE Column stats: COMPLETE
                        TableScan [TS_5]
                           alias:src
                           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select srcpart.key from srcpart join src on (srcpart.value=src.value) join src1 on (srcpart.key=src1.key) where srcpart.value > 'val_450'
PREHOOK: type: QUERY
POSTHOOK: query: explain select srcpart.key from srcpart join src on (srcpart.value=src.value) join src1 on (srcpart.key=src1.key) where srcpart.value > 'val_450'
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
Map 1 <- Map 3 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_19]
            compressed:true
            Statistics:Num rows: 555 Data size: 48285 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_29]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: string)","0":"_col1 (type: string)"}
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 555 Data size: 48285 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_14]
            |     key expressions:_col1 (type: string)
            |     Map-reduce partition columns:_col1 (type: string)
            |     sort order:+
            |     Statistics:Num rows: 241 Data size: 42898 Basic stats: COMPLETE Column stats: COMPLETE
            |     value expressions:_col0 (type: string)
            |     Map Join Operator [MAPJOIN_28]
            |     |  condition map:[{"":"Inner Join 0 to 1"}]
            |     |  keys:{"Map 1":"_col0 (type: string)","Map 3":"_col0 (type: string)"}
            |     |  outputColumnNames:["_col0","_col1"]
            |     |  Statistics:Num rows: 241 Data size: 42898 Basic stats: COMPLETE Column stats: COMPLETE
            |     |<-Map 3 [BROADCAST_EDGE]
            |     |  Reduce Output Operator [RS_11]
            |     |     key expressions:_col0 (type: string)
            |     |     Map-reduce partition columns:_col0 (type: string)
            |     |     sort order:+
            |     |     Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
            |     |     Select Operator [SEL_4]
            |     |        outputColumnNames:["_col0"]
            |     |        Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
            |     |        Filter Operator [FIL_26]
            |     |           predicate:key is not null (type: boolean)
            |     |           Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
            |     |           TableScan [TS_3]
            |     |              alias:src1
            |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: COMPLETE
            |     |<-Select Operator [SEL_2]
            |           outputColumnNames:["_col0","_col1"]
            |           Statistics:Num rows: 666 Data size: 118548 Basic stats: COMPLETE Column stats: COMPLETE
            |           Filter Operator [FIL_25]
            |              predicate:(((value > 'val_450') and key is not null) and value is not null) (type: boolean)
            |              Statistics:Num rows: 666 Data size: 118548 Basic stats: COMPLETE Column stats: COMPLETE
            |              TableScan [TS_0]
            |                 alias:srcpart
            |                 Statistics:Num rows: 2000 Data size: 21248 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 4 [SIMPLE_EDGE]
               Reduce Output Operator [RS_16]
                  key expressions:_col0 (type: string)
                  Map-reduce partition columns:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 166 Data size: 15106 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_7]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 166 Data size: 15106 Basic stats: COMPLETE Column stats: COMPLETE
                     Filter Operator [FIL_27]
                        predicate:(value > 'val_450') (type: boolean)
                        Statistics:Num rows: 166 Data size: 15106 Basic stats: COMPLETE Column stats: COMPLETE
                        TableScan [TS_5]
                           alias:src
                           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select srcpart.key from srcpart join src on (srcpart.value=src.value) join src1 on (srcpart.key=src1.key) where srcpart.value > 'val_450'
PREHOOK: type: QUERY
POSTHOOK: query: explain select srcpart.key from srcpart join src on (srcpart.value=src.value) join src1 on (srcpart.key=src1.key) where srcpart.value > 'val_450'
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
Map 1 <- Map 3 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_19]
            compressed:true
            Statistics:Num rows: 555 Data size: 48285 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_29]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: string)","0":"_col1 (type: string)"}
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 555 Data size: 48285 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_14]
            |     key expressions:_col1 (type: string)
            |     Map-reduce partition columns:_col1 (type: string)
            |     sort order:+
            |     Statistics:Num rows: 241 Data size: 42898 Basic stats: COMPLETE Column stats: COMPLETE
            |     value expressions:_col0 (type: string)
            |     Map Join Operator [MAPJOIN_28]
            |     |  condition map:[{"":"Inner Join 0 to 1"}]
            |     |  keys:{"Map 1":"_col0 (type: string)","Map 3":"_col0 (type: string)"}
            |     |  outputColumnNames:["_col0","_col1"]
            |     |  Statistics:Num rows: 241 Data size: 42898 Basic stats: COMPLETE Column stats: COMPLETE
            |     |<-Map 3 [BROADCAST_EDGE]
            |     |  Reduce Output Operator [RS_11]
            |     |     key expressions:_col0 (type: string)
            |     |     Map-reduce partition columns:_col0 (type: string)
            |     |     sort order:+
            |     |     Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
            |     |     Select Operator [SEL_4]
            |     |        outputColumnNames:["_col0"]
            |     |        Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
            |     |        Filter Operator [FIL_26]
            |     |           predicate:key is not null (type: boolean)
            |     |           Statistics:Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
            |     |           TableScan [TS_3]
            |     |              alias:src1
            |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: COMPLETE
            |     |<-Select Operator [SEL_2]
            |           outputColumnNames:["_col0","_col1"]
            |           Statistics:Num rows: 666 Data size: 118548 Basic stats: COMPLETE Column stats: COMPLETE
            |           Filter Operator [FIL_25]
            |              predicate:(((value > 'val_450') and key is not null) and value is not null) (type: boolean)
            |              Statistics:Num rows: 666 Data size: 118548 Basic stats: COMPLETE Column stats: COMPLETE
            |              TableScan [TS_0]
            |                 alias:srcpart
            |                 Statistics:Num rows: 2000 Data size: 21248 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 4 [SIMPLE_EDGE]
               Reduce Output Operator [RS_16]
                  key expressions:_col0 (type: string)
                  Map-reduce partition columns:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 166 Data size: 15106 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_7]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 166 Data size: 15106 Basic stats: COMPLETE Column stats: COMPLETE
                     Filter Operator [FIL_27]
                        predicate:(value > 'val_450') (type: boolean)
                        Statistics:Num rows: 166 Data size: 15106 Basic stats: COMPLETE Column stats: COMPLETE
                        TableScan [TS_5]
                           alias:src
                           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name, p_size,
rank() over (partition by p_mfgr order by p_name) as r,
dense_rank() over (partition by p_mfgr order by p_name) as dr,
sum(p_retailprice) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row) as s1
from noop(on part 
  partition by p_mfgr
  order by p_name
  )
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name, p_size,
rank() over (partition by p_mfgr order by p_name) as r,
dense_rank() over (partition by p_mfgr order by p_name) as dr,
sum(p_retailprice) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row) as s1
from noop(on part 
  partition by p_mfgr
  order by p_name
  )
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_9]
            compressed:true
            Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_7]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_6]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_5]
                  |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                  |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_4]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int), _col7 (type: double)
                        PTF Operator [PTF_3]
                           Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col1"}}]
                           Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_2]
                           |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                           |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_1]
                                 key expressions:p_mfgr (type: string), p_name (type: string)
                                 Map-reduce partition columns:p_mfgr (type: string)
                                 sort order:++
                                 Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:p_size (type: int), p_retailprice (type: double)
                                 TableScan [TS_0]
                                    alias:part
                                    Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name,
p_size, p_size - lag(p_size,1,p_size) over (partition by p_mfgr order by p_name) as deltaSz
from noop (on (select p1.* from part p1 join part p2 on p1.p_partkey = p2.p_partkey) j
distribute by j.p_mfgr
sort by j.p_name)
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name,
p_size, p_size - lag(p_size,1,p_size) over (partition by p_mfgr order by p_name) as deltaSz
from noop (on (select p1.* from part p1 join part p2 on p1.p_partkey = p2.p_partkey) j
distribute by j.p_mfgr
sort by j.p_name)
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Map 1 <- Map 4 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_16]
            compressed:true
            Statistics:Num rows: 29 Data size: 6583 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_14]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 29 Data size: 6583 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_13]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 29 Data size: 6467 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_12]
                  |  outputColumnNames:["_col1","_col2","_col5"]
                  |  Statistics:Num rows: 29 Data size: 6467 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_11]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 29 Data size: 6467 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int)
                        PTF Operator [PTF_10]
                           Function definitions:[{"Input definition":{"type:":"SUBQUERY"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col1"}}]
                           Statistics:Num rows: 29 Data size: 6467 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_9]
                           |  outputColumnNames:["_col1","_col2","_col5"]
                           |  Statistics:Num rows: 29 Data size: 6467 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_8]
                                 key expressions:_col2 (type: string), _col1 (type: string)
                                 Map-reduce partition columns:_col2 (type: string)
                                 sort order:++
                                 Statistics:Num rows: 29 Data size: 6467 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:_col5 (type: int)
                                 Map Join Operator [MAPJOIN_21]
                                 |  condition map:[{"":"Inner Join 0 to 1"}]
                                 |  keys:{"Map 1":"p_partkey (type: int)","Map 4":"p_partkey (type: int)"}
                                 |  outputColumnNames:["_col1","_col2","_col5"]
                                 |  Statistics:Num rows: 29 Data size: 6467 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Map 4 [BROADCAST_EDGE]
                                 |  Reduce Output Operator [RS_5]
                                 |     key expressions:p_partkey (type: int)
                                 |     Map-reduce partition columns:p_partkey (type: int)
                                 |     sort order:+
                                 |     Statistics:Num rows: 26 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
                                 |     Filter Operator [FIL_20]
                                 |        predicate:p_partkey is not null (type: boolean)
                                 |        Statistics:Num rows: 26 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
                                 |        TableScan [TS_1]
                                 |           alias:p2
                                 |           Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Filter Operator [FIL_19]
                                       predicate:p_partkey is not null (type: boolean)
                                       Statistics:Num rows: 26 Data size: 5902 Basic stats: COMPLETE Column stats: COMPLETE
                                       TableScan [TS_0]
                                          alias:p1
                                          Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name, p_size,
rank() over (partition by p_mfgr order by p_name) as r,
dense_rank() over (partition by p_mfgr order by p_name) as dr,
sum(p_retailprice) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row) as s1
from noop(on part 
  partition by p_mfgr
  order by p_name
  ) abc
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name, p_size,
rank() over (partition by p_mfgr order by p_name) as r,
dense_rank() over (partition by p_mfgr order by p_name) as dr,
sum(p_retailprice) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row) as s1
from noop(on part 
  partition by p_mfgr
  order by p_name
  ) abc
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_9]
            compressed:true
            Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_7]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_6]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_5]
                  |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                  |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_4]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int), _col7 (type: double)
                        PTF Operator [PTF_3]
                           Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col1"}}]
                           Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_2]
                           |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                           |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_1]
                                 key expressions:p_mfgr (type: string), p_name (type: string)
                                 Map-reduce partition columns:p_mfgr (type: string)
                                 sort order:++
                                 Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:p_size (type: int), p_retailprice (type: double)
                                 TableScan [TS_0]
                                    alias:part
                                    Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name, p_size, 
rank() over (partition by p_mfgr order by p_name) as r, 
dense_rank() over (partition by p_mfgr order by p_name) as dr, 
p_size, p_size - lag(p_size,1,p_size) over (partition by p_mfgr order by p_name) as deltaSz 
from noop(on part 
          partition by p_mfgr 
          order by p_name 
          )
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name, p_size, 
rank() over (partition by p_mfgr order by p_name) as r, 
dense_rank() over (partition by p_mfgr order by p_name) as dr, 
p_size, p_size - lag(p_size,1,p_size) over (partition by p_mfgr order by p_name) as deltaSz 
from noop(on part 
          partition by p_mfgr 
          order by p_name 
          )
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_9]
            compressed:true
            Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_7]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
               Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_6]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_5]
                  |  outputColumnNames:["_col1","_col2","_col5"]
                  |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_4]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int)
                        PTF Operator [PTF_3]
                           Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col1"}}]
                           Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_2]
                           |  outputColumnNames:["_col1","_col2","_col5"]
                           |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_1]
                                 key expressions:p_mfgr (type: string), p_name (type: string)
                                 Map-reduce partition columns:p_mfgr (type: string)
                                 sort order:++
                                 Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:p_size (type: int)
                                 TableScan [TS_0]
                                    alias:part
                                    Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name, p_size, 
rank() over (partition by p_mfgr order by p_name) as r, 
dense_rank() over (partition by p_mfgr order by p_name) as dr, 
p_size, p_size - lag(p_size,1,p_size) over (partition by p_mfgr order by p_name) as deltaSz 
from noop(on part 
          partition by p_mfgr 
          order by p_name 
          ) 
group by p_mfgr, p_name, p_size
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name, p_size, 
rank() over (partition by p_mfgr order by p_name) as r, 
dense_rank() over (partition by p_mfgr order by p_name) as dr, 
p_size, p_size - lag(p_size,1,p_size) over (partition by p_mfgr order by p_name) as deltaSz 
from noop(on part 
          partition by p_mfgr 
          order by p_name 
          ) 
group by p_mfgr, p_name, p_size
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 5
         File Output Operator [FS_14]
            compressed:true
            Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_12]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
               Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_11]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col0","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_10]
                  |  outputColumnNames:["_col0","_col1","_col2"]
                  |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 4 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_9]
                        key expressions:_col0 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col0 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col2 (type: int)
                        Group By Operator [GBY_8]
                        |  keys:KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
                        |  outputColumnNames:["_col0","_col1","_col2"]
                        |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Reducer 3 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_7]
                              key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: int)
                              Map-reduce partition columns:_col0 (type: string), _col1 (type: string), _col2 (type: int)
                              sort order:+++
                              Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator [GBY_6]
                              |  keys:KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
                              |  outputColumnNames:["_col0","_col1","_col2"]
                              |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                              |<-Reducer 2 [SIMPLE_EDGE]
                                 Reduce Output Operator [RS_5]
                                    key expressions:_col2 (type: string), _col1 (type: string), _col5 (type: int)
                                    Map-reduce partition columns:rand() (type: double)
                                    sort order:+++
                                    Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                    PTF Operator [PTF_3]
                                       Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col1"}}]
                                       Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                       Select Operator [SEL_2]
                                       |  outputColumnNames:["_col1","_col2","_col5"]
                                       |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                       |<-Map 1 [SIMPLE_EDGE]
                                          Reduce Output Operator [RS_1]
                                             key expressions:p_mfgr (type: string), p_name (type: string)
                                             Map-reduce partition columns:p_mfgr (type: string)
                                             sort order:++
                                             Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                             value expressions:p_size (type: int)
                                             TableScan [TS_0]
                                                alias:part
                                                Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select abc.* 
from noop(on part 
partition by p_mfgr 
order by p_name 
) abc join part p1 on abc.p_partkey = p1.p_partkey
PREHOOK: type: QUERY
POSTHOOK: query: explain
select abc.* 
from noop(on part 
partition by p_mfgr 
order by p_name 
) abc join part p1 on abc.p_partkey = p1.p_partkey
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_11]
            compressed:true
            Statistics:Num rows: 29 Data size: 17951 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Map Join Operator [MAPJOIN_16]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{"Reducer 2":"_col0 (type: int)","Map 3":"p_partkey (type: int)"}
            |  outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8"]
            |  Statistics:Num rows: 29 Data size: 17951 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 3 [BROADCAST_EDGE]
            |  Reduce Output Operator [RS_8]
            |     key expressions:p_partkey (type: int)
            |     Map-reduce partition columns:p_partkey (type: int)
            |     sort order:+
            |     Statistics:Num rows: 26 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
            |     Filter Operator [FIL_15]
            |        predicate:p_partkey is not null (type: boolean)
            |        Statistics:Num rows: 26 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
            |        TableScan [TS_1]
            |           alias:p1
            |           Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Filter Operator [FIL_14]
                  predicate:_col0 is not null (type: boolean)
                  Statistics:Num rows: 26 Data size: 16094 Basic stats: COMPLETE Column stats: COMPLETE
                  PTF Operator [PTF_4]
                     Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col1"}}]
                     Statistics:Num rows: 26 Data size: 16094 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator [SEL_3]
                     |  outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8"]
                     |  Statistics:Num rows: 26 Data size: 16094 Basic stats: COMPLETE Column stats: COMPLETE
                     |<-Map 1 [SIMPLE_EDGE]
                        Reduce Output Operator [RS_2]
                           key expressions:p_mfgr (type: string), p_name (type: string)
                           Map-reduce partition columns:p_mfgr (type: string)
                           sort order:++
                           Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                           value expressions:p_partkey (type: int), p_brand (type: string), p_type (type: string), p_size (type: int), p_container (type: string), p_retailprice (type: double), p_comment (type: string)
                           TableScan [TS_0]
                              alias:part
                              Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name, p_size, 
rank() over (partition by p_mfgr order by p_name, p_size desc) as r
from noopwithmap(on part
partition by p_mfgr
order by p_name, p_size desc)
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name, p_size, 
rank() over (partition by p_mfgr order by p_name, p_size desc) as r
from noopwithmap(on part
partition by p_mfgr
order by p_name, p_size desc)
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_10]
            compressed:true
            Statistics:Num rows: 26 Data size: 5902 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_8]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 26 Data size: 5902 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_7]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1, _col5(DESC)"}]
                  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_6]
                  |  outputColumnNames:["_col1","_col2","_col5"]
                  |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_5]
                        key expressions:_col2 (type: string), _col1 (type: string), _col5 (type: int)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++-
                        Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                        PTF Operator [PTF_4]
                           Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noopwithmap","order by:":"_col1, _col5(DESC)"}}]
                           Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_3]
                           |  outputColumnNames:["_col1","_col2","_col5"]
                           |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_2]
                                 key expressions:p_mfgr (type: string), p_name (type: string), p_size (type: int)
                                 Map-reduce partition columns:p_mfgr (type: string)
                                 sort order:++-
                                 Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                 PTF Operator [PTF_1]
                                    Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"p_mfgr","name:":"noopwithmap","order by:":"p_name, p_size(DESC)"}}]
                                    Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                    TableScan [TS_0]
                                       alias:part
                                       Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain 
select p_mfgr, p_name, p_size,
rank() over (partition by p_mfgr order by p_name) as r,
dense_rank() over (partition by p_mfgr order by p_name) as dr,
sum(p_retailprice) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row) as s1
from noopwithmap(on part 
  partition by p_mfgr
  order by p_name)
PREHOOK: type: QUERY
POSTHOOK: query: explain 
select p_mfgr, p_name, p_size,
rank() over (partition by p_mfgr order by p_name) as r,
dense_rank() over (partition by p_mfgr order by p_name) as dr,
sum(p_retailprice) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row) as s1
from noopwithmap(on part 
  partition by p_mfgr
  order by p_name)
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_10]
            compressed:true
            Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_8]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_7]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_6]
                  |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                  |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_5]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int), _col7 (type: double)
                        PTF Operator [PTF_4]
                           Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noopwithmap","order by:":"_col1"}}]
                           Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_3]
                           |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                           |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_2]
                                 key expressions:p_mfgr (type: string), p_name (type: string)
                                 Map-reduce partition columns:p_mfgr (type: string)
                                 sort order:++
                                 Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:p_size (type: int), p_retailprice (type: double)
                                 PTF Operator [PTF_1]
                                    Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"p_mfgr","name:":"noopwithmap","order by:":"p_name"}}]
                                    Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                    TableScan [TS_0]
                                       alias:part
                                       Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name, p_size,
rank() over (partition by p_mfgr order by p_name) as r,
dense_rank() over (partition by p_mfgr order by p_name) as dr,
sum(p_retailprice) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row) as s1
from noop(on part
partition by p_mfgr
order by p_name)
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name, p_size,
rank() over (partition by p_mfgr order by p_name) as r,
dense_rank() over (partition by p_mfgr order by p_name) as dr,
sum(p_retailprice) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row) as s1
from noop(on part
partition by p_mfgr
order by p_name)
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_9]
            compressed:true
            Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_7]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_6]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_5]
                  |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                  |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_4]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int), _col7 (type: double)
                        PTF Operator [PTF_3]
                           Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col1"}}]
                           Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_2]
                           |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                           |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_1]
                                 key expressions:p_mfgr (type: string), p_name (type: string)
                                 Map-reduce partition columns:p_mfgr (type: string)
                                 sort order:++
                                 Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:p_size (type: int), p_retailprice (type: double)
                                 TableScan [TS_0]
                                    alias:part
                                    Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name, p_size, 
rank() over (partition by p_mfgr order by p_name) as r, 
dense_rank() over (partition by p_mfgr order by p_name) as dr, 
sum(p_retailprice) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row)  as s1
from noop(on noopwithmap(on noop(on part 
partition by p_mfgr 
order by p_mfgr DESC, p_name
)))
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name, p_size, 
rank() over (partition by p_mfgr order by p_name) as r, 
dense_rank() over (partition by p_mfgr order by p_name) as dr, 
sum(p_retailprice) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row)  as s1
from noop(on noopwithmap(on noop(on part 
partition by p_mfgr 
order by p_mfgr DESC, p_name
)))
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_13]
            compressed:true
            Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_11]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_10]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_9]
                  |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                  |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 3 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_8]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int), _col7 (type: double)
                        PTF Operator [PTF_7]
                           Function definitions:[{"Input definition":{"type:":"PTFCOMPONENT"}},{"Partition table definition":{"partition by:":"_col2","name:":"noopwithmap","order by:":"_col2(DESC), _col1"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col2(DESC), _col1"}}]
                           Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_6]
                           |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                           |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 2 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_5]
                                 key expressions:_col2 (type: string), _col1 (type: string)
                                 Map-reduce partition columns:_col2 (type: string)
                                 sort order:-+
                                 Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:_col5 (type: int), _col7 (type: double)
                                 PTF Operator [PTF_4]
                                    Function definitions:[{"Input definition":{"type:":"PTFCOMPONENT"}},{"Partition table definition":{"partition by:":"_col2","name:":"noopwithmap","order by:":"_col2(DESC), _col1"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col2(DESC), _col1"}}]
                                    Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                                    PTF Operator [PTF_3]
                                       Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col2(DESC), _col1"}}]
                                       Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                                       Select Operator [SEL_2]
                                       |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                                       |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                                       |<-Map 1 [SIMPLE_EDGE]
                                          Reduce Output Operator [RS_1]
                                             key expressions:p_mfgr (type: string), p_name (type: string)
                                             Map-reduce partition columns:p_mfgr (type: string)
                                             sort order:-+
                                             Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                             value expressions:p_size (type: int), p_retailprice (type: double)
                                             TableScan [TS_0]
                                                alias:part
                                                Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name, 
sub1.cd, sub1.s1 
from (select p_mfgr, p_name, 
count(p_size) over (partition by p_mfgr order by p_name) as cd, 
p_retailprice, 
sum(p_retailprice) over w1  as s1
from noop(on part 
partition by p_mfgr 
order by p_name) 
window w1 as (partition by p_mfgr order by p_name rows between 2 preceding and 2 following) 
) sub1
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name, 
sub1.cd, sub1.s1 
from (select p_mfgr, p_name, 
count(p_size) over (partition by p_mfgr order by p_name) as cd, 
p_retailprice, 
sum(p_retailprice) over w1  as s1
from noop(on part 
partition by p_mfgr 
order by p_name) 
window w1 as (partition by p_mfgr order by p_name rows between 2 preceding and 2 following) 
) sub1
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_10]
            compressed:true
            Statistics:Num rows: 26 Data size: 6110 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_7]
               outputColumnNames:["_col0","_col1","_col2","_col3"]
               Statistics:Num rows: 26 Data size: 6110 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_6]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_5]
                  |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                  |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_4]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int), _col7 (type: double)
                        PTF Operator [PTF_3]
                           Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col1"}}]
                           Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_2]
                           |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                           |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_1]
                                 key expressions:p_mfgr (type: string), p_name (type: string)
                                 Map-reduce partition columns:p_mfgr (type: string)
                                 sort order:++
                                 Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:p_size (type: int), p_retailprice (type: double)
                                 TableScan [TS_0]
                                    alias:part
                                    Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select abc.p_mfgr, abc.p_name, 
rank() over (distribute by abc.p_mfgr sort by abc.p_name) as r, 
dense_rank() over (distribute by abc.p_mfgr sort by abc.p_name) as dr, 
count(abc.p_name) over (distribute by abc.p_mfgr sort by abc.p_name) as cd, 
abc.p_retailprice, sum(abc.p_retailprice) over (distribute by abc.p_mfgr sort by abc.p_name rows between unbounded preceding and current row) as s1, 
abc.p_size, abc.p_size - lag(abc.p_size,1,abc.p_size) over (distribute by abc.p_mfgr sort by abc.p_name) as deltaSz 
from noop(on part 
partition by p_mfgr 
order by p_name 
) abc join part p1 on abc.p_partkey = p1.p_partkey
PREHOOK: type: QUERY
POSTHOOK: query: explain
select abc.p_mfgr, abc.p_name, 
rank() over (distribute by abc.p_mfgr sort by abc.p_name) as r, 
dense_rank() over (distribute by abc.p_mfgr sort by abc.p_name) as dr, 
count(abc.p_name) over (distribute by abc.p_mfgr sort by abc.p_name) as cd, 
abc.p_retailprice, sum(abc.p_retailprice) over (distribute by abc.p_mfgr sort by abc.p_name rows between unbounded preceding and current row) as s1, 
abc.p_size, abc.p_size - lag(abc.p_size,1,abc.p_size) over (distribute by abc.p_mfgr sort by abc.p_name) as deltaSz 
from noop(on part 
partition by p_mfgr 
order by p_name 
) abc join part p1 on abc.p_partkey = p1.p_partkey
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (BROADCAST_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_15]
            compressed:true
            Statistics:Num rows: 29 Data size: 7511 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_13]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8"]
               Statistics:Num rows: 29 Data size: 7511 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_12]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 29 Data size: 6699 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_11]
                  |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                  |  Statistics:Num rows: 29 Data size: 6699 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_10]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 29 Data size: 6699 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int), _col7 (type: double)
                        Map Join Operator [MAPJOIN_20]
                        |  condition map:[{"":"Inner Join 0 to 1"}]
                        |  keys:{"Reducer 2":"_col0 (type: int)","Map 4":"p_partkey (type: int)"}
                        |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                        |  Statistics:Num rows: 29 Data size: 6699 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Map 4 [BROADCAST_EDGE]
                        |  Reduce Output Operator [RS_8]
                        |     key expressions:p_partkey (type: int)
                        |     Map-reduce partition columns:p_partkey (type: int)
                        |     sort order:+
                        |     Statistics:Num rows: 26 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
                        |     Filter Operator [FIL_19]
                        |        predicate:p_partkey is not null (type: boolean)
                        |        Statistics:Num rows: 26 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
                        |        TableScan [TS_1]
                        |           alias:p1
                        |           Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                        |<-Filter Operator [FIL_18]
                              predicate:_col0 is not null (type: boolean)
                              Statistics:Num rows: 26 Data size: 6110 Basic stats: COMPLETE Column stats: COMPLETE
                              PTF Operator [PTF_4]
                                 Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col1"}}]
                                 Statistics:Num rows: 26 Data size: 6110 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_3]
                                 |  outputColumnNames:["_col0","_col1","_col2","_col5","_col7"]
                                 |  Statistics:Num rows: 26 Data size: 6110 Basic stats: COMPLETE Column stats: COMPLETE
                                 |<-Map 1 [SIMPLE_EDGE]
                                    Reduce Output Operator [RS_2]
                                       key expressions:p_mfgr (type: string), p_name (type: string)
                                       Map-reduce partition columns:p_mfgr (type: string)
                                       sort order:++
                                       Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                       value expressions:p_partkey (type: int), p_size (type: int), p_retailprice (type: double)
                                       TableScan [TS_0]
                                          alias:part
                                          Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain create view IF NOT EXISTS mfgr_price_view as 
select p_mfgr, p_brand, 
sum(p_retailprice) as s 
from part 
group by p_mfgr, p_brand
PREHOOK: type: CREATEVIEW
POSTHOOK: query: explain create view IF NOT EXISTS mfgr_price_view as 
select p_mfgr, p_brand, 
sum(p_retailprice) as s 
from part 
group by p_mfgr, p_brand
POSTHOOK: type: CREATEVIEW
Plan not optimized by CBO.

Stage-0
   Create View Operator:
      name:default.mfgr_price_view
      original text:select p_mfgr, p_brand, 
sum(p_retailprice) as s 
from part 
group by p_mfgr, p_brand
PREHOOK: query: CREATE TABLE part_4( 
p_mfgr STRING, 
p_name STRING, 
p_size INT, 
r INT, 
dr INT, 
s DOUBLE)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@part_4
POSTHOOK: query: CREATE TABLE part_4( 
p_mfgr STRING, 
p_name STRING, 
p_size INT, 
r INT, 
dr INT, 
s DOUBLE)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@part_4
PREHOOK: query: CREATE TABLE part_5( 
p_mfgr STRING, 
p_name STRING, 
p_size INT, 
s2 INT, 
r INT, 
dr INT, 
cud DOUBLE, 
fv1 INT)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@part_5
POSTHOOK: query: CREATE TABLE part_5( 
p_mfgr STRING, 
p_name STRING, 
p_size INT, 
s2 INT, 
r INT, 
dr INT, 
cud DOUBLE, 
fv1 INT)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@part_5
PREHOOK: query: explain
from noop(on part 
partition by p_mfgr 
order by p_name) 
INSERT OVERWRITE TABLE part_4 select p_mfgr, p_name, p_size, 
rank() over (distribute by p_mfgr sort by p_name) as r, 
dense_rank() over (distribute by p_mfgr sort by p_name) as dr, 
sum(p_retailprice) over (distribute by p_mfgr sort by p_name rows between unbounded preceding and current row)  as s  
INSERT OVERWRITE TABLE part_5 select  p_mfgr,p_name, p_size,  
round(sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row),1) as s2,
rank() over (distribute by p_mfgr sort by p_mfgr, p_name) as r, 
dense_rank() over (distribute by p_mfgr sort by p_mfgr, p_name) as dr, 
cume_dist() over (distribute by p_mfgr sort by p_mfgr, p_name) as cud, 
first_value(p_size, true) over w1  as fv1
window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
PREHOOK: type: QUERY
POSTHOOK: query: explain
from noop(on part 
partition by p_mfgr 
order by p_name) 
INSERT OVERWRITE TABLE part_4 select p_mfgr, p_name, p_size, 
rank() over (distribute by p_mfgr sort by p_name) as r, 
dense_rank() over (distribute by p_mfgr sort by p_name) as dr, 
sum(p_retailprice) over (distribute by p_mfgr sort by p_name rows between unbounded preceding and current row)  as s  
INSERT OVERWRITE TABLE part_5 select  p_mfgr,p_name, p_size,  
round(sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row),1) as s2,
rank() over (distribute by p_mfgr sort by p_mfgr, p_name) as r, 
dense_rank() over (distribute by p_mfgr sort by p_mfgr, p_name) as dr, 
cume_dist() over (distribute by p_mfgr sort by p_mfgr, p_name) as cud, 
first_value(p_size, true) over w1  as fv1
window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Reducer 2 (SIMPLE_EDGE)

Stage-5
   Stats-Aggr Operator
      Stage-1
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.part_5","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Stage-3
               Dependency Collection{}
                  Stage-2
                     Reducer 3
                     File Output Operator [FS_9]
                        compressed:true
                        Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.part_4","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                        Select Operator [SEL_7]
                           outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
                           Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
                           PTF Operator [PTF_6]
                              Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                              Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator [SEL_5]
                              |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                              |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                              |<-Reducer 2 [SIMPLE_EDGE]
                                 Reduce Output Operator [RS_4]
                                    key expressions:_col2 (type: string), _col1 (type: string)
                                    Map-reduce partition columns:_col2 (type: string)
                                    sort order:++
                                    Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions:_col5 (type: int), _col7 (type: double)
                                    PTF Operator [PTF_3]
                                       Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col1"}}]
                                       Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                                       Select Operator [SEL_2]
                                       |  outputColumnNames:["_col1","_col2","_col5","_col7"]
                                       |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                                       |<-Map 1 [SIMPLE_EDGE]
                                          Reduce Output Operator [RS_1]
                                             key expressions:p_mfgr (type: string), p_name (type: string)
                                             Map-reduce partition columns:p_mfgr (type: string)
                                             sort order:++
                                             Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                             value expressions:p_size (type: int), p_retailprice (type: double)
                                             TableScan [TS_0]
                                                alias:part
                                                Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                     Reducer 5
                     File Output Operator [FS_20]
                        compressed:true
                        Statistics:Num rows: 26 Data size: 6422 Basic stats: COMPLETE Column stats: COMPLETE
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.part_5","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                        Select Operator [SEL_17]
                           outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                           Statistics:Num rows: 26 Data size: 6422 Basic stats: COMPLETE Column stats: COMPLETE
                           PTF Operator [PTF_16]
                              Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col3","name:":"windowingtablefunction","order by:":"_col3, _col2"}]
                              Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator [SEL_15]
                              |  outputColumnNames:["_col0","_col2","_col3","_col6"]
                              |  Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                              |<-Reducer 4 [SIMPLE_EDGE]
                                 Reduce Output Operator [RS_14]
                                    key expressions:_col2 (type: string), _col1 (type: string)
                                    Map-reduce partition columns:_col2 (type: string)
                                    sort order:++
                                    Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions:sum_window_0 (type: bigint), _col5 (type: int)
                                    Select Operator [SEL_13]
                                       outputColumnNames:["_col1","_col2","_col5","sum_window_0"]
                                       Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                       PTF Operator [PTF_12]
                                          Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col5"}]
                                          Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                          Select Operator [SEL_11]
                                          |  outputColumnNames:["_col1","_col2","_col5"]
                                          |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                          |<-Reducer 2 [SIMPLE_EDGE]
                                             Reduce Output Operator [RS_10]
                                                key expressions:_col2 (type: string), _col5 (type: int)
                                                Map-reduce partition columns:_col2 (type: string)
                                                sort order:++
                                                Statistics:Num rows: 26 Data size: 6006 Basic stats: COMPLETE Column stats: COMPLETE
                                                value expressions:_col1 (type: string)
                                                 Please refer to the previous PTF Operator [PTF_3]
Stage-4
   Stats-Aggr Operator
      Stage-0
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.part_4","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
             Please refer to the previous Stage-3
PREHOOK: query: explain
select p_mfgr, p_name,  
rank() over (partition by p_mfgr,p_name) as r, 
dense_rank() over (partition by p_mfgr,p_name) as dr, 
p_size, sum(p_size) over (partition by p_mfgr,p_name rows between unbounded preceding and current row)  as s1
from noop(on 
        noopwithmap(on 
          noop(on 
              noop(on part 
              partition by p_mfgr 
              order by p_mfgr) 
            ) 
          partition by p_mfgr,p_name 
          order by p_mfgr,p_name) 
        partition by p_mfgr,p_name  
        order by p_mfgr,p_name)
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name,  
rank() over (partition by p_mfgr,p_name) as r, 
dense_rank() over (partition by p_mfgr,p_name) as dr, 
p_size, sum(p_size) over (partition by p_mfgr,p_name rows between unbounded preceding and current row)  as s1
from noop(on 
        noopwithmap(on 
          noop(on 
              noop(on part 
              partition by p_mfgr 
              order by p_mfgr) 
            ) 
          partition by p_mfgr,p_name 
          order by p_mfgr,p_name) 
        partition by p_mfgr,p_name  
        order by p_mfgr,p_name)
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_13]
            compressed:true
            Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_11]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_10]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2, _col1","name:":"windowingtablefunction","order by:":"_col2, _col1"}]
                  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_9]
                  |  outputColumnNames:["_col1","_col2","_col5"]
                  |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 3 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_8]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string), _col1 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int)
                        PTF Operator [PTF_7]
                           Function definitions:[{"Input definition":{"type:":"PTFCOMPONENT"}},{"Partition table definition":{"partition by:":"_col2, _col1","name:":"noopwithmap","order by:":"_col2, _col1"}},{"Partition table definition":{"partition by:":"_col2, _col1","name:":"noop","order by:":"_col2, _col1"}}]
                           Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_6]
                           |  outputColumnNames:["_col1","_col2","_col5"]
                           |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 2 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_5]
                                 key expressions:_col2 (type: string), _col1 (type: string)
                                 Map-reduce partition columns:_col2 (type: string), _col1 (type: string)
                                 sort order:++
                                 Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:_col5 (type: int)
                                 PTF Operator [PTF_4]
                                    Function definitions:[{"Input definition":{"type:":"PTFCOMPONENT"}},{"Partition table definition":{"partition by:":"_col2, _col1","name:":"noopwithmap","order by:":"_col2, _col1"}},{"Partition table definition":{"partition by:":"_col2, _col1","name:":"noop","order by:":"_col2, _col1"}}]
                                    Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                    PTF Operator [PTF_3]
                                       Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col2"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col2"}}]
                                       Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                       Select Operator [SEL_2]
                                       |  outputColumnNames:["_col1","_col2","_col5"]
                                       |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                       |<-Map 1 [SIMPLE_EDGE]
                                          Reduce Output Operator [RS_1]
                                             key expressions:p_mfgr (type: string)
                                             Map-reduce partition columns:p_mfgr (type: string)
                                             sort order:+
                                             Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                             value expressions:p_name (type: string), p_size (type: int)
                                             TableScan [TS_0]
                                                alias:part
                                                Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name,  
rank() over (partition by p_mfgr order by p_name) as r, 
dense_rank() over (partition by p_mfgr order by p_name) as dr, 
p_size, sum(p_size) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row)  as s1
from noop(on 
        noop(on 
          noop(on 
              noop(on part 
              partition by p_mfgr 
              order by p_mfgr) 
            ) 
          partition by p_mfgr,p_name 
          order by p_mfgr,p_name) 
        partition by p_mfgr  
        order by p_mfgr )
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name,  
rank() over (partition by p_mfgr order by p_name) as r, 
dense_rank() over (partition by p_mfgr order by p_name) as dr, 
p_size, sum(p_size) over (partition by p_mfgr order by p_name rows between unbounded preceding and current row)  as s1
from noop(on 
        noop(on 
          noop(on 
              noop(on part 
              partition by p_mfgr 
              order by p_mfgr) 
            ) 
          partition by p_mfgr,p_name 
          order by p_mfgr,p_name) 
        partition by p_mfgr  
        order by p_mfgr )
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 5
         File Output Operator [FS_15]
            compressed:true
            Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_13]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_12]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_11]
                  |  outputColumnNames:["_col1","_col2","_col5"]
                  |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 4 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_10]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int)
                        PTF Operator [PTF_9]
                           Function definitions:[{"Input definition":{"type:":"PTFCOMPONENT"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col2"}}]
                           Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_8]
                           |  outputColumnNames:["_col1","_col2","_col5"]
                           |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 3 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_7]
                                 key expressions:_col2 (type: string)
                                 Map-reduce partition columns:_col2 (type: string)
                                 sort order:+
                                 Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:_col1 (type: string), _col5 (type: int)
                                 PTF Operator [PTF_6]
                                    Function definitions:[{"Input definition":{"type:":"PTFCOMPONENT"}},{"Partition table definition":{"partition by:":"_col2, _col1","name:":"noop","order by:":"_col2, _col1"}}]
                                    Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                    Select Operator [SEL_5]
                                    |  outputColumnNames:["_col1","_col2","_col5"]
                                    |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Reducer 2 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_4]
                                          key expressions:_col2 (type: string), _col1 (type: string)
                                          Map-reduce partition columns:_col2 (type: string), _col1 (type: string)
                                          sort order:++
                                          Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                          value expressions:_col5 (type: int)
                                          PTF Operator [PTF_3]
                                             Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col2"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col2"}}]
                                             Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                             Select Operator [SEL_2]
                                             |  outputColumnNames:["_col1","_col2","_col5"]
                                             |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                             |<-Map 1 [SIMPLE_EDGE]
                                                Reduce Output Operator [RS_1]
                                                   key expressions:p_mfgr (type: string)
                                                   Map-reduce partition columns:p_mfgr (type: string)
                                                   sort order:+
                                                   Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                                   value expressions:p_name (type: string), p_size (type: int)
                                                   TableScan [TS_0]
                                                      alias:part
                                                      Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain
select p_mfgr, p_name,  
rank() over (partition by p_mfgr order by p_name) as r, 
dense_rank() over (partition by p_mfgr order by p_name) as dr, 
p_size, sum(p_size) over (partition by p_mfgr order by p_name) as s1 
from noop(on 
        noop(on 
          noop(on 
              noop(on part 
              partition by p_mfgr,p_name 
              order by p_mfgr,p_name) 
            ) 
          partition by p_mfgr 
          order by p_mfgr))
PREHOOK: type: QUERY
POSTHOOK: query: explain
select p_mfgr, p_name,  
rank() over (partition by p_mfgr order by p_name) as r, 
dense_rank() over (partition by p_mfgr order by p_name) as dr, 
p_size, sum(p_size) over (partition by p_mfgr order by p_name) as s1 
from noop(on 
        noop(on 
          noop(on 
              noop(on part 
              partition by p_mfgr,p_name 
              order by p_mfgr,p_name) 
            ) 
          partition by p_mfgr 
          order by p_mfgr))
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_12]
            compressed:true
            Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_10]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               Statistics:Num rows: 26 Data size: 6214 Basic stats: COMPLETE Column stats: COMPLETE
               PTF Operator [PTF_9]
                  Function definitions:[{"Input definition":{"type:":"WINDOWING"}},{"partition by:":"_col2","name:":"windowingtablefunction","order by:":"_col1"}]
                  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator [SEL_8]
                  |  outputColumnNames:["_col1","_col2","_col5"]
                  |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Reducer 3 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_7]
                        key expressions:_col2 (type: string), _col1 (type: string)
                        Map-reduce partition columns:_col2 (type: string)
                        sort order:++
                        Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions:_col5 (type: int)
                        PTF Operator [PTF_6]
                           Function definitions:[{"Input definition":{"type:":"PTFCOMPONENT"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col2"}},{"Partition table definition":{"partition by:":"_col2","name:":"noop","order by:":"_col2"}}]
                           Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                           Select Operator [SEL_5]
                           |  outputColumnNames:["_col1","_col2","_col5"]
                           |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Reducer 2 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_4]
                                 key expressions:_col2 (type: string)
                                 Map-reduce partition columns:_col2 (type: string)
                                 sort order:+
                                 Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                 value expressions:_col1 (type: string), _col5 (type: int)
                                 PTF Operator [PTF_3]
                                    Function definitions:[{"Input definition":{"type:":"TABLE"}},{"Partition table definition":{"partition by:":"_col2, _col1","name:":"noop","order by:":"_col2, _col1"}},{"Partition table definition":{"partition by:":"_col2, _col1","name:":"noop","order by:":"_col2, _col1"}}]
                                    Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                    Select Operator [SEL_2]
                                    |  outputColumnNames:["_col1","_col2","_col5"]
                                    |  Statistics:Num rows: 26 Data size: 5798 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 1 [SIMPLE_EDGE]
                                       Reduce Output Operator [RS_1]
                                          key expressions:p_mfgr (type: string), p_name (type: string)
                                          Map-reduce partition columns:p_mfgr (type: string), p_name (type: string)
                                          sort order:++
                                          Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
                                          value expressions:p_size (type: int)
                                          TableScan [TS_0]
                                             alias:part
                                             Statistics:Num rows: 26 Data size: 3147 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select distinct src.* from src
PREHOOK: type: QUERY
POSTHOOK: query: explain select distinct src.* from src
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_8]
            compressed:true
            Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_6]
            |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Reducer 2 [SIMPLE_EDGE]
               Reduce Output Operator [RS_5]
                  key expressions:_col0 (type: string), _col1 (type: string)
                  Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                  sort order:++
                  Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator [GBY_4]
                  |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                  |  outputColumnNames:["_col0","_col1"]
                  |  Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                  |<-Map 1 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_3]
                        key expressions:_col0 (type: string), _col1 (type: string)
                        Map-reduce partition columns:rand() (type: double)
                        sort order:++
                        Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator [SEL_1]
                           outputColumnNames:["_col0","_col1"]
                           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                           TableScan [TS_0]
                              alias:src
                              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select explode(array('a', 'b'))
PREHOOK: type: QUERY
POSTHOOK: query: explain select explode(array('a', 'b'))
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Others].

Stage-0
   Fetch Operator
      limit:-1
      UDTF Operator [UDTF_2]
         function name:explode
         Select Operator [SEL_1]
            outputColumnNames:["_col0"]
            TableScan [TS_0]
               alias:_dummy_table
PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@T1
POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@T1
PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@T2
POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@T2
PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@T3
POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@T3
PREHOOK: query: CREATE TABLE T4(key STRING, val STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@T4
POSTHOOK: query: CREATE TABLE T4(key STRING, val STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@T4
PREHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@dest_j1
POSTHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@dest_j1
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/T1.txt' INTO TABLE T1
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t1
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/T1.txt' INTO TABLE T1
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t1
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/T2.txt' INTO TABLE T2
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t2
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/T2.txt' INTO TABLE T2
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t2
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/T3.txt' INTO TABLE T3
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t3
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/T3.txt' INTO TABLE T3
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t3
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/T1.txt' INTO TABLE T4
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t4
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/T1.txt' INTO TABLE T4
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t4
PREHOOK: query: explain
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
INSERT OVERWRITE TABLE dest_j1 select src1.key, src2.value
PREHOOK: type: QUERY
POSTHOOK: query: explain
FROM src src1 JOIN src src2 ON (src1.key = src2.key)
INSERT OVERWRITE TABLE dest_j1 select src1.key, src2.value
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-3
   Stats-Aggr Operator
      Stage-0
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest_j1","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Stage-2
               Dependency Collection{}
                  Stage-1
                     Reducer 2
                     File Output Operator [FS_11]
                        compressed:true
                        Statistics:Num rows: 1219 Data size: 115805 Basic stats: COMPLETE Column stats: COMPLETE
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest_j1","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                        Select Operator [SEL_9]
                           outputColumnNames:["_col0","_col1"]
                           Statistics:Num rows: 1219 Data size: 115805 Basic stats: COMPLETE Column stats: COMPLETE
                           Merge Join Operator [MERGEJOIN_16]
                           |  condition map:[{"":"Inner Join 0 to 1"}]
                           |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                           |  outputColumnNames:["_col1","_col2"]
                           |  Statistics:Num rows: 1219 Data size: 216982 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 1 [SIMPLE_EDGE]
                           |  Reduce Output Operator [RS_5]
                           |     key expressions:_col0 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:+
                           |     Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                           |     value expressions:_col1 (type: string)
                           |     Select Operator [SEL_1]
                           |        outputColumnNames:["_col0","_col1"]
                           |        Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                           |        Filter Operator [FIL_14]
                           |           predicate:key is not null (type: boolean)
                           |           Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                           |           TableScan [TS_0]
                           |              alias:src1
                           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                           |<-Map 3 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_7]
                                 key expressions:_col0 (type: string)
                                 Map-reduce partition columns:_col0 (type: string)
                                 sort order:+
                                 Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                 Select Operator [SEL_3]
                                    outputColumnNames:["_col0"]
                                    Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                    Filter Operator [FIL_15]
                                       predicate:key is not null (type: boolean)
                                       Statistics:Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                                       TableScan [TS_2]
                                          alias:src1
                                          Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: FROM src src1 JOIN src src2 ON (src1.key = src2.key)
INSERT OVERWRITE TABLE dest_j1 select src1.key, src2.value
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@dest_j1
POSTHOOK: query: FROM src src1 JOIN src src2 ON (src1.key = src2.key)
INSERT OVERWRITE TABLE dest_j1 select src1.key, src2.value
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@dest_j1
POSTHOOK: Lineage: dest_j1.key EXPRESSION [(src)src1.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: dest_j1.value SIMPLE [(src)src1.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: explain
select /*+ STREAMTABLE(a) */ *
FROM T1 a JOIN T2 b ON a.key = b.key
          JOIN T3 c ON b.key = c.key
          JOIN T4 d ON c.key = d.key
PREHOOK: type: QUERY
POSTHOOK: query: explain
select /*+ STREAMTABLE(a) */ *
FROM T1 a JOIN T2 b ON a.key = b.key
          JOIN T3 c ON b.key = c.key
          JOIN T4 d ON c.key = d.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Hint].

Vertex dependency in root stage
Map 1 <- Map 2 (BROADCAST_EDGE), Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Map 1
         File Output Operator [FS_14]
            compressed:true
            Statistics:Num rows: 3 Data size: 99 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_13]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
               Statistics:Num rows: 3 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator [MAPJOIN_31]
               |  condition map:[{"":"Inner Join 0 to 1"},{"":"Inner Join 1 to 2"},{"":"Inner Join 2 to 3"}]
               |  keys:{"Map 1":"key (type: string)","Map 2":"key (type: string)","Map 3":"key (type: string)","Map 4":"key (type: string)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6","_col10","_col11","_col15","_col16"]
               |  Statistics:Num rows: 3 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |<-Map 4 [BROADCAST_EDGE]
               |  Reduce Output Operator [RS_11]
               |     key expressions:key (type: string)
               |     Map-reduce partition columns:key (type: string)
               |     sort order:+
               |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:val (type: string)
               |     Filter Operator [FIL_30]
               |        predicate:key is not null (type: boolean)
               |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_3]
               |           alias:d
               |           Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [BROADCAST_EDGE]
               |  Reduce Output Operator [RS_9]
               |     key expressions:key (type: string)
               |     Map-reduce partition columns:key (type: string)
               |     sort order:+
               |     Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:val (type: string)
               |     Filter Operator [FIL_29]
               |        predicate:key is not null (type: boolean)
               |        Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_2]
               |           alias:c
               |           Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: NONE
               |<-Map 2 [BROADCAST_EDGE]
               |  Reduce Output Operator [RS_7]
               |     key expressions:key (type: string)
               |     Map-reduce partition columns:key (type: string)
               |     sort order:+
               |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:val (type: string)
               |     Filter Operator [FIL_28]
               |        predicate:key is not null (type: boolean)
               |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_1]
               |           alias:b
               |           Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |<-Filter Operator [FIL_27]
                     predicate:key is not null (type: boolean)
                     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                     TableScan [TS_0]
                        alias:a
                        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain
select /*+ STREAMTABLE(a,c) */ *
FROM T1 a JOIN T2 b ON a.key = b.key
          JOIN T3 c ON b.key = c.key
          JOIN T4 d ON c.key = d.key
PREHOOK: type: QUERY
POSTHOOK: query: explain
select /*+ STREAMTABLE(a,c) */ *
FROM T1 a JOIN T2 b ON a.key = b.key
          JOIN T3 c ON b.key = c.key
          JOIN T4 d ON c.key = d.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Hint].

Vertex dependency in root stage
Map 1 <- Map 2 (BROADCAST_EDGE), Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Map 1
         File Output Operator [FS_14]
            compressed:true
            Statistics:Num rows: 3 Data size: 99 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_13]
               outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
               Statistics:Num rows: 3 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator [MAPJOIN_31]
               |  condition map:[{"":"Inner Join 0 to 1"},{"":"Inner Join 1 to 2"},{"":"Inner Join 2 to 3"}]
               |  keys:{"Map 1":"key (type: string)","Map 2":"key (type: string)","Map 3":"key (type: string)","Map 4":"key (type: string)"}
               |  outputColumnNames:["_col0","_col1","_col5","_col6","_col10","_col11","_col15","_col16"]
               |  Statistics:Num rows: 3 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |<-Map 4 [BROADCAST_EDGE]
               |  Reduce Output Operator [RS_11]
               |     key expressions:key (type: string)
               |     Map-reduce partition columns:key (type: string)
               |     sort order:+
               |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:val (type: string)
               |     Filter Operator [FIL_30]
               |        predicate:key is not null (type: boolean)
               |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_3]
               |           alias:d
               |           Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [BROADCAST_EDGE]
               |  Reduce Output Operator [RS_9]
               |     key expressions:key (type: string)
               |     Map-reduce partition columns:key (type: string)
               |     sort order:+
               |     Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:val (type: string)
               |     Filter Operator [FIL_29]
               |        predicate:key is not null (type: boolean)
               |        Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_2]
               |           alias:c
               |           Statistics:Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: NONE
               |<-Map 2 [BROADCAST_EDGE]
               |  Reduce Output Operator [RS_7]
               |     key expressions:key (type: string)
               |     Map-reduce partition columns:key (type: string)
               |     sort order:+
               |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:val (type: string)
               |     Filter Operator [FIL_28]
               |        predicate:key is not null (type: boolean)
               |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_1]
               |           alias:b
               |           Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
               |<-Filter Operator [FIL_27]
                     predicate:key is not null (type: boolean)
                     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                     TableScan [TS_0]
                        alias:a
                        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain FROM T1 a JOIN src c ON c.key+1=a.key select /*+ STREAMTABLE(a) */ sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key))
PREHOOK: type: QUERY
POSTHOOK: query: explain FROM T1 a JOIN src c ON c.key+1=a.key select /*+ STREAMTABLE(a) */ sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key))
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Hint].

Vertex dependency in root stage
Reducer 3 <- Map 2 (SIMPLE_EDGE)
Map 2 <- Map 1 (BROADCAST_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_13]
            compressed:true
            Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_11]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)"]
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_10]
                  sort order:
                  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                  Group By Operator [GBY_9]
                  |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)"]
                  |  outputColumnNames:["_col0","_col1","_col2"]
                  |  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                  |<-Map 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_8]
                        Map-reduce partition columns:rand() (type: double)
                        sort order:
                        Statistics:Num rows: 275 Data size: 23925 Basic stats: COMPLETE Column stats: NONE
                        value expressions:hash(_col0) (type: int), hash(_col1) (type: int), hash(_col5) (type: int)
                        Map Join Operator [MAPJOIN_18]
                        |  condition map:[{"":"Inner Join 0 to 1"}]
                        |  keys:{"Map 1":"UDFToDouble(key) (type: double)","Map 2":"(key + 1) (type: double)"}
                        |  outputColumnNames:["_col0","_col1","_col5"]
                        |  Statistics:Num rows: 275 Data size: 23925 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 1 [BROADCAST_EDGE]
                        |  Reduce Output Operator [RS_3]
                        |     key expressions:UDFToDouble(key) (type: double)
                        |     Map-reduce partition columns:UDFToDouble(key) (type: double)
                        |     sort order:+
                        |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |     value expressions:key (type: string), val (type: string)
                        |     Filter Operator [FIL_16]
                        |        predicate:UDFToDouble(key) is not null (type: boolean)
                        |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |        TableScan [TS_0]
                        |           alias:a
                        |           Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |<-Filter Operator [FIL_17]
                              predicate:(key + 1) is not null (type: boolean)
                              Statistics:Num rows: 250 Data size: 21750 Basic stats: COMPLETE Column stats: COMPLETE
                              TableScan [TS_1]
                                 alias:c
                                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: FROM T1 a JOIN src c ON c.key+1=a.key select /*+ STREAMTABLE(a) */ sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key))
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Input: default@t1
#### A masked pattern was here ####
POSTHOOK: query: FROM T1 a JOIN src c ON c.key+1=a.key select /*+ STREAMTABLE(a) */ sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key))
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Input: default@t1
#### A masked pattern was here ####
198	6274	194
PREHOOK: query: explain 
select * FROM 
(select src.* FROM src) x
JOIN 
(select src.* FROM src) Y
ON (x.key = Y.key)
PREHOOK: type: QUERY
POSTHOOK: query: explain 
select * FROM 
(select src.* FROM src) x
JOIN 
(select src.* FROM src) Y
ON (x.key = Y.key)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_10]
            compressed:true
            Statistics:Num rows: 1219 Data size: 433964 Basic stats: COMPLETE Column stats: COMPLETE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_15]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
            |  outputColumnNames:["_col0","_col1","_col2","_col3"]
            |  Statistics:Num rows: 1219 Data size: 433964 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_5]
            |     key expressions:_col0 (type: string)
            |     Map-reduce partition columns:_col0 (type: string)
            |     sort order:+
            |     Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |     value expressions:_col1 (type: string)
            |     Select Operator [SEL_1]
            |        outputColumnNames:["_col0","_col1"]
            |        Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |        Filter Operator [FIL_13]
            |           predicate:key is not null (type: boolean)
            |           Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
            |           TableScan [TS_0]
            |              alias:src
            |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
            |<-Map 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_7]
                  key expressions:_col0 (type: string)
                  Map-reduce partition columns:_col0 (type: string)
                  sort order:+
                  Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions:_col1 (type: string)
                  Select Operator [SEL_3]
                     outputColumnNames:["_col0","_col1"]
                     Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                     Filter Operator [FIL_14]
                        predicate:key is not null (type: boolean)
                        Statistics:Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                        TableScan [TS_2]
                           alias:src
                           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
PREHOOK: query: explain select /*+ mapjoin(k)*/ sum(hash(k.key)), sum(hash(v.val)) from T1 k join T1 v on k.key=v.val
PREHOOK: type: QUERY
POSTHOOK: query: explain select /*+ mapjoin(k)*/ sum(hash(k.key)), sum(hash(v.val)) from T1 k join T1 v on k.key=v.val
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Hint].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Map 1 <- Map 4 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_13]
            compressed:true
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_11]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 2 [SIMPLE_EDGE]
               Reduce Output Operator [RS_10]
                  sort order:
                  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint)
                  Group By Operator [GBY_9]
                  |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
                  |  outputColumnNames:["_col0","_col1"]
                  |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                  |<-Map 1 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_8]
                        Map-reduce partition columns:rand() (type: double)
                        sort order:
                        Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        value expressions:hash(_col0) (type: int), hash(_col6) (type: int)
                        Map Join Operator [MAPJOIN_18]
                        |  condition map:[{"":"Inner Join 0 to 1"}]
                        |  keys:{"Map 1":"key (type: string)","Map 4":"val (type: string)"}
                        |  outputColumnNames:["_col0","_col6"]
                        |  Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 4 [BROADCAST_EDGE]
                        |  Reduce Output Operator [RS_5]
                        |     key expressions:val (type: string)
                        |     Map-reduce partition columns:val (type: string)
                        |     sort order:+
                        |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |     Filter Operator [FIL_17]
                        |        predicate:val is not null (type: boolean)
                        |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |        TableScan [TS_1]
                        |           alias:v
                        |           Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |<-Filter Operator [FIL_16]
                              predicate:key is not null (type: boolean)
                              Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                              TableScan [TS_0]
                                 alias:k
                                 Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select sum(hash(k.key)), sum(hash(v.val)) from T1 k join T1 v on k.key=v.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select sum(hash(k.key)), sum(hash(v.val)) from T1 k join T1 v on k.key=v.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing statistics. Please check log for more details.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Map 1 <- Map 4 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_13]
            compressed:true
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_11]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 2 [SIMPLE_EDGE]
               Reduce Output Operator [RS_10]
                  sort order:
                  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint)
                  Group By Operator [GBY_9]
                  |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
                  |  outputColumnNames:["_col0","_col1"]
                  |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                  |<-Map 1 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_8]
                        Map-reduce partition columns:rand() (type: double)
                        sort order:
                        Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        value expressions:hash(_col0) (type: int), hash(_col6) (type: int)
                        Map Join Operator [MAPJOIN_18]
                        |  condition map:[{"":"Inner Join 0 to 1"}]
                        |  keys:{"Map 1":"key (type: string)","Map 4":"key (type: string)"}
                        |  outputColumnNames:["_col0","_col6"]
                        |  Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 4 [BROADCAST_EDGE]
                        |  Reduce Output Operator [RS_5]
                        |     key expressions:key (type: string)
                        |     Map-reduce partition columns:key (type: string)
                        |     sort order:+
                        |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |     value expressions:val (type: string)
                        |     Filter Operator [FIL_17]
                        |        predicate:key is not null (type: boolean)
                        |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |        TableScan [TS_1]
                        |           alias:v
                        |           Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |<-Filter Operator [FIL_16]
                              predicate:key is not null (type: boolean)
                              Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                              TableScan [TS_0]
                                 alias:k
                                 Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select count(1) from  T1 a join T1 b on a.key = b.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select count(1) from  T1 a join T1 b on a.key = b.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing statistics. Please check log for more details.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Map 1 <- Map 4 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_13]
            compressed:true
            Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_11]
            |  aggregations:["count(VALUE._col0)"]
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 2 [SIMPLE_EDGE]
               Reduce Output Operator [RS_10]
                  sort order:
                  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint)
                  Group By Operator [GBY_9]
                  |  aggregations:["count(1)"]
                  |  outputColumnNames:["_col0"]
                  |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  |<-Map 1 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_8]
                        Map-reduce partition columns:rand() (type: double)
                        sort order:
                        Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator [MAPJOIN_18]
                        |  condition map:[{"":"Inner Join 0 to 1"}]
                        |  keys:{"Map 1":"key (type: string)","Map 4":"key (type: string)"}
                        |  Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 4 [BROADCAST_EDGE]
                        |  Reduce Output Operator [RS_5]
                        |     key expressions:key (type: string)
                        |     Map-reduce partition columns:key (type: string)
                        |     sort order:+
                        |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |     Filter Operator [FIL_17]
                        |        predicate:key is not null (type: boolean)
                        |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |        TableScan [TS_1]
                        |           alias:b
                        |           Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |<-Filter Operator [FIL_16]
                              predicate:key is not null (type: boolean)
                              Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                              TableScan [TS_0]
                                 alias:a
                                 Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain FROM T1 a LEFT OUTER JOIN T2 c ON c.key+1=a.key select sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key))
PREHOOK: type: QUERY
POSTHOOK: query: explain FROM T1 a LEFT OUTER JOIN T2 c ON c.key+1=a.key select sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key))
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing statistics. Please check log for more details.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Map 1 <- Map 4 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_11]
            compressed:true
            Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_9]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)"]
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 2 [SIMPLE_EDGE]
               Reduce Output Operator [RS_8]
                  sort order:
                  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                  Group By Operator [GBY_7]
                  |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)"]
                  |  outputColumnNames:["_col0","_col1","_col2"]
                  |  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                  |<-Map 1 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_6]
                        Map-reduce partition columns:rand() (type: double)
                        sort order:
                        Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        value expressions:hash(_col0) (type: int), hash(_col1) (type: int), hash(_col5) (type: int)
                        Map Join Operator [MAPJOIN_14]
                        |  condition map:[{"":"Left Outer Join0 to 1"}]
                        |  keys:{"Map 1":"UDFToDouble(key) (type: double)","Map 4":"(key + 1) (type: double)"}
                        |  outputColumnNames:["_col0","_col1","_col5"]
                        |  Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 4 [BROADCAST_EDGE]
                        |  Reduce Output Operator [RS_3]
                        |     key expressions:(key + 1) (type: double)
                        |     Map-reduce partition columns:(key + 1) (type: double)
                        |     sort order:+
                        |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |     value expressions:key (type: string)
                        |     TableScan [TS_1]
                        |        alias:c
                        |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |<-TableScan [TS_0]
                              alias:a
                              Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain FROM T1 a RIGHT OUTER JOIN T2 c ON c.key+1=a.key select /*+ STREAMTABLE(a) */ sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key))
PREHOOK: type: QUERY
POSTHOOK: query: explain FROM T1 a RIGHT OUTER JOIN T2 c ON c.key+1=a.key select /*+ STREAMTABLE(a) */ sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key))
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Hint].

Vertex dependency in root stage
Reducer 3 <- Map 2 (SIMPLE_EDGE)
Map 2 <- Map 1 (BROADCAST_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_11]
            compressed:true
            Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_9]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)"]
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_8]
                  sort order:
                  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                  Group By Operator [GBY_7]
                  |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)"]
                  |  outputColumnNames:["_col0","_col1","_col2"]
                  |  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                  |<-Map 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_6]
                        Map-reduce partition columns:rand() (type: double)
                        sort order:
                        Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        value expressions:hash(_col0) (type: int), hash(_col1) (type: int), hash(_col5) (type: int)
                        Map Join Operator [MAPJOIN_14]
                        |  condition map:[{"":"Right Outer Join0 to 1"}]
                        |  keys:{"Map 1":"UDFToDouble(key) (type: double)","Map 2":"(key + 1) (type: double)"}
                        |  outputColumnNames:["_col0","_col1","_col5"]
                        |  Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 1 [BROADCAST_EDGE]
                        |  Reduce Output Operator [RS_2]
                        |     key expressions:UDFToDouble(key) (type: double)
                        |     Map-reduce partition columns:UDFToDouble(key) (type: double)
                        |     sort order:+
                        |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |     value expressions:key (type: string), val (type: string)
                        |     TableScan [TS_0]
                        |        alias:a
                        |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |<-TableScan [TS_1]
                              alias:c
                              Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain FROM T1 a FULL OUTER JOIN T2 c ON c.key+1=a.key select /*+ STREAMTABLE(a) */ sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key))
PREHOOK: type: QUERY
POSTHOOK: query: explain FROM T1 a FULL OUTER JOIN T2 c ON c.key+1=a.key select /*+ STREAMTABLE(a) */ sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key))
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Hint].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_11]
            compressed:true
            Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_9]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)"]
            |  outputColumnNames:["_col0","_col1","_col2"]
            |  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_8]
                  sort order:
                  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                  Group By Operator [GBY_7]
                  |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)"]
                  |  outputColumnNames:["_col0","_col1","_col2"]
                  |  Statistics:Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                  |<-Reducer 2 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_6]
                        Map-reduce partition columns:rand() (type: double)
                        sort order:
                        Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        value expressions:hash(_col0) (type: int), hash(_col1) (type: int), hash(_col5) (type: int)
                        Merge Join Operator [MERGEJOIN_12]
                        |  condition map:[{"":"Outer Join 0 to 1"}]
                        |  keys:{"1":"(key + 1) (type: double)","0":"UDFToDouble(key) (type: double)"}
                        |  outputColumnNames:["_col0","_col1","_col5"]
                        |  Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 1 [SIMPLE_EDGE]
                        |  Reduce Output Operator [RS_2]
                        |     key expressions:UDFToDouble(key) (type: double)
                        |     Map-reduce partition columns:UDFToDouble(key) (type: double)
                        |     sort order:+
                        |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |     value expressions:key (type: string), val (type: string)
                        |     TableScan [TS_0]
                        |        alias:a
                        |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 5 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_3]
                              key expressions:(key + 1) (type: double)
                              Map-reduce partition columns:(key + 1) (type: double)
                              sort order:+
                              Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                              value expressions:key (type: string)
                              TableScan [TS_1]
                                 alias:c
                                 Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain select /*+ mapjoin(v)*/ sum(hash(k.key)), sum(hash(v.val)) from T1 k left outer join T1 v on k.key+1=v.key
PREHOOK: type: QUERY
POSTHOOK: query: explain select /*+ mapjoin(v)*/ sum(hash(k.key)), sum(hash(v.val)) from T1 k left outer join T1 v on k.key+1=v.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Hint].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
Map 1 <- Map 4 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_11]
            compressed:true
            Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_9]
            |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 2 [SIMPLE_EDGE]
               Reduce Output Operator [RS_8]
                  sort order:
                  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint), _col1 (type: bigint)
                  Group By Operator [GBY_7]
                  |  aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"]
                  |  outputColumnNames:["_col0","_col1"]
                  |  Statistics:Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                  |<-Map 1 [SIMPLE_EDGE]
                     Reduce Output Operator [RS_6]
                        Map-reduce partition columns:rand() (type: double)
                        sort order:
                        Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        value expressions:hash(_col0) (type: int), hash(_col6) (type: int)
                        Map Join Operator [MAPJOIN_14]
                        |  condition map:[{"":"Left Outer Join0 to 1"}]
                        |  keys:{"Map 1":"(key + 1) (type: double)","Map 4":"UDFToDouble(key) (type: double)"}
                        |  outputColumnNames:["_col0","_col6"]
                        |  Statistics:Num rows: 1 Data size: 33 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 4 [BROADCAST_EDGE]
                        |  Reduce Output Operator [RS_3]
                        |     key expressions:UDFToDouble(key) (type: double)
                        |     Map-reduce partition columns:UDFToDouble(key) (type: double)
                        |     sort order:+
                        |     Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |     value expressions:val (type: string)
                        |     TableScan [TS_1]
                        |        alias:v
                        |        Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
                        |<-TableScan [TS_0]
                              alias:k
                              Statistics:Num rows: 1 Data size: 30 Basic stats: COMPLETE Column stats: NONE
