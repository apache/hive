PREHOOK: query: -- Create table
create table if not exists alter_part_protect_mode(key string, value string ) partitioned by (year string, month string) stored as textfile
PREHOOK: type: CREATETABLE
POSTHOOK: query: -- Create table
create table if not exists alter_part_protect_mode(key string, value string ) partitioned by (year string, month string) stored as textfile
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@alter_part_protect_mode
PREHOOK: query: -- Load data
load data local inpath '../data/files/T1.txt' overwrite into table alter_part_protect_mode partition (year='1996', month='10')
PREHOOK: type: LOAD
PREHOOK: Output: default@alter_part_protect_mode
POSTHOOK: query: -- Load data
load data local inpath '../data/files/T1.txt' overwrite into table alter_part_protect_mode partition (year='1996', month='10')
POSTHOOK: type: LOAD
POSTHOOK: Output: default@alter_part_protect_mode
POSTHOOK: Output: default@alter_part_protect_mode@year=1996/month=10
PREHOOK: query: load data local inpath '../data/files/T1.txt' overwrite into table alter_part_protect_mode partition (year='1996', month='12')
PREHOOK: type: LOAD
PREHOOK: Output: default@alter_part_protect_mode
POSTHOOK: query: load data local inpath '../data/files/T1.txt' overwrite into table alter_part_protect_mode partition (year='1996', month='12')
POSTHOOK: type: LOAD
POSTHOOK: Output: default@alter_part_protect_mode
POSTHOOK: Output: default@alter_part_protect_mode@year=1996/month=12
PREHOOK: query: load data local inpath '../data/files/T1.txt' overwrite into table alter_part_protect_mode partition (year='1995', month='09')
PREHOOK: type: LOAD
PREHOOK: Output: default@alter_part_protect_mode
POSTHOOK: query: load data local inpath '../data/files/T1.txt' overwrite into table alter_part_protect_mode partition (year='1995', month='09')
POSTHOOK: type: LOAD
POSTHOOK: Output: default@alter_part_protect_mode
POSTHOOK: Output: default@alter_part_protect_mode@year=1995/month=09
PREHOOK: query: load data local inpath '../data/files/T1.txt' overwrite into table alter_part_protect_mode partition (year='1994', month='07')
PREHOOK: type: LOAD
PREHOOK: Output: default@alter_part_protect_mode
POSTHOOK: query: load data local inpath '../data/files/T1.txt' overwrite into table alter_part_protect_mode partition (year='1994', month='07')
POSTHOOK: type: LOAD
POSTHOOK: Output: default@alter_part_protect_mode
POSTHOOK: Output: default@alter_part_protect_mode@year=1994/month=07
PREHOOK: query: -- offline
alter table alter_part_protect_mode partition (year='1996') disable offline
PREHOOK: type: ALTERPARTITION_PROTECTMODE
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Output: default@alter_part_protect_mode@year=1996/month=10
PREHOOK: Output: default@alter_part_protect_mode@year=1996/month=12
POSTHOOK: query: -- offline
alter table alter_part_protect_mode partition (year='1996') disable offline
POSTHOOK: type: ALTERPARTITION_PROTECTMODE
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Input: default@alter_part_protect_mode@year=1996/month=10
POSTHOOK: Input: default@alter_part_protect_mode@year=1996/month=12
POSTHOOK: Output: default@alter_part_protect_mode@year=1996/month=10
POSTHOOK: Output: default@alter_part_protect_mode@year=1996/month=12
PREHOOK: query: select * from alter_part_protect_mode where year = '1996'
PREHOOK: type: QUERY
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Input: default@alter_part_protect_mode@year=1996/month=10
PREHOOK: Input: default@alter_part_protect_mode@year=1996/month=12
#### A masked pattern was here ####
POSTHOOK: query: select * from alter_part_protect_mode where year = '1996'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Input: default@alter_part_protect_mode@year=1996/month=10
POSTHOOK: Input: default@alter_part_protect_mode@year=1996/month=12
#### A masked pattern was here ####
1	11	1996	10
2	12	1996	10
3	13	1996	10
7	17	1996	10
8	18	1996	10
8	28	1996	10
1	11	1996	12
2	12	1996	12
3	13	1996	12
7	17	1996	12
8	18	1996	12
8	28	1996	12
PREHOOK: query: alter table alter_part_protect_mode partition (year='1995') enable offline
PREHOOK: type: ALTERPARTITION_PROTECTMODE
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Output: default@alter_part_protect_mode@year=1995/month=09
POSTHOOK: query: alter table alter_part_protect_mode partition (year='1995') enable offline
POSTHOOK: type: ALTERPARTITION_PROTECTMODE
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Input: default@alter_part_protect_mode@year=1995/month=09
POSTHOOK: Output: default@alter_part_protect_mode@year=1995/month=09
PREHOOK: query: alter table alter_part_protect_mode partition (year='1995') disable offline
PREHOOK: type: ALTERPARTITION_PROTECTMODE
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Output: default@alter_part_protect_mode@year=1995/month=09
POSTHOOK: query: alter table alter_part_protect_mode partition (year='1995') disable offline
POSTHOOK: type: ALTERPARTITION_PROTECTMODE
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Input: default@alter_part_protect_mode@year=1995/month=09
POSTHOOK: Output: default@alter_part_protect_mode@year=1995/month=09
PREHOOK: query: select * from alter_part_protect_mode where year = '1995'
PREHOOK: type: QUERY
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Input: default@alter_part_protect_mode@year=1995/month=09
#### A masked pattern was here ####
POSTHOOK: query: select * from alter_part_protect_mode where year = '1995'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Input: default@alter_part_protect_mode@year=1995/month=09
#### A masked pattern was here ####
1	11	1995	09
2	12	1995	09
3	13	1995	09
7	17	1995	09
8	18	1995	09
8	28	1995	09
PREHOOK: query: -- no_drop
alter table alter_part_protect_mode partition (year='1996') enable no_drop
PREHOOK: type: ALTERPARTITION_PROTECTMODE
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Output: default@alter_part_protect_mode@year=1996/month=10
PREHOOK: Output: default@alter_part_protect_mode@year=1996/month=12
POSTHOOK: query: -- no_drop
alter table alter_part_protect_mode partition (year='1996') enable no_drop
POSTHOOK: type: ALTERPARTITION_PROTECTMODE
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Input: default@alter_part_protect_mode@year=1996/month=10
POSTHOOK: Input: default@alter_part_protect_mode@year=1996/month=12
POSTHOOK: Output: default@alter_part_protect_mode@year=1996/month=10
POSTHOOK: Output: default@alter_part_protect_mode@year=1996/month=12
PREHOOK: query: alter table alter_part_protect_mode partition (year='1995') disable no_drop
PREHOOK: type: ALTERPARTITION_PROTECTMODE
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Output: default@alter_part_protect_mode@year=1995/month=09
POSTHOOK: query: alter table alter_part_protect_mode partition (year='1995') disable no_drop
POSTHOOK: type: ALTERPARTITION_PROTECTMODE
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Input: default@alter_part_protect_mode@year=1995/month=09
POSTHOOK: Output: default@alter_part_protect_mode@year=1995/month=09
PREHOOK: query: alter table alter_part_protect_mode drop partition (year='1995')
PREHOOK: type: ALTERTABLE_DROPPARTS
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Output: default@alter_part_protect_mode@year=1995/month=09
POSTHOOK: query: alter table alter_part_protect_mode drop partition (year='1995')
POSTHOOK: type: ALTERTABLE_DROPPARTS
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Output: default@alter_part_protect_mode@year=1995/month=09
PREHOOK: query: alter table alter_part_protect_mode partition (year='1994', month='07') disable no_drop
PREHOOK: type: ALTERPARTITION_PROTECTMODE
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Output: default@alter_part_protect_mode@year=1994/month=07
POSTHOOK: query: alter table alter_part_protect_mode partition (year='1994', month='07') disable no_drop
POSTHOOK: type: ALTERPARTITION_PROTECTMODE
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Input: default@alter_part_protect_mode@year=1994/month=07
POSTHOOK: Output: default@alter_part_protect_mode@year=1994/month=07
PREHOOK: query: alter table alter_part_protect_mode drop partition (year='1994')
PREHOOK: type: ALTERTABLE_DROPPARTS
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Output: default@alter_part_protect_mode@year=1994/month=07
POSTHOOK: query: alter table alter_part_protect_mode drop partition (year='1994')
POSTHOOK: type: ALTERTABLE_DROPPARTS
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Output: default@alter_part_protect_mode@year=1994/month=07
PREHOOK: query: -- Cleanup
alter table alter_part_protect_mode partition (year='1996') disable no_drop
PREHOOK: type: ALTERPARTITION_PROTECTMODE
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Output: default@alter_part_protect_mode@year=1996/month=10
PREHOOK: Output: default@alter_part_protect_mode@year=1996/month=12
POSTHOOK: query: -- Cleanup
alter table alter_part_protect_mode partition (year='1996') disable no_drop
POSTHOOK: type: ALTERPARTITION_PROTECTMODE
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Input: default@alter_part_protect_mode@year=1996/month=10
POSTHOOK: Input: default@alter_part_protect_mode@year=1996/month=12
POSTHOOK: Output: default@alter_part_protect_mode@year=1996/month=10
POSTHOOK: Output: default@alter_part_protect_mode@year=1996/month=12
PREHOOK: query: drop table alter_part_protect_mode
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@alter_part_protect_mode
PREHOOK: Output: default@alter_part_protect_mode
POSTHOOK: query: drop table alter_part_protect_mode
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@alter_part_protect_mode
POSTHOOK: Output: default@alter_part_protect_mode
